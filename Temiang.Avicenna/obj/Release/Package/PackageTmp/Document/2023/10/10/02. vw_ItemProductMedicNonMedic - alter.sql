ALTER VIEW vw_ItemProductMedicNonMedic      
AS      
SELECT ipm.ItemID,      
       ipm.SRItemUnit,      
       ipm.SRPurchaseUnit,      
       ipm.ConversionFactor,      
       ipm.IsInventoryItem,      
       ipm.PriceInPurchaseUnit,      
       ipm.PriceInBaseUnit,      
       ipm.PriceInBasedUnitWVat,      
       ipm.HighestPriceInBasedUnit,      
       ipm.CostPrice,      
       ipm.IsRegularItem,      
       ipm.IsSalesAvailable,      
       ipm.BrandName,      
       ipm.Dosage,      
       ipm.SRDosageUnit,      
       ipm.IsUsingCigna,      
       ipm.SRDrugLabelType,      
       CASE       
            WHEN ipm.isGeneric = 1 THEN 'Generic'      
            ELSE 'Non Generic'      
       END               AS GenericFlag,      
       ipm.IsControlExpired,      
       ipm.IsFornas,      
       ipm.IsFormularium,      
       ipm.Barcode,      
       ipm.IsAntibiotic,      
       ipm.IsMedication,    
       ipm.isGeneric AS IsGeneric,    
       ipm.IsNonGeneric,    
       ipm.IsNonGenericLimited,  
       ipm.SRAntibioticLine,
       ISNULL(ipm.SpecificInfo, '') AS SpecificInfo  
FROM   ItemProductMedic     ipm      
UNION ALL      
SELECT ipm.ItemID,      
       ipm.SRItemUnit,      
       ipm.SRPurchaseUnit,      
       ipm.ConversionFactor,      
       ipm.IsInventoryItem,      
       ipm.PriceInPurchaseUnit,      
       ipm.PriceInBaseUnit,      
       ipm.PriceInBasedUnitWVat,      
       ipm.HighestPriceInBasedUnit,      
       ipm.CostPrice,      
       1                    AS IsRegularItem,      
       ipm.IsSalesAvailable,      
       ipm.BrandName,      
       0                    AS Dosage,      
       ''                   AS SRDosageUnit,      
       0                    AS IsUsingCigna,      
       ''                   AS SRDrugLabelType,      
       ''                   AS GenericFlag,      
       ipm.IsControlExpired,      
       0                    AS IsFornas,      
       0                    AS IsFormularium,      
       ipm.Barcode,      
       0                    AS IsAntibiotic,      
       0                    AS IsMedication,    
       0 AS IsGeneric,    
       0 AS IsNonGeneric,    
       0 AS IsNonGenericLimited,  
       '' AS SRAntibioticLine,
       '' AS SpecificInfo  
FROM   ItemProductNonMedic     ipm      
UNION ALL      
SELECT ipm.ItemID,      
       ipm.SRItemUnit,      
       ipm.SRPurchaseUnit,      
       ipm.ConversionFactor,      
       ipm.IsInventoryItem,      
       ipm.PriceInPurchaseUnit,      
       ipm.PriceInBaseUnit,      
       ipm.PriceInBasedUnitWVat,      
       ipm.HighestPriceInBasedUnit,      
       ipm.CostPrice,      
       1            AS IsRegularItem,      
       ipm.IsSalesAvailable,      
       ''              BrandName,      
       0            AS Dosage,      
       ''           AS SRDosageUnit,      
       0            AS IsUsingCigna,      
       '1'          AS SRDrugLabelType,      
       ''           AS GenericFlag,      
       ipm.IsControlExpired,      
       0            AS IsFornas,      
       0            AS IsFormularium,      
       ipm.Barcode,      
       0            AS IsAntibiotic,      
       0            AS IsMedication,    
       0 AS IsGeneric,    
       0 AS IsNonGeneric,    
       0 AS IsNonGenericLimited,  
       '' AS SRAntibioticLine,
       '' AS SpecificInfo
FROM   ItemKitchen     ipm