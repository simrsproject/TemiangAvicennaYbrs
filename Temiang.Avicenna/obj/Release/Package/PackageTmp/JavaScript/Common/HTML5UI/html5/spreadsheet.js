(function(b,a){a("util/undoredostack",["kendo.core"],b);
}(function(){(function(a){var b=a.Observable.extend({init:function(c){a.Observable.fn.init.call(this,c);
this.clear();
},events:["undo","redo"],push:function(c){this.stack=this.stack.slice(0,this.currentCommandIndex+1);
this.currentCommandIndex=this.stack.push(c)-1;
},undo:function(){if(this.canUndo()){var c=this.stack[this.currentCommandIndex--];
c.undo();
this.trigger("undo",{command:c});
}},redo:function(){if(this.canRedo()){var c=this.stack[++this.currentCommandIndex];
c.redo();
this.trigger("redo",{command:c});
}},clear:function(){this.stack=[];
this.currentCommandIndex=-1;
},canUndo:function(){return this.currentCommandIndex>=0;
},canRedo:function(){return this.currentCommandIndex!=this.stack.length-1;
}});
a.deepExtend(a,{util:{UndoRedoStack:b}});
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("util/text-metrics",["kendo.core"],b);
}(function(){(function(a){window.kendo.util=window.kendo.util||{};
var e=kendo.Class.extend({init:function(m){this._size=m;
this._length=0;
this._map={};
},put:function(n,p){var o=this._map;
var m={key:n,value:p};
o[n]=m;
if(!this._head){this._head=this._tail=m;
}else{this._tail.newer=m;
m.older=this._tail;
this._tail=m;
}if(this._length>=this._size){o[this._head.key]=null;
this._head=this._head.newer;
this._head.older=null;
}else{this._length++;
}},get:function(n){var m=this._map[n];
if(m){if(m===this._head&&m!==this._tail){this._head=m.newer;
this._head.older=null;
}if(m!==this._tail){if(m.older){m.older.newer=m.newer;
m.newer.older=m.older;
}m.older=this._tail;
m.newer=null;
this._tail.newer=m;
this._tail=m;
}return m.value;
}}});
var i=/\r?\n|\r|\t/g;
var j=" ";
function g(m){return String(m).replace(i,j);
}function h(n){var o=[];
for(var m in n){o.push(m+n[m]);
}return o.sort().join("");
}function d(o){var m=2166136261;
for(var n=0;
n<o.length;
++n){m+=(m<<1)+(m<<4)+(m<<7)+(m<<8)+(m<<24);
m^=o.charCodeAt(n);
}return m>>>0;
}function l(){return{width:0,height:0,baseline:0};
}var b={baselineMarkerSize:1};
var c;
if(typeof document!=="undefined"){c=document.createElement("div");
c.style.cssText="position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;padding: 0 !important; margin: 0 !important; border: 0 !important;line-height: normal !important; visibility: hidden !important; white-space: pre!important;";
}var k=kendo.Class.extend({init:function(m){this._cache=new e(1000);
this.options=a.extend({},b,m);
},measure:function(v,t,r){if(r===void 0){r={};
}if(!v){return l();
}var u=h(t);
var o=d(v+u);
var n=this._cache.get(o);
if(n){return n;
}var s=l();
var q=r.box||c;
var m=this._baselineMarker().cloneNode(false);
for(var p in t){var x=t[p];
if(typeof x!=="undefined"){q.style[p]=x;
}}var w=r.normalizeText!==false?g(v):String(v);
q.textContent=w;
q.appendChild(m);
document.body.appendChild(q);
if(w.length){s.width=q.offsetWidth-this.options.baselineMarkerSize;
s.height=q.offsetHeight;
s.baseline=m.offsetTop+this.options.baselineMarkerSize;
}if(s.width>0&&s.height>0){this._cache.put(o,s);
}q.parentNode.removeChild(q);
return s;
},_baselineMarker:function(){var m=document.createElement("div");
m.style.cssText="display: inline-block; vertical-align: baseline;width: "+this.options.baselineMarkerSize+"px; height: "+this.options.baselineMarkerSize+"px;overflow: hidden;";
return m;
}});
k.current=new k();
function f(o,n,m){return k.current.measure(o,n,m);
}kendo.deepExtend(kendo.util,{LRUCache:e,TextMetrics:k,measureText:f,objectKey:h,hashKey:d,normalizeText:g});
}(window.kendo.jQuery));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("util/main",["kendo.core"],b);
}(function(){(function(){var d=window.kendo,b=d.deepExtend;
function k(m){return m*m;
}var f=Date.now;
if(!f){f=function(){return new Date().getTime();
};
}function h(m){if(typeof m!=="string"){m+="px";
}return m;
}function g(o){var p=[];
if(o){var n=d.toHyphens(o).split("-");
for(var m=0;
m<n.length;
m++){p.push("k-pos-"+n[m]);
}}return p.join(" ");
}function a(o){var m={1:"i",10:"x",100:"c",2:"ii",20:"xx",200:"cc",3:"iii",30:"xxx",300:"ccc",4:"iv",40:"xl",400:"cd",5:"v",50:"l",500:"d",6:"vi",60:"lx",600:"dc",7:"vii",70:"lxx",700:"dcc",8:"viii",80:"lxxx",800:"dccc",9:"ix",90:"xc",900:"cm",1000:"m"};
var q=[1000,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1];
var p="";
while(o>0){if(o<q[0]){q.shift();
}else{p+=m[q[0]];
o-=q[0];
}}return p;
}function i(p){p=p.toLowerCase();
var m={i:1,v:5,x:10,l:50,c:100,d:500,m:1000};
var s=0,o=0;
for(var n=0;
n<p.length;
++n){var q=m[p.charAt(n)];
if(!q){return null;
}s+=q;
if(q>o){s-=2*o;
}o=q;
}return s;
}function e(n){var m=Object.create(null);
return function(){var p="";
for(var o=arguments.length;
--o>=0;
){p+=":"+arguments[o];
}return p in m?m[p]:m[p]=n.apply(this,arguments);
};
}function c(m){return j.test(m);
}function l(n,o){try{return n.call(o,function(q){throw new p(q);
});
}catch(m){if(m instanceof p){return m.value;
}throw m;
}function p(q){this.value=q;
}}b(d,{util:{now:f,renderPos:g,renderSize:h,sqr:k,romanToArabic:i,arabicToRoman:a,memoize:e,isUnicodeLetter:c,withExit:l}});
var j=new RegExp("[\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");
}());
return window.kendo;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("util/parse-xml",["kendo.core","util/main"],b);
}(function(){var w=String.fromCharCode;
var i={amp:38,lt:60,gt:62,quot:34,apos:39,nbsp:160};
function c(B){var A=[];
for(var z=0;
z<B.length;
++z){A.push(B.charCodeAt(z));
}return A;
}function x(A,z){if(z>65535){z-=65536;
A.push(z>>>10&1023|55296,56320|z&1023);
}else{A.push(z);
}}var u=c("<![CDATA[");
var d=c("]]>");
var e=c("-->");
var v=c("!--");
var g=c("/>");
var h=c("</");
var f=c("?>");
var q=c("?");
var m=c("<");
var l=c(">");
var s=c(";");
var j=c("=");
var a=c("&");
var r=c('"');
var b=c("'");
var t=c("#");
var n=c("x");
var y=c("X");
var k={};
function o(C,A){var E=0;
var Q=[];
var K={is:function(ac){var aa=Q.length,ab=ac.length;
while(--aa>=0&&--ab>=0){if(Q[aa].$tag!=ac[ab]&&ac[ab]!="*"){return false;
}}return ab<0?Q[Q.length-1]:null;
},exit:function(){throw k;
},stack:Q};
function M(aa){var ab=C[E++];
if(!(ab&240^240)){x(aa,(ab&3)<<18|(C[E++]&63)<<12|(C[E++]&63)<<6|C[E++]&63);
}else{if(!(ab&224^224)){x(aa,(ab&15)<<12|(C[E++]&63)<<6|C[E++]&63);
}else{if(!(ab&192^192)){x(aa,(ab&31)<<6|C[E++]&63);
}else{aa.push(ab);
}}}}function B(aa){throw new Error(aa+", at "+E);
}function N(ab){var aa=[];
while(E<C.length&&ab(C[E])){aa.push(C[E++]);
}return aa;
}function L(aa){return w.apply(0,N(aa));
}function P(){N(J);
}function D(aa){var ac=E;
for(var ab=0;
ab<aa.length;
++ab){if(C[E++]!=aa[ab]){E=ac;
return false;
}}return aa;
}function O(aa){if(!D(aa)){B("Expecting "+aa.join(", "));
}}function J(aa){return aa==9||aa==10||aa==13||aa==32;
}function F(aa){return aa>=48&&aa<=57;
}function G(aa){return aa>=48&&aa<=57||(aa|=32)>=97&&aa<=102;
}function I(aa){return aa==58||aa==95||(aa|=32)>=97&&aa<=122;
}function H(aa){return aa==45||F(aa)||I(aa);
}function T(){var aa=[];
while(E<C.length){if(D(e)){return z("comment",w.apply(0,aa));
}M(aa);
}}function Z(){var ab,aa;
if(D(q)){V();
}else{if(D(v)){T();
}else{ab=X();
aa=S(ab);
Q.push(aa);
if(D(g)){z("enter",ab,aa,true);
}else{O(l);
z("enter",ab,aa);
U(ab);
if(ab!=X()){B("Bad closing tag");
}z("leave",ab,aa);
P();
O(l);
}Q.pop();
}}}function U(ab){var aa=[];
while(E<C.length){if(D(h)){return aa.length&&z("text",w.apply(0,aa));
}else{if(D(u)){while(E<C.length&&!D(d)){M(aa);
}}else{if(D(m)){if(aa.length){z("text",w.apply(0,aa));
}Z();
aa=[];
}else{if(D(a)){W(aa);
}else{M(aa);
}}}}}B("Unclosed tag "+ab);
}function X(){if(!I(C[E])){B("Expecting XML name");
}return L(H);
}function Y(){var ab=D(r)||D(b);
if(!ab){B("Expecting string");
}var aa=[];
while(E<C.length){if(D(ab)){return w.apply(0,aa);
}else{if(D(a)){W(aa);
}else{M(aa);
}}}B("Unfinished string");
}function W(aa){var ab;
if(D(t)){if(D(n)||D(y)){ab=parseInt(L(G),16);
}else{ab=parseInt(L(F),10);
}if(isNaN(ab)){B("Bad numeric entity");
}}else{var ac=X();
ab=i[ac];
if(ab===undefined){B("Unknown entity "+ac);
}}x(aa,ab);
O(s);
}function V(){z("decl",X(),S());
O(f);
}function S(ac){var ab={$tag:ac};
while(E<C.length){P();
var aa=C[E];
if(aa==63||aa==62||aa==47){break;
}ab[X()]=(O(j),Y());
}return ab;
}function z(ae,ad,aa,ab){var ac=A&&A[ae];
if(ac){ac.call(K,ad,aa,ab);
}}var R=[];
M(R);
if(R[0]!=65279){E=0;
}while(E<C.length){P();
O(m);
Z();
P();
}}kendo.util.parseXML=function p(){try{return o.apply(this,arguments);
}catch(z){if(z!==k){throw z;
}}};
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/commands",["kendo.core","kendo.binder","kendo.window","kendo.list","kendo.tabstrip"],b);
}(function(){(function(i){if(i.support.browser.msie&&i.support.browser.version<9){return;
}var a=i.jQuery;
var e={AUTO_FILL:"autoFill",CLEAR:"clear",CUT:"cut",EDIT:"edit",PASTE:"paste",VALIDATION:"validation"};
var d=i.spreadsheet.Command=i.Class.extend({init:function(n){this.options=n;
this._workbook=n.workbook;
this._property=n&&n.property;
this._state={};
},range:function(n){if(n!==undefined){this._setRange(n);
}return this._range;
},_setRange:function(n){this._range=n;
},redo:function(){this.range().select();
this.exec();
},undo:function(){this.setState(this._state);
},getState:function(){this._state=this.range().getState(this._property);
},setState:function(n){this.range().setState(n);
},rejectState:function(n){this.undo();
return{title:n.title,body:n.message,reason:"error",type:"validationError"};
},_forEachCell:function(n){var o=this.range();
var p=o._ref;
p.forEach(function(q){o.sheet().forEach(q.toRangeRef(),n.bind(this));
}.bind(this));
},usesImage:function(){return false;
}});
i.spreadsheet.DrawingUpdateCommand=d.extend({init:function(n){this._sheet=n.sheet;
this._drawing=n.drawing;
this._orig=this._drawing.clone();
this._previous=n.previous;
},exec:function(){},undo:function(){this._drawing.reset(this._previous);
this._sheet._activeDrawing=this._drawing;
this._sheet.triggerChange({layout:true});
},redo:function(){this._drawing.reset(this._orig);
this._sheet._activeDrawing=this._drawing;
this._sheet.triggerChange({layout:true});
},usesImage:function(n){return this._drawing.image===n||this._orig.image===n||this._previous.image===n;
}});
var h=d.extend({init:function(n){d.fn.init.call(this,n);
this._drawing=n.drawing;
},usesImage:function(n){return this._drawing.image===n;
}});
i.spreadsheet.InsertImageCommand=h.extend({init:function(n){h.fn.init.call(this,n);
this._blob=n.blob;
this._width=n.width;
this._height=n.height;
},exec:function(){var p=this.range();
var q=p.sheet();
var r=this._width;
var o=this._height;
var n=r/o;
if(r>o){r=Math.min(r,300);
o=r/n;
}else{o=Math.min(o,300);
r=o*n;
}this._drawing=q.addDrawing({topLeftCell:p.topLeft(),offsetX:5,offsetY:5,width:r,height:o,opacity:1,image:this._workbook.addImage(this._blob)},true);
this._blob=null;
},undo:function(){var n=this.range().sheet();
n._activeDrawing=null;
n.removeDrawing(this._drawing);
},redo:function(){var n=this.range().sheet();
n._activeDrawing=this._drawing;
n.addDrawing(this._drawing);
}});
i.spreadsheet.DeleteDrawingCommand=h.extend({exec:function(){var n=this.range().sheet();
n._activeDrawing=null;
n.removeDrawing(this._drawing);
},undo:function(){var n=this.range().sheet();
n._activeDrawing=this._drawing;
n.addDrawing(this._drawing);
},redo:function(){this.exec();
}});
var l=h.extend({exec:function(){var n=this.range().sheet();
this._origIndex=n._drawings.indexOf(this._drawing);
n._drawings.splice(this._origIndex,1);
this._newIndex=this._reorder();
n._drawings.splice(this._newIndex,0,this._drawing);
n.triggerChange({drawings:true});
},undo:function(){var n=this.range().sheet();
n._drawings.splice(this._newIndex,1);
n._drawings.splice(this._origIndex,0,this._drawing);
n.triggerChange({drawings:true});
}});
i.spreadsheet.BringToFrontCommand=l.extend({_reorder:function(){return this.range().sheet()._drawings.length;
}});
i.spreadsheet.SendToBackCommand=l.extend({_reorder:function(){return 0;
}});
var m=d.extend({init:function(n){d.fn.init.call(this,n);
this._target=n.target;
this._value=n.value;
},exec:function(){this.getState();
this.setState(this._value);
}});
i.spreadsheet.ColumnWidthCommand=m.extend({getState:function(){this._state=this.range().sheet().columnWidth(this._target);
},setState:function(n){this.range().sheet().columnWidth(this._target,n);
}});
i.spreadsheet.RowHeightCommand=m.extend({getState:function(){this._state=this.range().sheet().rowHeight(this._target);
},setState:function(n){this.range().sheet().rowHeight(this._target,n);
}});
i.spreadsheet.HyperlinkCommand=d.extend({init:function(n){d.fn.init.call(this,n);
this._link=n.link;
},exec:function(){var n=this.range();
this._prevLink=n.link();
this._prevUnderline=n.underline();
n.link(this._link);
n.underline(true);
if(n.value()==null){this._hasSetValue=true;
n.value(this._link);
}},undo:function(){var n=this.range();
n.link(this._prevLink);
n.underline(this._prevUnderline);
if(this._hasSetValue){n.value(null);
}}});
i.spreadsheet.GridLinesChangeCommand=m.extend({getState:function(){this._state=this._range.sheet().showGridLines();
},setState:function(n){this._range.sheet().showGridLines(n);
}});
var k=i.spreadsheet.PropertyChangeCommand=d.extend({_setRange:function(n){d.prototype._setRange.call(this,n.skipHiddenCells());
},init:function(n){d.fn.init.call(this,n);
this._value=n.value;
},exec:function(){var n=this.range();
if(n.enable()){this.getState();
if(this.options.property==="format"){this._workbook.trigger("changeFormat",{range:n});
}n[this._property](this._value);
}}});
i.spreadsheet.ClearContentCommand=d.extend({exec:function(){var s=[],p,q,o,r,n;
if(!this.range().enable()){return{reason:"error",type:"cannotModifyDisabled"};
}if(!this.range().canEditArrayFormula()){return{reason:"error",type:"intersectsArray"};
}this.getState();
p=this.range().skipHiddenCells();
if(p._ref.refs&&p._ref.refs.length>1){p._ref.refs.forEach(function(t){n=p.sheet().range(t);
s=s.concat(n.values());
});
}else{s=p.values();
}o=[];
s.forEach(function(t){q=[];
t.forEach(function(){q.push(null);
});
o.push(q);
});
if(p.sheet().trigger("changing",{data:o,range:p,changeType:e.CLEAR})){return;
}p.clearContent();
r=p._getValidationState();
if(r){return this.rejectState(r);
}},undo:function(){var o=this.range().skipHiddenCells();
var q=o.sheet();
var n=this._state.data;
var r=[];
var p;
n.forEach(function(s){p=[];
s.forEach(function(t){p.push(t.value);
});
r.push(p);
});
if(q.trigger("changing",{data:r,range:o,changeType:e.CLEAR})){return;
}this.setState(this._state);
}});
i.spreadsheet.EditCommand=k.extend({init:function(n){n.property=n.property||"input";
k.fn.init.call(this,n);
},_setRange:function(n){k.prototype._setRange.apply(this,arguments);
this._editRange=this.options.arrayFormula?n:n.sheet().activeCellSelection();
},getState:function(){this._state=this.range().getState();
},exec:function(){return this.range().sheet().withCultureDecimals(this._exec.bind(this));
},undo:function(){var n=this._editRange;
var o=this._state;
if(n.sheet().trigger("changing",{data:o.data[0][0].value,range:n,changeType:e.EDIT})){return;
}this.setState(this._state);
},_exec:function(){var n=this.options.arrayFormula;
var o=this._editRange;
if(!o.enable()){return{reason:"error",type:"rangeDisabled"};
}if(!o.canEditArrayFormula()){return{reason:"error",type:"intersectsArray"};
}var r=this._value;
this.getState();
if(this.range().sheet().trigger("changing",{data:r,range:this._editRange,changeType:e.EDIT})){return;
}if(this._property=="value"){o.value(r);
return;
}try{o.link(null);
if(r===""){o.value(null);
}else{o.input(r,{arrayFormula:n});
if(/\n/.test(o.value())){o.wrap(true);
}}o._adjustRowHeight();
var q=o._getValidationState();
if(q){return this.rejectState(q);
}}catch(p){if(p instanceof i.spreadsheet.calc.ParseError){return{title:"Error in formula",body:p+"",reason:"error"};
}else{throw p;
}}}});
i.spreadsheet.InsertCommentCommand=k.extend({init:function(n){n.property="comment";
k.fn.init.call(this,n);
}});
i.spreadsheet.TextWrapCommand=k.extend({init:function(n){n.property="wrap";
k.fn.init.call(this,n);
this._value=n.value;
},getState:function(){var n={};
this.range().forEachRow(function(p){var o=p.topLeft().row;
n[o]=p.sheet().rowHeight(o);
});
this._state=this.range().getState(this._property);
this._rowHeight=n;
},undo:function(){var p=this.range().sheet();
var o=this._rowHeight;
this.range().setState(this._state);
for(var n in o){p.rowHeight(n,o[n]);
}}});
i.spreadsheet.AdjustDecimalsCommand=d.extend({init:function(n){this._delta=n.value;
n.property="format";
d.fn.init.call(this,n);
},exec:function(){var p=this.range().sheet();
var n=this._delta;
var o=i.spreadsheet.formatting;
this.getState();
p.batch(function(){this.range().forEachCell(function(t,r,q){var s=q.format;
if(!s){var u=q.value;
if(typeof u=="number"&&/\./.test(u)){s="0."+String(u).split(".")[1].replace(/\d/g,"0");
}}if(s||n>0){s=o.adjustDecimals(s||"0",n);
p.range(t,r).format(s);
}});
}.bind(this));
}});
i.spreadsheet.BorderChangeCommand=d.extend({init:function(n){n.property="border";
d.fn.init.call(this,n);
this._type=n.border;
this._style=n.style;
},_batch:function(n){return this.range().sheet().batch(n,{});
},exec:function(){var n=this;
n.getState();
n._batch(function(){n[n._type](n._style);
});
},noBorders:function(){this.range().insideBorders(null);
this.outsideBorders(null);
},allBorders:function(n){this.range().insideBorders(n);
this.outsideBorders(n);
},leftBorder:function(n){this.range().leftColumn().borderLeft(n);
},rightBorder:function(n){this.range().rightColumn().borderRight(n);
},topBorder:function(n){this.range().topRow().borderTop(n);
},bottomBorder:function(n){this.range().bottomRow().borderBottom(n);
},outsideBorders:function(o){var n=this.range();
n.leftColumn().borderLeft(o);
n.topRow().borderTop(o);
n.rightColumn().borderRight(o);
n.bottomRow().borderBottom(o);
},insideBorders:function(n){this.range().insideBorders(n);
this.outsideBorders(null);
},insideHorizontalBorders:function(n){this.range().insideHorizontalBorders(n);
},insideVerticalBorders:function(n){this.range().insideVerticalBorders(n);
}});
i.spreadsheet.MergeCellCommand=d.extend({init:function(n){d.fn.init.call(this,n);
this._type=n.value;
},exec:function(){this.getState();
this[this._type]();
},activate:function(n){this.range().sheet().activeCell(n);
},getState:function(){this._state=this.range().getState();
},undo:function(){if(this._type!=="unmerge"){this.range().unmerge();
this.activate(this.range().topLeft());
}this.range().setState(this._state);
},cells:function(){var n=this.range();
var o=n._ref;
n.merge();
this.activate(o);
},horizontally:function(){var n=this.range().topRow()._ref;
this.range().forEachRow(function(o){o.merge();
});
this.activate(n);
},vertically:function(){var n=this.range().leftColumn()._ref;
this.range().forEachColumn(function(o){o.merge();
});
this.activate(n);
},unmerge:function(){var n=this.range();
var o=n._ref.topLeft;
n.unmerge();
this.activate(o);
}});
i.spreadsheet.FreezePanesCommand=d.extend({init:function(n){d.fn.init.call(this,n);
this._type=n.value;
},exec:function(){this.getState();
this._topLeft=this.range().topLeft();
this[this._type]();
},getState:function(){this._state=this.range().sheet().getState();
},undo:function(){this.range().sheet().setState(this._state);
},panes:function(){var o=this._topLeft;
var n=this.range().sheet();
n.frozenColumns(o.col).frozenRows(o.row);
},rows:function(){var o=this._topLeft;
var n=this.range().sheet();
n.frozenRows(o.row);
},columns:function(){var o=this._topLeft;
var n=this.range().sheet();
n.frozenColumns(o.col);
},unfreeze:function(){var n=this.range().sheet();
n.frozenRows(0).frozenColumns(0);
}});
i.spreadsheet.PasteCommand=d.extend({init:function(n){d.fn.init.call(this,n);
this._clipboard=n.workbook.clipboard();
this._clipboard.parse();
this._event=n.event;
this._clipboardContent=this._clipboard._content;
this._clipboardPasteRef=this._clipboard.pasteRef();
this._sheet=this._workbook.activeSheet();
this._range=this._sheet.range(this._clipboard.pasteRef());
this._state=this._range.getState();
},exec:function(){return this.range().sheet().withCultureDecimals(this._exec.bind(this));
},undo:function(){var o=this._sheet;
var n=o.range(this._clipboardPasteRef);
if(o.trigger("changing",{data:this._state.data,range:n,changeType:e.PASTE})){return;
}this.setState(this._state);
},_exec:function(){var o=this._clipboard.canPaste();
if(!o.canPaste){if(o.menuInvoked){return{reason:"error",type:"useKeyboard"};
}if(o.pasteOnMerged){return{reason:"error",type:"modifyMerged"};
}if(o.overflow){return{reason:"error",type:"overflow"};
}if(o.pasteOnDisabled){this._event.preventDefault();
return{reason:"error",type:"cannotModifyDisabled"};
}return{reason:"error"};
}var n=this._sheet.range(this._clipboardPasteRef);
if(this._workbook.trigger("paste",{range:n,clipboardContent:this._clipboardContent})||this._sheet.trigger("changing",{data:this._clipboardContent.data,range:n,changeType:e.PASTE})){this._event.preventDefault();
return;
}else{this._sheet.range(this._clipboardPasteRef).setState(this._clipboardContent,this._clipboard);
n._adjustRowHeight();
}}});
i.spreadsheet.AdjustRowHeightCommand=d.extend({exec:function(){var n=this.options;
var p=this._workbook.activeSheet();
var o=n.range||p.range(n.rowIndex);
o._adjustRowHeight();
}});
i.spreadsheet.ToolbarPasteCommand=d.extend({exec:function(){if(i.support.clipboard.paste){this._workbook._view.clipboard.focus().select();
document.execCommand("paste");
}else{return{reason:"error",type:"useKeyboard"};
}}});
i.spreadsheet.CutCommand=d.extend({_eventType:"cut",init:function(n){d.fn.init.call(this,n);
this._clipboard=n.workbook.clipboard();
this._event=n.event;
},exec:function(){var r=this._clipboard.canCopy();
var o=[],q,n;
if(!r.canCopy){if(r.menuInvoked){return{reason:"error",type:"useKeyboard"};
}else{if(r.multiSelection){return{reason:"error",type:"unsupportedSelection"};
}}return;
}var p=this._workbook.activeSheet().selection();
if(this._eventType=="cut"){if(!p.enable()){this._event.preventDefault();
return{reason:"error",type:"cannotModifyDisabled"};
}this.getState();
}if(this._workbook.trigger(this._eventType,{range:p})){this._event.preventDefault();
}else{if(this._eventType=="cut"){q=p.values();
q.forEach(function(s){n=[];
s.forEach(function(){n.push({});
});
o.push(n);
});
if(p.sheet().trigger("changing",{data:o,range:p,changeType:e.CUT})){return;
}this._clipboard.cut();
}else{this._clipboard.copy();
}}},undo:function(){var n=this.range();
if(n.sheet().trigger("changing",{data:this._state.data,range:n,changeType:e.CUT})){return;
}this.setState(this._state);
}});
i.spreadsheet.CopyCommand=i.spreadsheet.CutCommand.extend({_eventType:"copy",undo:a.noop});
function f(n){var o=document.createElement("textarea");
a(o).addClass("k-spreadsheet-clipboard").val(n).appendTo(document.body).focus().select();
document.execCommand("copy");
a(o).remove();
}i.spreadsheet.ToolbarCopyCommand=d.extend({init:function(n){d.fn.init.call(this,n);
this._clipboard=n.workbook.clipboard();
},undo:a.noop,exec:function(){if(i.support.clipboard.copy){var n=this._workbook._view.clipboard;
f(n.html());
n.trigger("copy");
}else{return{reason:"error",type:"useKeyboard"};
}}});
i.spreadsheet.AutoFillCommand=d.extend({init:function(n){d.fn.init.call(this,n);
},origin:function(n){this._origin=n;
},exec:function(){var p=this.range(),n;
if(!p.enable()){return{reason:"error",type:"rangeDisabled"};
}if(p.intersectingArrayFormula()){return{reason:"error",type:"intersectsArray"};
}this.getState();
try{n=p._previewFillFrom(this._origin);
if(p.sheet().trigger("changing",{data:n.props,range:n.dest,changeType:e.AUTO_FILL})){return;
}n.dest._properties(n.props,true);
}catch(o){if(o instanceof i.spreadsheet.Range.FillError){return{reason:"error",type:o.code};
}throw o;
}},undo:function(){var n=this.range();
var o=this._state;
if(n.sheet().trigger("changing",{data:o.data,range:n,changeType:e.AUTO_FILL})){return;
}this.setState(this._state);
}});
i.spreadsheet.ToolbarCutCommand=d.extend({init:function(n){d.fn.init.call(this,n);
this._clipboard=n.workbook.clipboard();
},exec:function(){if(i.support.clipboard.copy){var n=this._workbook._view.clipboard;
f(n.html());
n.trigger("cut");
}else{return{reason:"error",type:"useKeyboard"};
}}});
i.spreadsheet.FilterCommand=d.extend({undo:function(){this.range().filter(this._state);
},exec:function(){var n=this.range();
this._state=n.hasFilter();
n.filter(!this._state);
}});
i.spreadsheet.SortCommand=d.extend({undo:function(){var n=this.range().sheet();
n.setState(this._state);
},exec:function(){var q=this.range();
var s=q.sheet();
var n=s.activeCell();
var p=this.options.sheet?n.topLeft.col:this.options.column||0;
var o=this.options.value==="asc"?true:false;
this._state=s.getState();
if(this.options.sheet){q=this.expandRange();
}var r=q.cantSort();
if(r){return{reason:"error",type:r.code};
}q.sort({column:p,ascending:o});
},expandRange:function(){var n=this.range().sheet();
return new i.spreadsheet.Range(n._sheetRef,n);
}});
var c=i.spreadsheet.ApplyFilterCommand=d.extend({column:function(){return this.options.column||0;
},undo:function(){var n=this.range().sheet();
n.clearFilter(this.column());
if(this._state.length){this.range().filter(this._state);
}},getState:function(){var o=this.range().sheet();
var n=o.filter();
if(n){this._state=n.columns.filter(function(p){return p.index==this.column();
}.bind(this));
}},exec:function(){var s=this.range();
var n=this.column();
var o=s.sheet().filter();
var r;
var q;
var p=false;
if(this.options.valueFilter){q={column:n,filter:new i.spreadsheet.ValueFilter(this.options.valueFilter)};
}else{if(this.options.customFilter){q={column:n,filter:new i.spreadsheet.CustomFilter(this.options.customFilter)};
}}this.getState();
if(o&&o.ref.eq(s._ref)&&o.columns.length){o.columns.forEach(function(t){if(t.index===n){p=true;
}});
r=o.columns.map(function(t){return t.index===n?q:{column:t.index,filter:t.filter};
});
if(!p){r.push(q);
}}else{r=q;
}s.filter(r);
}});
i.spreadsheet.ClearFilterCommand=c.extend({exec:function(){var o=this.range();
var n=this.column();
this.getState();
o.clearFilter(n);
}});
i.spreadsheet.HideLineCommand=d.extend({init:function(n){d.fn.init.call(this,n);
this.axis=n.axis;
},undo:function(){var n=this.range().sheet();
n.setAxisState(this._state);
},exec:function(){var n=this.range().sheet();
this._state=n.getAxisState();
if(this.axis=="row"){n.axisManager().hideSelectedRows();
}else{n.axisManager().hideSelectedColumns();
}}});
i.spreadsheet.UnHideLineCommand=i.spreadsheet.HideLineCommand.extend({exec:function(){var n=this.range().sheet();
this._state=n.getAxisState();
if(this.axis=="row"){n.axisManager().unhideSelectedRows();
}else{n.axisManager().unhideSelectedColumns();
}}});
var g=d.extend({exec:function(){this._expandedRange=this._expand(this.range());
this._state=this._expandedRange.getState();
this._indexes=this._exec(this._expandedRange.sheet());
},undo:function(){var o=this;
var n=o._expandedRange;
var p=n.sheet();
p.batch(function(){o._indexes.forEach(function(q){o._undoOne(p,q);
p._restoreModifiedFormulas(q.formulas);
});
n.setState(o._state);
},{layout:true,recalc:true,ref:n._ref});
}});
i.spreadsheet.DeleteRowCommand=g.extend({_expand:function(n){return n.resize({left:-Infinity,right:+Infinity});
},_exec:function(n){return n.axisManager().deleteSelectedRows();
},_undoOne:function(n,o){n.insertRow(o.index);
n.rowHeight(o.index,o.height);
}});
i.spreadsheet.DeleteColumnCommand=g.extend({_expand:function(n){return n.resize({top:-Infinity,bottom:+Infinity});
},_exec:function(n){return n.axisManager().deleteSelectedColumns();
},_undoOne:function(n,o){n.insertColumn(o.index);
n.columnWidth(o.index,o.width);
}});
var b=d.extend({init:function(n){d.fn.init.call(this,n);
this._value=n.value;
},undo:function(){var n=this;
var o=n.range().sheet();
o.batch(function(){for(var p=n._pos.count;
--p>=0;
){n._undoOne(o,n._pos.base);
}},{layout:true,recalc:true});
}});
i.spreadsheet.AddColumnCommand=b.extend({exec:function(){var o=this.range().sheet();
var n=o.axisManager().preventAddColumn();
if(n){return n;
}if(this._value==="left"){this._pos=o.axisManager().addColumnLeft();
}else{this._pos=o.axisManager().addColumnRight();
}},_undoOne:function(o,n){o.deleteColumn(n);
}});
i.spreadsheet.AddRowCommand=b.extend({exec:function(){var o=this.range().sheet();
var n=o.axisManager().preventAddRow();
if(n){return n;
}if(this._value==="above"){this._pos=o.axisManager().addRowAbove();
}else{this._pos=o.axisManager().addRowBelow();
}},_undoOne:function(o,n){o.deleteRow(n);
}});
i.spreadsheet.EditValidationCommand=d.extend({init:function(n){d.fn.init.call(this,n);
this._value=n.value;
},exec:function(){var n=this,o=n.range().sheet();
this.getState();
if(o.trigger("changing",{data:n._value,range:n.range(),changeType:e.VALIDATION})){return;
}o.withCultureDecimals(function(){n.range().validation(n._value);
});
},undo:function(){var n=this.range();
var o=this._state;
if(n.sheet().trigger("changing",{data:o.data[0][0].validation,range:n,changeType:e.VALIDATION})){return;
}this.setState(this._state);
}});
i.spreadsheet.OpenCommand=d.extend({cannotUndo:true,exec:function(){var n=this.options.file;
if(n.name.match(/.xlsx$/i)===null){return{reason:"error",type:"openUnsupported"};
}var o=this.options.workbook;
o.fromFile(this.options.file).then(function(){var p=o.excelImportErrors;
if(p&&p.length){o._view.openDialog("importError",{errors:p});
}});
}});
i.spreadsheet.SaveAsCommand=d.extend({cannotUndo:true,exec:function(){var n=this.options.name+this.options.extension;
if(this.options.extension===".xlsx"){this.options.workbook.saveAsExcel({fileName:n});
}else{if(this.options.extension===".pdf"){this.options.workbook.saveAsPDF(a.extend(this.options.pdf,{workbook:this.options.workbook,fileName:n}));
}}}});
var j=d.extend({init:function(n){d.fn.init.call(this,n);
this._name=n.name;
this._value=n.value;
},getState:function(){this._state=this._workbook.nameDefinition(this._name);
},setState:function(){this._workbook.nameDefinition(this._name,this._state);
this._workbook.trigger("change",{recalc:true});
}});
i.spreadsheet.DefineNameCommand=j.extend({exec:function(){this.getState();
try{this._workbook.defineName(this._name,this._value);
this._workbook.trigger("change",{recalc:true});
}catch(n){return{title:"Error",body:n+"",reason:"error"};
}}});
i.spreadsheet.DeleteNameCommand=j.extend({exec:function(){this.getState();
this._workbook.undefineName(this._name);
this._workbook.trigger("change",{recalc:true});
}});
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/formulabar",["kendo.core"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var a=d.jQuery;
var b={wrapper:"k-spreadsheet-formula-bar"};
var c=d.ui.Widget.extend({init:function(e,f){d.ui.Widget.call(this,e,f);
e=this.element.addClass(c.classNames.wrapper);
this.formulaInput=new d.spreadsheet.FormulaInput(a("<div/>").appendTo(e));
},destroy:function(){if(this.formulaInput){this.formulaInput.destroy();
}this.formulaInput=null;
}});
d.spreadsheet.FormulaBar=c;
a.extend(true,c,{classNames:b});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/formulainput",["kendo.core"],b);
}(function(){(function(h,q){if(h.support.browser.msie&&h.support.browser.version<9){return;
}var a=h.jQuery;
var p=h.ui.Widget;
var l=".kendoFormulaInput";
var j=h.keys;
var b={wrapper:"k-spreadsheet-formula-input",listWrapper:"k-spreadsheet-formula-list"};
var n=["font-family","font-size","font-stretch","font-style","font-weight","letter-spacing","text-transform","line-height"];
var i={27:"esc",37:"left",39:"right",35:"end",36:"home",32:"spacebar"};
var m=/(^_|[^a-z0-9]$)/i;
var c=p.extend({init:function(r,s){p.call(this,r,s);
r=this.element;
r.addClass(c.classNames.wrapper).attr("contenteditable",true).attr("spellcheck",false).css("white-space","pre");
if(this.options.autoScale){r.on("input",this.scale.bind(this));
}this._highlightedRefs=[];
this._staticTokens=[];
this._formulaSource();
this._formulaList();
this._popup();
this._tooltip();
r.on("keydown",this._keydown.bind(this)).on("keyup",this._keyup.bind(this)).on("blur",this._blur.bind(this)).on("input click",this._input.bind(this)).on("focus",this._focus.bind(this)).on("paste",this._paste.bind(this));
},options:{name:"FormulaInput",autoScale:false,filterOperator:"startswith",scalePadding:30,minLength:1},events:["keyup","focus"],enable:function(r){if(r===undefined){return this.element.attr("contenteditable")==="true";
}if(r){this.element.attr("contenteditable",r);
}else{this.element.removeAttr("contenteditable");
}this.element.toggleClass("k-state-disabled",!r);
},getPos:function(){var t=this.element[0];
var v=q.getSelection();
var r=u(v.focusNode,v.focusOffset);
var s=u(v.anchorNode,v.anchorOffset);
if(r!=null&&s!=null){if(r>s){var w=r;
r=s;
s=w;
}return{begin:r,end:s,collapsed:r==s};
}function u(y,A){try{(function z(C){if(C===y){throw A;
}else{if(C.nodeType==1){for(var B=C.firstChild;
B;
B=B.nextSibling){z(B);
}}else{if(C.nodeType==3){A+=C.nodeValue.length;
}}}}(t));
}catch(x){return x;
}}},setPos:function(r,v){var u=this.element[0];
r=w(u,r);
if(v!=null){v=w(u,v);
}else{v=r;
}if(r&&v){var x=document.createRange();
x.setStart(r.node,r.pos);
x.setEnd(v.node,v.pos);
var y=q.getSelection();
var s=y.getRangeAt(0);
if(t(x,s)){y.removeAllRanges();
y.addRange(x);
}}function t(z,A){return z.startOffset!=A.startOffset||z.endOffset!=A.endOffset||z.startContainer!=A.endContainer||z.endContainer!=A.endContainer;
}function w(B,C){try{(function A(F){if(F.nodeType==3){var E=F.nodeValue.length;
if(E>=C){throw F;
}C-=E;
}else{if(F.nodeType==1){for(var D=F.firstChild;
D;
D=D.nextSibling){A(D);
}}}}(B));
}catch(z){return{node:z,pos:C};
}}},end:function(){this.setPos(this.length());
},home:function(){this.setPos(0);
},select:function(){this.setPos(0,this.length());
},length:function(){return this.value().length;
},_formulaSource:function(){var s=[];
var t;
for(var r in h.spreadsheet.calc.runtime.FUNCS){if(!m.test(r)){t=r.toUpperCase();
s.push({value:t,text:t});
}}this.formulaSource=new h.data.DataSource({data:s});
},_formulaList:function(){this.list=new h.ui.StaticList(a("<ul />").addClass(c.classNames.listWrapper).insertAfter(this.element),{autoBind:false,selectable:true,change:this._formulaListChange.bind(this),dataSource:this.formulaSource,dataValueField:"value",template:"#:data.value#"});
this.list.element.on("mousedown",function(r){r.preventDefault();
});
},_formulaListChange:function(){var u=this._tokenContext();
if(!u||this._mute){return;
}var r=u.token;
var s=this.list.value()[0];
var t={replace:true,token:r,end:r.end};
if(!u.nextToken||u.nextToken.value!="("){s+="(";
}this._replaceAt(t,s);
this.popup.close();
},_popup:function(){this.popup=new h.ui.Popup(this.list.element,{anchor:this.element});
},_blur:function(){this.popup.close();
clearTimeout(this._focusId);
this.trigger("blur");
},_isFormula:function(){return/^=/.test(this.value());
},_keydown:function(r){var s=r.keyCode;
if(i[s]){this.popup.close();
this._navigated=true;
}else{if(this._move(s)){this._navigated=true;
r.preventDefault();
}}this._keyDownTimeout=setTimeout(this._syntaxHighlight.bind(this));
},_keyup:function(){var r=this.popup;
var s;
if(this._isFormula()&&!this._navigated){s=((this._tokenContext()||{}).token||{}).value;
this.filter(s);
if(!s||!this.formulaSource.view().length){r.close();
}else{r[r.visible()?"position":"open"]();
this.list.focusFirst();
}}this._navigated=false;
this._syntaxHighlight();
this.trigger("keyup");
},_input:function(){this._syntaxHighlight();
},_focus:function(){setTimeout(this._sync.bind(this));
this._focusTimeout=setTimeout(this._syntaxHighlight.bind(this));
this.trigger("focus");
},_paste:function(r){r.preventDefault();
var s=this.getPos();
var t;
if(h.support.browser.msie){t=q.clipboardData.getData("Text");
}else{t=r.originalEvent.clipboardData.getData("text/plain");
}var u=this.value();
u=u.substr(0,s.begin)+t+u.substr(s.end);
this.value(u);
this.setPos(s.begin+t.length);
this.scale();
},_move:function(r){var s=this.list;
var t=this.popup;
if(t.visible()){if(r===j.DOWN){s.focusNext();
if(!s.focus()){s.focusFirst();
}return true;
}if(r===j.UP){s.focusPrev();
if(!s.focus()){s.focusLast();
}return true;
}if(r===j.ENTER){s.select(s.focus());
t.close();
return true;
}if(r===j.TAB){s.select(s.focus());
t.close();
return true;
}if(r===j.PAGEUP){s.focusFirst();
return true;
}if(r===j.PAGEDOWN){s.focusLast();
return true;
}}return r===j.ENTER||r===j.TAB;
},_tokenContext:function(){var s=this.getPos();
var v=this.value();
if(!v||!s||!s.collapsed){return null;
}var u=h.spreadsheet.calc.tokenize(v,this.row(),this.col());
var t;
for(var r=0;
r<u.length;
++r){t=u[r];
if(o(t,s)&&/^(?:str|sym|func)$/.test(t.type)){return{token:t,nextToken:u[r+1]};
}}return null;
},_sync:function(){if(this._editorToSync&&this.isActive()){this._editorToSync.value(this.value());
}},_textContainer:function(){var r=h.getComputedStyles(this.element[0],n);
r.position="absolute";
r.visibility="hidden";
r.whiteSpace="pre";
r.top=-3333;
r.left=-3333;
this._span=a("<span style='white-space: pre'/>").css(r).insertAfter(this.element);
},_tooltip:function(){this._cellTooltip=a('<div class="k-widget k-tooltip" style="position:absolute; display:none">A1</div>').insertAfter(this.element);
},tooltip:function(r){this._cellTooltip.text(r);
},toggleTooltip:function(r){this._cellTooltip.toggle(r);
},isActive:function(){return this.element[0]===h._activeElement();
},filter:function(r){if(!r||r.length<this.options.minLength){return;
}this._mute=true;
this.list.select(-1);
this._mute=false;
this.formulaSource.filter({field:this.list.options.dataValueField,operator:this.options.filterOperator,value:r});
},hide:function(){this.enable(false);
this.element.hide();
this._cellTooltip.hide();
},show:function(){this.enable(true);
this.element.show();
},row:function(){if(this.activeCell){return this.activeCell.row;
}},col:function(){if(this.activeCell){return this.activeCell.col;
}},position:function(r){if(!r){return;
}this.show();
this.element.css({top:r.top+1+"px",left:r.left+1+"px"});
this._cellTooltip.css({top:r.top-this._cellTooltip.height()-10+"px",left:r.left});
},resize:function(r){if(!r){return;
}this.element.css({width:r.width-1,height:r.height-1});
},canInsertRef:function(s){var t=this._canInsertRef(s);
var u=t&&t.token;
var r;
if(u){for(r=0;
r<this._staticTokens.length;
r++){if(e(u,this._staticTokens[r])){return null;
}}}return t;
},_canInsertRef:function(v){if(this.popup.visible()){return null;
}var x=v;
var w=this.getPos();
var z,y;
if(w&&this._isFormula()){if(w.begin===0){return null;
}z=h.spreadsheet.calc.tokenize(this.value(),this.row(),this.col());
for(var u=0;
u<z.length;
++u){y=z[u];
if(o(y,w)){return t(y);
}if(r(y)){return s(z[u-1],y);
}}return s(y,null);
}return null;
function r(A){return A.begin>w.begin;
}function t(A){if(A){if(/^(?:num|str|bool|sym|ref)$/.test(A.type)){return{replace:true,token:A,end:A.end};
}if(/^(?:op|punc|startexp)$/.test(A.type)){if(A.end==w.end){return s(A,z[u+1]);
}return s(z[u-1],A);
}}}function s(A,B){if(A==null){return null;
}if(B==null){if(/^(?:op|startexp)$/.test(A.type)||g(A.value)){return{token:A,end:w.end};
}return null;
}if(x){if(A.type=="op"&&/^(?:punc|op)$/.test(B.type)){return{token:A,end:w.end};
}}else{if(A.type=="startexp"){return{token:A,end:w.end};
}if(/^(?:op|punc)$/.test(A.type)&&/^[,;({]$/.test(A.value)){return{token:A,end:w.end};
}if(/^(?:ref|sym)/.test(A.type)){return{token:A,replace:true,end:A.end};
}if(/^(?:ref|sym)/.test(B.type)){return{token:B,replace:true,end:B.end};
}}return false;
}},refAtPoint:function(s){var t=this._canInsertRef();
if(t){var r=s.selection()._ref.simplify().clone().relative(0,0,3);
if(s!==this.activeSheet){r=r.setSheet(s.name(),true);
}this._replaceAt(t,r.print(0,0));
}},_replaceAt:function(r,s){var w=this.value();
var v=r.token;
var u=w.substr(r.end);
w=w.substr(0,r.replace?v.begin:r.end)+s;
var t=w.length;
w+=u;
this._value(w);
this.setPos(t);
this.scale();
this._syntaxHighlight();
},syncWith:function(s){var v=this;
var r="input"+l;
var t=v._sync.bind(v),u;
if(h.support.browser.msie){r="keydown"+l;
u=function(){setTimeout(t);
};
}v._editorToSync=s;
v.element.off(r).on(r,u||t);
},scale:function(){var r=this.element;
var t,s;
if(!this._span){this._textContainer();
}this._span.html(r.html());
t=this._span.width()+this.options.scalePadding;
s=this._span.height();
if(t>r.width()){r.width(t);
}if(s>r.height()){r.height(s);
}this._sync();
},_value:function(r){this.element.text(r);
},value:function(s){if(s===undefined){var r=this.element[0].innerText;
return r.replace(/\n$/,"");
}this._value(s);
this._syntaxHighlight();
},highlightedRefs:function(){return this._highlightedRefs.slice();
},_syntaxHighlight:function(){var u=this.getPos();
var y=this.value();
var v=h.spreadsheet.Pane.classNames.series;
var s=[];
var w=0;
var t=[];
var x=[];
var r;
if(u&&!u.collapsed){return;
}if(!/^=/.test(y)){if(this._staticTokens.length||this._highlightedRefs.length){this._staticTokens=[];
this._highlightedRefs=[];
this.element.text(y);
}if(this.popup){this.popup.close();
}return;
}else{x=h.spreadsheet.calc.tokenize(y,this.row(),this.col());
x.forEach(function(A){A.active=false;
A.cls=["k-syntax-"+A.type];
if(A.type=="ref"){A.colorClass=v[w++%v.length];
A.cls.push(A.colorClass);
s.push(A);
}if(u&&A.type=="punc"){if(g(A.value)){t.unshift(A);
}else{if(d(A.value)){var z=t.shift();
if(z){if(f(A.value,z.value)){if(o(A,u)||o(z,u)){A.cls.push("k-syntax-paren-match");
z.cls.push("k-syntax-paren-match");
}}else{A.cls.push("k-syntax-error");
z.cls.push("k-syntax-error");
}}else{A.cls.push("k-syntax-error");
}}}}if(u&&o(A,u)){A.cls.push("k-syntax-at-point");
A.active=true;
r=A;
}if(A.type=="func"&&!k(A.value)&&(!u||!o(A,u))){A.cls.push("k-syntax-error");
}});
x.reverse().forEach(function(C){var z=C.begin,A=C.end;
var B=h.htmlEncode(y.substring(z,A));
y=y.substr(0,z)+"<span class='"+C.cls.join(" ")+"'>"+B+"</span>"+y.substr(A);
});
this.element.html(y);
}if(u){this.setPos(u.begin,u.end);
}if(r&&/^(?:startexp|op|punc)$/.test(r.type)){this._setStaticTokens(x);
}this._highlightedRefs=s;
},_setStaticTokens:function(t){var r,s;
this._staticTokens=[];
for(r=0;
r<t.length;
r++){s=t[r];
if(/^(?:num|str|bool|sym|ref)$/.test(s.type)){this._staticTokens.push(s);
}}},destroy:function(){this._editorToSync=null;
this.element.off(l);
clearTimeout(this._focusTimeout);
clearTimeout(this._keyDownTimeout);
this._cellTooltip=null;
this._span=null;
this.popup.destroy();
this.popup=null;
p.fn.destroy.call(this);
},insertNewline:function(){var t=this.value();
var s=this.getPos();
var r=s.end==t.length;
t=t.substr(0,s.begin)+(r?"\n\n":"\n"+t.substr(s.end));
this.value(t);
this.setPos(s.begin+1);
}});
function g(r){return r=="("||r=="["||r=="{";
}function d(r){return r==")"||r=="]"||r=="}";
}function f(r,s){return s=="("?r==")":s=="["?r=="]":s=="{"?r=="}":false;
}function o(r,s){return r.begin<=s.begin&&r.end>=s.end;
}function k(r){return h.spreadsheet.calc.runtime.FUNCS[r.toLowerCase()];
}function e(r,s){if(!r||!s){return false;
}if(r.type=="ref"&&s.type=="ref"){return r.ref.eq(s.ref);
}else{return r.value===s.value;
}}h.spreadsheet.FormulaInput=c;
a.extend(true,c,{classNames:b});
}(kendo,window));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/eventlistener",["kendo.core"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var a=d.jQuery;
var e={8:"backspace",9:"tab",13:"enter",27:"esc",37:"left",38:"up",39:"right",40:"down",35:"end",36:"home",32:"spacebar",33:"pageup",34:"pagedown",46:"delete",113:":edit"};
var g=navigator.platform.toUpperCase().indexOf("MAC")>=0;
var c=function(h){if(h>47&&h<58||h>64&&h<91||h>95&&h<112||h>185&&h<193||h>218&&h<223||h===229){return true;
}return false;
};
var f=function(h){var i=h.keyCode;
var j=e[i];
if(!j&&c(i)){j=":alphanum";
}if(!j&&h.key&&h.key.length==1){j=":alphanum";
}return j;
};
var b=d.Class.extend({init:function(k,j,h){this._handlers={};
this.target=k;
this._observer=j||window;
this.keyDownProxy=this.keyDown.bind(this);
this.mouseProxy=this.mouse.bind(this);
this.touchProxy=this.touch.bind(this);
this.threshold=5;
this._pressLocation=null;
k.on("keydown",this.keyDownProxy);
k.on("contextmenu mousedown cut copy paste scroll wheel click dblclick focus",this.mouseProxy);
k.on("touchmove touchend",this.touchProxy);
a(document.documentElement).on("mousemove mouseup",this.mouseProxy);
a(document.documentElement).on("touchmove touchend",this.touchProxy);
if(h){for(var i in h){this.on(i,h[i]);
}}},keyDown:function(h){this.handleEvent(h,f(h.originalEvent));
},touch:function(h){this.handleEvent(h,h.type);
},mouse:function(k){var l;
if(k.which){l=k.which==3;
}else{if(k.button){l=k.button==2;
}}var m=k.type;
if(m==="mousedown"){if(l){m="rightmousedown";
}else{this._pressLocation={x:k.pageX,y:k.pageY};
}}if(m==="mouseup"){if(!l){this._pressLocation=null;
}}if(m==="mousemove"&&this._pressLocation){var i=this._pressLocation.x-k.pageX;
var j=this._pressLocation.y-k.pageY;
var h=Math.sqrt(i*i+j*j);
if(h>this.threshold){m="mousedrag";
}}this.handleEvent(k,m);
},handleEvent:function(i,l){var j="";
i.mod=g?i.metaKey:i.ctrlKey&&!i.altKey;
if(i.altKey){j+="alt+";
}if(i.shiftKey){j+="shift+";
}if(i.ctrlKey){j+="ctrl+";
}j+=l;
var h=this._handlers["*+"+l];
if(h){h.call(this._observer,i,j);
}var k=this._handlers[j];
if(k){k.call(this._observer,i,j);
}},on:function(i,h){var j=this._handlers;
if(typeof h==="string"){h=this._observer[h];
}if(typeof i==="string"){i=i.split(",");
}i.forEach(function(k){j[k]=h;
});
},destroy:function(){this.target.off("keydown",this.keyDownProxy);
this.target.off("keydown",this.mouseProxy);
a(document.documentElement).off("mousemove mouseup",this.mouseProxy);
}});
d.spreadsheet.EventListener=b;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/rangelist",["kendo.core"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var l=d.Class.extend({init:function h(t,v,s,u){this.level=t;
this.value=v;
this.left=s;
this.right=u;
}});
var g=new function f(){this.left=this;
this.right=this;
this.level=0;
}();
function n(s){if(s.left.level===s.level){var t=s;
s=s.left;
t.left=s.right;
s.right=t;
}return s;
}function p(s){if(s.right.right.level===s.level){var t=s;
s=s.right;
t.right=s.left;
s.left=t;
s.level+=1;
}return s;
}function a(s,t){if(s===g){return new l(1,t,g,g);
}else{if(s.value.start>t.start){s.left=a(s.left,t);
}else{s.right=a(s.right,t);
}}return p(n(s));
}function m(u,v){if(u===g){return u;
}var s=u.value.start-v.start;
if(s===0){if(u.left!==g&&u.right!==g){var t=u.left;
while(t.right!==g){t=t.right;
}u.value=t.value;
u.left=m(u.left,u.value);
}else{if(u.left===g){u=u.right;
}else{u=u.left;
}}}else{if(s>0){u.left=m(u.left,v);
}else{u.right=m(u.right,v);
}}if(u.left.level<u.level-1||u.right.level<u.level-1){u.level-=1;
if(u.right.level>u.level){u.right.level=u.level;
}u=n(u);
u.right=n(u.right);
u.right.right=n(u.right.right);
u=p(u);
u.right=p(u.right);
}return u;
}var i=d.Class.extend({init:function q(t,s,u){this.start=t;
this.end=s;
this.value=u;
},intersects:function(s){return s.start<=this.end&&s.end>=this.start;
},clone:function(){return new i(this.start,this.end,this.value);
}});
var k=d.Class.extend({init:function(){this.root=g;
},insert:function(s){this.root=a(this.root,s);
},remove:function(s){this.root=m(this.root,s);
},findrange:function(t){var s=this.root;
while(s!=g){if(t<s.value.start){s=s.left;
}else{if(t>s.value.end){s=s.right;
}else{return s.value;
}}}return null;
},values:function(){var s=[];
r(this.root,s);
return s;
},intersecting:function(u,s){var t=[];
b(this.root,new i(u,s),t);
return t;
},map:function(s){var t=new k();
e(t,this.root,s);
return t;
},clone:function(){return this.map(function(s){return s.clone();
});
},first:function(){var s=this.root;
while(s.left!=g){s=s.left;
}return s;
},last:function(){var s=this.root;
while(s.right!=g){s=s.right;
}return s;
}});
function r(s,t){if(s===g){return;
}r(s.left,t);
t.push(s.value);
r(s.right,t);
}function b(s,t,u){if(s===g){return;
}var v=s.value;
if(t.start<v.start){b(s.left,t,u);
}if(v.intersects(t)){u.push(v);
}if(t.end>v.end){b(s.right,t,u);
}}function e(u,t,s){if(t===g){return;
}e(u,t.left,s);
u.insert(s(t.value));
e(u,t.right,s);
}var j=d.Class.extend({init:function(t,s,u){if(s===undefined){this.tree=t;
}else{this.tree=new k();
this.tree.insert(new i(t,s,u));
}},values:function(){return this.tree.values();
},map:function(s){return new j(this.tree.map(s));
},intersecting:function(t,s){return this.tree.intersecting(t,s);
},first:function(){return this.tree.first().value;
},last:function(){return this.tree.last().value;
},insert:function(t,s,u){return this.tree.insert(new i(t,s,u));
},value:function(C,s,D){if(D===undefined){if(s===undefined){s=C;
}return this.intersecting(C,s)[0].value;
}var z=this.tree.intersecting(C-1,s+1);
if(z.length){var t=z[0],v=z[z.length-1];
if(t.end<C){if(t.value===D){C=t.start;
}else{z.shift();
}}if(v.start>s){if(v.value===D){s=v.end;
}else{z.pop();
}}for(var u=0,w=z.length;
u<w;
u++){var x=z[u];
var B=x.value;
var A=x.start;
var y=x.end;
this.tree.remove(x);
if(A<C){if(B!==D){this.insert(A,C-1,B);
}else{C=A;
}}if(y>s){if(B!==D){this.insert(s+1,y,B);
}else{s=y;
}}}}this.insert(C,s,D);
},expandedValues:function(x,s){var v=this.intersecting(x,s);
var w=[];
var u=0;
for(var t=x;
t<=s;
t++){if(v[u].end<t){u++;
}w.push({index:t-x,value:v[u].value});
}return w;
},sortedIndices:function(w,t,x,u){var v=this.expandedValues(w,t);
var s=function(y,z){if(y.value===z.value){return y.index-z.index;
}return x(y.value,z.value);
};
if(u){s=function(z,A){var B=u[z.index];
var C=u[A.index];
if(B.value===C.value){return x(z.value,A.value);
}return z.index-A.index;
};
}v.sort(s);
return v;
},sort:function(w,s,u){if(this.intersecting(w,s).length===1){return;
}var x=this.expandedValues(w,s);
for(var t=0,v=u.length;
t<v;
t++){this.value(t+w,t+w,x[u[t].index].value);
}},copy:function(y,x,A){var B=this.intersecting(y,x);
var z=A;
var s;
for(var t=0,u=B.length;
t<u;
t++){var w=B[t].start;
if(w<y){w=y;
}var v=B[t].end;
if(v>x){v=x;
}s=z+(v-w);
this.value(z,s,B[t].value);
z=++s;
}},iterator:function(t,s){return new c(t,s,this.intersecting(t,s));
},getState:function(){return this.tree.clone();
},setState:function(s){this.tree=s.clone();
},toJSON:function(){return this.values();
},fromJSON:function(s){s.forEach(function(t){this.value(t.start,t.end,t.value);
},this);
}});
var c=d.Class.extend({init:function(u,s,t){this.start=u;
this.end=s;
this.index=0;
this.ranges=t;
},unique:function(){return this.ranges.map(function(s){return s.value;
});
},at:function(s){while(this.ranges[this.index]&&this.ranges[this.index].end<s){this.index++;
}return this.ranges[this.index]&&this.ranges[this.index].value;
},forEach:function(s){for(var t=this.start;
t<=this.end;
t++){s(this.at(t),t);
}this.index=0;
}});
var o=j.extend({init:function(t,s,u){this.tree=new k();
this.range=new i(t,s,u);
},intersecting:function(y,s){var w=this.tree.intersecting(y,s);
var x=[];
var v;
if(!w.length){return[this.range];
}for(var t=0,u=w.length;
t<u;
t++){v=w[t];
if(v.start>y){x.push(new i(y,v.start-1,this.range.value));
}x.push(v);
y=v.end+1;
}if(v.end<s){x.push(new i(v.end+1,s,this.range.value));
}return x;
},insert:function(t,s,u){if(u!==this.range.value){this.tree.insert(new i(t,s,u));
}},lastRangeStart:function(){var s=this.tree.root;
if(s===g){return this.range.start;
}while(s.right!==g){s=s.right;
}return s.value.end+1;
}});
d.spreadsheet.RangeTree=k;
d.spreadsheet.RangeList=j;
d.spreadsheet.SparseRangeList=o;
d.spreadsheet.ValueRange=i;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/propertybag",["kendo.core"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var e=d.Class.extend({init:function(h){this.list=h;
},get:function(h){return this.parse(this.list.value(h,h));
},set:function(i,h,j){if(j===undefined){j=h;
h=i;
}this.list.value(i,h,j);
},parse:function(h){return h;
},copy:function(j,i,h){this.list.copy(j,i,h);
},iterator:function(i,h){return this.list.iterator(i,h);
}});
var c=e.extend({set:function(i,h,j){this.list.value(i,h,JSON.stringify(j));
},parse:function(h){return JSON.parse(h);
}});
var g=e.extend({init:function(i,h){e.prototype.init.call(this,i);
this.formats=h;
},set:function(i,h,j){if(j instanceof Date){j=d.spreadsheet.dateToNumber(j);
if(!this.formats.value(i,h)){this.formats.value(i,h,f(d.culture().calendar.patterns.d));
}}else{if(typeof j=="number"){j=d.spreadsheet.calc.runtime.limitPrecision(j);
}}this.list.value(i,h,j);
}});
function f(h){return h.replace(/M/g,"m").replace(/'/g,'"').replace(/tt/,"am/pm");
}d.spreadsheet.PropertyBag=d.Class.extend({specs:[{property:e,name:"format",value:null,sortable:true,serializable:true},{property:g,name:"value",value:null,sortable:true,serializable:true,depends:"format"},{property:e,name:"formula",value:null,sortable:true,serializable:true},{property:e,name:"background",value:null,sortable:true,serializable:true},{property:c,name:"vBorders",value:null,sortable:false,serializable:false},{property:c,name:"hBorders",value:null,sortable:false,serializable:false},{property:e,name:"color",value:null,sortable:true,serializable:true},{property:e,name:"fontFamily",value:null,sortable:true,serializable:true},{property:e,name:"underline",value:null,sortable:true,serializable:true},{property:e,name:"fontSize",value:null,sortable:true,serializable:true},{property:e,name:"italic",value:null,sortable:true,serializable:true},{property:e,name:"bold",value:null,sortable:true,serializable:true},{property:e,name:"textAlign",value:null,sortable:true,serializable:true},{property:e,name:"indent",value:null,sortable:true,serializable:true},{property:e,name:"verticalAlign",value:null,sortable:true,serializable:true},{property:e,name:"wrap",value:null,sortable:true,serializable:true},{property:e,name:"validation",value:null,sortable:false,serializable:true},{property:e,name:"enable",value:null,sortable:false,serializable:true},{property:e,name:"link",value:null,sortable:true,serializable:true},{property:e,name:"editor",value:null,sortable:true,serializable:true},{property:e,name:"comment",value:null,sortable:true,serializable:true}],init:function(k,i,j){j=j||{};
var h=k*i-1;
this.rowCount=k;
this.columnCount=i;
this.cellCount=h;
this.properties={};
this.lists={};
this.specs.forEach(function(n){var l=n.name;
var o=j[l];
if(o===undefined){o=n.value;
}this.lists[l]=new d.spreadsheet.SparseRangeList(0,h,o);
var m=this.properties[l]=new n.property(this.lists[l],this.lists[n.depends]);
m.spec=n;
},this);
this.lists.formula.tree.clone=a;
this.lists.validation.tree.clone=a;
},getState:function(){var h={};
this.specs.forEach(function(i){h[i.name]=this.lists[i.name].getState();
},this);
return h;
},setState:function(h){this.specs.forEach(function(i){this.lists[i.name].setState(h[i.name]);
},this);
},get:function(i,h){if(h===undefined){return this.lists[i];
}switch(i){case"borderRight":h+=this.rowCount;
case"borderLeft":i="vBorders";
break;
case"borderBottom":h++;
case"borderTop":i="hBorders";
break;
}return h>this.cellCount?null:this.properties[i].get(h);
},set:function(i,j,h,k){switch(i){case"borderRight":j+=this.rowCount;
h+=this.rowCount;
case"borderLeft":i="vBorders";
break;
case"borderBottom":j++;
h++;
case"borderTop":i="hBorders";
break;
}if(j<=h&&h<=this.cellCount){this.properties[i].set(j,h,k);
}},fromJSON:function(h,k){for(var i=0;
i<this.specs.length;
i++){var j=this.specs[i];
if(j.serializable){if(k[j.name]!==undefined){this.set(j.name,h,h,k[j.name],false);
}}}["borderLeft","borderRight","borderTop","borderBottom"].forEach(function(l){if(k[l]!==undefined){this.set(l,h,h,k[l]);
}},this);
},copy:function(i,h,j){this.specs.forEach(function(k){this.properties[k.name].copy(i,h,j);
},this);
},iterator:function(l,n,j){var m=this.properties[l];
var k=m.iterator(n,j),h=k.at;
var i=this.cellCount;
k.at=function(o){return o>i?null:m.parse(h.call(k,o));
};
k.name=l;
k.value=m.spec.value;
return k;
},sortable:function(){return this.specs.filter(function(h){return h.sortable;
}).map(function(h){return this.lists[h.name];
},this);
},iterators:function(i,h){return this.specs.reduce(function(j,k){if(k.serializable){j.push(this.iterator(k.name,i,h));
}return j;
}.bind(this),[]);
},forEach:function(s,k,j){var p=this.iterators(s,k);
var l=this.iterator("hBorders",s,k+1);
var q=this.iterator("vBorders",s,k);
var r=this.iterator("vBorders",s+this.rowCount,k+this.rowCount);
var u,n;
function h(w,v,i){var x=v.at(i);
if(x!==v.value){u[w]=x;
}}for(n=s;
n<=k;
n++){u={};
for(var m=0;
m<p.length;
m++){var o=p[m];
var t=o.at(n);
if(t!==o.value){u[o.name]=t;
}}h("borderLeft",q,n);
h("borderRight",r,n+this.rowCount);
h("borderTop",l,n);
if((n+1)%this.rowCount){h("borderBottom",l,n+1);
}j(u);
}},forEachProperty:function(h){for(var i in this.properties){h(this.properties[i]);
}}});
function b(h){h=h.clone();
h.value=h.value.deepClone();
return h;
}function a(){var h=this.map(b);
h.clone=a;
return h;
}d.spreadsheet.ALL_PROPERTIES=d.spreadsheet.PropertyBag.prototype.specs.reduce(function(h,i){if(i.serializable){h.push(i.name);
}return h;
},["borderTop","borderRight","borderBottom","borderLeft"]);
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/references",["kendo.core"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var k=kendo.spreadsheet;
var b=kendo.Class;
function c(m){var n=Math.floor(m/26)-1;
return(n>=0?c(n):"")+String.fromCharCode(65+m%26);
}function e(m){if(/^[a-z_][a-z0-9_]*$/i.test(m)){return m;
}return"'"+m.replace(/\x27/g,"\\'")+"'";
}function d(q,p,n,o){var m="";
++p;
if(!isFinite(p)){p="";
}else{if(o!=null&&!(o&2)){p="$"+p;
}}if(!isFinite(n)){n="";
}else{m=c(n);
if(o!=null&&!(o&1)){m="$"+m;
}}if(q){return e(q)+"!"+m+p;
}else{return m+p;
}}var j=b.extend({type:"ref",sheet:"",clone:function(){return this;
},hasSheet:function(){return this._hasSheet;
},simplify:function(){return this;
},setSheet:function(n,m){this.sheet=n;
if(m!=null){this._hasSheet=m;
}return this;
},absolute:function(){return this;
},relative:function(){return this;
},adjust:function(){return this;
},toString:function(){return this.relative(0,0,3,3).print(0,0);
},forEach:function(m,n){m.call(n,this);
},map:function(m,n){return m.call(n,this);
},intersects:function(m){return this.intersect(m)!==g;
},isCell:function(){return false;
},toRow:function(){return this;
},toColumn:function(){return this;
},first:function(){return this;
},lastRange:function(){return this;
},size:function(){return 1;
},rangeAt:function(){return this;
},nextRangeIndex:function(){return 0;
},previousRangeIndex:function(){return 0;
},eq:function(q){var o=this;
var p=q;
if(o===g||p===g){return o===p;
}if(p instanceof a||p instanceof i&&!(o instanceof a)){o=q;
p=this;
}if(o instanceof a){p=p.simplify();
return p instanceof a&&o.row==p.row&&o.col==p.col&&o.sheet==p.sheet;
}else{if(o instanceof i){if(p instanceof i){return p.topLeft.eq(o.topLeft)&&p.bottomRight.eq(o.bottomRight);
}if(p instanceof l){return p.single()&&o.eq(p.refs[0]);
}}else{if(o instanceof l&&p instanceof l){var r=o.refs;
var s=p.refs;
if(r.length!=s.length){return false;
}for(var m=0,n=r.length;
m<n;
m++){if(!r[m].eq(s[m])){return false;
}}return true;
}}}return o===p;
},concat:function(m){return new l([this,m]);
},replaceAt:function(m,n){return n;
},forEachColumnIndex:function(m){this.forEachAxisIndex("col",m);
},forEachRowIndex:function(m){this.forEachAxisIndex("row",m);
},forEachAxisIndex:function(m,n){var p=[];
var o=m==="row"?"forEachRow":"forEachColumn";
this[o](function(r){var q=r.first()[m];
if(p.indexOf(q)===-1){p.push(q);
}});
p.sort(function(q,r){return q>r?1:q<r?-1:0;
}).forEach(n);
},valid:function(){return false;
},renameSheet:function(n,m){if(this.sheet&&this.sheet.toLowerCase()==n.toLowerCase()){this.sheet=m;
return true;
}}});
j.display=d;
var g=new (j.extend({init:function h(){},print:function(){return"#NULL!";
},eq:function(m){return m===this;
},forEach:function(){}}))();
var f=j.extend({ref:"name",init:function f(m){this.name=m;
},clone:function(){return new f(this.name).setSheet(this.sheet,this.hasSheet());
},print:function(){var m=e(this.name);
if(this.hasSheet()){m=e(this.sheet)+"!"+m;
}return m;
}});
var a=j.extend({ref:"cell",init:function a(o,m,n){this.row=o;
this.col=m;
this.rel=n||0;
},clone:function(){return new a(this.row,this.col,this.rel).setSheet(this.sheet,this.hasSheet());
},intersect:function(m){if(m instanceof a){if(this.eq(m)){return this;
}else{return g;
}}return m.intersect(this);
},print:function(t,s,o){var n=this.col,q=this.row,p=this.rel,m;
if(t==null&&p){var r=this.hasSheet()?e(this.sheet)+"!":"";
if(isFinite(n)){n=p&1?"C["+n+"]":"C"+(n+1);
}else{n="";
}if(isFinite(q)){q=p&2?"R["+q+"]":"R"+(q+1);
}else{q="";
}return r+q+n;
}else{m=this.absolute(t,s);
if(o){q=m.row%1048576;
n=m.col%16384;
if(q<0){q+=1048576;
}if(n<0){n+=16384;
}return d(this._hasSheet&&this.sheet,q,n,p);
}return m.valid()?d(this._hasSheet&&this.sheet,m.row,m.col,p):"#REF!";
}},absolute:function(n,m){var o=this.clone();
if(o.rel&3===0){return o;
}if(o.rel&1){o.col=(o.col+m)%16384;
}if(o.rel&2){o.row=(o.row+n)%1048576;
}o.rel=0;
return o;
},toRangeRef:function(){return new i(this,this);
},relative:function(n,m,p){if(p==null){p=this.rel;
}var q=p&2?this.row-n:this.row;
var o=p&1?this.col-m:this.col;
return new a(q,o,p).setSheet(this.sheet,this.hasSheet());
},height:function(){return 1;
},width:function(){return 1;
},toString:function(){return d(null,this.row,this.col,3);
},isCell:function(){return true;
},leftColumn:function(){return this;
},rightColumn:function(){return this;
},topRow:function(){return this;
},bottomRow:function(){return this;
},forEachRow:function(m){m(this.toRangeRef());
},forEachColumn:function(m){m(this.toRangeRef());
},adjust:function(q,m,t,s,o,r,n){var p=this.absolute(q,m);
if(o){if(p.row>=r){if(n<0&&p.row<r-n){return g;
}p.row+=n;
}}else{if(p.col>=r){if(n<0&&p.col<r-n){return g;
}p.col+=n;
}}if(t!=null&&s!=null){p=p.relative(t,s,this.rel);
}return p;
},valid:function(){if(this.rel){throw new Error("valid() called on relative reference");
}var m=this.col,n=this.row;
return !(isFinite(m)&&m<0||isFinite(n)&&n<0);
}});
var i=j.extend({ref:"range",init:function i(n,m){if(n._hasSheet&&m._hasSheet&&n.sheet.toLowerCase()!=m.sheet.toLowerCase()){this.endSheet=m.sheet;
}this.topLeft=new a(n.row,n.col,n.rel);
this.bottomRight=new a(m.row,m.col,m.rel);
this.normalize();
},clone:function(){return new i(this.topLeft.clone(),this.bottomRight.clone()).setSheet(this.sheet,this.hasSheet());
},_containsRange:function(m){return this._containsCell(m.topLeft)&&this._containsCell(m.bottomRight);
},_containsCell:function(m){return m.sheet==this.sheet&&m.row>=this.topLeft.row&&m.col>=this.topLeft.col&&m.row<=this.bottomRight.row&&m.col<=this.bottomRight.col;
},contains:function(m){if(m instanceof Array){var n=this;
return m.some(function(o){return n.contains(o);
});
}if(m instanceof a){return this._containsCell(m);
}if(m instanceof i){return this._containsRange(m);
}return false;
},_intersectRange:function(u){if(this.sheet!=u.sheet){return g;
}var n=this.topLeft.col;
var p=this.topLeft.row;
var o=this.bottomRight.col;
var m=this.bottomRight.row;
var r=u.topLeft.col;
var t=u.topLeft.row;
var s=u.bottomRight.col;
var q=u.bottomRight.row;
if(n<=s&&r<=o&&p<=q&&t<=m){return new i(new a(Math.max(p,t),Math.max(n,r)),new a(Math.min(m,q),Math.min(o,s))).setSheet(this.sheet,this.hasSheet());
}else{return g;
}},intersect:function(m){if(m instanceof a){return this._containsCell(m)?m:g;
}if(m instanceof i){return this._intersectRange(m).simplify();
}if(m instanceof l){return m.intersect(this);
}return g;
},simplify:function(){if(this.isCell()){return new a(this.topLeft.row,this.topLeft.col,this.topLeft.rel).setSheet(this.sheet,this.hasSheet());
}return this;
},normalize:function(){var m=this.topLeft,n=this.bottomRight;
var r=m.row,o=m.col,s=n.row,p=n.col;
var v=m.rel&2,t=m.rel&1;
var w=n.rel&2,u=n.rel&1;
var x,q=false;
if(v===w&&t===u){if(r>s){q=true;
x=r;
r=s;
s=x;
x=v;
v=w;
w=x;
}if(o>p){q=true;
x=o;
o=p;
p=x;
x=t;
t=u;
u=x;
}if(q){this.topLeft=new a(r,o,t|v);
this.bottomRight=new a(s,p,u|w);
}}return this;
},print:function(p,o,m){if(m||this.absolute(p,o).valid()){var n=this.topLeft.print(p,o,m)+":"+this.bottomRight.print(p,o,m);
if(this.hasSheet()){n=e(this.sheet)+(this.endSheet?":"+e(this.endSheet):"")+"!"+n;
}return n;
}return"#REF!";
},absolute:function(n,m){return new i(this.topLeft.absolute(n,m),this.bottomRight.absolute(n,m)).setSheet(this.sheet,this.hasSheet());
},relative:function(n,m,p,o){if(o==null){o=p;
}return new i(this.topLeft.relative(n,m,p),this.bottomRight.relative(n,m,o)).setSheet(this.sheet,this.hasSheet());
},height:function(){if(this.topLeft.rel!=this.bottomRight.rel){throw new Error("Mixed relative/absolute references");
}return this.bottomRight.row-this.topLeft.row+1;
},width:function(){if(this.topLeft.rel!=this.bottomRight.rel){throw new Error("Mixed relative/absolute references");
}return this.bottomRight.col-this.topLeft.col+1;
},collapse:function(){return this.topLeft.toRangeRef();
},leftColumn:function(){return new i(this.topLeft,new a(this.bottomRight.row,this.topLeft.col));
},rightColumn:function(){return new i(new a(this.topLeft.row,this.bottomRight.col),this.bottomRight);
},topRow:function(){return new i(this.topLeft,new a(this.topLeft.row,this.bottomRight.col));
},bottomRow:function(){return new i(new a(this.bottomRight.row,this.topLeft.col),this.bottomRight);
},toRangeRef:function(){return this;
},toRow:function(m){m+=Math.max(0,this.topLeft.row);
return new i(new a(m,this.topLeft.col),new a(m,this.bottomRight.col)).setSheet(this.sheet,this.hasSheet());
},toColumn:function(m){m+=Math.max(0,this.topLeft.col);
return new i(new a(this.topLeft.row,m),new a(this.bottomRight.row,m)).setSheet(this.sheet,this.hasSheet());
},toCell:function(n,m){n+=Math.max(0,this.topLeft.row);
m+=Math.max(0,this.topLeft.col);
return new a(n,m,0).setSheet(this.sheet,this.hasSheet());
},forEachRow:function(m){var r=this.topLeft.row;
var o=this.bottomRight.row;
var q=this.topLeft.col;
var n=this.bottomRight.col;
for(var p=r;
p<=o;
p++){m(new i(new a(p,q),new a(p,n)));
}},forEachColumn:function(m){var r=this.topLeft.row;
var o=this.bottomRight.row;
var q=this.topLeft.col;
var n=this.bottomRight.col;
for(var p=q;
p<=n;
p++){m(new i(new a(r,p),new a(o,p)));
}},intersecting:function(m){return m.filter(function(n){return n.toRangeRef().intersects(this);
},this);
},union:function(r,o){var p=this.intersecting(r);
var u=this.topLeft.row;
var t=this.topLeft.col;
var n=this.bottomRight.row;
var m=this.bottomRight.col;
var q=false;
p.forEach(function(v){v=v.toRangeRef();
if(v.topLeft.row<u){q=true;
u=v.topLeft.row;
}if(v.topLeft.col<t){q=true;
t=v.topLeft.col;
}if(v.bottomRight.row>n){q=true;
n=v.bottomRight.row;
}if(v.bottomRight.col>m){q=true;
m=v.bottomRight.col;
}if(o){o(v);
}});
var s=new i(new a(u,t),new a(n,m));
if(q){return s.union(r,o);
}else{return s;
}},resize:function(q){var o=Math.max.bind(Math,0);
function p(t){return t||0;
}var s=this.topLeft.row+p(q.top);
var n=this.topLeft.col+p(q.left);
var m=this.bottomRight.row+p(q.bottom);
var r=this.bottomRight.col+p(q.right);
if(n<0&&r<0||s<0&&m<0){return g;
}else{if(s<=m&&n<=r){return new i(new a(o(s),o(n)),new a(o(m),o(r)));
}else{return g;
}}},move:function(n,m){return new i(new a(this.topLeft.row+n,this.topLeft.col+m),new a(this.bottomRight.row+n,this.bottomRight.col+m));
},first:function(){return this.topLeft.clone().setSheet(this.sheet,this.hasSheet());
},isCell:function(){return !this.endSheet&&this.topLeft.eq(this.bottomRight);
},toString:function(){return this.topLeft+":"+this.bottomRight;
},adjust:function(p,m,u,r,o,q,n){var s=this.topLeft.adjust(p,m,u,r,o,q,n);
var t=this.bottomRight.adjust(p,m,u,r,o,q,n);
if(s===g&&t===g){return g;
}if(s===g){s=this.topLeft.absolute(p,m);
if(o){s.row=q;
}else{s.col=q;
}if(u!=null&&r!=null){s=s.relative(u,r,this.topLeft.rel);
}}else{if(t===g){t=this.bottomRight.absolute(p,m);
if(o){t.row=q-1;
}else{t.col=q-1;
}if(u!=null&&r!=null){t=t.relative(u,r,this.bottomRight.rel);
}}}return new i(s,t).setSheet(this.sheet,this.hasSheet()).simplify();
},valid:function(){return this.topLeft.valid()&&this.bottomRight.valid();
}});
var l=j.extend({init:function l(m){this.refs=m;
this.length=m.length;
},clone:function(){return new l(this.refs.slice());
},intersect:function(o){var m=[];
for(var n=0;
n<this.length;
++n){var p=o.intersect(this.refs[n]);
if(p!==g){m.push(p);
}}if(m.length>0){return new l(m).simplify();
}return g;
},simplify:function(){var m=new l(this.refs.reduce(function(n,o){o=o.simplify();
if(o!==g){n.push(o);
}return n;
},[]));
if(m.empty()){return g;
}if(m.single()){return m.refs[0];
}return m;
},absolute:function(n,m){return new l(this.refs.map(function(o){return o.absolute(n,m);
}));
},forEach:function(m,n){this.refs.forEach(function(o){if(o instanceof l){o.forEach(m,n);
}else{m.call(n,o);
}},n);
},toRangeRef:function(){return this.refs[0].toRangeRef();
},contains:function(m){return this.refs.some(function(n){return n.contains(m);
});
},map:function(m,n){var o=[];
this.forEach(function(p){o.push(m.call(n,p));
});
return new l(o);
},first:function(){return this.refs[0].first();
},lastRange:function(){return this.refs[this.length-1];
},size:function(){return this.length;
},single:function(){return this.length==1;
},empty:function(){return this.length===0;
},isCell:function(){return this.single()&&this.refs[0].isCell();
},rangeAt:function(m){return this.refs[m];
},nextRangeIndex:function(m){if(m===this.length-1){return 0;
}else{return m+1;
}},previousRangeIndex:function(m){if(m===0){return this.length-1;
}else{return m-1;
}},concat:function(m){return new l(this.refs.concat([m]));
},print:function(o,m,n){return this.refs.map(function(p){return p.print(o,m,n);
}).join(",");
},replaceAt:function(m,o){var n=this.refs.slice();
n.splice(m,1,o);
return new l(n);
},leftColumn:function(){return this.map(function(m){return m.leftColumn();
});
},rightColumn:function(){return this.map(function(m){return m.rightColumn();
});
},topRow:function(){return this.map(function(m){return m.topRow();
});
},bottomRow:function(){return this.map(function(m){return m.bottomRow();
});
},forEachRow:function(m){this.forEach(function(n){n.forEachRow(m);
});
},forEachColumn:function(m){this.forEach(function(n){n.forEachColumn(m);
});
},adjust:function(p,m,s,r,o,q,n){return this.map(function(t){return t.adjust(p,m,s,r,o,q,n);
}).simplify();
},toString:function(){return this.refs.map(function(m){return m.toString();
}).join(", ");
},valid:function(){for(var m=this.refs.length;
--m>=0;
){if(this.refs[m].valid()){return false;
}}return true;
},renameSheet:function(n,m){this.refs.forEach(function(o){o.renameSheet(n,m);
});
}});
k.NULLREF=g;
k.SHEETREF=new i(new a(0,0),new a(Infinity,Infinity));
k.FIRSTREF=new a(0,0);
k.Ref=j;
k.NameRef=f;
k.CellRef=a;
k.RangeRef=i;
k.UnionRef=l;
k.SHEETREF.print=function(){return"#SHEET";
};
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/autofillcalculator",["kendo.core"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var d=c.spreadsheet.RangeRef;
var b=c.spreadsheet.CellRef;
var a=c.Class.extend({init:function(e){this._grid=e;
},rectIsVertical:function(g,e,i,j){var h=this._grid.rectangle(g.toRangeRef());
var f=this._grid.rectangle(e.toRangeRef());
return Math.abs(f[j]-h[j])>Math.abs(h[i]-f[i]);
},autoFillDest:function(o,h){var p=o.topLeft;
var f=o.bottomRight;
var n;
var k=h.row>=p.row;
var j=h.col>=p.col;
if(k){n=j?4:3;
}else{n=j?2:1;
}var m,l,g,i;
if(n===4){m=p;
l=f;
i=h.row>l.row||h.col>l.col;
if(i){h=new b(Math.max(h.row,l.row),Math.max(h.col,l.col));
}if(this.rectIsVertical(l,h,"right","bottom")){g=new b(h.row,l.col);
}else{g=new b(l.row,h.col);
}}else{if(n===3){var e=new b(p.col,f.row);
if(h.row>f.row&&this.rectIsVertical(e,h,"left","bottom")){m=p;
g=new b(h.row,f.col);
}else{m=f;
g=new b(p.row,h.col);
}}else{if(n===2){var q=new b(p.row,f.col);
if(h.col>f.col&&!this.rectIsVertical(q,h,"right","top")){m=p;
g=new b(f.row,h.col);
}else{m=f;
g=new b(h.row,p.col);
}}else{m=f;
if(this.rectIsVertical(p,h,"left","top")){g=new b(h.row,p.col);
}else{g=new b(p.row,h.col);
}}}}return this._grid.normalize(new d(m,g));
}});
c.spreadsheet.AutoFillCalculator=a;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/navigator",["kendo.core","spreadsheet/autofillcalculator"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var d=c.spreadsheet.RangeRef;
var a=c.spreadsheet.CellRef;
var b=c.Class.extend({init:function(g,f,h,i){this.rangeGetter=h;
this.prevLeft=function(k){var j=i(this.range(k));
var l=this.range(f.prevVisible(j.topLeft[g]));
return i(l).topLeft[g];
};
this.nextRight=function(k){var j=i(this.range(k));
var l=this.range(f.nextVisible(j.bottomRight[g]));
return i(l).bottomRight[g];
};
this.nextLeft=function(j){var k=i(this.range(j));
return f.nextVisible(k.bottomRight[g]);
};
this.prevRight=function(j){var k=i(this.range(j));
return f.prevVisible(k.topLeft[g]);
};
},boundary:function(g,f){this.top=g;
this.bottom=f;
},range:function(f){return this.rangeGetter(f,this.top,this.bottom);
}});
var e=c.Class.extend({init:function(f){this._sheet=f;
this.columns=this._sheet._grid._columns;
this.autoFillCalculator=new c.spreadsheet.AutoFillCalculator(f._grid);
this.colEdge=new b("col",this._sheet._grid._columns,this.columnRange.bind(this),this.union.bind(this));
this.rowEdge=new b("row",this._sheet._grid._rows,this.rowRange.bind(this),this.union.bind(this));
},height:function(f){this._viewPortHeight=f;
},union:function(f){return this._sheet.unionWithMerged(f);
},columnRange:function(g,h,f){return this._sheet._ref(h,g,f-h,1);
},rowRange:function(h,f,g){return this._sheet._ref(h,f,1,g-f);
},selectionIncludesMergedCells:function(){return this._sheet.select().contains(this._sheet._mergedCells);
},setSelectionValue:function(g){var f=this._sheet.selection();
setTimeout(function(){f.value(g());
});
},selectAll:function(){this._sheet.select(this._sheet._sheetRef);
},select:function(h,g,f){h=this.refForMode(h,g);
if(f){h=this._sheet.select().concat(h);
}this._sheet.select(h);
},refForMode:function(h,g){var f=this._sheet._grid;
switch(g){case"range":h=f.normalize(h);
break;
case"row":h=f.rowRef(h.row);
break;
case"column":h=f.colRef(h.col);
break;
case"sheet":h=this._sheet._sheetRef;
break;
}return h;
},startSelection:function(i,g,f,j,k){if(g=="autofill"){this._sheet.startAutoFill();
}else{if(j&&g=="range"){var h=new d(this._sheet.activeCell().first(),i);
this._sheet.select(h,false,false);
this._sheet.startSelection(k);
}else{this._sheet.startSelection(k);
this.select(i,g,f);
}}},completeSelection:function(){this._sheet.completeSelection();
},selectForContextMenu:function(g,f){var h=this._sheet;
h._activeDrawing=null;
if(!h.select().contains(this.refForMode(g,f))){this.select(g,f);
}},selectDrawingForContextMenu:function(f){var g=this._sheet;
g._activeDrawing=f;
g.triggerChange({selection:true});
},modifySelection:function(f){var j=this.determineDirection(f);
var p=this._sheet;
var r=this._viewPortHeight;
var m=p._grid._rows;
var i=p._grid._columns;
var l=p.currentOriginalSelectionRange();
var o=p.select().toRangeRef();
var g=p.activeCell();
var q=l.topLeft.clone();
var h=l.bottomRight.clone();
var n;
this.colEdge.boundary(o.topLeft.row,o.bottomRight.row);
this.rowEdge.boundary(o.topLeft.col,o.bottomRight.col);
switch(j){case"expand-left":q.col=this.colEdge.prevLeft(q.col);
n=q;
break;
case"shrink-right":q.col=this.colEdge.nextLeft(q.col);
n=q;
break;
case"expand-right":h.col=this.colEdge.nextRight(h.col);
n=h;
break;
case"shrink-left":h.col=this.colEdge.prevRight(h.col);
n=h;
break;
case"expand-up":q.row=this.rowEdge.prevLeft(q.row);
n=q;
break;
case"shrink-down":q.row=this.rowEdge.nextLeft(q.row);
n=q;
break;
case"expand-down":h.row=this.rowEdge.nextRight(h.row);
n=h;
break;
case"shrink-up":h.row=this.rowEdge.prevRight(h.row);
n=h;
break;
case"expand-page-up":q.row=m.prevPage(q.row,r);
break;
case"shrink-page-up":h.row=m.prevPage(h.row,r);
break;
case"expand-page-down":h.row=m.nextPage(h.row,r);
break;
case"shrink-page-down":q.row=m.nextPage(q.row,r);
break;
case"first-col":q.col=i.firstVisible();
h.col=g.bottomRight.col;
n=q;
break;
case"last-col":h.col=i.lastVisible();
q.col=g.topLeft.col;
n=h;
break;
case"first-row":q.row=m.firstVisible();
h.row=g.bottomRight.row;
n=q;
break;
case"last-row":h.row=m.lastVisible();
q.row=g.topLeft.row;
n=h;
break;
case"last":h.row=m.lastVisible();
h.col=i.lastVisible();
q=g.topLeft;
n=h;
break;
case"first":q.row=m.firstVisible();
q.col=i.firstVisible();
h=g.bottomRight;
n=q;
break;
}var k=new d(q,h);
if(!this.union(k).intersects(g)){this.modifySelection(j.replace("shrink","expand"));
return;
}if(n){p.focus(n);
}this.updateCurrentSelectionRange(k);
},moveActiveCell:function(k){var n=this._sheet;
var f=n.activeCell();
var o=f.topLeft;
var g=f.bottomRight;
var h=n.originalActiveCell();
var m=n._grid._rows;
var j=n._grid._columns;
var l=h.row;
var i=h.col;
switch(k){case"left":i=j.prevVisible(o.col);
break;
case"up":l=m.prevVisible(o.row);
break;
case"right":i=j.nextVisible(g.col);
break;
case"down":l=m.nextVisible(g.row);
break;
case"first-col":i=j.firstVisible();
break;
case"last-col":i=j.lastVisible();
break;
case"first-row":l=m.firstVisible();
break;
case"last-row":l=m.lastVisible();
break;
case"last":l=m.lastVisible();
i=j.lastVisible();
break;
case"first":l=m.firstVisible();
i=j.firstVisible();
break;
case"next-page":l=m.nextPage(g.row,this._viewPortHeight);
break;
case"prev-page":l=m.prevPage(g.row,this._viewPortHeight);
break;
}n.select(new a(l,i));
},navigateInSelection:function(k){var r=this._sheet;
var f=r.activeCell();
var t=f.topLeft;
var g=r.originalActiveCell();
var n=r._grid._rows;
var i=r._grid._columns;
var m=g.row;
var h=g.col;
var p,o;
var u=t.col;
var v=t.row;
var s;
function q(w){p=w.topLeft;
o=w.bottomRight;
}q(r.currentNavigationRange());
var l=false;
while(!l){var j=new a(m,h);
switch(k){case"next":if(o.eq(j)){q(r.nextNavigationRange());
m=p.row;
h=p.col;
}else{h=i.nextVisible(u);
if(h==u||h>o.col){h=p.col;
s=n.nextVisible(m);
if(s==m||s>o.row){m=p.row;
}else{m=s;
}}}break;
case"previous":if(p.eq(j)){q(r.previousNavigationRange());
m=o.row;
h=o.col;
}else{h=i.prevVisible(u);
if(h==u||h<p.col){h=o.col;
s=n.prevVisible(m);
if(s==m||s<p.row){m=o.row;
}else{m=s;
}}}break;
case"lower":if(o.eq(j)){q(r.nextNavigationRange());
m=p.row;
h=p.col;
}else{m=n.nextVisible(v);
if(m==v||m>o.row){m=p.row;
s=i.nextVisible(h);
if(s==h||s>o.col){h=p.col;
}else{h=s;
}}}break;
case"upper":if(p.eq(j)){q(r.previousNavigationRange());
m=o.row;
h=o.col;
}else{m=n.prevVisible(v);
if(m==v||m<p.row){m=o.row;
s=i.prevVisible(h);
if(s==h||s<p.col){h=o.col;
}else{h=s;
}}}break;
default:throw new Error("Unknown entry navigation: "+k);
}l=!this.shouldSkip(m,h);
u=h;
v=m;
}if(r.singleCellSelection()){r.select(new a(m,h));
}else{r.activeCell(new a(m,h));
}},extendSelection:function(i,h){var j=this._sheet;
var g=j._grid;
if(h==="autofill"){this.resizeAutoFill(i);
return;
}if(h==="range"){i=g.normalize(i);
}else{if(h==="row"){i=g.rowRef(i.row).bottomRight;
}else{if(h==="column"){i=g.colRef(i.col).bottomRight;
}}}var f=j.originalActiveCell().toRangeRef();
this.updateCurrentSelectionRange(new d(f.topLeft,i));
},shouldSkip:function(i,f){if(this._sheet.isHiddenRow(i)||this._sheet.isHiddenColumn(f)){return true;
}var h=new a(i,f);
var g=false;
this._sheet.forEachMergedCell(function(j){if(j.intersects(h)&&!j.collapse().eq(h)){g=true;
}});
return g;
},resizeAutoFill:function(l){var n=this._sheet;
var m=n.select();
var i=n._autoFillOrigin;
var f=this.autoFillCalculator.autoFillDest(m,l);
var k=this.punch(m,f);
var h,g;
if(!k){var j=n.range(f)._previewFillFrom(n.range(i));
if(j){g=j.direction;
h=j.hint;
}}n.updateAutoFill(f,k,h,g);
},determineDirection:function(f){var k=this._sheet.currentSelectionRange();
var g=this._sheet.activeCell();
var i=g.topLeft.col==k.topLeft.col;
var j=g.bottomRight.col==k.bottomRight.col;
var l=g.topLeft.row==k.topLeft.row;
var h=g.bottomRight.row==k.bottomRight.row;
switch(f){case"left":f=j?"expand-left":"shrink-left";
break;
case"right":f=i?"expand-right":"shrink-right";
break;
case"up":f=h?"expand-up":"shrink-up";
break;
case"down":f=l?"expand-down":"shrink-down";
break;
case"prev-page":f=h?"expand-page-up":"shrink-page-up";
break;
case"next-page":f=l?"expand-page-down":"shrink-page-down";
break;
}return f;
},updateCurrentSelectionRange:function(f){var g=this._sheet;
g.select(g.originalSelect().replaceAt(g.selectionRangeIndex(),f),false);
},punch:function(i,j){var h;
if(j.topLeft.eq(i.topLeft)){if(j.bottomRight.row<i.bottomRight.row){var g=this.rowEdge.nextRight(j.bottomRight.row);
h=new d(new a(g,i.topLeft.col),i.bottomRight);
}else{if(j.bottomRight.col<i.bottomRight.col){var f=this.colEdge.nextRight(j.bottomRight.col);
h=new d(new a(i.topLeft.row,f),i.bottomRight);
}}}return h;
}});
c.spreadsheet.SheetNavigator=e;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/axismanager",["kendo.core"],b);
}(function(){(function(b){if(b.support.browser.msie&&b.support.browser.version<9){return;
}var a=b.Class.extend({init:function(c){this._sheet=c;
},forEachSelectedColumn:function(c){var d=this._sheet;
d.batch(function(){d.select().forEachColumnIndex(function(f,e){c(d,f,e);
});
},{layout:true,recalc:true});
},forEachSelectedRow:function(c){var d=this._sheet;
d.batch(function(){d.select().forEachRowIndex(function(f,e){c(d,f,e);
});
},{layout:true,recalc:true});
},includesHiddenColumns:function(c){return this._sheet._grid._columns.includesHidden(c.topLeft.col,c.bottomRight.col);
},includesHiddenRows:function(c){return this._sheet._grid._rows.includesHidden(c.topLeft.row,c.bottomRight.row);
},selectionIncludesHiddenColumns:function(){return this.includesHiddenColumns(this._sheet.select());
},selectionIncludesHiddenRows:function(){return this.includesHiddenRows(this._sheet.select());
},deleteSelectedColumns:function(){var d=[],c=0;
this.forEachSelectedColumn(function(g,f){f-=c;
if(g.isHiddenColumn(f)){return;
}c++;
var e=[];
d.unshift({index:f,formulas:e,width:g.columnWidth(f)});
g._saveModifiedFormulas(e,function(){g.deleteColumn(f);
});
});
return d;
},deleteSelectedRows:function(){var d=[],c=0;
this.forEachSelectedRow(function(g,f){f-=c;
if(g.isHiddenRow(f)){return;
}c++;
var e=[];
d.unshift({index:f,formulas:e,height:g.rowHeight(f)});
g._saveModifiedFormulas(e,function(){g.deleteRow(f);
});
});
return d;
},hideSelectedColumns:function(){this.forEachSelectedColumn(function(k,j){k.hideColumn(j);
});
var i=this._sheet;
var f=i.select().toRangeRef();
var e=f.topLeft.col;
var g=f.bottomRight.col;
var h=null;
while(true){var d=g<i._columns._count;
var c=e>=0;
if(!c&&!d){break;
}if(d&&!i.isHiddenColumn(g)){h=g;
break;
}if(c&&!i.isHiddenColumn(e)){h=e;
break;
}e--;
g++;
}if(h!==null){f=new b.spreadsheet.RangeRef(new b.spreadsheet.CellRef(0,h),new b.spreadsheet.CellRef(i._rows._count-1,h));
i.range(f).select();
}},hideSelectedRows:function(){this.forEachSelectedRow(function(k,j){k.hideRow(j);
});
var h=this._sheet;
var f=h.select().toRangeRef();
var i=f.topLeft.row;
var c=f.bottomRight.row;
var g=null;
while(true){var d=c<h._rows._count;
var e=i>=0;
if(!e&&!d){break;
}if(d&&!h.isHiddenRow(c)){g=c;
break;
}if(e&&!h.isHiddenRow(i)){g=i;
break;
}i--;
c++;
}if(g!==null){f=new b.spreadsheet.RangeRef(new b.spreadsheet.CellRef(g,0),new b.spreadsheet.CellRef(g,h._columns._count-1));
h.range(f).select();
}},unhideSelectedColumns:function(){this.forEachSelectedColumn(function(d,c){d.unhideColumn(c);
});
},unhideSelectedRows:function(){this.forEachSelectedRow(function(d,c){d.unhideRow(c);
});
},preventAddRow:function(){var c=this._sheet.select().toRangeRef();
var d=c.height();
return this._sheet.preventInsertRow(0,d);
},preventAddColumn:function(){var d=this._sheet.select().toRangeRef();
var c=d.width();
return this._sheet.preventInsertColumn(0,c);
},addColumnLeft:function(){var e=this._sheet;
var c,d=0;
e.batch(function(){e.select().forEachColumnIndex(function(f){if(!c){c=f;
}e.insertColumn(c);
++d;
});
},{recalc:true,layout:true});
return{base:c,count:d};
},addColumnRight:function(){var e=this._sheet;
var c,d=0;
e.batch(function(){e.select().forEachColumnIndex(function(g){c=g+1;
++d;
});
for(var f=0;
f<d;
++f){e.insertColumn(c);
}},{recalc:true,layout:true});
return{base:c,count:d};
},addRowAbove:function(){var e=this._sheet;
var c,d=0;
e.batch(function(){e.select().forEachRowIndex(function(f){if(!c){c=f;
}e.insertRow(c);
++d;
});
},{recalc:true,layout:true});
return{base:c,count:d};
},addRowBelow:function(){var e=this._sheet;
var c,d=0;
e.batch(function(){e.select().forEachRowIndex(function(g){c=g+1;
++d;
});
for(var f=0;
f<d;
++f){e.insertRow(c);
}},{recalc:true,layout:true});
return{base:c,count:d};
}});
b.spreadsheet.AxisManager=a;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/clipboard",["kendo.core"],b);
}(function(){(function(f){if(f.support.browser.msie&&f.support.browser.version<9){return;
}var a=f.jQuery;
var c=f.spreadsheet.CellRef;
var e=f.Class.extend({init:function(l){this._content={};
this._externalContent={};
this._internalContent={};
this.workbook=l;
this.origin=f.spreadsheet.NULLREF;
this.iframe=document.createElement("iframe");
this.iframe.className="k-spreadsheet-clipboard-paste";
this.menuInvoked=false;
this._uid=f.guid();
document.body.appendChild(this.iframe);
},destroy:function(){document.body.removeChild(this.iframe);
},canCopy:function(){var m={canCopy:true};
var l=this.workbook.activeSheet().select();
if(l===f.spreadsheet.NULLREF){m.canCopy=false;
}if(l instanceof f.spreadsheet.UnionRef){m.canCopy=false;
m.multiSelection=true;
}if(this.menuInvoked){m.canCopy=false;
m.menuInvoked=true;
}return m;
},canPaste:function(){var n=this.workbook.activeSheet();
var m=this.pasteRef();
var l=n.range(m);
var o={canPaste:true,pasteOnMerged:false,pasteOnDisabled:false};
if(!l.enable()){o.canPaste=false;
o.pasteOnDisabled=true;
}if(!m.eq(n.unionWithMerged(m))){o.canPaste=false;
o.pasteOnMerged=true;
}if(this.menuInvoked){o.canPaste=false;
o.menuInvoked=true;
}if(m.bottomRight.row>=n._rows._count||m.bottomRight.col>=n._columns._count){o.canPaste=false;
o.overflow=true;
}return o;
},intersectsMerged:function(){var m=this.workbook.activeSheet();
this.parse();
this.origin=this._content.origRef;
var l=this.pasteRef();
return !l.eq(m.unionWithMerged(l));
},copy:function(){var l=this.workbook.activeSheet();
this.origin=l.select();
this._internalContent=l.selection().getState();
delete this._externalContent.html;
delete this._externalContent.plain;
},cut:function(){var l=this.workbook.activeSheet();
this.copy();
l.range(l.select()).clear();
},pasteRef:function(){var p=this.workbook.activeSheet();
if(this.origin===f.spreadsheet.NULLREF){return p.select();
}var m=p.activeCell().first();
var n=this.origin.first();
var o=n.row-m.row;
var l=n.col-m.col;
return this.origin.relative(o,l,3);
},paste:function(){var m=this.workbook.activeSheet();
var l=this.pasteRef();
m.range(l).setState(this._content,this);
m.triggerChange({recalc:true,ref:l});
},external:function(l){if(l&&(l.html||l.plain)){this._externalContent=l;
}else{return this._externalContent;
}},isExternal:function(){return !this._isInternal();
},parse:function(){var n=g();
if(this._isInternal()){n=this._internalContent;
}else{var l=this._externalContent;
if(l.html){var m=this.iframe.contentWindow.document;
m.open();
m.write(l.html);
m.close();
var o=m.querySelector("table");
if(o){n=h(o);
}else{n=i(l.plain);
}}else{n=i(l.plain);
}this.origin=n.origRef;
}this._content=n;
},_isInternal:function(){if(this._externalContent.html===undefined){return true;
}var l=a("<div/>").html(this._externalContent.html).find("table.kendo-clipboard-"+this._uid).length?true:false;
var m=a("<div/>").html(this._externalContent.plain).find("table.kendo-clipboard-"+this._uid).length?true:false;
return l||m;
}});
f.spreadsheet.Clipboard=e;
function g(){var l=new c(0,0,0);
return{ref:l,mergedCells:[],data:[],foreign:true,origRef:l.toRangeRef()};
}function j(p,o,m,q){var n=p.data||(p.data=[]);
if(!n[o]){n[o]=[];
}n[o][m]=q;
var l=p.origRef.bottomRight;
l.row=Math.max(l.row,o);
l.col=Math.max(l.col,m);
}function k(l){return l.replace(/^-(?:ms|moz|webkit)-/,"");
}function b(m){var l={};
["borderBottom","borderRight","borderLeft","borderTop"].forEach(function(n){l[n]=m[n+"Style"]=="none"?null:{size:1,color:m[n+"Color"]};
});
return l;
}function d(p,m,n,o,t){var r=window.getComputedStyle(n);
var s=n.innerText.replace(/\t$/,"");
var l=b(r);
var q={value:s===""?null:s,borderTop:l.borderTop||o.get(p,m)||null,borderBottom:l.borderBottom||o.get(p+1,m)||null,borderLeft:l.borderLeft||t.get(p,m)||null,borderRight:l.borderRight||t.get(p,m+1)||null,fontSize:parseInt(r["font-size"],10)};
o.set(p,m,q.borderTop);
o.set(p+1,m,q.borderBottom);
t.set(p,m,q.borderLeft);
t.set(p,m+1,q.borderRight);
if(r["background-color"]!=="rgb(0, 0, 0)"&&r["background-color"]!=="rgba(0, 0, 0, 0)"){q.background=r["background-color"];
}if(r.color!=="rgb(0, 0, 0)"&&r.color!=="rgba(0, 0, 0, 0)"){q.color=r.color;
}if(r["text-decoration"]=="underline"){q.underline=true;
}if(r["font-style"]=="italic"){q.italic=true;
}if(r["font-weight"]=="bold"){q.bold=true;
}if(k(r["text-align"])!=="right"){q.textAlign=k(r["text-align"]);
}if(r["vertical-align"]!=="middle"){q.verticalAlign=r["vertical-align"];
}if(r["word-wrap"]!=="normal"){q.wrap=true;
}return q;
}function h(z){var x=g();
var p=[],v=0,m=0;
for(var s=0;
s<z.rows.length;
++s){p.push([]);
}var r=new f.spreadsheet.calc.runtime.Matrix();
var C=new f.spreadsheet.calc.runtime.Matrix();
for(var u=0;
u<z.rows.length;
++u,++v){var B=z.rows[u];
m=0;
for(var l=0;
l<B.cells.length;
++l){var A=B.cells[l];
var w=A.rowSpan;
var n=A.colSpan;
while(p[v][m]){m++;
}var y=A.getAttribute("style");
var t=/mso-ignore:colspan/.test(y);
j(x,v,m,d(v,m,A,r,C));
if(w>1||n>1&&!t){x.mergedCells.push(new f.spreadsheet.RangeRef(new c(v,m),new c(v+w-1,m+n-1)).toString());
}for(var q=v+w;
--q>=v;
){for(var o=m+n;
--o>=m;
){if(q<p.length){p[q][o]=true;
if(!(q==v&&o==m)){j(x,q,o,{});
}}}}}}return x;
}function i(n){var q=g();
if(n.indexOf("\t")===-1&&n.indexOf("\n")==-1){j(q,0,0,{value:n});
}else{var p=n.split("\n");
for(var o=0;
o<p.length;
o++){var m=p[o].split("\t");
for(var l=0;
l<m.length;
l++){j(q,o,l,{value:m[l]});
}}}return q;
}}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/range",["kendo.core","util/text-metrics","util/main"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var a=d.jQuery;
var l=d.spreadsheet.UnionRef;
var b=d.spreadsheet.CellRef;
var j=d.spreadsheet.RangeRef;
var h=["color","fontFamily","underline","italic","bold","textAlign","indent","verticalAlign","background","format","link","editor","borderTop","borderRight","borderBottom","borderLeft","comment"];
var i=d.Class.extend({init:function(m,n){this._sheet=n;
this._ref=m;
},clone:function(){return new i(this._ref.clone(),this._sheet);
},skipHiddenCells:function(){var m=[];
var n=this,o=n._sheet;
var q=o.isHiddenRow.bind(o);
var p=o.isHiddenColumn.bind(o);
n._ref.forEach(function(v){v=n._normalize(v.toRangeRef());
var x=v.topLeft,r=v.bottomRight;
var w=g(x.row,r.row,q);
var s=g(x.col,r.col,p);
for(var t=0;
t<w.length;
++t){for(var u=0;
u<s.length;
++u){m.push(new j(new b(w[t].begin,s[u].begin),new b(w[t].end,s[u].end)));
}}});
return o.range(m.length>1?new l(m):m[0]);
},_normalize:function(m){return this._sheet._grid.normalize(m);
},_set:function(m,q,n){var o=this;
var p=o._sheet;
o._ref.forEach(function(r){p._set(r.toRangeRef(),m,q);
});
if(!n){p.triggerChange({recalc:m=="formula"||m=="value"||m=="validation",value:q,range:o,ref:o._ref});
}return o;
},_get:function(m){return this._sheet._get(this._ref.toRangeRef(),m);
},_property:function(m,n){if(n===undefined){return this._get(m);
}else{return this._set(m,n);
}},value:function(m){if(m!==undefined){this._set("formula",null,true);
}return this._property("value",m);
},resize:function(m){var n=this._resizedRef(m);
return new i(n,this._sheet);
},_resizedRef:function(m){return this._ref.map(function(n){return n.toRangeRef().resize(m);
});
},input:function(t,o){o=a.extend({arrayFormula:false},o);
var m=this._get("format"),u;
if(t!==undefined){var r=this._ref.toRangeRef().topLeft;
u=d.spreadsheet.calc.parse(this._sheet.name(),r.row,r.col,t,m);
this._sheet.batch(function(){var w=null;
if(u.type=="exp"){w=d.spreadsheet.calc.compile(u);
}else{if(m!="@"){var v=m&&d.spreadsheet.formatting.type(u.value,m);
if(u.type=="date"&&v!="date"){this.format(u.format||k(d.culture().calendar.patterns.d));
}else{if(u.type=="percent"&&v!="percent"){this.format(u.value*100==(u.value*100|0)?"0%":"0.00%");
}else{if(u.format){if(!m||u.currency||v=="number"&&u.type=="number"&&u.format.length>m.length){this.format(u.format);
}}}}}else{if(u.type!="string"){u.value=t;
}}}this.formula(w,o.arrayFormula);
if(!w){this.value(u.value);
}}.bind(this),{recalc:true,value:t,ref:this._ref,editorChange:this._sheet.isInEditMode()});
return this;
}else{t=this._get("value");
var n=this._get("formula");
var s=m&&!n&&d.spreadsheet.formatting.type(t,m);
if(n){t="="+n;
}else{OUT:{if(m&&s=="date"){var p=d.spreadsheet.formatting.text(t,m);
u=d.spreadsheet.calc.parse(null,null,null,p,m);
var q=d.spreadsheet.formatting.text(u.value,m);
if(p==q){t=p;
break OUT;
}}if(s==="date"){t=d.toString(d.spreadsheet.numberToDate(t),d.culture().calendar.patterns.d);
}else{if(s==="percent"){t=d.spreadsheet.calc.runtime.limitPrecision(t*100)+"%";
}else{if(typeof t=="string"&&(/^[=']/.test(t)||/^(?:true|false)$/i.test(t)||e(t))){t="'"+t;
}else{if(this._sheet._useCultureDecimals()&&typeof t=="number"&&t!=Math.floor(t)){t=String(t).replace(".",d.culture().numberFormat["."]);
}}}}}}return t;
}},enable:function(m){if(m===undefined){return !d.util.withExit(function(n){this._sheet.forEach(this._ref,function(o,p,q){if(q.enable===false){n(true);
}});
},this);
}return this._property("enable",m);
},formula:function(q,m){var p=this;
if(q===undefined){var n=p._get("formula");
return n?""+n:null;
}if(m){var o=this._ref.toRangeRef();
q=p._sheet.range(o.topLeft)._set("formula",q)._get("formula");
if(q){q.setArrayFormulaRange(o);
}}else{p._set("formula",q);
}return p;
},intersectingArrayFormula:function(){var m=this._ref.clone().simplify().setSheet(this._sheet.name());
return d.util.withExit(function(n){this._sheet._forFormulas(function(o){var p=o.arrayFormulaRange;
if(p&&(p=m.intersect(p))!==d.spreadsheet.NULLREF){n({formula:o,intersection:p});
}});
},this);
},canEditArrayFormula:function(){var m=this.intersectingArrayFormula();
if(m){return m.formula.arrayFormulaRange.eq(m.intersection);
}return true;
},validation:function(n){if(n===undefined){var m=this._get("validation");
return m?m.toJSON():null;
}return this._property("validation",n);
},_getValidationState:function(){var p=this._ref.toRangeRef();
var s=p.topLeft.row;
var r=p.topLeft.col;
var n=p.bottomRight.row;
var m=p.bottomRight.col;
var o,q;
for(o=r;
o<=m;
o++){for(q=s;
q<=n;
q++){var t=this._sheet._validation(q,o);
if(t&&t.type==="reject"&&t.value===false){return t;
}}}return false;
},merge:function(){this._ref=this._sheet._merge(this._ref);
return this;
},unmerge:function(){var m=this._sheet._mergedCells;
this._ref.forEach(function(n){n.toRangeRef().intersecting(m).forEach(function(o){m.splice(m.indexOf(o),1);
});
});
this._sheet.triggerChange({});
return this;
},select:function(){this._sheet.select(this._ref);
return this;
},values:function(v){if(this._ref instanceof l){throw new Error("Unsupported for multiple ranges.");
}if(this._ref===d.spreadsheet.NULLREF){if(v!==undefined){throw new Error("Unsupported for NULLREF.");
}else{return[];
}}var p=this._ref.toRangeRef();
var t=p.topLeft.row;
var s=p.topLeft.col;
var n=p.bottomRight.row;
var m=p.bottomRight.col;
var o,q;
if(v===undefined){v=new Array(p.height());
for(var w=0;
w<v.length;
w++){v[w]=new Array(p.width());
}for(o=s;
o<=m;
o++){for(q=t;
q<=n;
q++){v[q-t][o-s]=this._sheet._value(q,o);
}}return v;
}else{this._sheet._set(p,"formula",null);
for(o=s;
o<=m;
o++){for(q=t;
q<=n;
q++){var r=v[q-t];
if(r){var u=r[o-s];
if(u!==undefined){this._sheet._value(q,o,u);
}}}}this._sheet.triggerChange({recalc:true,ref:p});
return this;
}},_properties:function(r,q){if(this._ref instanceof l){throw new Error("Unsupported for multiple ranges.");
}if(this._ref===d.spreadsheet.NULLREF){if(r!==undefined){throw new Error("Unsupported for NULLREF.");
}else{return[];
}}var s=this._ref.toRangeRef();
var y=s.topLeft.row;
var x=s.topLeft.col;
var n=s.bottomRight.row;
var m=s.bottomRight.col;
var o,t;
var w=this._sheet;
if(r===undefined){r=new Array(s.height());
w.forEach(s,function(C,z,A){C-=y;
z-=x;
var B=r[C]||(r[C]=[]);
B[z]=A;
});
return r;
}else{var p;
s=s.clone();
var v=function(z){var A=p[z];
s.topLeft.row=s.bottomRight.row=t;
s.topLeft.col=s.bottomRight.col=o;
if(z=="value"){w._set(s,"formula",null);
}w._set(s,z,A);
};
for(o=x;
o<=m;
o++){if(!q&&w.isHiddenColumn(o)){continue;
}for(t=y;
t<=n;
t++){if(!q&&w.isHiddenRow(t)){continue;
}if(q&&w.isFilteredRow(t)){continue;
}var u=r[t-y];
if(u){p=u[o-x];
if(p){Object.keys(p).forEach(v);
}}}}w.triggerChange({recalc:true,ref:this._ref});
return this;
}},clear:function(n){n=n||{};
var m=n.clearAll||!Object.keys(n).length;
var p=this._sheet;
var o={recalc:m||n.contentsOnly,ref:this._ref};
p.batch(function(){if(o.recalc){this.formula(null);
}if(m){this.validation(null);
}if(m||n.formatOnly){h.forEach(function(q){if(!(n.keepBorders&&/^border/i.test(q))){this[q](null);
}}.bind(this));
this.fontSize(null);
this.wrap(null);
this.unmerge();
}}.bind(this),o);
return this;
},clearContent:function(){return this.clear({contentsOnly:true});
},clearFormat:function(){return this.clear({formatOnly:true});
},isSortable:function(){return !this.cantSort();
},cantSort:function(){if(this._ref instanceof l){return{code:"cantSortMultipleSelection",message:"Unsupported for multiple ranges."};
}if(this._ref===d.spreadsheet.NULLREF){return{code:"cantSortNullRef",message:"Unsupported for NULLREF."};
}var p=this._sheet._getMergedCells(this._ref.toRangeRef());
var q=p.primary;
var r=p.secondary;
var s=null,o=null;
var m={};
try{this._sheet.forEach(this,function(w,t){var u=new b(w,t).print();
var v=q[u];
if(v){if(s===null){s=v.width();
o=v.height();
}else{if(!(s==v.width()&&o==v.height())){throw m;
}}}else{if(!r[u]&&p.hasMerged){throw m;
}}});
}catch(n){if(n!==m){throw n;
}return{code:"cantSortMixedCells",message:"Unsupported for range containing cells of different shapes."};
}return false;
},sort:function(n){var m=this.cantSort();
if(m){throw new Error(m.message);
}if(n===undefined){n={column:0};
}n=n instanceof Array?n:[n];
this._sheet._sortBy(this._ref.toRangeRef(),n.map(function(p,o){if(typeof p==="number"){p={column:p};
}return{index:p.column===undefined?o:p.column,ascending:p.ascending===undefined?true:p.ascending};
}));
return this;
},isFilterable:function(){return !(this._ref instanceof l);
},filter:function(m){if(this._ref instanceof l){throw new Error("Unsupported for multiple ranges.");
}if(m===false){this.clearFilters();
}else{m=m===true?[]:m instanceof Array?m:[m];
this._sheet._filterBy(this._ref.toRangeRef(),m.map(function(o,n){return{index:o.column===undefined?n:o.column,filter:o.filter};
}));
}return this;
},clearFilter:function(m){this._sheet.clearFilter(m);
},clearFilters:function(){var m=this._sheet.filter();
var o=[];
if(m){for(var n=0;
n<m.columns.length;
n++){o.push(m.columns[n].index);
}this._sheet.batch(function(){this.clearFilter(o);
this._filter=null;
},{layout:true,filter:true});
}},hasFilter:function(){var m=this._sheet.filter();
return !!m;
},leftColumn:function(){return new i(this._ref.leftColumn(),this._sheet);
},rightColumn:function(){return new i(this._ref.rightColumn(),this._sheet);
},topRow:function(){return new i(this._ref.topRow(),this._sheet);
},bottomRow:function(){return new i(this._ref.bottomRow(),this._sheet);
},column:function(m){return new i(this._ref.toColumn(m),this._sheet);
},row:function(m){return new i(this._ref.toRow(m),this._sheet);
},forEachRow:function(m){this._ref.forEachRow(function(n){m(new i(n,this._sheet));
}.bind(this));
},forEachColumn:function(m){this._ref.forEachColumn(function(n){m(new i(n,this._sheet));
}.bind(this));
},sheet:function(){return this._sheet;
},topLeft:function(){return this._ref.toRangeRef().topLeft;
},intersectingMerged:function(){var n=this._sheet;
var m=[];
n._mergedCells.forEach(function(o){if(o.intersects(this._ref)){m.push(o.toString());
}}.bind(this));
return m;
},getState:function(o){var q=this._ref.first();
var p={ref:q,data:[],origRef:this._ref,rows:this._sheet._rows.getState()};
var n;
if(!o){n=d.spreadsheet.ALL_PROPERTIES;
p.mergedCells=this.intersectingMerged();
}else{if(o==="input"){n=["value","formula"];
}else{if(o==="border"){n=["borderLeft","borderTop","borderRight","borderBottom"];
}else{n=[o];
}}}var m=p.data;
this.forEachCell(function(w,t,r){var s={};
var v=w-q.row;
var u=t-q.col;
if(!m[v]){m[v]=[];
}m[v][u]=s;
n.forEach(function(x){var y=typeof r[x]=="undefined"?null:r[x];
if(y instanceof d.spreadsheet.calc.runtime.Formula||y instanceof d.spreadsheet.validation.Validation){y=y.deepClone();
}s[x]=y;
});
});
return p;
},setState:function(t,m){var s=this._sheet;
var q=this._ref.first();
var r=t.ref.row-q.row;
var n=t.ref.col-q.col;
var p=m&&!m.isExternal();
var o=m&&!p;
s.batch(function(){if(t.mergedCells){this.unmerge();
}if(!m){this._sheet._rows.setState(t.rows);
}var v=q.row;
var u=this.hasFilter();
t.data.forEach(function(x,y){if(u&&p&&s.isHiddenRow(t.ref.row+y)){return;
}var w=q.col;
x.forEach(function(z,A){if(u&&p&&s.isHiddenColumn(t.ref.col+A)){return;
}var D=m?s.range(v,w):s.range(q.row+y,q.col+A);
if(D.enable()){for(var C in z){if(C!="value"){if(!(m&&C=="enable")){D._set(C,z[C]);
}}}if(!z.formula){if(o){try{if(z.value==null){D._set("value",null);
}else{D.input(z.value);
}}catch(B){D._set("value",z.value);
}}else{D._set("value",z.value);
}}}w++;
});
v++;
});
if(t.mergedCells){t.mergedCells.forEach(function(w){w=s._ref(w).relative(r,n,3);
s.range(w).merge();
},this);
}}.bind(this),{recalc:true,ref:this._ref});
},_adjustRowHeight:function(){var q=this;
var p=q._sheet;
var m=p._getMergedCells(q._ref.toRangeRef());
var n=m.primary;
var o=m.secondary;
p.batch(function(){q.forEachRow(function(t){var s=t._ref.topLeft.row;
var r=p.rowHeight(s);
t.forEachCell(function(z,v,u){var x=new b(z,v).print();
if(o[x]){return;
}var y=n[x];
var B;
if(y){B=p._columns.sum(y.topLeft.col,y.bottomRight.col);
}else{B=p.columnWidth(v);
}var w=u.value;
if(u.format&&w!=null){w=d.spreadsheet.formatting.format(w,u.format);
}var A=d.spreadsheet.util.getTextHeight(w,B,u.fontFamily,u.fontSize,u.wrap);
r=Math.max(r,A);
});
p.rowHeight(s,r);
});
},{layout:true});
},forEachCell:function(m){this._ref.forEach(function(n){this._sheet.forEach(n.toRangeRef(),m.bind(this));
}.bind(this));
},hasValue:function(){var m=this._sheet._defaultCellStyle;
return d.util.withExit(function(n){this.forEachCell(function(r,p,o){for(var q in o){var s=o[q];
if(s!==undefined&&s!==null&&s!==m[q]){n(true);
}}});
},this);
},wrap:function(m){if(m===undefined){return !!this._property("wrap");
}this._property("wrap",m);
if(m!==null){this._adjustRowHeight();
}return this;
},fontSize:function(m){if(m===undefined){return this._property("fontSize");
}this._property("fontSize",m);
if(m!==null){this._adjustRowHeight();
}return this;
},draw:function(n,m){this._sheet.draw(this,n,m);
},insideBorders:function(m){return this.insideVerticalBorders(m).insideHorizontalBorders(m);
},insideVerticalBorders:function(m){this._ref.forEach(function(n){if(n instanceof j&&n.width()>1){n=n.clone();
n.topLeft.col++;
this._sheet.range(n)._set("vBorders",m);
}},this);
return this;
},insideHorizontalBorders:function(m){this._ref.forEach(function(n){if(n instanceof j&&n.height()>1){n=n.clone();
n.topLeft.row++;
this._sheet.range(n)._set("hBorders",m);
}},this);
return this;
}});
function g(m,n,p){while(m<=n&&p(m)){m++;
}if(m>n){return[];
}for(var o=m+1;
o<=n;
++o){if(p(o)){return[{begin:m,end:o-1}].concat(g(o+1,n,p));
}}return[{begin:m,end:n}];
}a.each(h,function(m,n){i.prototype[n]=function(o){return this._property(n,o);
};
});
function k(m){return m.replace(/M/g,"m").replace(/'/g,'"').replace(/tt/,"am/pm");
}function e(m){return !/^=/.test(m)&&/number|percent/.test(d.spreadsheet.calc.parse(null,0,0,m).type);
}var f=a('<div style="position: absolute !important; top: -4000px !important; height: auto !important;padding: 1px 3px !important; box-sizing: border-box; margin: 0 !important; border: 1px solid black !important;line-height: normal !important; visibility: hidden !important;white-space: pre-wrap;" />')[0];
function c(p,q,m,n,r){var o={baselineMarkerSize:0,width:r===true?q+"px":"auto","font-size":(n||12)+"px","font-family":m||"Arial","white-space":r===true?"pre-wrap":"pre","overflow-wrap":r===true?"break-word":"normal","word-wrap":r===true?"break-word":"normal"};
return d.util.measureText(p,o,{box:f,normalizeText:false}).height;
}d.spreadsheet.util={getTextHeight:c};
d.spreadsheet.Range=i;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/runtime",["spreadsheet/references"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var f={};
var O=kendo.spreadsheet;
O.calc=f;
var r=f.runtime={};
var i=kendo.Class;
var L=O.Ref;
var h=O.CellRef;
var K=O.RangeRef;
var P=O.UnionRef;
var E=O.NULLREF;
function g(U){if(U instanceof g){return U;
}this.code=U;
}g.prototype.toString=function(){return"#"+this.code+(this.code=="NAME"?"?":"!");
};
var k=i.extend({init:function k(U,V,X,W){this.callback=U;
this.formula=V;
this.ss=X;
this.parent=W;
},resolve:function(V){var U=this;
if(V instanceof L){U.resolveCells([V],function(){U._resolve(V);
});
}else{U._resolve(V);
}},error:function(U){return new g(U);
},_resolve:function(V){if(V===undefined){V=null;
}else{if(Array.isArray(V)){V=this.asMatrix(V);
}else{V=A(V);
}}var U=this.formula;
if(U.arrayFormulaRange){V=this.asMatrix(V)||this.asMatrix([[V]]);
}else{if(V instanceof K){V=this._arrayArg(V);
}}U.value=V;
if(this.ss.onFormula(U)&&this.callback){this.callback.call(U,V);
}},resolveCells:function(U,X){var W=this,Z=[];
(function ab(ad){for(var ae=0;
ae<ad.length;
++ae){var af=ad[ae];
if(af instanceof L){V(W.getRefCells(af));
}if(Array.isArray(af)){ab(af);
}}}(U));
if(!Z.length){return X.call(W);
}for(var ac=Z.length,aa=0;
aa<Z.length;
++aa){Y(Z[aa]);
}function Y(ad){ad.exec(W.ss,function(){if(!--ac){X.call(W);
}},W);
}function V(ad){for(var af=0;
af<ad.length;
++af){var ae=ad[af];
if(ae.formula){Z.push(ae.formula);
}}return true;
}},cellValues:function(U,Y){var W=[];
for(var V=0;
V<U.length;
++V){var X=U[V];
if(X instanceof L){X=this.getRefData(X,Y);
W=W.concat(X);
}else{if(Array.isArray(X)){W=W.concat(this.cellValues(X,Y));
}else{if(X instanceof z){W=W.concat(this.cellValues(X.data,Y));
}else{W.push(X);
}}}}return W;
},fetchName:function(W,U){var V=this.formula;
var Y=this.ss.nameValue(W,V.sheet,V.row,V.col);
if(Y instanceof s){Y=Y.clone(V.sheet,V.row,V.col,true);
var X=new O.ValidationFormulaContext(this.ss.workbook);
Y.exec(X,U,this);
}else{if(Y instanceof L){Y=Y.absolute(V.row,V.col);
if(!Y.sheet){Y.sheet=V.sheet;
}}U(Y==null?new g("NAME"):Y);
}},force:function(U){if(U instanceof L){return this.getRefData(U);
}return U;
},func:function(X,V,U){X=X.toLowerCase();
var W=t[X];
if(W){return W.call(this,V,U);
}V(new g("NAME"));
},bool:function(U){if(U instanceof L){U=this.getRefData(U);
}if(typeof U=="string"){return U.toLowerCase()=="true";
}if(typeof U=="number"){return U!==0;
}if(typeof U=="boolean"){return U;
}return U!=null;
},_arrayArg:function(V){var U=this.formula;
if(!U.arrayFormulaRange&&V instanceof K){if(V.height()==1&&U.col>=V.topLeft.col&&U.col<=V.bottomRight.col){return this.getRefData(new h(V.topLeft.row,U.col).setSheet(V.sheet));
}if(V.width()==1&&U.row>=V.topLeft.row&&U.row<=V.bottomRight.row){return this.getRefData(new h(U.row,V.topLeft.col).setSheet(V.sheet));
}return new g("VALUE");
}else{return this.asMatrix(V);
}},asMatrix:function(X){if(X instanceof z){return X;
}var Z=this;
if(X instanceof K){var aa=X.topLeft;
var ab=aa.row,V=aa.col;
var U=Z.getRefCells(X);
var W=new z(Z);
if(isFinite(X.width())){W.width=X.width();
}if(isFinite(X.height())){W.height=X.height();
}if(!isFinite(ab)){ab=0;
}if(!isFinite(V)){V=0;
}U.forEach(function(ac){W.set(ac.row-ab,ac.col-V,ac.value);
});
return W;
}if(Array.isArray(X)&&X.length>0){var W=new z(Z),Y=0;
X.forEach(function(ae){var ac=0;
var ad=1;
ae.forEach(function(af){var ag=af instanceof K;
if(af instanceof L&&!ag){af=Z.getRefData(af);
}if(ag||Array.isArray(af)){af=Z.asMatrix(af);
}if(af instanceof z){af.each(function(ai,aj,ah){W.set(Y+aj,ac+ah,ai);
});
ad=Math.max(ad,af.height);
ac+=af.width;
}else{W.set(Y,ac++,af);
}});
Y+=ad;
});
return W;
}},getRefCells:function(W,V,X){var U=this.formula;
return this.ss.getRefCells(W,V,U.sheet,U.row,U.col,X);
},getRefData:function(V,W){var U=this.formula;
return this.ss.getData(V,U.sheet,U.row,U.col,W);
},workbook:function(){return this.ss.workbook;
}});
var z=i.extend({init:function z(U){this.context=U;
this.height=0;
this.width=0;
this.data=[];
},clone:function(){var U=new z(this.context);
U.height=this.height;
U.width=this.width;
U.data=this.data.map(function(V){return V.slice();
});
return U;
},get:function(W,U){var V=this.data[W];
var X=V?V[U]:null;
return X instanceof L?this.context.getRefData(X):X;
},getNA:function(V,U){if(V<this.height&&U<this.width){return this.get(V,U);
}return new g("N/A");
},set:function(X,U,V){var W=this.data[X];
if(W==null){W=this.data[X]=[];
}W[U]=V;
if(X>=this.height){this.height=X+1;
}if(U>=this.width){this.width=U+1;
}},each:function(V,W){for(var X=0;
X<this.height;
++X){for(var U=0;
U<this.width;
++U){var Y=this.get(X,U);
if(W||Y!=null){Y=V.call(this.context,Y,X,U);
if(Y!==undefined){return Y;
}}}}},map:function(U,V){var W=new z(this.context);
this.each(function(Y,Z,X){W.set(Z,X,U.call(this,Y,Z,X));
},V);
return W;
},eachRow:function(U){for(var V=0;
V<this.height;
++V){var W=U.call(this.context,V);
if(W!==undefined){return W;
}}},eachCol:function(V){for(var U=0;
U<this.width;
++U){var W=V.call(this.context,U);
if(W!==undefined){return W;
}}},mapRow:function(U){var V=new z(this.context);
this.eachRow(function(W){V.set(W,0,U.call(this.context,W));
});
return V;
},mapCol:function(U){var V=new z(this.context);
this.eachCol(function(W){V.set(0,W,U.call(this.context,W));
});
return V;
},toString:function(){return JSON.stringify(this.data);
},transpose:function(){var U=new z(this.context);
this.each(function(W,X,V){U.set(V,X,W);
});
return U;
},unit:function(X){this.width=this.height=X;
var U=this.data=new Array(X);
for(var V=X;
--V>=0;
){var Y=U[V]=new Array(X);
for(var W=X;
--W>=0;
){Y[W]=V==W?1:0;
}}return this;
},multiply:function(V){var U=this,Y=new z(U.context);
for(var Z=0;
Z<U.height;
++Z){for(var W=0;
W<V.width;
++W){var aa=0;
for(var X=0;
X<U.width;
++X){var ab=U.get(Z,X);
var ac=V.get(X,W);
if(typeof ab!="number"||typeof ac!="number"){throw new g("VALUE");
}aa+=ab*ac;
}Y.set(Z,W,aa);
}}return Y;
},adds:function(V,Z){var U=this,X=new z(U.context);
var aa=Z?-1:1;
for(var Y=0;
Y<U.height;
++Y){for(var W=0;
W<U.width;
++W){var ab=U.get(Y,W),ac=V.get(Y,W);
X.set(Y,W,ab+aa*ac);
}}return X;
},determinant:function(){var U=this.clone().data;
var aa=U.length;
var W=1,V,Z,X,Y;
for(V=0;
V<aa;
V++){for(Z=V;
Z<aa&&!U[Z][V];
Z++){}if(Z==aa){return 0;
}if(Z!=V){W=-W;
for(Y=V;
Y<aa;
Y++){var ab=U[V][Y];
U[V][Y]=U[Z][Y];
U[Z][Y]=ab;
}}for(X=V+1;
X<aa;
X++){for(Y=V+1;
Y<aa;
Y++){U[X][Y]-=U[V][Y]*U[X][V]/U[V][V];
}}W*=U[V][V];
}return W;
},inverse:function(){var ab=this.width;
var aa=this.augment(new z(this.context).unit(ab));
var U=aa.data;
var ac;
for(var Z=0;
Z<ab;
++Z){var X=a(Z,ab,function(ad){return U[ad][Z];
});
if(!U[X][Z]){return null;
}if(Z!=X){ac=U[Z];
U[Z]=U[X];
U[X]=ac;
}for(var W=Z+1;
W<ab;
++W){for(var Y=Z+1;
Y<2*ab;
++Y){U[W][Y]-=U[Z][Y]*U[W][Z]/U[Z][Z];
}U[W][Z]=0;
}}for(var W=0;
W<ab;
++W){for(var V=U[W][W],Y=0;
Y<2*ab;
++Y){U[W][Y]/=V;
}}for(var Z=ab;
--Z>=0;
){for(var W=Z;
--W>=0;
){if(U[W][Z]){for(var Y=2*ab;
--Y>=ab;
){U[W][Y]-=U[Z][Y]*U[W][Z];
}}}}return aa.slice(0,ab,ab,ab);
},augment:function(U){var W=this.clone(),V=W.width;
U.each(function(Z,Y,X){W.set(Y,X+V,Z);
});
return W;
},slice:function(Z,U,V,aa){var Y=new z(this.context);
for(var W=0;
W<V;
++W){for(var X=0;
X<aa;
++X){Y.set(W,X,this.get(Z+W,U+X));
}}return Y;
}});
function a(W,U,V){var X=V(W),Y=W;
while(++W<U){var Z=V(W);
if(Z>X){X=Z;
Y=W;
}}return Y;
}var s=i.extend({init:function s(Y,W,X,aa,Z,V,U){this.refs=Y;
this.handler=W;
this.print=X;
this.absrefs=null;
this.sheet=aa;
this.row=Z;
this.col=V;
this.onReady=[];
this.pending=false;
this.arrayFormulaRange=U;
},setArrayFormulaRange:function(U){this.arrayFormulaRange=U.clone().setSheet(this.sheet);
},clone:function(aa,Z,U,V){var W=aa.toLowerCase();
var Y=this.refs;
var X=this.arrayFormulaRange;
if(V||W!=this.sheet.toLowerCase()){Y=Y.map(function(ab){if(!ab.hasSheet()&&(!ab.sheet||ab.sheet.toLowerCase()!=W)){ab=ab.clone().setSheet(aa);
}return ab;
});
if(X){X=X.clone().setSheet(aa);
}}return new s(Y,this.handler,this.print,aa,Z,U,X);
},deepClone:function(){var U=this.refs.map(function(V){return V.clone();
});
return new s(U,this.handler,this.print,this.sheet,this.row,this.col,this.arrayFormulaRange);
},resolve:function(U){this.pending=false;
this.onReady.forEach(function(V){V(U);
});
},exec:function(Z,U,Y){if("value" in this){if(U){U(this.value);
}}else{if(U){this.onReady.push(U);
}var V=new k(this.resolve,this,Z,Y);
var W=0;
while(Y){if(Y.formula===this){this.pending=false;
V.resolve(new g("CIRCULAR"));
return;
}Y=Y.parent;
++W;
}if(this.pending){return;
}this.pending=true;
var X=function(){if(!this.absrefs){this.absrefs=this.refs.map(function(aa){return aa.absolute(this.row,this.col);
},this);
}this.handler.call(V);
}.bind(this);
if(W<20){X();
}else{setTimeout(X,0);
}}},reset:function(){this.onReady=[];
this.pending=false;
delete this.value;
},renameSheet:function(V,U){V=V.toLowerCase();
this.absrefs=null;
if(this.sheet.toLowerCase()==V){this.sheet=U;
}this.refs.forEach(function(W){W.renameSheet(V,U);
});
},adjust:function(V,ae,ah,W){V=V.toLowerCase();
var Z=this.row;
var X=this.col;
var aa=this.sheet.toLowerCase();
var Y=false;
if(aa==V){if(ae=="row"&&Z>=ah){this.row+=W;
Y=true;
}if(ae=="col"&&X>=ah){this.col+=W;
Y=true;
}}var ad=this.row;
var ac=this.col;
this.absrefs=null;
var ag=this.refs;
var ab=Y;
this.refs=ag.map(function(aj){var ai=U(aj);
if(!ab&&!M(ai,aj)){ab=true;
}return ai;
});
var af=this.arrayFormulaRange;
if(af){this.arrayFormulaRange=U(af);
if(!ab&&!M(af,this.arrayFormulaRange)){ab=true;
}}if(ab){return new s(ag,this.handler,this.print,this.sheet,Z,X,af);
}function U(ai){if(ai===E){return ai;
}if(ai.sheet.toLowerCase()!=V){if(Y){if(ae=="row"&&Z>=ah){ai=ai.relative(W,0);
}if(ae=="col"&&X>=ah){ai=ai.relative(0,W);
}}return ai;
}return ai.adjust(Z,X,ad,ac,ae=="row",ah,W);
}},toString:function(){return this.print(this.row,this.col);
}});
function M(V,W){if(V.constructor!==W.constructor){return false;
}if(V instanceof h){return V.sheet==W.sheet&&V.row==W.row&&V.col==W.col&&V.rel==W.rel;
}if(V instanceof K){return M(V.topLeft,W.topLeft)&&M(V.bottomRight,W.bottomRight)&&V.endSheet==W.endSheet;
}if(V instanceof P){var U=V.refs.length;
if(U!=W.refs.length){return false;
}while(--U>=0){if(!M(V.refs[U],W.refs[U])){return false;
}}}return true;
}var t=Object.create(null);
t["if"]=function(V,U){var Y=this;
var W=U[0],Z=U[1],X=U[2];
this.resolveCells([W],function(){var aa=Y.asMatrix(W);
if(aa){Z(function(ab){X(function(ac){var ae=Y.asMatrix(ab);
var ad=Y.asMatrix(ac);
V(aa.map(function(ah,ag,af){if(ah instanceof g){return ah;
}else{if(Y.bool(ah)){return ae?ae.get(ag,af):ab;
}else{return ad?ad.get(ag,af):ac;
}}}));
});
});
}else{W=this.force(W);
if(W instanceof g){V(W);
}else{if(Y.bool(W)){Z(V);
}else{X(V);
}}}});
};
t.f=function(U){U((1+Math.sqrt(5))/2);
};
function j(ad,U){var V="function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ";
var ai="function resolve(args, callback) { var toResolve = [], i = 0; ";
var ah,ab,ag="'use strict'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE'; ",af=false;
var W=false,ae=false;
ag+=U.map(X).join("");
ag+="if (i < args.length) return new CalcError('N/A'); ";
ag+="return xargs; } ";
V+="return { args: xargs, width: width, height: height, arrays: arrays }; } ";
var Z;
if(af){ai+="this.resolveCells(toResolve, callback); } ";
Z=new Function("CalcError","round",ag+ai+V+" return { resolve: resolve, check: check, arrayArgs: arrayArgs };");
}else{Z=new Function("CalcError","round",ag+" return { check: check };");
}Z=Z(g,w);
if(!ae){delete Z.arrayArgs;
}return Z;
function X(ap){ah=ap[0];
var al="{ ";
if(Array.isArray(ah)){V+="while (i < args.length) { ";
ai+="while (i < args.length) { ";
al+="xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ";
al+="while (i < args.length) { ";
al+=ap.map(X).join("");
al+="} ";
al+="xargs = stack.pop(); ";
ai+="} ";
V+="} ";
}else{if(ah=="+"){V+="while (i < args.length) { ";
ai+="while (i < args.length) { ";
al+="if (i >= args.length) return new CalcError('N/A'); ";
al+="xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ";
al+="do { ";
al+=ap.slice(1).map(X).join("");
al+="} while (i < args.length); ";
al+="xargs = stack.pop(); ";
ai+="} ";
V+="} ";
}else{if(ah=="?"){al+="if (!("+Y(ap[1])+")) return new CalcError(err); ";
}else{var an=ap[1];
if(Array.isArray(an)&&/^#?collect/.test(an[0])){var ao=/!$/.test(an[0]);
var am=an[2];
aa();
al+="try {var $"+ah+" = this.cellValues(args.slice(i";
if(am){al+=", i + "+am;
}al+=")"+(ao?",true":"")+").reduce(function(ret, $"+ah+"){ ";
if(an[0].charAt(0)!="#"){al+="if ($"+ah+" instanceof CalcError) throw $"+ah+"; ";
}al+="if ("+Y(an[1])+") ret.push($"+ah+"); ";
al+="return ret; ";
al+="}.bind(this), []); ";
if(am){al+="i += "+am+"; ";
}else{al+="i = args.length; ";
}al+="xargs.push($"+ah+")} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ";
ai+="toResolve.push(args.slice(i)); ";
}else{if(an=="rest"){al+="xargs.push(args.slice(i)); i = args.length; ";
}else{if(W=/^\*/.test(ah)){ae=true;
ah=ah.substr(1);
}al+="var $"+ah+" = args[i++]; ";
var ak=false;
if(/!$/.test(an)){an=an.substr(0,an.length-1);
ak=true;
}else{al+="if ($"+ah+" instanceof CalcError) return $"+ah+"; ";
}al+=aj(an,ak)+"xargs.push($"+ah+"); ";
}}}}}al+="} ";
return al;
}function aa(){if(ab){return"$"+ah+"";
}af=true;
ab=true;
ai+="toResolve.push(args[i++]); ";
return"($"+ah+" = this.force($"+ah+"))";
}function ac(ak){return"("+(ak?"(typeof "+aa()+" == 'number' ? ($"+ah+" = round($"+ah+"), true) : false) || ":"(typeof "+aa()+" == 'number') || ")+"(typeof $"+ah+" == 'boolean' ? ($"+ah+" = +$"+ah+", true) : false) || (typeof $"+ah+" == 'string' && !/^(?:=|true|false)/i.test($"+ah+") ? (tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $"+ah+"), /^date|number|percent$/.test(tmp.type) ? ($"+ah+" = +tmp.value, true) : false) : false))";
}function aj(am,ak){ab=false;
var al="if (!("+Y(am)+")) { ";
if(ab&&!ak){al+=" if ($"+ah+" instanceof CalcError) return $"+ah+"; ";
}al+="return new CalcError(err); } ";
if(!ab){ai+="i++; ";
}if(W){V+="var $"+ah+" = this._arrayArg(args[i]); if ($"+ah+") { xargs.push($"+ah+"); width = Math.max(width, $"+ah+".width); height = Math.max(height, $"+ah+".height); arrays.push(true) } else { xargs.push(args[i]); arrays.push(false); } i++; ";
}else{V+="xargs.push(args[i++]); arrays.push(false); ";
}return al;
}function Y(al){if(Array.isArray(al)){if(al[0]=="or"){return"("+al.slice(1).map(Y).join(") || (")+")";
}if(al[0]=="and"){return"("+al.slice(1).map(Y).join(") && (")+")";
}if(al[0]=="values"){return"("+al.slice(1).map(function(am){return aa()+" === "+am;
}).join(") || (")+")";
}if(al[0]=="null"){return"("+Y("null")+" ? (($"+ah+" = "+al[1]+"), true) : false)";
}if(al[0]=="between"||al[0]=="[between]"){return"("+aa()+" >= "+al[1]+" && $"+ah+" <= "+al[2]+" ? true : ((err = 'NUM'), false))";
}if(al[0]=="(between)"){return"("+aa()+" > "+al[1]+" && $"+ah+" < "+al[2]+" ? true : ((err = 'NUM'), false))";
}if(al[0]=="(between]"){return"("+aa()+" > "+al[1]+" && $"+ah+" <= "+al[2]+" ? true : ((err = 'NUM'), false))";
}if(al[0]=="[between)"){return"("+aa()+" >= "+al[1]+" && $"+ah+" < "+al[2]+" ? true : ((err = 'NUM'), false))";
}if(al[0]=="assert"){var ak=al[2]||"N/A";
return"(("+al[1]+") ? true : (err = "+JSON.stringify(ak)+", false))";
}if(al[0]=="not"){return"!("+Y(al[1])+")";
}throw new Error("Unknown array type condition: "+al[0]);
}if(al=="number"||al=="datetime"){return ac(true);
}if(al=="number!"){return"(typeof "+aa()+" == 'number' ? ($"+ah+" = round($"+ah+"), true) : false)";
}if(al=="integer"||al=="date"){return"("+ac()+" && (($"+ah+" |= 0), true))";
}if(al=="divisor"){return"("+ac(true)+" && ($"+ah+" == 0 ? ((err = 'DIV/0'), false) : true))";
}if(al=="number+"){return"("+ac(true)+" && ($"+ah+" >= 0 ? true : ((err = 'NUM'), false)))";
}if(al=="integer+"){return"("+ac()+" && (($"+ah+" |= 0) >= 0 ? true : ((err = 'NUM'), false)))";
}if(al=="number++"){return"("+ac(true)+" && ($"+ah+" > 0 ? true : ((err = 'NUM'), false)))";
}if(al=="integer++"){return"("+ac()+" && (($"+ah+" |= 0) > 0 ? true : ((err = 'NUM'), false)))";
}if(al=="string"){return"((typeof "+aa()+" == 'string' || typeof $"+ah+" == 'boolean' || typeof $"+ah+" == 'number') ? ($"+ah+" += '', true) : ($"+ah+" === undefined ? (($"+ah+" = ''), true) : false))";
}if(al=="boolean"){return"(typeof "+aa()+" == 'boolean')";
}if(al=="logical"){return"(typeof "+aa()+" == 'boolean' || (typeof $"+ah+" == 'number' ? ($"+ah+" = !!$"+ah+", true) : false))";
}if(al=="matrix"){aa();
return"((m = this.asMatrix($"+ah+")) ? ($"+ah+" = m) : false)";
}if(al=="#matrix"){return"((m = this.asMatrix($"+ah+")) ? ($"+ah+" = m) : false)";
}if(al=="ref"){return"($"+ah+" instanceof kendo.spreadsheet.Ref)";
}if(al=="area"){return"($"+ah+" instanceof kendo.spreadsheet.CellRef || $"+ah+" instanceof kendo.spreadsheet.RangeRef)";
}if(al=="cell"){return"($"+ah+" instanceof kendo.spreadsheet.CellRef)";
}if(al=="null"){return"("+aa()+" == null)";
}if(al=="anyvalue"){return"("+aa()+" != null && i <= args.length)";
}if(al=="forced"){return"("+aa()+", i <= args.length)";
}if(al=="anything"){return"(i <= args.length)";
}if(al=="blank"){return"("+aa()+" == null || $"+ah+" === '')";
}throw new Error("Can't check for type: "+al);
}}function w(U){return U===parseInt(U,10)?U:+U.toPrecision(14);
}function A(U){if(typeof U=="number"){return w(U);
}else{return U;
}}function T(X,W,U){if(U instanceof g){return U;
}try{return W.apply(X,U);
}catch(V){if(V instanceof g){return V;
}else{throw V;
}}}function y(W,X,V,U){return function(Z,Y){function aa(){if(U){var af=U.call(this,Y);
Y=af.args;
if(af.width>0&&af.height>0){var ad=new z(this);
for(var ae=0;
ae<af.height;
++ae){for(var ab=0;
ab<af.width;
++ab){var ag=[];
for(var ac=0;
ac<Y.length;
++ac){if(af.arrays[ac]){ag[ac]=Y[ac].getNA(ae,ab);
}else{ag[ac]=Y[ac];
}}ag=V.call(this,ag);
ad.set(ae,ab,T(this,W,ag));
}}return Z(ad);
}}var ag=V.call(this,Y);
Z(T(this,W,ag));
}if(X){X.call(this,Y,aa);
}else{aa.call(this);
}};
}function x(W,X,V,U){return function(Z,Y){function aa(){if(U){var ah=U.call(this,Y);
Y=ah.args;
if(ah.width>0&&ah.height>0){var af=new z(this);
var ac=ah.width*ah.height;
var ae=function(ak,aj){return function(al){af.set(ak,aj,al);
--ac;
if(ac===0){return Z(af);
}};
};
for(var ag=0;
ag<ah.height&&ac>0;
++ag){for(var ab=0;
ab<ah.width&&ac>0;
++ab){var ai=[];
for(var ad=0;
ad<Y.length;
++ad){if(ah.arrays[ad]){ai[ad]=Y[ad].getNA(ag,ab);
}else{ai[ad]=Y[ad];
}}ai=V.call(this,ai);
if(ai instanceof g){af.set(ag,ab,ai);
--ac;
if(ac===0){return Z(af);
}}else{ai.unshift(ae(ag,ab));
W.apply(this,ai);
}}}return;
}}var ah=V.call(this,Y);
if(ah instanceof g){Z(ah);
}else{ah.unshift(Z);
W.apply(this,ah);
}}if(X){X.call(this,Y,aa);
}else{aa.call(this);
}};
}function q(V,U){V=V.toLowerCase();
t[V]=U;
return{args:function(W,Z){var X=j(V,W);
if(Z){if(X.arrayArgs){console.log(X.arrayArgs.toString());
}if(X.resolve){console.log(X.resolve.toString());
}if(X.check){console.log(X.check.toString());
}}var Y=t[V]=y(U,X.resolve,X.check,X.arrayArgs);
Y.kendoSpreadsheetArgs=W;
return this;
},argsAsync:function(W,Z){var X=j(V,W);
if(Z){if(X.arrayArgs){console.log(X.arrayArgs.toString());
}if(X.resolve){console.log(X.resolve.toString());
}if(X.check){console.log(X.check.toString());
}}var Y=t[V]=x(U,X.resolve,X.check,X.arrayArgs);
Y.kendoSpreadsheetArgs=W;
return this;
}};
}function l(W,V,U){V++;
return(1461*(W+4800+((V-14)/12|0))/4|0)+(367*(V-2-12*((V-14)/12|0))/12|0)-(3*((W+4900+((V-14)/12|0))/100|0)/4|0)+U-32075;
}function v(X){var Y,aa,W,V,Z,U,ab;
Y=X+68569;
aa=4*Y/146097|0;
Y=Y-((146097*aa+3)/4|0);
V=4000*(Y+1)/1461001|0;
Y=Y-(1461*V/4|0)+31;
W=80*Y/2447|0;
U=Y-(2447*W/80|0);
Y=W/11|0;
Z=W+2-12*Y;
ab=100*(aa-49)+V+Y;
Z--;
return{year:ab,month:Z,date:U,day:(X+1)%7,ord:G[u(ab)][Z]+U};
}var d=l(1900,0,-1);
var n=[31,28,31,30,31,30,31,31,30,31,30,31];
var G=[[0,31,59,90,120,151,181,212,243,273,304,334],[0,31,60,91,121,152,182,213,244,274,305,335]];
function u(U){if(U%4){return 0;
}if(U%100){return 1;
}if(U%400){return 0;
}return 1;
}function p(U){return u(U)?366:365;
}function o(V,U){return u(V)&&U==1?29:n[U];
}function S(W,V,U){return V>=1&&V<=12&&U>=1&&U<=o(W,V-1);
}function Q(U){return v((U|0)+d);
}function H(W,V,U){return l(W,V,U)-d;
}var D=60*1000;
var C=60*D;
var B=24*C;
function R(Z){var U=Z-(Z|0);
if(U<0){U++;
}var X=Math.round(B*U);
var V=Math.floor(X/C);
X-=V*C;
var W=Math.floor(X/D);
X-=W*D;
var Y=Math.floor(X/1000);
X-=Y*1000;
return{hours:V,minutes:W,seconds:Y,milliseconds:X};
}function N(V){var U=Q(V),W=R(V);
return new Date(U.year,U.month,U.date,W.hours,W.minutes,W.seconds,W.milliseconds);
}function I(U,V,X,W){return(U+(V+(X+W/1000)/60)/60)/24;
}function m(U){var V=I(U.getHours(),U.getMinutes(),U.getSeconds(),U.getMilliseconds());
U=H(U.getFullYear(),U.getMonth(),U.getDate());
if(U<0){return U-1+V;
}else{return U+V;
}}function J(V,U){if(U){U=kendo.spreadsheet.formatting.makeDateFormat(U);
}return kendo.parseExactDate(V,U)||kendo.parseExactDate(V)||kendo.parseExactDate(V,["MMMM dd yyyy","MMMM dd yy","MMM dd yyyy","MMM dd yy","dd MMMM yyyy","dd MMMM yy","dd MMM yyyy","dd MMM yy","MMMM dd, yyyy","MMMM dd, yy","MMM dd, yyyy","MMM dd, yy","MMMM dd","MMM dd","MMMM yyyy","MMM yyyy","dd MMMM","dd MMM"]);
}r.CalcError=g;
r.Formula=s;
r.Matrix=z;
r.packDate=H;
r.unpackDate=Q;
r.packTime=I;
r.unpackTime=R;
r.serialToDate=N;
r.dateToSerial=m;
r.daysInMonth=o;
r.validDate=S;
r.isLeapYear=u;
r.daysInYear=p;
r.parseDate=J;
r.limitPrecision=w;
O.dateToNumber=m;
O.numberToDate=N;
O.defineFunction=q;
O.CalcError=g;
r.defineFunction=q;
r.defineAlias=function(U,V){var W=t[V];
if(!W){throw new Error("Function "+V+" is not yet defined");
}if(!W.kendoSpreadsheetAliases){W.kendoSpreadsheetAliases=[V];
}W.kendoSpreadsheetAliases.push(U);
t[U]=W;
};
r.FUNCS=t;
var F=["or","number",["null",0]];
var c=[["*a",F],["*b",F]];
var b=[["*a",["or","anyvalue",["null",0]]],["*b",["or","anyvalue",["null",0]]]];
q("binary+",function(U,V){return U+V;
}).args(c);
q("binary-",function(U,V){return U-V;
}).args(c);
q("binary*",function(U,V){return U*V;
}).args(c);
q("binary/",function(U,V){return U/V;
}).args([["*a",F],["*b","divisor"]]);
q("binary^",function(U,V){return Math.pow(U,V);
}).args(c);
q("binary&",function(U,V){if(U==null){U="";
}if(V==null){V="";
}return""+U+V;
}).args([["*a",["or","number","string","boolean","null"]],["*b",["or","number","string","boolean","null"]]]);
q("binary=",function(U,V){U=typeof U==="string"?U.toLowerCase():U;
V=typeof V==="string"?V.toLowerCase():V;
return U===V;
}).args(b);
q("binary<>",function(U,V){return U!==V;
}).args(b);
q("binary<",e(function(U,V){return U<V;
})).args(b);
q("binary<=",e(function(U,V){return U<=V;
})).args(b);
q("binary>",e(function(U,V){return U>V;
})).args(b);
q("binary>=",e(function(U,V){return U>=V;
})).args(b);
q("unary+",function(U){return U;
}).args([["*a",F]]);
q("unary-",function(U){return -U;
}).args([["*a",F]]);
q("unary%",function(U){return U/100;
}).args([["*a",F]]);
q("binary:",function(U,V){return new K(U,V).setSheet(U.sheet||this.formula.sheet,U.hasSheet());
}).args([["a","cell"],["b","cell"]]);
q("binary,",function(U,V){return new P([U,V]);
}).args([["a","ref"],["b","ref"]]);
q("binary ",function(U,V){return U.intersect(V);
}).args([["a","ref"],["b","ref"]]);
q("not",function(U){return !this.bool(U);
}).args([["*a",["or","anyvalue",["null",0]]]]);
q("isblank",function(U){if(U instanceof h){U=this.getRefData(U);
return U==null;
}return false;
}).args([["*value","anything!"]]);
q("iserror",function(U){return U instanceof g;
}).args([["*value","forced!"]]);
q("iserr",function(U){return U instanceof g&&U.code!="N/A";
}).args([["*value","forced!"]]);
q("isna",function(U){return U instanceof g&&U.code=="N/A";
}).args([["*value","forced!"]]);
q("islogical",function(U){return typeof U=="boolean";
}).args([["*value","forced!"]]);
q("isnontext",function(U){return typeof U!="string";
}).args([["*value","forced!"]]);
q("istext",function(U){return typeof U=="string";
}).args([["*value","forced!"]]);
q("isnumber",function(U){return typeof U=="number";
}).args([["*value","forced!"]]);
q("isref",function(U){return U instanceof h||U instanceof K;
}).args([["*value","anything!"]]);
t[",getname"]=function(V,U){this.fetchName(U[0],V);
};
function e(U){return function(V,W){if(typeof V=="string"&&typeof W!="string"){W=W==null?"":W+"";
}if(typeof V!="string"&&typeof W=="string"){V=V==null?"":V+"";
}if(typeof V=="number"&&W==null){W=0;
}if(typeof W=="number"&&V==null){V=0;
}if(typeof V=="string"&&typeof W=="string"){V=V.toLowerCase();
W=W.toLowerCase();
}if(typeof W==typeof V){return U(V,W);
}else{return new g("VALUE");
}};
}},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/validation",["spreadsheet/runtime"],b);
}(function(){var a=kendo.jQuery;
if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var g=kendo.spreadsheet;
var f={};
g.validation=f;
var b=g.calc;
var c=kendo.Class;
var h="_matrix({0})";
var e='DATEVALUE("{0}")';
b.runtime.defineFunction("_matrix",function(j){if(typeof j=="string"){j=this.asMatrix([j.split(/\s*,\s*/)]);
}return j;
}).args([["m",["or","matrix","string"]]]);
function d(o,n,j,p){var q;
var k;
var l;
var m;
if(typeof p==="string"){p=JSON.parse(p);
}if(p.from){if(p.dataType==="list"&&!p.fromIsListValue){p.from=kendo.format(h,p.from);
p.fromIsListValue=true;
}if(p.dataType==="date"){l=b.runtime.parseDate(p.from);
if(l){p.from=kendo.format(e,p.from);
p.fromIsDateValue=true;
}}p.from=b.compile(b.parseFormula(o,n,j,p.from));
}if(p.to){if(p.dataType==="date"){m=b.runtime.parseDate(p.to);
if(m){p.to=kendo.format(e,p.to);
p.toIsDateValue=true;
}}p.to=b.compile(b.parseFormula(o,n,j,p.to));
}if(p.dataType=="custom"){k=f.validationComparers.custom;
}else{if(p.dataType=="list"){k=f.validationComparers.list;
}else{k=f.validationComparers[p.comparerType];
}}if(!k){throw kendo.format("'{0}' comparer is not implemented.",p.comparerType);
}q=function(t){var s=this.to&&(this.to_value||this.to_value===0)?this.to_value:undefined;
if(t===null||t===""){if(this.allowNulls){this.value=true;
}else{this.value=false;
}}else{if(this.dataType=="custom"){this.value=k(t,this.from_value,s);
}else{if(this.dataType=="list"){var r=this._getListData();
this.value=k(t,r,s);
}else{this.value=k(t,this.from_value,s);
}}}return this.value;
};
return new kendo.spreadsheet.validation.Validation(a.extend(p,{handler:q,sheet:o,row:n,col:j}));
}var i=c.extend({init:function i(j){this.handler=j.handler;
this.from=j.from;
this.to=j.to;
this.dataType=j.dataType;
this.comparerType=j.comparerType;
this.type=j.type?j.type:"warning";
this.allowNulls=j.allowNulls?true:false;
this.fromIsDateValue=j.fromIsDateValue?true:false;
this.toIsDateValue=j.toIsDateValue?true:false;
this.showButton=j.showButton;
this.fromIsListValue=j.fromIsListValue?true:false;
this.sheet=j.sheet;
this.row=j.row;
this.col=j.col;
if(j.tooltipMessageTemplate){this.tooltipMessageTemplate=j.tooltipMessageTemplate;
}if(j.tooltipTitleTemplate){this.tooltipTitleTemplate=j.tooltipTitleTemplate;
}if(j.messageTemplate){this.messageTemplate=j.messageTemplate;
}if(j.titleTemplate){this.titleTemplate=j.titleTemplate;
}},_formatMessages:function(l){var m=this.from?this.from_value:"";
var o=this.to?this.to_value:"";
var n=this.from?this.from.toString():"";
var p=this.to?this.to.toString():"";
var k=this.dataType;
var q=this.type;
var j=this.comparerType;
return kendo.format(l,m,o,n,p,k,q,j);
},_setMessages:function(){this.title="";
this.message="";
if(this.tooltipTitleTemplate){this.tooltipTitle=this._formatMessages(this.tooltipTitleTemplate);
}if(this.tooltipMessageTemplate){this.tooltipMessage=this._formatMessages(this.tooltipMessageTemplate);
}if(this.titleTemplate){this.title=this._formatMessages(this.titleTemplate);
}if(this.messageTemplate){this.message=this._formatMessages(this.messageTemplate);
}},_getListData:function(){if(!this.from_value||!this.from_value.data){return[];
}var k=this.from_value.data;
var m;
var n;
var l=[];
for(m=0;
m<k.length;
m++){var j=k[m];
if(j){for(n=0;
n<j.length;
n++){l.push(j[n]);
}}}return l;
},clone:function(m,l,j){var k=this._getOptions();
if(k.from){k.from=k.from.clone(m,l,j);
}if(k.to){k.to=k.to.clone(m,l,j);
}return new i(a.extend(k,{handler:this.handler},{sheet:m,row:l,col:j}));
},deepClone:function(){var j=new i(this);
j.from=j.from.deepClone();
if(j.to){j.to=j.to.deepClone();
}return j;
},exec:function(p,m,l,k){var o=this;
function n(q){if(q instanceof kendo.spreadsheet.Ref){q=p.getData(q);
if(Array.isArray(q)){q=q[0];
}}return q;
}var j=function(q){o.from_value=n(q);
o.value=o.handler.call(o,m,l);
o._setMessages();
if(k){k(o.value);
}};
if(o.to){o.to.exec(p,function(q){o.to_value=n(q);
o.from.exec(p,j);
});
}else{o.from.exec(p,j);
}},reset:function(){if(this.from){this.from.reset();
}if(this.to){this.to.reset();
}delete this.value;
},adjust:function(j,o,r,k){var p,q,n;
var m=this.row;
var l=this.col;
if(this.from){p=this.from.adjust(j,o,r,k);
}if(this.to){q=this.to.adjust(j,o,r,k);
}if(this.sheet.toLowerCase()==j.toLowerCase()){switch(o){case"row":if(m>=r){n=true;
this.row+=k;
}break;
case"col":if(l>=r){n=true;
this.col+=k;
}break;
}}if(n||p||q){var s=new i(this);
s.from=p;
s.to=q;
s.row=m;
s.col=l;
return s;
}},toJSON:function(){var j=this._getOptions();
if(j.from){j.from=j.from.toString();
if(j.dataType==="list"){j.from=j.from.replace(/^_matrix\((.*)\)$/i,"$1");
delete j.fromIsListValue;
}if(j.dataType==="date"){if(this.fromIsDateValue){j.from=j.from.replace(/^DATEVALUE\("(.*)"\)$/i,"$1");
delete j.fromIsDateValue;
}}}if(j.to){j.to=j.to.toString();
if(j.dataType==="date"){if(this.toIsDateValue){j.to=j.to.replace(/^DATEVALUE\("(.*)"\)$/i,"$1");
delete j.toIsDateValue;
}}}return j;
},_getOptions:function(){return{from:this.from,to:this.to,dataType:this.dataType,type:this.type,comparerType:this.comparerType,row:this.row,col:this.col,sheet:this.sheet,allowNulls:this.allowNulls,fromIsListValue:this.fromIsListValue,fromIsDateValue:this.fromIsDateValue,toIsDateValue:this.toIsDateValue,tooltipMessageTemplate:this.tooltipMessageTemplate,tooltipTitleTemplate:this.tooltipTitleTemplate,messageTemplate:this.messageTemplate,titleTemplate:this.titleTemplate,showButton:this.showButton};
}});
f.compile=d;
f.validationComparers={greaterThan:function(k,j){return k>j;
},lessThan:function(k,j){return k<j;
},between:function(l,j,k){return l>=j&&l<=k;
},equalTo:function(k,j){return k==j;
},notEqualTo:function(k,j){return k!=j;
},greaterThanOrEqualTo:function(k,j){return k>=j;
},lessThanOrEqualTo:function(k,j){return k<=j;
},notBetween:function(l,j,k){return l<j||l>k;
},custom:function(k,j){return j;
},list:function(k,j){return j.indexOf(k)>-1;
}};
f.Validation=i;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/sheet",["kendo.core","kendo.color","spreadsheet/runtime","spreadsheet/validation","spreadsheet/references"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var f=c.spreadsheet.RangeRef;
var i=c.spreadsheet.UnionRef;
var a=c.spreadsheet.CellRef;
var e=c.spreadsheet.Range;
var d;
var g=c.Class.extend({init:function(j){this._sheet=j;
this.selection=c.spreadsheet.FIRSTREF.toRangeRef();
this.originalSelection=c.spreadsheet.FIRSTREF.toRangeRef();
this._activeCell=c.spreadsheet.FIRSTREF.toRangeRef();
this.originalActiveCell=c.spreadsheet.FIRSTREF;
},currentSelectionRange:function(){return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();
},currentOriginalNavigationRange:function(){return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();
},currentNavigationRange:function(){if(this.singleCellSelection()){return this._sheet._sheetRef;
}else{return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();
}},nextNavigationRange:function(){if(!this.singleCellSelection()){this.selectionRangeIndex=this.selection.nextRangeIndex(this.selectionRangeIndex);
}return this.currentNavigationRange();
},previousNavigationRange:function(){if(!this.singleCellSelection()){this.selectionRangeIndex=this.selection.previousRangeIndex(this.selectionRangeIndex);
}return this.currentNavigationRange();
},activeCell:function(j){if(j){this.originalActiveCell=j.first();
this._activeCell=this._sheet.unionWithMerged(j.toRangeRef());
this._sheet.focus(j);
this._sheet.triggerChange({activeCell:true,selection:true});
}return this._activeCell;
},select:function(q,l,j,s){if(q){if(q.eq(this.originalSelection)){return;
}this._sheet.triggerSelect(new e(q,this._sheet));
this.originalSelection=q;
this.selection=l;
if(j!==false){if(q.isCell()){this._sheet.forEachMergedCell(q,function(u){q=u.topLeft;
});
this.activeCell(q);
}else{q=this.selection.lastRange();
if(s&&s._sheet===this._sheet&&s.panes[0]){var p=s.panes;
var m,o,r,k,t,n;
for(m=0;
m<p.length;
m++){o=p[m];
r=o._currentView.rows.values;
k=o._currentView.columns.values;
t=new f(new a(r.start,k.start),new a(r.end,k.end));
n=q.intersect(t);
if(n!==c.spreadsheet.NULLREF){break;
}}q=n;
}this.activeCell(q.first());
}this.selectionRangeIndex=this.selection.size()-1;
}else{this._sheet.triggerChange({selection:true});
}}return this.selection;
},singleCellSelection:function(){return this._activeCell.eq(this.selection);
}});
var h=c.Observable.extend({init:function(){c.Observable.prototype.init.call(this);
this._reinit.apply(this,arguments);
},events:["changing","commandRequest","afterInsertRow","afterDeleteRow","insertRow","insertColumn","deleteRow","deleteColumn","hideRow","hideColumn","unhideRow","unhideColumn","select","dataBinding","dataBound"],_reinit:function(o,j,p,k,m,n,l){l=l||{};
this._defaultCellStyle={background:l.background,color:l.color,fontFamily:l.fontFamily,fontSize:l.fontSize,italic:l.italic,bold:l.bold,underline:l.underline,wrap:l.wrap,verticalAlign:l.verticalAlign,textAlign:l.textAlign};
this._rows=new c.spreadsheet.Axis(o,p);
this._columns=new c.spreadsheet.Axis(j,k);
this._filteredRows=new c.spreadsheet.RangeList(0,o-1,false);
this._mergedCells=[];
this._frozenRows=0;
this._frozenColumns=0;
this._suspendChanges=false;
this._filter=null;
this._showGridLines=true;
this._gridLinesColor=null;
this._grid=new c.spreadsheet.Grid(this._rows,this._columns,o,j,m,n);
this._sheetRef=this._grid.normalize(c.spreadsheet.SHEETREF);
this._properties=new c.spreadsheet.PropertyBag(o,j,this._defaultCellStyle);
this._sorter=new c.spreadsheet.Sorter(this._grid,this._properties.sortable());
this._viewSelection=new g(this);
this._editSelection=new g(this);
this._formulaSelections=[];
this._drawings=[];
},_selectionState:function(){return this._inEdit?this._editSelection:this._viewSelection;
},navigator:function(){if(!this._navigator){this._navigator=new c.spreadsheet.SheetNavigator(this);
}return this._navigator;
},axisManager:function(){if(!this._axisManager){this._axisManager=new c.spreadsheet.AxisManager(this);
}return this._axisManager;
},_name:function(j){if(!j){return this._sheetName;
}this._sheetName=j;
return this;
},name:function(){return this._name();
},_property:function(j,l,k){if(l===undefined){return j();
}else{j(l);
return this.triggerChange(k);
}},_field:function(j,l,k){if(l===undefined){return this[j];
}else{this[j]=l;
return this.triggerChange(k);
}},suspendChanges:function(j){if(j===undefined){return this._suspendChanges;
}this._suspendChanges=j;
return this;
},triggerChange:function(j){if(!this._suspendChanges){this.trigger("change",j);
}return this;
},triggerSelect:function(j){this.trigger("select",{range:j});
},setDataSource:function(k,j){if(this.dataSourceBinder){this.dataSourceBinder.destroy();
}this.dataSourceBinder=new c.spreadsheet.SheetDataSourceBinder({dataSource:k,sheet:this,columns:j});
this.dataSource=this.dataSourceBinder.dataSource;
},hideColumn:function(j){if(this.trigger("hideColumn",{index:j})){return;
}return this._property(this._columns.hide.bind(this._columns),j,{layout:true});
},unhideColumn:function(j){if(this.trigger("unhideColumn",{index:j})){return;
}return this._property(this._columns.unhide.bind(this._columns),j,{layout:true});
},isHiddenColumn:function(j){return this._grid._columns.hidden(j);
},_copyRange:function(p,r){var j=this._grid;
var o=j.rowCount;
var n=j.normalize(p.topLeft);
var m=j.normalize(p.bottomRight);
var l=n.col*o+n.row;
var k=m.col*o+m.row;
var q=r.col*o+r.row;
this._properties.copy(l,k,q);
},_saveModifiedFormulas:function(j,k){var m=d;
d=j;
var l=k();
d=m;
return l;
},_restoreModifiedFormulas:function(j){var k=this._workbook;
j.forEach(function(l){var n=k.sheetByName(l.sheet),m;
if(l instanceof c.spreadsheet.calc.runtime.Formula){m=n._grid.cellRefIndex(l);
n._properties.set("formula",m,m,l);
}if(l instanceof c.spreadsheet.validation.Validation){m=n._grid.cellRefIndex(l);
n._properties.set("validation",m,m,l);
}});
},_adjustReferences:function(n,p,l,m){this._mergedCells=m.reduce(function(q,r){r=r.adjust(null,null,null,null,n=="row",p,l);
if(r instanceof f){q.push(r);
}return q;
},[]);
if(this._workbook){var j=this._name();
this._workbook._sheets.forEach(function(q){q._forFormulas(function(r){var s=r.adjust(j,n,p,l);
if(s&&d){d.push(s);
}});
q._forValidations(function(s){var r=s.adjust(j,n,p,l);
if(r&&d){d.push(r);
}});
});
this._workbook.adjustNames(j,n=="row",p,l);
}var o=this.select();
o=o.adjust(null,null,null,null,n=="row",p,l);
if(o!==c.spreadsheet.NULLREF){this.select(o);
}var k=n=="col"?this._columns:this._rows;
k.adjust(p,l);
if(n=="row"){if(l<0){this._filteredRows.copy(p-l,this._rows._count-1,p);
}else{this._filteredRows.copy(p,this._rows._count,p+l);
this._filteredRows.value(p,p+l-1,false);
}}this._drawings.forEach(function(q){if(q.topLeftCell){q.topLeftCell=q.topLeftCell.adjust(null,null,null,null,n=="row",p,l);
}});
},_forFormulas:function(j){var m=this._properties;
var k=m.get("formula").values();
var l=k.length;
k.forEach(function(n,o){j.call(this,n.value,o,l);
},this);
},_forValidations:function(j){var k=this._properties;
k.get("validation").values().forEach(function(l){j.call(this,l.value);
},this);
},preventInsertRow:function(m,j){if(this.selectedHeaders().allRows){return{reason:"error",type:"insertRowWhenColumnIsSelected"};
}j=j||1;
var k=this._grid;
var l=this.range(k.rowCount-j,0,j,k.columnCount);
if(l.hasValue()){return{reason:"error",type:"shiftingNonblankCells"};
}return false;
},preventInsertColumn:function(j,k){if(this.selectedHeaders().allCols){return{reason:"error",type:"insertColumnWhenRowIsSelected"};
}k=k||1;
var l=this._grid;
var m=this.range(0,l.columnCount-k,l.rowCount,k);
if(m.hasValue()){return{reason:"error",type:"shiftingNonblankCells"};
}return false;
},insertRow:function(k,l){var j=this.preventInsertRow(k);
if(j){throw new Error("Shifting nonblank cells off the worksheet is not supported!");
}if(this.trigger("insertRow",{index:k})){return;
}this.batch(function(){var q=this._grid;
var o=q.columnCount;
var u=q.rowCount;
var p=this.frozenRows();
if(k<p){this.frozenRows(p+1);
}var r=this._mergedCells.slice();
for(var n=0;
n<o;
n++){var t=new f(new a(k,n),new a(k,n));
var v=q.normalize(t.topLeft);
var m=q.normalize(t.bottomRight);
var s=new f(new a(v.row,v.col),new a(u-2,m.col));
this._copyRange(s,new a(v.row+1,v.col));
new e(t,this).clear({clearAll:true,keepBorders:true});
}this._adjustReferences("row",k,1,r);
},{recalc:true,layout:true,insertRow:{index:k},ref:new f(new a(k,0),new a(Infinity,Infinity))});
if(!l){this.trigger("afterInsertRow",{index:k});
}return this;
},isEnabledRow:function(k){var j=new f(new a(k,0),new a(k,this._grid.columnCount));
return new e(j,this).enable();
},deleteRow:function(j,k){if(!this.isEnabledRow(j)){return this;
}if(this.trigger("deleteRow",{index:j})){return;
}this.batch(function(){var p=this._grid;
var n=p.columnCount;
var o=this.frozenRows();
if(j<o){this.frozenRows(o-1);
}var q=this._mergedCells.slice();
for(var m=0;
m<n;
m++){var t=new f(new a(j,m),new a(j,m));
new e(t,this).clear({clearAll:true,keepBorders:true});
var u=p.normalize(t.topLeft);
var l=p.normalize(t.bottomRight);
var r=new f(new a(u.row+1,u.col),new a(Infinity,l.col));
this._copyRange(r,u);
var s=p.normalize(r.bottomRight);
new e(new f(s,s),this).clear();
}this._adjustReferences("row",j,-1,q);
},{recalc:true,layout:true,deleteRow:{index:j},ref:new f(new a(j,0),new a(Infinity,Infinity))});
if(!k){this.trigger("afterDeleteRow",{index:j});
}return this;
},insertColumn:function(j){if(this.trigger("insertColumn",{index:j})){return;
}this.batch(function(){var o=this._grid;
var m=o.columnCount;
var n=this.frozenColumns();
if(j<n){this.frozenColumns(n+1);
}var p=this._mergedCells.slice();
for(var l=m;
l>=j;
l--){var r=new f(new a(0,l),new a(Infinity,l));
new e(r,this).clear({clearAll:true,keepBorders:true});
if(l==j){break;
}var s=o.normalize(r.topLeft);
var k=o.normalize(r.bottomRight);
var q=new f(new a(s.row,s.col-1),new a(k.row,k.col-1));
this._copyRange(q,s);
}this._adjustReferences("col",j,1,p);
},{recalc:true,layout:true,insertColumn:{index:j},ref:new f(new a(0,j),new a(Infinity,Infinity))});
return this;
},isEnabledColumn:function(j){var k=new f(new a(0,j),new a(Infinity,j));
return new e(k,this).enable();
},deleteColumn:function(j){if(!this.isEnabledColumn(j)){return this;
}if(this.trigger("deleteColumn",{index:j})){return;
}this.batch(function(){var o=this._grid;
var m=o.columnCount;
var n=this.frozenColumns();
if(j<n){this.frozenColumns(n-1);
}var p=this._mergedCells.slice();
for(var l=j;
l<m;
l++){var r=new f(new a(0,l),new a(Infinity,l));
new e(r,this).clear({clearAll:true,keepBorders:true});
if(l==m-1){break;
}var s=o.normalize(r.topLeft);
var k=o.normalize(r.bottomRight);
var q=new f(new a(s.row,s.col+1),new a(k.row,k.col+1));
this._copyRange(q,s);
}this._adjustReferences("col",j,-1,p);
},{recalc:true,layout:true,deleteColumn:{index:j},ref:new f(new a(0,j),new a(Infinity,Infinity))});
return this;
},_filterRow:function(j){this._rows.hide(j);
this._filteredRows.value(j,j,true);
this.triggerChange({layout:true});
},hideRow:function(j){if(this.trigger("hideRow",{index:j})){return;
}return this._property(this._rows.hide.bind(this._rows),j,{layout:true});
},unhideRow:function(j){if(this.trigger("unhideRow",{index:j})){return;
}return this._property(this._rows.unhide.bind(this._rows),j,{layout:true});
},isHiddenRow:function(j){return this._grid._rows.hidden(j);
},isFilteredRow:function(j){return this._filteredRows.value(j);
},columnWidth:function(j,k){return this._property(this._columns.value.bind(this._columns,j,j),k,{layout:true});
},rowHeight:function(k,j){return this._property(this._rows.value.bind(this._rows,k,k),j,{layout:true});
},frozenRows:function(j){return this._field("_frozenRows",j,{layout:true});
},frozenColumns:function(j){return this._field("_frozenColumns",j,{layout:true});
},showGridLines:function(j){return this._field("_showGridLines",j,{layout:true});
},gridLinesColor:function(j){return this._field("_gridLinesColor",j,{layout:true});
},_ref:function(n,j,l,k){var m=null;
if(n instanceof c.spreadsheet.Ref){return n;
}if(n instanceof c.spreadsheet.Range){return n._ref.toRangeRef();
}if(typeof n==="string"){m=c.spreadsheet.calc.parseReference(n);
}else{if(!l){l=1;
}if(!k){k=1;
}m=new f(new a(n,j),new a(n+l-1,j+k-1));
}return m;
},range:function(m,j,l,k){return new e(this._ref(m,j,l,k),this);
},_getMergedCells:function(m){var j=this._grid;
var l={};
var n={};
var k=false;
this.forEachMergedCell(m,function(o){var p=o.topLeft;
j.forEach(o,function(q){if(p.eq(q)){l[q.print()]=o;
k=true;
}else{if(m.contains(q)){n[q.print()]=p;
k=true;
}}});
});
return{primary:l,secondary:n,hasMerged:k};
},forEachMergedCell:function(k,j){var l=false;
if(typeof j==="undefined"){j=k;
l=true;
}this._mergedCells.forEach(function(m){if(l||m.intersects(k)){j(m);
}});
},forEachFilterHeader:function(k,j){var m=false;
if(typeof j==="undefined"){j=k;
m=true;
}if(this._filter){var l=[];
this._filter.ref.forEachColumn(function(o){if(m||o.intersects(k)){l.push(o.topLeft);
}});
this._mergedCells.forEach(function(o){l=l.map(function(p){if(o.intersects(p)){return o;
}return p;
});
});
l.reduce(function n(p,o){if(p.indexOf(o)<0){p.push(o);
}return p;
},[]).forEach(j);
}},forEach:function(l,j){var m=this;
function k(r){if(!(r instanceof f)){r=r.toRangeRef();
}var u=m._grid.normalize(r.topLeft);
var n=m._grid.normalize(r.bottomRight);
var o,s;
function p(v){j(s++,o,v);
}for(o=u.col;
o<=n.col;
o++){s=u.row;
var t=m._grid.index(s,o);
var q=m._grid.index(n.row,o);
m._properties.forEach(t,q,p);
}}if(!(l instanceof f)){l=m._ref(l);
}if(l instanceof i){l.forEach(k);
}else{k(l);
}},startResizing:function(j){this._initialPosition=j;
this._resizeInProgress=true;
},startAutoFill:function(){this._autoFillInProgress=true;
var j=this.select();
this._autoFillOrigin=j;
this._autoFillDest=j;
this.triggerChange({selection:true});
},updateAutoFill:function(j,m,l,k){this._autoFillDest=j;
this._autoFillPunch=m;
this._autoFillHint=l;
this._autoFillDirection=k;
this.triggerChange({selection:true});
},autoFillRef:function(){return this._autoFillDest;
},autoFillPunch:function(){return this._autoFillPunch;
},autoFillInProgress:function(){return this._autoFillInProgress;
},resizingInProgress:function(){return this._resizeInProgress;
},draggingInProgress:function(){return this._draggingInProgress;
},completeResizing:function(){if(this._resizeInProgress){this._resizeInProgress=false;
var k=this.resizeHintPosition();
if(this._initialPosition&&k){var j=this.resizeHandlePosition();
if(j.col!==-Infinity){this.trigger("commandRequest",{command:"ColumnWidthCommand",options:{target:j.col,value:this.columnWidth(j.col)-(this._initialPosition.x-k.x)}});
}else{this.trigger("commandRequest",{command:"RowHeightCommand",options:{target:j.row,value:this.rowHeight(j.row)-(this._initialPosition.y-k.y)}});
}}else{this.trigger("change",{resize:true});
}}},_renderComment:function(k){var j=k?this.range(k).comment():null;
if(j){if(!this._commentRef||!k.eq(this._commentRef)){this._commentRef=k;
this.trigger("change",{comment:true});
}}else{if(this._commentRef){this._commentRef=null;
this.trigger("change",{comment:true});
}}},resizeHandlePosition:function(){return this._resizeHandlePosition;
},resizeHintPosition:function(j){if(j!==undefined){this._resizeHintPosition=j;
this.trigger("change",{resize:true});
}return this._resizeHintPosition;
},removeResizeHandle:function(){if(this._resizeHandlePosition){this._resizeHintPosition=undefined;
this._resizeHandlePosition=undefined;
this._initialPosition=undefined;
this.trigger("change",{resize:true});
}},positionResizeHandle:function(j){this._resizeHandlePosition=j;
this.trigger("change",{resize:true});
},startDragging:function(j){this._draggingInProgress=j;
},completeDragging:function(){var l=this._draggingInProgress;
if(l){this._draggingInProgress=null;
var m=l.drawing;
if(m.eq(l.copy)){return;
}if(m.topLeftCell){var j=this.drawingBoundingBox(m);
var p=this._rows.indexVisible(j.top);
var k=this._columns.indexVisible(j.left);
var n=new a(p,k);
var o=this.refBoundingBox(n);
m.offsetX=j.left-o.left;
m.offsetY=j.top-o.top;
m.topLeftCell=n;
this.triggerChange({dragging:true});
}this.trigger("commandRequest",{command:"DrawingUpdateCommand",options:{sheet:this,drawing:m,previous:l.copy}});
}},startSelection:function(j){if(j&&j._sheet===this){this._currentView=j;
}this._selectionInProgress=true;
},completeSelection:function(){if(this._selectionInProgress){this._selectionInProgress=false;
this._resizeHintPosition=undefined;
this.trigger("change",{selection:true});
}if(this._autoFillInProgress){this._autoFillInProgress=false;
var j=this._autoFillDest;
var k=this._autoFillOrigin;
if(this._autoFillPunch){this.trigger("commandRequest",{command:"ClearContentCommand",options:{operatingRange:this.range(this._autoFillPunch)}});
}else{if(!j.eq(k)){this.trigger("commandRequest",{command:"AutoFillCommand",options:{operatingRange:this.range(j),origin:this.range(k)}});
}else{this.triggerChange({selection:true});
}}this._autoFillDest=null;
this._autoFillPunch=null;
this._autoFillOrigin=null;
this.select(j);
}},selectionInProgress:function(){return this._selectionInProgress;
},select:function(l,j){var m=this._selectionState();
var k;
if(l){l=this._ref(l);
l=this._grid.normalize(l);
k=this._grid.isAxis(l)?l:this.unionWithMerged(l);
}return m.select(l,k,j,this._currentView);
},originalSelect:function(){return this._selectionState().originalSelection;
},currentSelectionRange:function(){return this._selectionState().currentSelectionRange();
},currentOriginalSelectionRange:function(){return this._selectionState().currentOriginalNavigationRange();
},currentNavigationRange:function(){return this._selectionState().currentNavigationRange();
},nextNavigationRange:function(){return this._selectionState().nextNavigationRange();
},previousNavigationRange:function(){return this._selectionState().previousNavigationRange();
},selectionRangeIndex:function(){return this._selectionState().selectionRangeIndex;
},activeCell:function(j){return this._selectionState().activeCell(j);
},originalActiveCell:function(){return this._selectionState().originalActiveCell;
},singleCellSelection:function(){return this._selectionState().singleCellSelection();
},unionWithMerged:function(k){var j=this._mergedCells;
return k.map(function(l){return l.toRangeRef().union(j);
});
},trim:function(k){var l=[];
var j=this._grid;
this._properties.forEachProperty(function(m){l.push(j.trim(k,m.list));
});
return this.unionWithMerged(k.topLeft.toRangeRef().union(l));
},focus:function(k){if(k){this._focus=k.toRangeRef();
}else{var j=this._focus;
this._focus=null;
return j;
}},activeCellSelection:function(){return new e(this._grid.normalize(this.activeCell()),this);
},selection:function(){return new e(this._grid.normalize(this._selectionState().selection),this);
},selectedHeaders:function(){var p=this.select();
var o={};
var l={};
var j=false;
var k=false;
var n=this._grid.rowCount-1;
var m=this._grid.columnCount-1;
p.forEach(function(u){var t;
var w="partial";
var s="partial";
u=u.toRangeRef();
var q=u.bottomRight;
var x=u.topLeft;
var v=x.col<=0&&q.col>=m;
var r=x.row<=0&&q.row>=n;
if(r){k=true;
s="full";
}if(v){j=true;
w="full";
}if(!r){for(t=x.row;
t<=q.row;
t++){if(o[t]!=="full"){o[t]=w;
}}}if(!v){for(t=x.col;
t<=q.col;
t++){if(l[t]!=="full"){l[t]=s;
}}}});
return{rows:o,cols:l,allRows:k,allCols:j,all:k&&j};
},isInEditMode:function(j){if(j===undefined){return this._inEdit;
}this._inEdit=j;
if(j){this._editSelection.selection=this._viewSelection.selection.clone();
this._editSelection.originalSelection=this._viewSelection.originalSelection.clone();
this._editSelection._activeCell=this._viewSelection._activeCell.clone();
this._editSelection.originalActiveCell=this._viewSelection.originalActiveCell.clone();
}},_setFormulaSelections:function(j){this._formulaSelections=(j||[]).slice();
this.triggerChange({selection:true});
},_viewActiveCell:function(){return this._viewSelection._activeCell.toRangeRef();
},toJSON:function(){var o={};
var p=this._rows.toJSON("height",o);
var k=this._columns.toJSON("width",{});
var q=this._viewSelection;
var m=[];
var l=this._defaultCellStyle||{};
function j(r){Object.keys(l).forEach(function(s){if(r[s]===l[s]){delete r[s];
}});
}this.forEach(c.spreadsheet.SHEETREF,function(u,s,r){j(r);
if(Object.keys(r).length===0){return;
}if(r.link){m.push({ref:c.spreadsheet.Ref.display(null,u,s),target:r.link});
}var t=o[u];
if(t===undefined){t=p.length;
p.push({index:u});
o[u]=t;
}u=p[t];
r.index=s;
if(u.cells===undefined){u.cells=[];
}if(r.formula){if(r.formula.arrayFormulaRange){r.formula={src:r.formula.toString(),ref:r.formula.arrayFormulaRange.toString()};
}else{r.formula=r.formula.toString();
}}if(r.validation){r.validation=r.validation.toJSON();
}if(r.color){r.color=c.parseColor(r.color).toCss();
}if(r.background){r.background=c.parseColor(r.background).toCss();
}if(r.borderTop&&r.borderTop.color){r.borderTop.color=c.parseColor(r.borderTop.color).toCss();
}if(r.borderBottom&&r.borderBottom.color){r.borderBottom.color=c.parseColor(r.borderBottom.color).toCss();
}if(r.borderRight&&r.borderRight.color){r.borderRight.color=c.parseColor(r.borderRight.color).toCss();
}if(r.borderLeft&&r.borderLeft.color){r.borderLeft.color=c.parseColor(r.borderLeft.color).toCss();
}u.cells.push(r);
});
var n={name:this._name(),rows:p,columns:k,selection:q.selection.toString(),activeCell:q.activeCell().toString(),frozenRows:this.frozenRows(),frozenColumns:this.frozenColumns(),showGridLines:this.showGridLines(),gridLinesColor:this.gridLinesColor(),mergedCells:this._mergedCells.map(function(r){return r.toString();
}),hyperlinks:m,defaultCellStyle:l,drawings:this._drawings.map(function(r){return r.toJSON();
})};
if(this._sort){n.sort={ref:this._sort.ref.toString(),columns:this._sort.columns.map(function(r){return{index:r.index,ascending:r.ascending};
})};
}if(this._filter){n.filter={ref:this._filter.ref.toString(),columns:this._filter.columns.map(function(r){var s=r.filter.toJSON();
s.index=r.index;
return s;
})};
}return n;
},fromJSON:function(j){this.batch(function(){if(j.name!==undefined){this._name(j.name);
}if(j.frozenColumns!==undefined){this.frozenColumns(j.frozenColumns);
}if(j.frozenRows!==undefined){this.frozenRows(j.frozenRows);
}if(j.columns!==undefined){this._columns.fromJSON("width",j.columns);
}if(j.rows!==undefined){this._rows.fromJSON("height",j.rows);
for(var s=0;
s<j.rows.length;
s++){var t=j.rows[s];
var u=t.index;
if(u===undefined){u=s;
}if(t.cells){for(var m=0;
m<t.cells.length;
m++){var l=t.cells[m];
var n=l.index;
if(n===undefined){n=m;
}if(l.formula){var q=typeof l.formula!="string";
var v=q?l.formula.src:l.formula;
var p=this._compileFormula(u,n,v);
if(q){p.setArrayFormulaRange(c.spreadsheet.calc.parseReference(l.formula.ref));
}l.formula=p;
}if(l.validation){l.validation=this._compileValidation(u,n,l.validation);
}this._properties.fromJSON(this._grid.index(u,n),l);
}}}}if(j.drawings){this._drawings=j.drawings.map(b.fromJSON);
}if(j.selection){this._viewSelection.selection=this._viewSelection.originalSelection=this._ref(j.selection);
}if(j.activeCell){var k=this._ref(j.activeCell);
this._viewSelection._activeCell=k.toRangeRef();
this._viewSelection.originalActiveCell=k.first();
}if(j.mergedCells){j.mergedCells.forEach(function(w){this.range(w).merge();
},this);
}if(j.sort){this._sort={ref:this._ref(j.sort.ref),columns:j.sort.columns.slice(0)};
}if(j.filter){var r=j.filter.ref;
var o=j.filter.columns===undefined?[]:j.filter.columns;
if(!r){c.logToConsole("Dropping filter for sheet '"+j.name+"' due to missing ref");
}else{this._filter={ref:this._ref(r),columns:o.map(function(w){return{index:w.index,filter:c.spreadsheet.Filter.create(w)};
})};
this._refreshFilter();
}}if(j.showGridLines!==undefined){this._showGridLines=j.showGridLines;
}this._gridLinesColor=j.gridLinesColor;
});
this._rows._refresh();
this._columns._refresh();
},formula:function(j){return this._properties.get("formula",this._grid.cellRefIndex(j));
},validation:function(j){return this._properties.get("validation",this._grid.cellRefIndex(j));
},resetFormulas:function(){this._forFormulas(function(j){j.reset();
});
},resetValidations:function(){this._forValidations(function(j){j.reset();
});
},recalc:function(k,j){var m=this._properties.get("formula").values();
var l=m.length,p=0,n=0;
if(!l&&j){return j();
}function o(){p--;
if(n==l&&!p){j();
}}while(n<l){p++;
m[n++].value.exec(k,j?o:null);
}},revalidate:function(j){var k=this;
this._forValidations(function(n){var l=new a(n.row,n.col);
var m=new f(l,l);
n.exec(j,k._get(m,"value"),k._get(m,"format"));
});
},_value:function(l,j,m){var k=this._grid.index(l,j);
if(m!==undefined){this._properties.set("value",k,k,m);
}else{return this._properties.get("value",k);
}},_validation:function(l,j){var k=this._grid.index(l,j);
return this._properties.get("validation",k);
},_compileValidation:function(k,j,l){if(l instanceof c.spreadsheet.validation.Validation){return l.clone(this._name(),k,j);
}if(l.from!=null){l.from=(l.from+"").replace(/^=/,"");
}if(l.to!=null){l.to=(l.to+"").replace(/^=/,"");
}return c.spreadsheet.validation.compile(this._name(),k,j,l);
},_compileFormula:function(l,j,k){k=k.replace(/^=/,"");
k=c.spreadsheet.calc.parseFormula(this._name(),l,j,k);
return c.spreadsheet.calc.compile(k);
},_copyValuesInRange:function(q,j,r,n){var k,p,l;
for(k=q.col;
k<=j.col;
k++){p=this._grid.index(q.row,k);
l=this._grid.index(j.row,k);
for(var m=p,o=q.row;
m<=l;
++m,++o){r=r.clone(this._name(),o,k);
this._properties.set(n,m,m,r);
}}return r;
},_set:function(n,m,q){var p=this._grid.normalize(n.topLeft);
var j=this._grid.normalize(n.bottomRight);
var k,o,l;
if(typeof q=="number"){q=c.spreadsheet.calc.runtime.limitPrecision(q);
}if(q&&m=="formula"){if(typeof q=="string"){q=this._compileFormula(p.row,p.col,q);
}q=this._copyValuesInRange(p,j,q,"formula");
}else{if(q&&m=="validation"){q=this._compileValidation(p.row,p.col,q);
q=this._copyValuesInRange(p,j,q,"validation");
}else{for(k=p.col;
k<=j.col;
k++){o=this._grid.index(p.row,k);
l=this._grid.index(j.row,k);
this._properties.set(m,o,l,q);
if(m=="formula"){this._properties.set("value",o,l,null);
}}}}},_get:function(l,k){var m=this._grid.normalize(l.topLeft);
var j=this._grid.index(m.row,m.col);
return this._properties.get(k,j);
},batch:function(j,k){var l=this.suspendChanges();
this.suspendChanges(true);
j.call(this);
return this.suspendChanges(l).triggerChange(k||{recalc:true});
},_sortBy:function(l,j){var k=null;
j.forEach(function(m){k=this._sorter.sortBy(l,m.index,this._properties.get("value"),m.ascending,k);
},this);
this._sort={ref:l,columns:j};
this._refreshFilter();
this.forEach(l,function(q,m,p){var o=p.formula;
if(o){var n=q-o.row;
if(n!==0){var r=n>0?o.row:o.row+n;
o.adjust(this.name(),"row",r,n);
}}}.bind(this));
this.triggerChange({recalc:true});
},_refreshFilter:function(){if(this._filter){this._filterBy(this._filter.ref,this._filter.columns);
}},_filterBy:function(k,j){this.batch(function(){for(var l=k.topLeft.row;
l<=k.bottomRight.row;
l++){if(this.isFilteredRow(l)){this._filteredRows.value(l,l,false);
this._rows.unhide(l);
}}j.forEach(function(p){var q=k.resize({top:1}).toColumn(p.index);
var n=[];
if(q===c.spreadsheet.NULLREF){return;
}this.forEach(q,function(u,t,s){s.row=u;
n.push(s);
});
p.filter.prepare(n);
for(var o=0;
o<n.length;
o++){var m=n[o];
var r=p.filter.value(m);
if(p.filter.matches(r)===false){this._filterRow(m.row);
}}},this);
this._filter={ref:k,columns:j};
},{recalc:true,layout:true,filter:true});
},filterColumn:function(k){var j=this.filter().ref;
return k.toRangeRef().topLeft.col-j.topLeft.col;
},filter:function(){return this._filter;
},clearFilter:function(j){this._clearFilter(j instanceof Array?j:[j]);
},_clearFilter:function(j){if(this._filter){this.batch(function(){this._filter.columns=this._filter.columns.filter(function(k){return j.indexOf(k.index)<0;
});
this._refreshFilter();
},{recalc:true,layout:true,filter:true});
}},getAxisState:function(){return{rows:this._rows.getState(),columns:this._columns.getState()};
},setAxisState:function(j){this._rows.setState(j.rows);
this._columns.setState(j.columns);
this.triggerChange({layout:true});
},getState:function(){return{rows:this._rows.getState(),columns:this._columns.getState(),mergedCells:this._mergedCells.map(function(j){return j.clone();
}),properties:this._properties.getState()};
},setState:function(j){this._rows.setState(j.rows);
this._columns.setState(j.columns);
this._mergedCells=j.mergedCells;
this._properties.setState(j.properties);
this.triggerChange(c.spreadsheet.ALL_REASONS);
},_merge:function(l){var j=this._mergedCells;
var m=this;
var k;
this.batch(function(){k=l.map(function(t){if(t instanceof c.spreadsheet.CellRef){return t;
}var p=t.toRangeRef().union(j,function(w){j.splice(j.indexOf(w),1);
});
var s=new e(p,m);
var r=s._get("formula");
var v=s.value();
var q=s.format();
var o=s.background();
s.value(null);
s.format(null);
s.background(null);
var u=new e(p.collapse(),m);
if(r){u._set("formula",r);
}else{u.value(v);
}u.format(q);
u.background(o);
j.push(p);
return p;
});
var n=m._viewSelection;
n.selection=m.unionWithMerged(n.originalSelection);
n._activeCell=m.unionWithMerged(n.originalActiveCell);
},{activeCell:true,selection:true});
return k;
},_useCultureDecimals:function(){return this._workbook&&this._workbook.options.useCultureDecimals;
},withCultureDecimals:function(k){var j=".";
if(this._useCultureDecimals()){j=c.culture().numberFormat["."];
}return c.spreadsheet.calc.withDecimalSeparator(j,k);
},drawingBoundingBox:function(j){var k=j.offsetX;
var l=j.offsetY;
if(j.topLeftCell){k+=this._columns.sum(0,j.topLeftCell.col-1);
l+=this._rows.sum(0,j.topLeftCell.row-1);
}return new c.spreadsheet.Rectangle(k,l,j.width,j.height);
},refBoundingBox:function(j){return this._grid.rectangle(j.toRangeRef());
},addDrawing:function(k,j){if(!(k instanceof b)){k=new b(k);
}this._drawings.push(k);
if(j){this._activeDrawing=k;
}this.triggerChange({layout:true});
return k;
},removeDrawing:function(j){var k=this._drawings.indexOf(j);
if(k>=0){this._drawings.splice(k,1);
this.triggerChange({layout:true});
}},usesImage:function(k){for(var j=this._drawings.length;
--j>=0;
){if(this._drawings[j].image===k){return true;
}}return false;
}});
var b=c.Class.extend({init:function b(j){this.reset(j);
},toJSON:function(){return{topLeftCell:this.topLeftCell.toString(),offsetX:this.offsetX,offsetY:this.offsetY,width:this.width,height:this.height,image:this.image,opacity:this.opacity};
},clone:function(){return new b(this);
},reset:function(k){var j=k.topLeftCell;
if(typeof j=="string"){j=c.spreadsheet.calc.parseReference(j);
}this.topLeftCell=j;
this.offsetX=k.offsetX||0;
this.offsetY=k.offsetY||0;
this.width=k.width;
this.height=k.height;
this.image=k.image;
this.opacity=k.opacity!=null?k.opacity:1;
},eq:function(j){return(!this.topLeftCell&&!j.topLeftCell||this.topLeftCell&&j.topLeftCell&&this.topLeftCell.eq(j.topLeftCell))&&this.offsetX===j.offsetX&&this.offsetY===j.offsetY&&this.width===j.width&&this.height===j.height&&this.image===j.image&&this.opacity===j.opacity;
}});
b.fromJSON=function(j){return new b(j);
};
c.spreadsheet.Sheet=h;
c.spreadsheet.Drawing=b;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/sheetsbar",["kendo.core","kendo.sortable"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var a=d.jQuery;
var e=d._outerWidth;
var b=".";
var c=" ";
var g={sheetsBarWrapper:"k-widget k-header",sheetsBarSheetsWrapper:"k-tabstrip k-floatwrap k-tabstrip-bottom",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",sheetsBarAdd:"k-spreadsheet-sheets-bar-add",sheetsBarRemove:"k-spreadsheet-sheets-remove",sheetsBarItems:"k-spreadsheet-sheets-items",sheetsBarEditor:"k-spreadsheet-sheets-editor",sheetsBarScrollable:"k-tabstrip-scrollable",sheetsBarNext:"k-tabstrip-next",sheetsBarPrev:"k-tabstrip-prev",sheetsBarKItem:"k-item k-state-default",sheetsBarKActive:"k-state-active k-state-tab-on-top",sheetsBarKTextbox:"k-textbox",sheetsBarKLink:"k-link",sheetsBarKIcon:"k-icon",sheetsBarKFontIcon:"k-icon",sheetsBarKButton:"k-button k-button-icon",sheetsBarKButtonBare:"k-bare",sheetsBarKArrowW:"k-i-arrow-60-left",sheetsBarKArrowE:"k-i-arrow-60-right",sheetsBarKReset:"k-reset k-tabstrip-items",sheetsBarKIconX:"k-i-close",sheetsBarKSprite:"k-sprite",sheetsBarKIconPlus:"k-i-plus",sheetsBarHintWrapper:"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint",sheetsBarKResetItems:"k-reset k-tabstrip-items"};
var f=d.ui.Widget.extend({init:function(i,j){var h=f.classNames;
d.ui.Widget.call(this,i,j);
i=this.element;
i.addClass(h.sheetsBarWrapper);
this._openDialog=j.openDialog;
this._tree=new d.dom.Tree(i[0]);
this._tree.render([this._addButton(),this._createSheetsWrapper([])]);
this._toggleScrollEvents(true);
this._createSortable();
this._sortable.bind("start",this._onSheetReorderStart.bind(this));
this._sortable.bind("end",this._onSheetReorderEnd.bind(this));
i.on("click",b+h.sheetsBarRemove,this._onSheetRemove.bind(this));
i.on("click","li",this._onSheetSelect.bind(this));
i.on("dblclick","li"+b+h.sheetsBarActive,this._createEditor.bind(this));
i.on("click",b+h.sheetsBarAdd,this._onAddSelect.bind(this));
},options:{name:"SheetsBar",scrollable:{distance:200}},events:["select","reorder","rename"],_createEditor:function(){if(this._editor){return;
}this._renderSheets(this._sheets,this._selectedIndex,true);
this._editor=this.element.find(d.format("input{0}{1}",b,f.classNames.sheetsBarEditor)).focus().on("keydown",this._onEditorKeydown.bind(this)).on("blur",this._onEditorBlur.bind(this));
},_destroyEditor:function(h){var i=h?null:this._editor.val();
this._editor.off();
this._editor=null;
this._renderSheets(this._sheets,this._selectedIndex,false);
this._onSheetRename(i);
},renderSheets:function(i,h){if(!i||h<0){return;
}this._renderSheets(i,h,false);
},_renderSheets:function(r,q,l){var v=this;
var w;
var t;
var j=f.classNames;
v._isRtl=d.support.isRtl(v.element);
v._sheets=r;
v._selectedIndex=q;
v._renderHtml(l,true);
if(!v._scrollableAllowed()){return;
}var u=v._sheetsWrapper();
var o=u.children(b+j.sheetsBarPrev);
var m=u.children(b+j.sheetsBarNext);
var k=2;
var h=v.element.find(b+j.sheetsBarAdd);
var i=e(h)+h.position().left+k;
var p=e(o)+k;
var s=v._sheetsGroup();
o.css({left:i});
u.addClass(j.sheetsBarScrollable+c+j.sheetsBarSheetsWrapper);
s.css({marginLeft:i});
w=u[0].offsetWidth;
t=s[0].scrollWidth;
if(t+i>w){var n=Math.ceil(d.parseFloat(m.css("right")));
if(!v._scrollableModeActive){v._nowScrollingSheets=false;
v._scrollableModeActive=true;
}s.css({marginLeft:p+i,marginRight:e(m)+n+k});
}else{if(v._scrollableModeActive&&t<=w){v._scrollableModeActive=false;
s.css({marginLeft:i,marginRight:""});
}else{s.css({marginLeft:i});
}}v._toggleScrollButtons();
},_toggleScrollButtons:function(l){var k=this;
var m=k._sheetsGroup();
var n=k._sheetsWrapper();
var j=m.scrollLeft();
var i=n.find(b+f.classNames.sheetsBarPrev);
var h=n.find(b+f.classNames.sheetsBarNext);
if(l===false){i.toggle(false);
h.toggle(false);
}else{i.toggle(k._isRtl?j<m[0].scrollWidth-m[0].offsetWidth-1:j!==0);
h.toggle(k._isRtl?j!==0:j<m[0].scrollWidth-m[0].offsetWidth-1);
}},_toggleScrollEvents:function(n){var m=this;
var h=f.classNames;
var i=m.options;
var k;
var j;
var l=m._sheetsWrapper();
k=l.children(b+h.sheetsBarPrev);
j=l.children(b+h.sheetsBarNext);
if(n){k.on("mousedown",function(){m._nowScrollingSheets=true;
m._scrollSheetsByDelta(i.scrollable.distance*(m._isRtl?1:-1));
});
j.on("mousedown",function(){m._nowScrollingSheets=true;
m._scrollSheetsByDelta(i.scrollable.distance*(m._isRtl?-1:1));
});
k.add(j).on("mouseup",function(){m._nowScrollingSheets=false;
});
}else{k.off();
j.off();
}},_renderHtml:function(o,q){var n;
var t=[];
var k=d.dom;
var l=k.element;
var u=this._sheets;
var r=this._selectedIndex;
var i=f.classNames;
for(n=0;
n<u.length;
n++){var s=u[n];
var p=n===r;
var h={className:i.sheetsBarKItem+c};
var m=[];
if(p){h.className+=i.sheetsBarKActive+c+i.sheetsBarActive;
}else{h.className+=i.sheetsBarInactive;
}if(p&&o){m.push(l("input",{type:"text",value:s.name(),className:i.sheetsBarKTextbox+c+i.sheetsBarEditor,maxlength:50},[]));
}else{m.push(l("span",{className:i.sheetsBarKLink,title:s.name()},[k.text(s.name())]));
if(u.length>1){var j=l("span",{className:i.sheetsBarKIcon+c+i.sheetsBarKFontIcon+c+i.sheetsBarKIconX},[]);
m.push(l("span",{className:i.sheetsBarKLink+c+i.sheetsBarRemove},[j]));
}}t.push(l("li",h,m));
}this._tree.render([this._addButton(),this._createSheetsWrapper(t,q)]);
},_createSheetsWrapper:function(m,l){var k=d.dom.element;
var j=f.classNames;
var i=[k("ul",{className:j.sheetsBarKReset},m)];
l=true;
if(l){var h=j.sheetsBarKButton+c+j.sheetsBarKButtonBare+c;
i.push(k("span",{className:h+j.sheetsBarPrev},[k("span",{className:j.sheetsBarKIcon+c+j.sheetsBarKArrowW},[])]));
i.push(k("span",{className:h+j.sheetsBarNext},[k("span",{className:j.sheetsBarKIcon+c+j.sheetsBarKArrowE},[])]));
}return k("div",{className:j.sheetsBarItems},i);
},_createSortable:function(){var h=f.classNames;
this._sortable=new d.ui.Sortable(this.element,{filter:d.format("ul li.{0},ul li.{1}",h.sheetsBarActive,h.sheetsBarInactive),container:b+h.sheetsBarItems,axis:"x",animation:false,ignore:"input",end:function(){if(this.draggable.hint){this.draggable.hint.remove();
}},hint:function(i){var j=a(i).clone();
return j.wrap("<div class='"+h.sheetsBarHintWrapper+"'><ul class='"+h.sheetsBarKResetItems+"'></ul></div>").closest("div");
}});
},_onEditorKeydown:function(h){if(this._editor){if(h.which===13){this._destroyEditor();
}if(h.which===27){this._destroyEditor(true);
}}},_onEditorBlur:function(){if(this._editor){this._destroyEditor();
}},_onSheetReorderEnd:function(h){h.preventDefault();
this.trigger("reorder",{oldIndex:h.oldIndex,newIndex:h.newIndex});
},_onSheetReorderStart:function(h){if(this._editor){h.preventDefault();
}},_onSheetRemove:function(i){var j=a(i.target).closest("li").text();
if(this._editor){this._destroyEditor();
}var h=function(l){var k=l.sender;
if(k.isConfirmed()){this.trigger("remove",{name:j,confirmation:true});
}}.bind(this);
this._openDialog("confirmation",{close:h});
},_onSheetSelect:function(h){var i=a(h.target).text();
if(a(h.target).is(b+f.classNames.sheetsBarEditor)||!i){h.preventDefault();
return;
}if(this._editor){this._destroyEditor();
}this._scrollSheetsToItem(a(h.target).closest("li"));
this.trigger("select",{name:i,isAddButton:false});
},_onSheetRename:function(h){if(this._sheets[this._selectedIndex].name()===h||h===null){return;
}this.trigger("rename",{name:h,sheetIndex:this._selectedIndex});
},_onAddSelect:function(){this.trigger("select",{isAddButton:true});
},_addButton:function(){var i=d.dom.element;
var h=f.classNames;
return i("a",{className:h.sheetsBarAdd+c+h.sheetsBarKButton},[i("span",{className:h.sheetsBarKIcon+c+h.sheetsBarKFontIcon+c+h.sheetsBarKIconPlus},[])]);
},destroy:function(){this._sortable.destroy();
},_scrollableAllowed:function(){var h=this.options;
return h.scrollable&&!isNaN(h.scrollable.distance);
},_scrollSheetsToItem:function(i){var p=this;
if(!p._scrollableModeActive){return;
}var m=p._sheetsGroup();
var h=m.scrollLeft();
var l=e(i);
var j=p._isRtl?i.position().left:i.position().left-m.children().first().position().left;
var o=m[0].offsetWidth;
var n=Math.ceil(parseFloat(m.css("padding-left")));
var k;
if(p._isRtl){if(j<0){k=h+j-(o-h)-n;
}else{if(j+l>o){k=h+j-l+n*2;
}}}else{if(h+o<j+l){k=j+l-o+n*2;
}else{if(h>j){k=j-n;
}}}m.finish().animate({scrollLeft:k},"fast","linear",function(){p._toggleScrollButtons();
});
},_sheetsGroup:function(){return this._sheetsWrapper().children("ul");
},_sheetsWrapper:function(){return this.element.find(b+f.classNames.sheetsBarItems);
},_scrollSheetsByDelta:function(h){var k=this;
var j=k._sheetsGroup();
var i=j.scrollLeft();
j.finish().animate({scrollLeft:i+h},"fast","linear",function(){if(k._nowScrollingSheets){k._scrollSheetsByDelta(h);
}else{k._toggleScrollButtons();
}});
}});
d.spreadsheet.SheetsBar=f;
a.extend(true,f,{classNames:g});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/calc",["spreadsheet/runtime"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var M=kendo.util;
var H=kendo.spreadsheet;
var B=H.Ref;
var z=H.RangeRef;
var a=H.CellRef;
var p=H.NameRef;
var c=H.calc;
var E=c.runtime;
var t=Object.create(null);
var s=Object.create(null);
(function(N){N.forEach(function(O,P){O.forEach(function(Q){t[Q]=N.length-P;
s[Q==","?";":Q]=N.length-P;
});
});
}([[":"],[" "],[","],["%"],["^"],["*","/"],["+","-"],["&"],["=","<",">","<=",">=","<>"]]));
var r=t;
var F={DEC:".",ARG:",",COL:","};
function G(N){F.DEC=N;
F.ARG=N==","?";":",";
F.COL=N==","?"\\":",";
r=N==","?s:t;
}c.withDecimalSeparator=function(P,N){if(F.DEC==P){return N();
}var O=F.DEC;
G(P);
try{return N();
}finally{G(O);
}};
c._separators=F;
var u=kendo.Class.extend({init:function u(N,O){this.message=N;
this.pos=O;
},toString:function(){return this.message;
}});
var L={type:"bool",value:true};
var d={type:"bool",value:false};
function g(P){P=P.toUpperCase();
for(var N=0,O=0;
O<P.length;
++O){N=N*26+P.charCodeAt(O)-64;
}return N-1;
}function i(N){return parseInt(N,10)-1;
}function x(Q,R){if(Q.toLowerCase()=="#sheet"){return H.SHEETREF;
}OUT:{var P;
if(P=/^(\$)?([a-z]+)(\$)?(\d+)$/i.exec(Q)){var T=i(P[4]),O=g(P[2]);
if(T<1048576&&O<16384){return new a(i(P[4]),g(P[2]));
}break OUT;
}var U=K(Q,{});
var N=[];
while(true){var S=U.next();
if(S instanceof a){S.rel=0;
}else{if(S instanceof z){S.topLeft.rel=0;
S.bottomRight.rel=0;
}else{break OUT;
}}N.push(S);
if(U.eof()){break;
}if(!U.is("op",F.ARG)){break OUT;
}U.next();
}return N.length==1?N[0]:new H.UnionRef(N);
}if(!R){throw new Error("Cannot parse reference: "+Q);
}}function v(ac,ab,O,Q){var aa=[];
Q=K(Q,{row:ab,col:O});
var R=Q.is;
return{type:"exp",ast:X(true),refs:aa,sheet:ac,row:ab,col:O};
function N(ae){ae.index=aa.length;
aa.push(ae);
return ae;
}function ad(ag,ah,ae){if(R(ag,ah)){return Q.next();
}else{var af=Q.peek();
if(af){Q.croak("Expected "+ag+" \xAB"+ah+"\xBB but found "+af.type+" \xAB"+af.value+"\xBB");
}else{if(!ae){Q.croak("Expected "+ag+" \xAB"+ah+"\xBB");
}}}}function X(ae){return S(T(W()),0,ae);
}function Z(ae){if(ae.upper=="TRUE"||ae.upper=="FALSE"){return ae.upper=="TRUE"?L:d;
}return N(new p(ae.value));
}function Y(){var af=Q.next();
af=af.value;
ad("punc","(");
var ae=[];
while(1){if(R("punc",")")){break;
}if(R("op",F.ARG)){ae.push({type:"null"});
Q.next();
continue;
}ae.push(X(false));
if(Q.eof()||R("punc",")")){break;
}ad("op",F.ARG);
}ad("punc",")",true);
return{type:"func",func:af,args:ae};
}function P(ae){if(!ae.hasSheet()){ae.setSheet(ac);
}return N(ae);
}function W(){var ae;
if(R("ref")){ae=P(Q.next());
}else{if(R("func")){ae=Y();
}else{if(R("punc","(")){Q.next();
ae=X(true);
ad("punc",")",true);
}else{if(R("punc","{")){Q.next();
ae=V();
ad("punc","}",true);
}else{if(R("num")||R("str")||R("error")){ae=Q.next();
}else{if(R("sym")){ae=Z(Q.next());
}else{if(R("op","+")||R("op","-")){ae={type:"prefix",op:Q.next().value,exp:W()};
}else{if(!Q.peek()){Q.croak("Incomplete expression");
}else{if(R("punc","[")){Q.croak("External reference not supported");
}else{Q.croak("Parse error");
}}}}}}}}}return U(ae);
}function V(){var af=[],ag=[af],ae=true;
while(!Q.eof()&&!R("punc","}")){if(ae){ae=false;
}else{if(R(null,";")){ag.push(af=[]);
Q.next();
}else{ad(null,F.COL);
}}af.push(X(false));
}return{type:"matrix",value:ag};
}function T(ae){if(R("punc","(")||R("ref")||R("num")||R("func")){return{type:"binary",op:" ",left:ae,right:X(false)};
}else{return ae;
}}function U(ae){if(R("op","%")){Q.next();
return U({type:"postfix",op:"%",exp:ae});
}else{return ae;
}}function S(ag,ah,ae){var aj=R("op");
if(aj&&(ae||aj.value!=F.ARG)){var af=r[aj.value];
if(af>ah){Q.next();
var ai=S(W(),af,ae);
return S({type:"binary",op:aj.value==";"?",":aj.value,left:ag,right:ai},ah,ae);
}}return ag;
}}function w(P,N){var Q=v(null,0,0,P);
if(!(Q.ast instanceof p)){throw new u("Invalid name: "+P);
}Q=Q.ast;
if(!(N instanceof B)){var O=v(Q.sheet,0,0,N);
if(O.ast instanceof B){N=O.ast;
}else{if(/^(?:str|num|bool|error)$/.test(O.ast.type)){N=O.ast.value;
}else{N=n(O);
}}}return{name:Q,value:N};
}var m=function(N){return function(O){var P=N[O];
if(!P){P=N[O]=new Function("'use strict';return("+O+")")();
}return P;
};
}(Object.create(null));
function o(N){return m("function(row, col, mod){return("+P(N.ast,N,0)+")}");
function P(Q,R,S){switch(Q.type){case"num":return"(kendo.spreadsheet.calc._separators.DEC == '.' ? "+JSON.stringify(JSON.stringify(Q.value))+" : "+JSON.stringify(JSON.stringify(Q.value))+".replace('.' , kendo.spreadsheet.calc._separators.DEC))";
case"bool":return JSON.stringify(Q.value);
case"error":return JSON.stringify("#"+Q.value);
case"str":return JSON.stringify(JSON.stringify(Q.value));
case"ref":return"this.refs["+Q.index+"].print(row, col, mod)";
case"prefix":return T(function(){return JSON.stringify(Q.op)+" + "+P(Q.exp,Q,r[Q.op]);
});
case"postfix":return T(function(){return P(Q.exp,Q,r[Q.op])+" + "+JSON.stringify(Q.op);
});
case"binary":return T(function(){var U=O(P(Q.left,Q,r[Q.op]),Q.left instanceof p&&Q.op==":");
var V=O(P(Q.right,Q,r[Q.op]),Q.right instanceof p&&Q.op==":");
if(/^[,;]/.test(Q.op)){return U+" + kendo.spreadsheet.calc._separators.ARG + "+V;
}else{return U+" + "+JSON.stringify(Q.op)+" + "+V;
}});
case"func":return JSON.stringify(Q.func+"(")+" + "+(Q.args.length>0?Q.args.map(function(U){return P(U,Q,0);
}).join(" + kendo.spreadsheet.calc._separators.ARG + ' ' + "):"''")+" + ')'";
case"matrix":return"'{ ' + "+Q.value.map(function(U){return U.map(function(V){return P(V,Q,0);
}).join(" + kendo.spreadsheet.calc._separators.COL + ' ' + ");
}).join(" + '; ' + ")+"+ ' }'";
case"null":return"''";
}throw new Error("Cannot make printer for node "+Q.type);
function T(U){var W=Q.op;
var V=r[W]<S||!S&&W==","||R.type=="prefix"&&S==r[W]&&R.op=="-"||R.type=="binary"&&S==r[W]&&Q===R.right;
return O(U(),V);
}}function O(Q,R){return R?"'(' + "+Q+" + ')'":Q;
}}function I(N,ac){var ab=0;
return O(N,ac);
function O(af,ae){switch(af.type){case"ref":return Y(af,ae);
case"num":case"str":case"null":case"error":case"bool":return Q(af,ae);
case"prefix":case"postfix":return Z(af,ae);
case"binary":return R(af,ae);
case"func":return S(af,ae);
case"lambda":return U(af,ae);
case"matrix":return V(af.value,ae,true);
}throw new Error("Cannot CPS "+af.type);
}function Y(af,ae){return af.ref=="name"?W(af,ae):Q(af,ae);
}function Q(af,ae){return ae(af);
}function W(af,ae){return{type:"func",func:",getname",args:[ad(ae),af]};
}function Z(af,ae){return O({type:"func",func:"unary"+af.op,args:[af.exp]},ae);
}function R(af,ae){return O({type:"func",func:"binary"+af.op,args:[af.left,af.right]},ae);
}function T(ae,ah,af,ag){return O(ae,function(ai){var ak=ad(ag);
var al=aa("T");
var aj=aa("E");
return{type:"func",func:"if",args:[ak,ai,{type:"lambda",vars:[al],body:O(ah||L,function(am){return{type:"call",func:{type:"var",name:al},args:[am]};
})},{type:"lambda",vars:[aj],body:O(af||d,function(am){return{type:"call",func:{type:"var",name:aj},args:[am]};
})}]};
});
}function P(ae,af){if(ae.length===0){return Q(L,af);
}return O({type:"func",func:"IF",args:[ae[0],{type:"func",func:"AND",args:ae.slice(1)},d]},af);
}function X(ae,af){if(ae.length===0){return Q(d,af);
}return O({type:"func",func:"IF",args:[ae[0],L,{type:"func",func:"OR",args:ae.slice(1)}]},af);
}function S(ag,ae){switch(ag.func.toLowerCase()){case"if":return T(ag.args[0],ag.args[1],ag.args[2],ae);
case"and":return P(ag.args,ae);
case"or":return X(ag.args,ae);
case"true":return ae(L);
case"false":return ae(d);
}return function af(ah,ai){if(ai==ag.args.length){return{type:"func",func:ag.func,args:ah};
}else{return O(ag.args[ai],function(aj){return af(ah.concat([aj]),ai+1);
});
}}([ad(ae)],0);
}function U(ah,ag){var af=aa("K");
var ae=O(ah.body,function(ai){return{type:"call",func:{type:"var",value:af},args:[ai]};
});
return ag({type:"lambda",vars:[af].concat(ah.vars),body:ae});
}function V(af,ah,ag){var ae=[];
return function ai(aj){if(aj==af.length){return ah({type:"matrix",value:ae});
}else{return(ag?V:O)(af[aj],function(ak){ae[aj]=ak;
return ai(aj+1);
});
}}(0);
}function ad(af){var ae=aa("R");
return{type:"lambda",vars:[ae],body:af({type:"var",name:ae})};
}function aa(ae){if(!ae){ae="";
}ae="_"+ae;
return ae+ ++ab;
}}var f=Object.create(null);
function n(O){var T=o(O);
var Q=T.call(O);
var P=f[Q];
if(P){return P.clone(O.sheet,O.row,O.col);
}var N=R(I(O.ast,function(U){return{type:"return",value:U};
}));
N=["function(){","var context = this, refs = context.formula.absrefs",N,"}"].join(";\n");
P=new E.Formula(O.refs,m(N),T,O.sheet,O.row,O.col);
f[Q]=P.clone(O.sheet,O.row,O.col);
return P;
function R(U){var V=U.type;
if(V=="num"){return U.value+"";
}else{if(V=="str"){return JSON.stringify(U.value);
}else{if(V=="error"){return"context.error("+JSON.stringify(U.value)+")";
}else{if(V=="return"){return"context.resolve("+R(U.value)+")";
}else{if(V=="func"){return"context.func("+JSON.stringify(U.func)+", "+R(U.args[0])+", "+S(U.args.slice(1))+")";
}else{if(V=="call"){return R(U.func)+"("+U.args.map(R).join(", ")+")";
}else{if(V=="ref"){return"refs["+U.index+"]";
}else{if(V=="bool"){return""+U.value;
}else{if(V=="if"){return"(context.bool("+R(U.co)+") ? "+R(U.th)+" : "+R(U.el)+")";
}else{if(V=="lambda"){return"(function("+U.vars.join(", ")+"){ return("+R(U.body)+") })";
}else{if(V=="var"){return U.name;
}else{if(V=="matrix"){return S(U.value);
}else{if(V=="null"){return"null";
}else{throw new Error("Cannot compile expression "+V);
}}}}}}}}}}}}}}function S(U){return"[ "+U.map(R).join(", ")+" ]";
}}function j(N){return N;
}function K(R,U){R=A(k(R),U);
var O=R.ahead;
var ad=R.skip;
var af=null;
var P=U.row!=null&&U.col!=null?function(ag){if(ag.rel&1){ag.col-=U.col;
}if(ag.rel&2){ag.row-=U.row;
}return ag;
}:j;
var N=U.forEditor?function(ai,ah,ag){ai.begin=ah.begin;
ai.end=ag.end;
return ai;
}:j;
return{peek:V,next:T,croak:R.croak,eof:R.eof,is:S};
function S(ah,ai){var ag=V();
return ag!=null&&(ah==null||ag.type===ah)&&(ai==null||ag.value===ai)?ag:null;
}function V(){if(af==null){af=W();
}return af;
}function T(){if(af!=null){var ag=af;
af=null;
return ag;
}return W();
}function W(){var ag;
var ah=R.peek();
if(ah){if(ah.type=="sym"||ah.type=="rc"||ah.type=="num"){ag=O(8,aa)||O(6,Y)||O(6,ac)||O(4,ab)||O(4,Z)||O(2,X)||O(2,Q);
}if(!ag){ag=R.next();
}}return ag;
}function ae(am,ai){if(am.type=="rc"){if(am.rel&&!U.forEditor&&(U.row==null||U.col==null)){R.croak("Cannot read relative cell in RC notation");
}return new a(am.row,am.col,am.rel);
}if(am.type=="num"){if(am.value<=1048577){return P(new a(i(am.value),ai?-Infinity:+Infinity,2));
}else{return null;
}}var ak=am.value;
var aj=/^(\$)?([a-z]+)(\$)?(\d+)$/i.exec(ak);
if(aj){var al=i(aj[4]),ah=g(aj[2]);
if(al<=1048576&&ah<=16383){return P(new a(i(aj[4]),g(aj[2]),(aj[1]?0:1)|(aj[3]?0:2)));
}else{return null;
}}var ag=ak.charAt(0)=="$";
if(ag){ak=ak.substr(1);
}if(/^\d+$/.test(ak)){var al=i(ak);
if(al<=1048576){return P(new a(i(ak),ai?-Infinity:+Infinity,ag?0:2));
}}else{var ah=g(ak);
if(ah<=16383){return P(new a(ai?-Infinity:+Infinity,g(ak),ag?0:1));
}}}function aa(ag,ah,aj,ak,al,am,an,ao){if(ag.type=="sym"&&ah.type=="op"&&ah.value==":"&&aj.type=="sym"&&ak.type=="punc"&&ak.value=="!"&&(al.type=="sym"||al.type=="rc"||al.type=="num"&&al.value==al.value|0)&&am.type=="op"&&am.value==":"&&(an.type=="sym"||an.type=="rc"||an.type=="num"&&an.value==an.value|0)&&an.type==al.type&&!(ao.type=="punc"&&ao.value=="("&&!an.space)){var ap=ae(al,true),ai=ae(an,false);
if(ap&&ai){ad(7);
return N(new z(ap.setSheet(ag.value,true),ai.setSheet(aj.value,true)).setSheet(ag.value,true),ag,an);
}}}function Y(ag,ah,aj,ak,al,am){if(ag.type=="sym"&&ah.type=="op"&&ah.value==":"&&aj.type=="sym"&&ak.type=="punc"&&ak.value=="!"&&(al.type=="sym"||al.type=="rc"||al.type=="num"&&al.value==al.value|0)&&!(am.type=="punc"&&am.value=="("&&!al.space)){var an=ae(al);
if(an){ad(5);
var ai=an.clone();
return N(new z(an.setSheet(ag.value,true),ai.setSheet(aj.value,true)).setSheet(ag.value,true),ag,al);
}}}function ac(ag,ah,aj,ak,al,am){if(ag.type=="sym"&&ah.type=="punc"&&ah.value=="!"&&(aj.type=="sym"||aj.type=="rc"||aj.type=="num"&&aj.value==aj.value|0)&&ak.type=="op"&&ak.value==":"&&(al.type=="sym"||al.type=="rc"||al.type=="num"&&al.value==al.value|0)&&!(am.type=="punc"&&am.value=="("&&!al.space)){var an=ae(aj,true),ai=ae(al,false);
if(an&&ai){ad(5);
return N(new z(an,ai).setSheet(ag.value,true),ag,al);
}}}function ab(ag,ah,ai,aj){if(ag.type=="sym"&&ah.type=="punc"&&ah.value=="!"&&(ai.type=="sym"||ai.type=="rc"||ai.type=="num"&&ai.value==ai.value|0)&&!(aj.type=="punc"&&aj.value=="("&&!ai.space)){ad(3);
var ak=ae(ai);
if(!ak||!isFinite(ak.row)){ak=new p(ai.value);
}return N(ak.setSheet(ag.value,true),ag,ai);
}}function Z(ag,ah,aj,ak){if((ag.type=="sym"||ag.type=="rc"||ag.type=="num"&&ag.value==ag.value|0)&&(ah.type=="op"&&ah.value==":")&&(aj.type=="sym"||aj.type=="rc"||aj.type=="num"&&aj.value==aj.value|0)&&!(ak.type=="punc"&&ak.value=="("&&!aj.space)){var al=ae(ag,true),ai=ae(aj,false);
if(al&&ai){ad(3);
return N(new z(al,ai),ag,aj);
}}}function X(ag,ah){if((ag.type=="sym"||ag.type=="rc")&&!(ah.type=="punc"&&ah.value=="("&&!ag.space)){var ai=ae(ag);
if(ai&&isFinite(ai.row)&&isFinite(ai.col)){ad(1);
return N(ai,ag,ag);
}}}function Q(ag,ah){if(ag.type=="sym"&&ah.type=="punc"&&ah.value=="("&&!ag.space){ag.type="func";
ad(1);
return ag;
}}}function l(N){return" \t\r\n\xA0\u200B".indexOf(N)>=0;
}var b={type:"eof"};
function A(R,Y){var ak=[],Q=0;
var ah=R.readWhile;
return{next:X,peek:Z,eof:O,croak:R.croak,ahead:N,skip:ai};
function S(al){return/[0-9]/i.test(al);
}function U(al){return/[a-z$_]/i.test(al)||M.isUnicodeLetter(al);
}function T(al){return U(al)||S(al)||al==".";
}function V(al){return al in r;
}function W(al){return"\\!;(){}[]".indexOf(al)>=0;
}function ab(){var al=false;
var am=ah(function(an){if(an==F.DEC){if(al){return false;
}al=true;
return true;
}return S(an);
});
if(am==F.DEC){return{type:"punc",value:F.DEC};
}else{return{type:"num",value:parseFloat(am.replace(F.DEC,"."))};
}}function aj(al,am){return{type:"sym",value:al,upper:al.toUpperCase(),space:l(R.peek()),quote:am};
}function P(al,am,an){if(!al&&!am&&!an){return null;
}if(!al&&!an||al&&an){var ao=am?parseInt(am,10):0;
return al?ao:ao-1;
}}function ag(){var am=R.lookingAt(/^R(\[)?(-?[0-9]+)?(\])?C(\[)?(-?[0-9]+)?(\])?/i);
if(am){var an=P(am[1],am[2],am[3]);
var al=P(am[4],am[5],am[6]);
if(an!=null&&al!=null){R.skip(am);
return{type:"rc",row:an,col:al,rel:(am[4]||!(am[4]||am[5]||am[6])?1:0)|(am[1]||!(am[1]||am[2]||am[3])?2:0)};
}}return aj(ah(T));
}function af(){R.next();
return{type:"str",value:R.readEscaped('"')};
}function ae(){R.next();
return aj(R.readEscaped("'"),true);
}function ac(){return{type:"op",value:ah(function(al,am){return am+al in r;
})};
}function ad(){return{type:"punc",value:R.next()};
}function aa(){if(R.eof()){return null;
}var al=R.peek(),am;
if(al=='"'){return af();
}if(al=="'"){return ae();
}if(S(al)||al==F.DEC){return ab();
}if(U(al)){return ag();
}if(V(al)){return ac();
}if(W(al)){return ad();
}if(am=R.lookingAt(/^#([a-z\/]+)[?!]?/i)){R.skip(am);
return{type:"error",value:am[1]};
}if(!Y.forEditor){R.croak("Can't handle character with code: "+al.charCodeAt(0));
}return{type:"error",value:R.next()};
}function Z(){while(ak.length<=Q){ah(l);
var al=R.pos();
var am=aa();
if(Y.forEditor&&am){am.begin=al;
am.end=R.pos();
}ak.push(am);
}return ak[Q];
}function X(){var al=Z();
if(al){Q++;
}return al;
}function N(an,am){var ao=Q,al=[];
while(an-->0){al.push(X()||b);
}Q=ao;
return am.apply(al,al);
}function ai(al){Q+=al;
}function O(){return Z()==null;
}}function k(R){var X=0,S=1,N=0;
return{next:V,peek:W,eof:P,croak:O,readWhile:Z,readEscaped:Y,lookingAt:U,skip:aa,forward:Q,pos:T};
function T(){return X;
}function V(){var ab=R.charAt(X++);
if(ab=="\n"){S++;
N=0;
}else{N++;
}return ab;
}function W(){return R.charAt(X);
}function P(){return W()==="";
}function O(ab){throw new u(ab+" (input: "+R+")",X);
}function aa(ab){if(typeof ab=="string"){if(R.substr(X,ab.length)!=ab){O("Expected "+ab);
}Q(ab.length);
}else{if(ab instanceof RegExp){var ac=ab.exec(R.substr(X));
if(ac){Q(ac[0].length);
return ac;
}}else{Q(ab[0].length);
}}}function Q(ab){while(ab-->0){V();
}}function Y(ac){var ad=false,ae="";
while(!P()){var ab=V();
if(ad){ae+=ab;
ad=false;
}else{if(ab=="\\"){ad=true;
}else{if(ab==ac){break;
}else{ae+=ab;
}}}}return ae;
}function Z(ab){var ac="";
while(!P()&&ab(W(),ac)){ac+=V();
}return ac;
}function U(ab){return ab.exec(R.substr(X));
}}var e=[];
var C=c.registerFormatParser=function(N){e.push(N);
};
c.parse=function(V,U,N,R,P){if(R instanceof Date){return{type:"date",value:E.dateToSerial(R)};
}if(typeof R=="number"){return{type:"number",value:R};
}if(typeof R=="boolean"){return{type:"boolean",value:R};
}R+="";
if(/^'/.test(R)){return{type:"string",value:R.substr(1)};
}if(/^-?[0-9]+%$/.test(R)){var W=R.substr(0,R.length-1);
var S=parseFloat(W);
if(!isNaN(S)&&S==W){return{type:"percent",value:S/100};
}}if(/^=/.test(R)){R=R.substr(1);
if(/\S/.test(R)){return v(V,U,N,R);
}else{return{type:"string",value:"="+R};
}}for(var Q=0;
Q<e.length;
++Q){var T=e[Q](R);
if(T){return T;
}}if(R.toLowerCase()=="true"){return{type:"boolean",value:true};
}if(R.toLowerCase()=="false"){return{type:"boolean",value:false};
}var O=E.parseDate(R,P);
if(O){return{type:"date",value:E.dateToSerial(O)};
}var S=parseFloat(R);
if(!isNaN(S)&&R.length>0&&S==R){P=null;
if(S!=Math.floor(S)){P="0."+String(S).split(".")[1].replace(/\d/g,"0");
}return{type:"number",value:S,format:P};
}return{type:"string",value:R};
};
function J(O,Q,N){var S=[];
O=K(O,{forEditor:true,row:Q,col:N});
while(!O.eof()){S.push(P());
}var R=S[0];
if(R.type=="op"&&R.value=="="){R.type="startexp";
}return S;
function P(){var T=O.next();
if(T.type=="sym"){if(T.upper=="TRUE"){T.type="bool";
T.value=true;
}else{if(T.upper=="FALSE"){T.type="bool";
T.value=false;
}}}else{if(T.type=="ref"){T={type:"ref",ref:Q!=null&&N!=null?T.absolute(Q,N):T,begin:T.begin,end:T.end};
}}return T;
}}function y(O,R,N){R=R||0;
N=N||0;
O=K(O,{row:R,col:N});
var Q=[];
while(!O.eof()){var P=O.next();
if(P.type!="ref"){throw new u("Expecting a reference but got: "+JSON.stringify(P));
}Q.push(P.absolute(R,N));
}return Q;
}c.parseNameDefinition=w;
c.parseFormula=v;
c.parseReference=x;
c.compile=n;
c.parseSqref=y;
c.InputStream=k;
c.ParseError=u;
c.tokenize=J;
C(function(R){var S,O=0,P="";
if(S=/^(\d+)([-\/.])(\d+)\2(\d{2}(?:\d{2})?)(\s*)/.exec(R)){var U=parseInt(S[1],10);
var X=S[2];
var N=parseInt(S[3],10);
var aa=parseInt(S[4],10);
if(aa<30){aa+=2000;
}else{if(aa<100){aa+=1900;
}}var V=true;
if(U>12){var Z=U;
U=N;
N=Z;
V=false;
}if(!E.validDate(aa,U,N)){return null;
}O=E.packDate(aa,U-1,N);
if(O<0){O--;
}if(V){P=["mm","dd","yyyy"].join(X);
}else{P=["dd","mm","yyyy"].join(X);
}P+=S[5];
R=R.substr(S[0].length);
}if(S=/^(\d+):(\d+)$/.exec(R)){var Q=parseInt(S[1],10);
var T=parseInt(S[2],10);
return{type:"date",format:P+"hh:mm",value:O+E.packTime(Q,T,0,0)};
}if(S=/^(\d+):(\d+)(\.\d+)$/.exec(R)){var T=parseInt(S[1],10);
var Y=parseInt(S[2],10);
var W=parseFloat(S[3])*1000;
return{type:"date",format:P+"mm:ss.00",value:O+E.packTime(0,T,Y,W)};
}if(S=/^(\d+):(\d+):(\d+)$/.exec(R)){var Q=parseInt(S[1],10);
var T=parseInt(S[2],10);
var Y=parseInt(S[3],10);
return{type:"date",format:P+"hh:mm:ss",value:O+E.packTime(Q,T,Y,0)};
}if(S=/^(\d+):(\d+):(\d+)(\.\d+)$/.exec(R)){var Q=parseInt(S[1],10);
var T=parseInt(S[2],10);
var Y=parseInt(S[3],10);
var W=parseFloat(S[4])*1000;
return{type:"date",format:P+"hh:mm:ss.00",value:O+E.packTime(Q,T,Y,W)};
}});
C(function(U){var V,W;
var O=kendo.culture();
var N=O.numberFormat[","];
var Q=O.numberFormat["."];
var P=O.numberFormat.currency.symbol;
var Y=h(N,Q);
var X=new RegExp("^\\s*\\"+P+"\\s*");
var Z=1;
var R="";
var aa="";
var S=false;
var T=false;
U=k(U.replace(/^\s+|\s+$/g,""));
if(U.skip(/^-\s*/)){Z=-1;
}if(V=U.skip(X)){S=true;
R+='"'+V[0]+'"';
}if(U.skip(/^-\s*/)){if(Z<0){return null;
}Z=-1;
}if(!(W=U.skip(Y))){return null;
}R+="0";
if(V=U.skip(X)){if(S){return null;
}S=true;
aa='"'+V[0]+'"';
}if(!S&&(V=U.skip(/^\s*%\s*/))){T=true;
aa=V[0];
}if(!U.eof()){return null;
}if(W[2]||S){R=R.replace("0","#");
R+=",0";
}if(W[3]){R+="."+D("0",W[3].length-1);
}var ab=W[0].replace(new RegExp("\\"+N,"g"),"").replace(new RegExp("\\"+Q,"g"),".");
ab=parseFloat(ab);
if(T){ab/=100;
}R+=aa;
if(S){R+=";-"+R;
}return{type:"number",currency:S,format:R,value:Z*ab};
});
C(function(N){var O;
if(O=/^([0-9]*)\.([0-9]+)(\s*%)$/.exec(N)){return{type:"number",value:parseFloat(N)/100,format:"0."+D("0",O[2].length)+O[3]};
}});
var q={};
function h(N,O){var P=N+O;
var Q=q[P];
if(!Q){Q="^(\\d+(COM\\d{3})*(DOT\\d+)?)";
Q=Q.replace(/DOT/g,"\\"+O).replace(/COM/g,"\\"+N);
Q=new RegExp(Q);
q[P]=Q;
}return Q;
}function D(P,N){var O="";
while(N-->0){O+=P;
}return O;
}},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/excel-reader",["kendo.core","kendo.color","util/parse-xml","spreadsheet/calc"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var a=kendo.jQuery;
var s=kendo.util.parseXML;
var r=kendo.spreadsheet.calc.parseReference;
var p={greaterThanOrEqual:"greaterThanOrEqualTo",lessThanOrEqual:"lessThanOrEqualTo"};
var g=null;
function w(av,ax,au){var aw=new FileReader();
aw.onload=function(ay){var az=new JSZip(ay.target.result);
C(az,ax,au);
};
aw.readAsArrayBuffer(av);
}var H=["sheetData","row","c"];
var I=["cols","col"];
var L=["definedNames","definedName"];
var O=["sheetData","row","c","f"];
var R=["mergeCells","mergeCell"];
var U=["sheetViews","sheetView","pane"];
var V=["sheetData","row"];
var Y=["sheetViews","sheetView","selection"];
var aa=["sheets","sheet"];
var ac=["sheetData","row","c","is"];
var ad=["t"];
var Z=["si"];
var al=["sheetData","row","c","v"];
var am=["bookViews","workbookView"];
var ab=["sheetViews","sheetView"];
var P=["hyperlinks","hyperlink"];
var ae=["dataValidations","dataValidation"];
var af=["dataValidations","dataValidation","formula1"];
var ah=["dataValidations","dataValidation","formula2"];
var aj=["x14:dataValidations","x14:dataValidation"];
var ak=["x14:dataValidations","x14:dataValidation","xm:sqref"];
var ag=["x14:dataValidations","x14:dataValidation","x14:formula1","xm:f"];
var ai=["x14:dataValidations","x14:dataValidation","x14:formula2","xm:f"];
var J=["commentList","comment"];
var F=["authors","author"];
var K=["t"];
function at(au){if(!/^\//.test(au)){if(!/^xl\//.test(au)){au="xl/"+au;
}}else{au=au.substr(1);
}return au;
}function C(aD,aC,ax){g=aC.excelImportErrors=[];
var az=z(aD);
var ay=x(aD,"_rels/workbook.xml");
var aB=B(aD,ay.byType.theme[0]);
var aA=A(aD,aB);
var av=[];
var au=0;
q(aD,"xl/workbook.xml",{enter:function(aJ,aE){if(this.is(aa)){var aI=aE["r:id"];
var aG=ay.byId[aI];
var aH=aE.name;
var aF=an(aD,aG);
aC.options.columnWidth=aF.columnWidth||aC.options.columnWidth;
aC.options.rowHeight=aF.rowHeight||aC.options.rowHeight;
av.push({workbook:aC,zip:aD,strings:az,styles:aA,file:aG,options:{name:aH,rows:Math.max(aC.options.rows||0,aF.rows),columns:Math.max(aC.options.columns||0,aF.cols),columnWidth:aF.columnWidth,rowHeight:aF.rowHeight}});
}else{if(this.is(am)){if(aE.activeTab){au=n(aE.activeTab);
}}}},text:function(aI){var aE=this.is(L);
if(aE&&!(c(aE["function"])||c(aE.vbProcedure))){var aF=aE.localSheetId;
var aH=null;
if(aF!=null){aH=av[aF].options.name;
}var aG=aE.name;
if(aG!="_xlnm._FilterDatabase"){if(aH){aG="'"+aH.replace(/\'/g,"\\'")+"'!"+aG;
}ar(aH,null,function(){aC.defineName(aG,aI,c(aE.hidden));
},"reading user-defined name: "+aG);
}}}});
var aw=new a.Deferred();
aw.progress(function(aE){if(ax){ax.notify(aE);
}}).then(function(){var aE=aC.sheets();
D(aE);
aC.activeSheet(aE[au]);
if(ax){ax.resolve();
}});
o(av,aC,aw);
}function o(av,ay,aw){var ax=new a.Deferred().resolve();
for(var au=0;
au<av.length;
au++){(function(az,aA){ax=ax.then(function(){var aD=ay.insertSheet(az.options);
aD.suspendChanges(true);
var aC=t(aD,az);
var aB={sheet:aD,progress:aA/(av.length-1)};
aC.then(function(){aw.notify(aB);
});
return aC;
});
}(av[au],au));
}ax.then(function(){aw.resolve();
});
}function t(aw,au){var av=new a.Deferred();
setTimeout(function(){y(au.zip,au.file,aw,au.strings,au.styles);
av.resolve();
},0);
return av;
}function D(av){for(var au=0;
au<av.length;
au++){av[au].suspendChanges(false).triggerChange({recalc:true});
}}function an(aw,av){var au={rows:0,cols:0};
q(aw,at(av),{enter:function(az,ax){if(az=="dimension"){var ay=r(ax.ref);
if(ay.bottomRight){au.cols=ay.bottomRight.col+1;
au.rows=ay.bottomRight.row+1;
}}else{if(az==="sheetFormatPr"){if(ax.defaultColWidth){au.columnWidth=ao(parseFloat(ax.defaultColWidth));
}if(ax.defaultRowHeight){au.rowHeight=aq(parseFloat(ax.defaultRowHeight));
}}else{if(this.is(V)){this.exit();
}}}}});
return au;
}function ao(aw){var av=7;
var au=(256*aw+Math.floor(128/av))/256;
return au*av;
}function aq(au){return au*(4/3);
}function y(aV,az,aO,aP,aQ){var aN={};
var aK,aR,aS,aD,aG,aH;
var aI=aO._columns._count;
var aJ=null;
var aM=az.replace(/worksheets\//,"worksheets/_rels/");
var aL=x(aV,aM);
var aE,aF;
var aB;
var aA;
var ax;
var aw;
var aT;
var aU;
var aC=[];
g=aO._workbook.excelImportErrors;
az=at(az);
q(aV,az,{enter:function(a6,aX,aZ){var a8;
if(this.is(O)){if(aZ){if(aX.t=="shared"&&aX.si!=null){aD=aO.range(aN[aX.si])._get("formula");
}}}else{if(this.is(H)){aS=null;
aD=null;
aK=aX.r;
aG=null;
if(aK==null){aK=r(aJ);
aK.col++;
aK=aK.toString();
}aJ=aK;
aR=aX.t;
var a5=aX.s;
if(a5!=null){b(aO,aK,aQ,a5);
}}else{if(this.is(R)){aO.range(aX.ref).merge();
}else{if(this.is(I)){var a3=n(aX.min)-1;
var a4=Math.min(aI,n(aX.max))-1;
var a9;
if(aX.width){a9=ao(parseFloat(aX.width));
if(a9!==0){aO._columns.values.value(a3,a4,a9);
}}if(aX.hidden==="1"||a9===0){for(var aY=a3;
aY<=a4;
aY++){aO.hideColumn(aY);
}}if(aX.style!=null){b(aO,new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(-Infinity,a3),new kendo.spreadsheet.CellRef(+Infinity,a4)),aQ,aX.style);
}}else{if(this.is(V)){var a2=n(aX.r)-1;
var a0;
if(aX.ht){a0=aq(parseFloat(aX.ht));
if(a0!==0){aO._rows.values.value(a2,a2,a0);
}}if(aX.hidden==="1"||a0===0){aO.hideRow(a2);
}}else{if(this.is(Y)){if(aX.activeCell){var aW=r(aX.activeCell);
aO.select(aW,true);
}}else{if(this.is(U)){if(aX.state=="frozen"){if(aX.xSplit){aO.frozenColumns(n(aX.xSplit));
}if(aX.ySplit){aO.frozenRows(n(aX.ySplit));
}}}else{if(this.is(ab)){aO.showGridLines(c(aX.showGridLines,true));
}else{if(this.is(P)){var a1=aX["r:id"];
var a7=aL.byId[a1];
if(a7){aO.range(aX.ref).link(a7);
}}else{if(this.is(["autoFilter"])){aB=aX.ref;
if(aZ){au();
}}else{if(aB){if(this.is(["filterColumn"])){aA=parseInt(aX.colId,10);
}else{if(this.is(["customFilters"])){ax=c(aX.and)?"and":"or";
aw=[];
}else{if(this.is(["customFilter"])){a8=j(aX.operator,aX.val);
if(a8){aw.push({operator:a8.operator,value:a8.value});
}}else{if(this.is(["dynamicFilter"])){aC.push({column:aA,filter:new kendo.spreadsheet.DynamicFilter({type:f(aX.type)})});
}else{if(this.is(["top10"])){aC.push({column:aA,filter:new kendo.spreadsheet.TopFilter({value:l(aX.val),type:function(ba,bb){return ba&&bb?"topPercent":bb?"topNumber":ba?"bottomPercent":"bottomNumber";
}(c(aX.percent),c(aX.top))})});
}else{if(this.is(["filters"])){aT=c(aX.blank);
aU=[];
}else{if(this.is(["filter"])){aU.push(l(aX.val));
}}}}}}}}}}}}}}}}}}},leave:function(aZ,aW){if(this.is(O)){if(!aD&&aW.t=="shared"&&aW.si!=null){aD=aO.range(aN[aW.si])._get("formula");
}}else{if(this.is(H)){if(aD!=null){var aX=ar(aO,aG||aK,function(){aO.range(aG||aK).formula(aD,aH);
},"parsing formula");
if(aX){aO.range(aG||aK).value(aD).background("#ffaaaa");
}}else{if(aS!=null){var aY=aO.range(aK);
if(!aY._get("formula")){if(!aR||aR=="n"){aS=parseFloat(aS);
}else{if(aR=="s"){aS=aP[n(aS)];
}else{if(aR=="b"){aS=aS==="1";
}else{if(aR=="d"){aS=kendo.parseDate(aS);
}}}}if(aS!=null){aY.value(aS);
}}}}}else{if(this.is(ae)||this.is(aj)){(function(){var a1=kendo.spreadsheet.calc.parseSqref(aW.sqref);
var a2=aW.type.toLowerCase();
var a0=aW.operator;
if(/^(?:whole|decimal)$/.test(a2)){a2="number";
}else{if(a2=="list"){a0="list";
}}if(!a0&&/^(?:number|date)$/.test(a2)){a0="between";
}a1.forEach(function(a3){ar(aO,a3,function(){aO.range(a3).validation({type:c(aW.showErrorMessage,true)?"reject":"warning",from:aE,to:aF,dataType:a2,comparerType:p[a0]||a0,allowNulls:c(aW.allowBlank),showButton:c(aW.showDropDown)||a2=="date"||a2=="list",messageTemplate:aW.error,titleTemplate:aW.errorTitle});
},"parsing validation");
});
}());
}else{if(aZ=="cols"){aO._columns._refresh();
}else{if(aZ=="sheetData"){aO._rows._refresh();
}else{if(aZ=="autoFilter"){au();
}else{if(aB){if(aZ=="customFilters"){aC.push({column:aA,filter:new kendo.spreadsheet.CustomFilter({logic:ax,criteria:aw})});
}else{if(aZ=="filters"){aC.push({column:aA,filter:new kendo.spreadsheet.ValueFilter({values:aU,blanks:aT})});
}}}}}}}}}},text:function(aX){var aW;
if(this.is(al)||this.is(ac)){aS=aX;
}else{if(aW=this.is(O)){aD=aX;
aH=aW.t=="array";
if(aH){aG=aW.ref;
}else{if(aW.t=="shared"){aN[aW.si]=aK;
}}}else{if(this.is(af)||this.is(ag)){aE=aX;
}else{if(this.is(ah)||this.is(ai)){aF=aX;
}else{if(this.is(ak)){this.stack[this.stack.length-2].sqref=aX;
}}}}}}});
if(aL.byType.comments){var av=E(az,aL.byType.comments[0]);
u(aV,av,aO);
}if(aL.byType.drawing){var ay=E(az,aL.byType.drawing[0]);
v(aV,ay,aO);
}function au(){aO.range(aB).filter(aC);
aB=null;
}}function i(au){var av=/\.([^.]+)$/.exec(au);
if(av&&av[1]){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif"}[av[1].toLowerCase()];
}}function k(au){var av=/[^\/]+$/.exec(au);
return av&&av[0];
}function v(aM,av,aK){var aJ=["xdr:twoCellAnchor"];
var aD=["xdr:ext"];
var aF=["xdr:oneCellAnchor"];
var aE=["xdr:from"];
var aI=["xdr:to"];
var aG=["xdr:row"];
var aB=["xdr:col"];
var aH=["xdr:rowOff"];
var aC=["xdr:colOff"];
var aA=["xdr:blipFill","a:blip"];
var az=av.replace(/drawings\//,"drawings/_rels/");
var ay=x(aM,az);
if(ay.byType.image){Object.keys(ay.byId).forEach(function(aP){var aQ=E(av,ay.byId[aP]);
var aS=i(aQ);
if(aS){var aO=aM.files[aQ].asArrayBuffer();
var aR=k(aQ);
var aN=aR&&!(kendo.support.browser.msie||kendo.support.browser.edge)?new window.File([aO],aR,{type:aS}):new window.Blob([aO],{type:aS});
ay.byId[aP]=aK._workbook.addImage(aN);
}});
}var au,ax,aL,aw;
q(aM,av,{enter:function(aP,aN){if(this.is(aJ)||this.is(aF)){au={};
}else{if(this.is(aE)||this.is(aI)){ax={};
}else{if(this.is(aA)){var aO=aN["r:embed"];
au.image=ay.byId[aO];
}else{if(this.is(aD)){aL=h(parseFloat(aN.cx));
aw=h(parseFloat(aN.cy));
}}}}},leave:function(){if(this.is(aE)){au.topLeftCell=new kendo.spreadsheet.CellRef(ax.row,ax.col);
au.offsetX=h(ax.colOffset);
au.offsetY=h(ax.rowOffset);
}else{if(this.is(aI)){au.brCell=new kendo.spreadsheet.CellRef(ax.row,ax.col);
au.brX=h(ax.colOffset);
au.brY=h(ax.rowOffset);
}else{if(this.is(aJ)){var aO=aK._columns.sum(0,au.topLeftCell.col-1)+au.offsetX;
var aQ=aK._rows.sum(0,au.topLeftCell.row-1)+au.offsetY;
var aP=aK._columns.sum(0,au.brCell.col-1)+au.brX;
var aN=aK._rows.sum(0,au.brCell.row-1)+au.brY;
aK.addDrawing({topLeftCell:au.topLeftCell,offsetX:au.offsetX,offsetY:au.offsetY,width:aL!=null?aL:aP-aO,height:aw!=null?aw:aN-aQ,image:au.image,opacity:1});
}else{if(this.is(aF)){aK.addDrawing({topLeftCell:au.topLeftCell,offsetX:au.offsetX,offsetY:au.offsetY,width:aL,height:aw,image:au.image,opacity:1});
}}}}},text:function(aN){if(this.is(aG)){ax.row=parseFloat(aN);
}else{if(this.is(aB)){ax.col=parseFloat(aN);
}else{if(this.is(aH)){ax.rowOffset=parseFloat(aN);
}else{if(this.is(aC)){ax.colOffset=parseFloat(aN);
}}}}}});
}function u(az,ax,ay){var av=[];
var au;
var aw;
q(az,ax,{enter:function(aB,aA){if(this.is(J)){aw={author:av[aA.authorId],ref:aA.ref,text:""};
}else{if(this.is(F)){au="";
}}},leave:function(){if(this.is(J)){ay.range(aw.ref).comment(aw.text);
}else{if(this.is(F)){av.push(au);
}}},text:function(aA){if(this.is(K)){aw.text+=aA;
}else{if(this.is(F)){au+=aA;
}}}});
}function j(au,aw){var av={equal:"eq",notEqual:"ne",greaterThan:"gt",greaterThanOrEqual:"gte",lessThan:"lt",lessThanOrEqual:"lte"}[au];
aw=l(aw);
if(av&&typeof aw=="number"){return{operator:av,value:aw};
}if((au=="notEqual"||!au)&&typeof aw=="string"){return{operator:au?"doesnotmatch":"matches",value:aw};
}}function f(au){return{Q1:"quarter1",Q2:"quarter2",Q3:"quarter3",Q4:"quarter4",M1:"january",M2:"february",M3:"march",M4:"april",M5:"may",M6:"june",M7:"july",M8:"august",M9:"september",M10:"october",M11:"november",M12:"december"}[au.toUpperCase()]||au;
}function l(av){var au=parseFloat(av);
if(!isNaN(au)&&au==av){return au;
}return av;
}function ar(az,ay,ax,au){try{ax();
return false;
}catch(aw){var av={context:au,error:String(aw)};
if(az){av.sheet=az.name();
}if(ay){av.location=String(ay);
}g.push(av);
return true;
}}var d={none:0,thin:1,medium:2,dashed:1,dotted:1,thick:3,"double":3,hair:1,mediumDashed:2,dashDot:1,mediumDashDot:2,dashDotDot:1,mediumDashDotDot:2,slantDashDot:1};
var e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"mm-dd-yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"};
function b(aB,aw,aE,aD){var av=aB.range(aw);
var aG=aE.inlineStyles[aD],au,aF;
if(aG.xfId){au=aE.namedStyles[aG.xfId];
}if(aC("applyBorder","borderId")){ax(aE.borders[aF]);
}if(aC("applyFont","fontId")){az(aE.fonts[aF]);
}if(aC("applyAlignment","textAlign")){av.textAlign(aF);
}if(aC("applyAlignment","verticalAlign")){av.verticalAlign(aF);
}if(aC("applyAlignment","indent")){av.indent(aF);
}if(aC("applyAlignment","wrapText")){av._property("wrap",aF);
}if(aC("applyFill","fillId")){ay(aE.fills[aF]);
}if(aC("applyNumberFormat","numFmtId")){aA(aE.numFmts[aF]||e[aF]);
}function aA(aH){var aI=typeof aH=="string"?aH:aH.formatCode;
if(aI!=null&&!/^general$/i.test(aI)){aI=aI.replace(/^\[\$-[0-9]+\]/,"");
av.format(aI);
}}function ay(aH){if(aH.type=="solid"){av.background(aH.color);
}}function az(aH){av.fontFamily(aH.name);
if(aH.size){av._property("fontSize",aH.size*4/3);
}if(aH.bold){av.bold(true);
}if(aH.italic){av.italic(true);
}if(aH.underline){av.underline(true);
}if(aH.color){av.color(aH.color);
}}function ax(aH){function aI(aM,aL){var aJ=aH[aM];
if(!aJ){return;
}var aN=d[aJ.style];
if(aN===0){return;
}var aK=aJ.color;
if(aK==null){aK="#000";
}av._property(aL,{size:aN,color:aK});
}aI("left","borderLeft");
aI("top","borderTop");
aI("right","borderRight");
aI("bottom","borderBottom");
}function aC(aH,aI){var aJ=aG[aH];
if(aJ!=null&&!aJ){return false;
}aF=aG[aI];
if(au&&aF==null){aJ=au[aH];
if(aJ!=null&&!aJ){return false;
}aF=au[aI];
}return aF!=null;
}}function q(ax,av,au){var aw=ax.files[av];
if(aw){s(aw.asUint8Array(),au);
}}function z(aw){var av=[];
var au=null;
q(aw,"xl/sharedStrings.xml",{leave:function(){if(this.is(Z)){av.push(au);
au=null;
}},text:function(ax){if(this.is(ad)){if(au==null){au="";
}au+=ax;
}}});
return av;
}function x(aw,au){var av={byId:{},byType:{theme:[]}};
q(aw,at(au)+".rels",{enter:function(az,ax){if(az=="Relationship"){av.byId[ax.Id]=ax.Target;
var aA=ax.Type.match(/\w+$/)[0];
var ay=av.byType[aA]||[];
ay.push(ax.Target);
av.byType[aA]=ay;
}}});
return av;
}var G=["borders","border"];
var M=["fills","fill"];
var N=["fonts","font"];
var Q=["cellXfs","xf"];
var S=["cellStyleXfs","xf"];
var T=["numFmts","numFmt"];
var m=[ap("FF000000"),ap("FFFFFFFF"),ap("FFFF0000"),ap("FF00FF00"),ap("FF0000FF"),ap("FFFFFF00"),ap("FFFF00FF"),ap("FF00FFFF"),ap("FF000000"),ap("FFFFFFFF"),ap("FFFF0000"),ap("FF00FF00"),ap("FF0000FF"),ap("FFFFFF00"),ap("FFFF00FF"),ap("FF00FFFF"),ap("FF800000"),ap("FF008000"),ap("FF000080"),ap("FF808000"),ap("FF800080"),ap("FF008080"),ap("FFC0C0C0"),ap("FF808080"),ap("FF9999FF"),ap("FF993366"),ap("FFFFFFCC"),ap("FFCCFFFF"),ap("FF660066"),ap("FFFF8080"),ap("FF0066CC"),ap("FFCCCCFF"),ap("FF000080"),ap("FFFF00FF"),ap("FFFFFF00"),ap("FF00FFFF"),ap("FF800080"),ap("FF800000"),ap("FF008080"),ap("FF0000FF"),ap("FF00CCFF"),ap("FFCCFFFF"),ap("FFCCFFCC"),ap("FFFFFF99"),ap("FF99CCFF"),ap("FFFF99CC"),ap("FFCC99FF"),ap("FFFFCC99"),ap("FF3366FF"),ap("FF33CCCC"),ap("FF99CC00"),ap("FFFFCC00"),ap("FFFF9900"),ap("FFFF6600"),ap("FF666699"),ap("FF969696"),ap("FF003366"),ap("FF339966"),ap("FF003300"),ap("FF333300"),ap("FF993300"),ap("FF993366"),ap("FF333399"),ap("FF333333"),ap("FF000000"),ap("FFFFFFFF")];
function A(aC,aA){var az={fonts:[],numFmts:{},fills:[],borders:[],namedStyles:[],inlineStyles:[]};
var aw=null;
var av=null;
var au=null;
var aB=null;
q(aC,"xl/styles.xml",{enter:function(aG,aD,aE){if(this.is(T)){az.numFmts[aD.numFmtId]=aD;
}else{if(this.is(N)){az.fonts.push(aw={});
}else{if(aw){if(aG=="sz"){aw.size=parseFloat(aD.val);
}else{if(aG=="name"){aw.name=aD.val;
}else{if(aG=="b"){aw.bold=c(aD.val,true);
}else{if(aG=="i"){aw.italic=c(aD.val,true);
}else{if(aG=="u"){aw.underline=aD.val==null||aD.val=="single";
}else{if(aG=="color"){aw.color=ax(aD);
}}}}}}}else{if(this.is(M)){az.fills.push(av={});
}else{if(av){if(aG=="patternFill"){av.type=aD.patternType;
}else{if(aG=="fgColor"&&av.type==="solid"){av.color=ax(aD);
}else{if(aG=="bgColor"&&av.type!=="solid"){av.color=ax(aD);
}}}}else{if(this.is(G)){az.borders.push(au={});
}else{if(au){if(/^(?:left|top|right|bottom)$/.test(aG)){au[aG]={style:aD.style||"none"};
}if(aG=="color"){var aF=this.stack[this.stack.length-2].$tag;
au[aF].color=ax(aD);
}}else{if(this.is(S)){aB=ay(aD);
az.namedStyles.push(aB);
if(aE){aB=null;
}}else{if(this.is(Q)){aB=ay(aD);
az.inlineStyles.push(aB);
if(aE){aB=null;
}}else{if(aB){if(aG=="alignment"){if(/^(?:left|center|right|justify)$/.test(aD.horizontal)){aB.textAlign=aD.horizontal;
}if(/^(?:top|center|bottom)$/.test(aD.vertical)){aB.verticalAlign=aD.vertical;
}if(aD.wrapText!=null){aB.wrapText=c(aD.wrapText);
}if(aD.indent!=null){aB.indent=n(aD.indent);
}}}}}}}}}}}}},leave:function(aD){if(this.is(N)){aw=null;
}else{if(this.is(M)){av=null;
}else{if(this.is(G)){au=null;
}else{if(aD=="xf"){aB=null;
}}}}}});
function ay(aE){var aF={borderId:n(aE.borderId),fillId:n(aE.fillId),fontId:n(aE.fontId),numFmtId:n(aE.numFmtId),pivotButton:c(aE.pivotButton),quotePrefix:c(aE.quotePrefix),xfId:n(aE.xfId)};
aD("applyAlignment");
aD("applyBorder");
aD("applyFill");
aD("applyFont");
aD("applyNumberFormat");
aD("applyProtection");
function aD(aG){if(aE[aG]!=null){aF[aG]=c(aE[aG]);
}}return aF;
}function ax(aD){if(aD.rgb){return ap(aD.rgb);
}else{if(aD.indexed){return m[n(aD.indexed)];
}else{if(aD.theme){var aF=aA.colorScheme[n(aD.theme)];
if(!aF){return m[0];
}var aE=kendo.parseColor(aF);
if(aD.tint){aE=aE.toHSL();
var aG=parseFloat(aD.tint);
if(aG<0){aE.l=aE.l*(1+aG);
}else{aE.l=aE.l*(1-aG)+(100-100*(1-aG));
}}return aE.toCssRgba();
}}}}return az;
}var W=["a:clrScheme","*","a:srgbClr"];
var X=["a:clrScheme","*","a:sysClr"];
function B(az,av){var aw=[];
var ay={colorScheme:aw};
var au=at(av);
if(az.files[au]){q(az,au,{enter:function(aB,aA){if(this.is(X)){aw.push(ap(aA.val=="window"?"FFFFFFFF":"FF000000"));
}else{if(this.is(W)){aw.push(ap("FF"+aA.val));
}}}});
if(aw.length>3){ax(aw,0,1);
ax(aw,2,3);
}}function ax(aB,aA,aC){var aD=aB[aA];
aB[aA]=aB[aC];
aB[aC]=aD;
}return ay;
}function n(au){return au==null?null:parseInt(au,10);
}function c(av,au){if(av==null){return au;
}return av=="true"||av===true||av==1;
}function ap(av){var au=/^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(av);
return"rgba("+parseInt(au[2],16)+", "+parseInt(au[3],16)+", "+parseInt(au[4],16)+", "+parseInt(au[1],16)/255+")";
}function E(au,av){au=au.split(/\/+/);
av=av.split(/\/+/);
au.pop();
while(av.length){var aw=av.shift();
if(aw===""){au=[];
}else{if(aw==="."){continue;
}else{if(aw===".."){au.pop();
}else{au.push(aw);
}}}}return au.join("/");
}function h(au){return au/9525;
}kendo.spreadsheet.readExcel=w;
kendo.spreadsheet._readSheet=y;
kendo.spreadsheet._readStrings=z;
kendo.spreadsheet._readStyles=A;
kendo.spreadsheet._readTheme=B;
kendo.spreadsheet._readWorkbook=C;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/workbook",["kendo.core","spreadsheet/runtime","spreadsheet/references","spreadsheet/excel-reader"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var a=d.jQuery;
var c=d.spreadsheet.calc.runtime.Formula;
var f=d.spreadsheet.Ref;
var b=d.spreadsheet.CalcError;
d.spreadsheet.messages.workbook={defaultSheetName:"Sheet"};
function e(j,i){var k=new XMLHttpRequest();
k.onload=function(){i(k.response,k.getResponseHeader("Content-Type"));
};
k.onerror=function(){i(null);
};
k.open("GET",j);
k.responseType="arraybuffer";
k.send();
}var h=d.Observable.extend({options:{},init:function(i,j){d.Observable.fn.init.call(this);
this.options=i;
this._view=j;
this._sheets=[];
this._images={};
this._imgID=0;
this._sheetsSearchCache={};
this._sheet=this.insertSheet({rows:this.options.rows,columns:this.options.columns,rowHeight:this.options.rowHeight,columnWidth:this.options.columnWidth,headerHeight:this.options.headerHeight,headerWidth:this.options.headerWidth,dataSource:this.options.dataSource});
this.undoRedoStack=new d.util.UndoRedoStack();
this.undoRedoStack.bind(["undo","redo"],this._onUndoRedo.bind(this));
this._context=new d.spreadsheet.FormulaContext(this);
this._validationContext=new d.spreadsheet.ValidationFormulaContext(this);
this._names=Object.create(null);
this.fromJSON(this.options);
},clipboard:function(){if(!this._clipboard){this._clipboard=new d.spreadsheet.Clipboard(this);
}return this._clipboard;
},destroy:function(){this.unbind();
if(this._clipboard){this._clipboard.destroy();
}},events:["cut","copy","paste","changing","change","excelImport","excelExport","insertSheet","removeSheet","selectSheet","renameSheet","insertRow","insertColumn","deleteRow","deleteColumn","hideRow","hideColumn","unhideRow","unhideColumn","select","changeFormat","dataBinding","dataBound"],_sheetChanging:function(i){if(this.trigger("changing",i)){i.preventDefault();
}},_sheetChange:function(i){this.trigger("change",i);
},_sheetInsertRow:function(i){if(this.trigger("insertRow",{sheet:i.sender,index:i.index})){i.preventDefault();
}},_sheetInsertColumn:function(i){if(this.trigger("insertColumn",{sheet:i.sender,index:i.index})){i.preventDefault();
}},_sheetDeleteRow:function(i){if(this.trigger("deleteRow",{sheet:i.sender,index:i.index})){i.preventDefault();
}},_sheetDeleteColumn:function(i){if(this.trigger("deleteColumn",{sheet:i.sender,index:i.index})){i.preventDefault();
}},_sheetHideRow:function(i){if(this.trigger("hideRow",{sheet:i.sender,index:i.index})){i.preventDefault();
}},_sheetHideColumn:function(i){if(this.trigger("hideColumn",{sheet:i.sender,index:i.index})){i.preventDefault();
}},_sheetUnhideRow:function(i){if(this.trigger("unhideRow",{sheet:i.sender,index:i.index})){i.preventDefault();
}},_sheetUnhideColumn:function(i){if(this.trigger("unhideColumn",{sheet:i.sender,index:i.index})){i.preventDefault();
}},_sheetSelect:function(i){this.trigger("select",i);
},_sheetDataBinding:function(i){if(this.trigger("dataBinding",{sheet:i.sender})){i.preventDefault();
}},_sheetDataBound:function(i){this.trigger("dataBound",{sheet:i.sender});
},_sheetCommandRequest:function(i){this.trigger("commandRequest",i);
},_inputForRef:function(i){var j=this;
return j._sheet.withCultureDecimals(function(){return new d.spreadsheet.Range(i,j._sheet).input();
});
},_onUndoRedo:function(i){i.command.range().select();
},execute:function(k){var j=a.extend({workbook:this},k.options);
var i=new d.spreadsheet[k.command](j);
var m=this.activeSheet();
if(j.origin){i.origin(j.origin);
}if(j.operatingRange){i.range(j.operatingRange);
}else{i.range(m.selection());
}var l=i.exec();
if(!l||l.reason!=="error"){if(!i.cannotUndo){this.undoRedoStack.push(i);
}}this.cleanupImages();
return l;
},resetFormulas:function(){this._sheets.forEach(function(i){i.resetFormulas();
});
},resetValidations:function(){this._sheets.forEach(function(i){i.resetValidations();
});
},refresh:function(i){if(i.recalc){this.resetFormulas();
this.resetValidations();
this._sheet.recalc(this._context);
this._sheet.revalidate(this._validationContext);
}},activeSheet:function(i){if(i===undefined){return this._sheet;
}if(!this.sheetByName(i.name())){return;
}this._sheet=i;
i.triggerChange(d.spreadsheet.ALL_REASONS);
},moveSheetToIndex:function(j,l){var i=this.sheetIndex(j);
var k=this._sheets;
if(i===-1){return;
}this._sheetsSearchCache={};
k.splice(l,0,k.splice(i,1)[0]);
this.trigger("change",{sheetSelection:true});
},insertSheet:function(k){k=k||{};
var o=this;
var j=typeof k.index==="number"?k.index:o._sheets.length;
var m;
var n=o._sheets;
var i=function(q){q=q?q:1;
var p=d.spreadsheet.messages.workbook.defaultSheetName+q;
if(!o.sheetByName(p)){return p;
}return i(q+1);
};
if(k.name&&o.sheetByName(k.name)){return;
}this._sheetsSearchCache={};
m=k.name||i();
var l=new d.spreadsheet.Sheet(k.rows||this.options.rows,k.columns||this.options.columns,k.rowHeight||this.options.rowHeight,k.columnWidth||this.options.columnWidth,k.headerHeight||this.options.headerHeight,k.headerWidth||this.options.headerWidth,k.defaultCellStyle||this.options.defaultCellStyle);
l._workbook=this;
l._name(m);
this._bindSheetEvents(l);
n.splice(j,0,l);
if(k.data){l.fromJSON(k.data);
}if(k.dataSource){l.setDataSource(k.dataSource);
}this.trigger("change",{sheetSelection:true});
return l;
},_bindSheetEvents:function(i){i.bind("changing",this._sheetChanging.bind(this));
i.bind("change",this._sheetChange.bind(this));
i.bind("insertRow",this._sheetInsertRow.bind(this));
i.bind("insertColumn",this._sheetInsertColumn.bind(this));
i.bind("deleteRow",this._sheetDeleteRow.bind(this));
i.bind("deleteColumn",this._sheetDeleteColumn.bind(this));
i.bind("hideRow",this._sheetHideRow.bind(this));
i.bind("hideColumn",this._sheetHideColumn.bind(this));
i.bind("unhideRow",this._sheetUnhideRow.bind(this));
i.bind("unhideColumn",this._sheetUnhideColumn.bind(this));
i.bind("select",this._sheetSelect.bind(this));
i.bind("commandRequest",this._sheetCommandRequest.bind(this));
i.bind("dataBinding",this._sheetDataBinding.bind(this));
i.bind("dataBound",this._sheetDataBound.bind(this));
},sheets:function(){return this._sheets.slice();
},sheetByName:function(i){return this._sheets[this.sheetIndex(i)];
},sheetByIndex:function(i){return this._sheets[i];
},sheetIndex:function(k){var m=this._sheets;
var l=(typeof k=="string"?k:k.name()).toLowerCase();
var i=this._sheetsSearchCache[l];
if(i>=0){return i;
}for(i=0;
i<m.length;
i++){var j=m[i].name().toLowerCase();
this._sheetsSearchCache[j]=i;
if(j===l){return i;
}}return -1;
},renameSheet:function(k,i){var j=k.name().toLowerCase();
if(!i||j===i.toLowerCase()||this.sheetByName(i)){return;
}k=this.sheetByName(j);
if(!k){return;
}this._sheetsSearchCache={};
if(this.trigger("renameSheet",{sheet:k,newSheetName:i})){return;
}this._sheets.forEach(function(l){l._forFormulas(function(m){m.renameSheet(j,i);
});
});
this.forEachName(function(l,m){if(l.nameref.renameSheet(j,i)){this.undefineName(m);
l.name=l.nameref.print();
this.nameDefinition(l.name,l);
}if(l.value instanceof f||l.value instanceof c){l.value.renameSheet(j,i);
}}.bind(this));
k._name(i);
this.trigger("change",{sheetSelection:true});
return k;
},removeSheet:function(l){var n=this;
var m=n._sheets;
var j=l.name();
var i=n.sheetIndex(l);
if(m.length===1){return;
}if(this.trigger("removeSheet",{sheet:l})){return;
}this._sheetsSearchCache={};
if(i>-1){l.unbind();
m.splice(i,1);
if(n.activeSheet().name()===j){var k=m[i===m.length?i-1:i];
n.activeSheet(k);
}else{this.trigger("change",{recalc:true,sheetSelection:true});
}}},_clearSheets:function(){for(var j=0;
j<this._sheets.length;
j++){this._sheets[j]._activeDrawing=[];
this._sheets[j]._drawings=[];
this._sheets[j].unbind();
}this._sheets=[];
this._sheetsSearchCache={};
this._names={};
this._images={};
this._imgID=0;
},fromJSON:function(l){if(l.sheets){this._clearSheets();
if(l.images){this._imgID=0;
this._images={};
Object.keys(l.images).forEach(function(n){if(!isNaN(n)){var o=parseFloat(n);
if(isFinite(o)){this._imgID=Math.max(this._imgID,o);
}}this._images[n]={url:l.images[n]};
},this);
}for(var k=0;
k<l.sheets.length;
k++){var j=l.sheets[k];
var i=g(j,this.options);
var m=this.insertSheet({rows:i.rowCount,columns:i.columnCount,rowHeight:i.rowHeight,columnWidth:i.columnWidth,headerHeight:i.headerHeight,headerWidth:i.headerWidth,data:j});
if(j.dataSource){m.setDataSource(j.dataSource);
}}}if(l.activeSheet){this.activeSheet(this.sheetByName(l.activeSheet));
}else{this.activeSheet(this._sheets[0]);
}if(l.names){l.names.forEach(function(n){this.defineName(n.name,n.value,n.hidden);
},this);
}},toJSON:function(){this.resetFormulas();
this.resetValidations();
var i=Object.keys(this._names).map(function(k){var j=this._names[k];
var l=j.value;
if(l instanceof f||l instanceof c){l=l.print(0,0,true);
}else{if(l instanceof b){l=l+"";
}else{l=JSON.stringify(l);
}}return{value:l,hidden:j.hidden,name:j.name,sheet:j.nameref.sheet,localName:j.nameref.name};
},this);
return{activeSheet:this.activeSheet().name(),sheets:this._sheets.map(function(j){j.recalc(this._context);
j.revalidate(this._validationContext);
return j.toJSON();
},this),names:i,columnWidth:this.options.columnWidth,rowHeight:this.options.rowHeight};
},saveJSON:function(){var n=this;
var k=new a.Deferred();
var j=n.toJSON();
var l=Object.keys(n._images).filter(function(o){return n.usesImage(o)===1;
});
var i=l.length;
j.images={};
if(i){l.forEach(function(o){var p=n._images[o];
if(p.blob){var q=new FileReader();
q.onload=function(){j.images[o]=q.result;
m();
};
q.readAsDataURL(p.blob);
}else{j.images[o]=p.url;
m();
}});
}else{m();
}return k.promise();
function m(){if(--i<=0){k.resolve(j);
}}},fromFile:function(k){var j=new a.Deferred();
var l=j.promise();
var i={file:k,promise:l};
if(k&&!this.trigger("excelImport",i)){this._clearSheets();
d.spreadsheet.readExcel(k,this,j);
}else{j.reject();
}return l;
},saveAsExcel:function(n){var o=this;
n=a.extend({},o.options.excel,n);
var j=o.toJSON();
if(o.trigger("excelExport",{workbook:j})){return;
}var k=Object.keys(o._images).filter(function(p){return o.usesImage(p)===1;
});
var i=k.length;
var l=i?{}:null;
if(i){k.forEach(function(p){var q=o._images[p];
if(q.blob){var r=new FileReader();
r.onload=function(){l[p]={type:q.blob.type,name:q.blob.name,data:r.result};
m();
};
r.readAsArrayBuffer(q.blob);
}else{e(q.url,function(s,t){l[p]={type:t,data:s};
m();
});
}});
}else{m();
}function m(){if(--i<=0){j.images=l;
var p=new d.ooxml.Workbook(j);
d.saveAs({dataURI:n.forceProxy?p.toDataURL():p.toBlob(),fileName:j.fileName||n.fileName,proxyURL:n.proxyURL,forceProxy:n.forceProxy});
}}},draw:function(k,i){if(typeof k=="function"&&!i){i=k;
k={};
}var l=[],m=this._sheets;
(function j(o){if(o<m.length){m[o].draw(d.spreadsheet.SHEETREF,k,function(p){l.push(p);
j(o+1);
});
}else{var n=l[0];
for(o=1;
o<l.length;
++o){n.children=n.children.concat(l[o].children);
}i(n);
}}(0));
},nameForRef:function(k,l){if(l===undefined){l=k.sheet;
}l=l.toLowerCase();
var m=k+"";
for(var j in this._names){var i=this._names[j];
var n=i.value;
if(n instanceof f){if(!n.sheet||n.sheet&&l==n.sheet.toLowerCase()){if(n+""==m){return i;
}}}}return{name:m};
},defineName:function(j,k,i){var l=d.spreadsheet.calc.parseNameDefinition(j,k);
j=l.name.print();
this._names[j.toLowerCase()]={value:l.value,hidden:i,name:j,nameref:l.name};
},undefineName:function(i){delete this._names[i.toLowerCase()];
},nameValue:function(i){i=i.toLowerCase();
if(i in this._names){return this._names[i].value;
}return null;
},nameDefinition:function(j,i){j=j.toLowerCase();
if(arguments.length>1){if(i===undefined){delete this._names[j];
}else{this._names[j]=i;
}}return this._names[j];
},forEachName:function(i){Object.keys(this._names).forEach(function(j){i(this._names[j],j);
},this);
},adjustNames:function(i,k,l,j){i=i.toLowerCase();
Object.keys(this._names).forEach(function(n){var m=this._names[n];
var o=m.value;
if(o instanceof f&&o.sheet.toLowerCase()==i){m.value=o.adjust(null,null,null,null,k,l,j);
}else{if(o instanceof c){o.adjust(i,k?"row":"col",l,j);
}}},this);
},addImage:function(j){var i=String(++this._imgID);
if(typeof j=="string"){this._images[i]={url:j};
}else{this._images[i]={blob:j};
}return i;
},imageUrl:function(i){var j=this._images[i];
var k=j.url;
if(!k){k=j.url=window.URL.createObjectURL(j.blob);
}return k;
},cleanupImages:function(){Object.keys(this._images).forEach(function(i){if(!this.usesImage(i)){var j=this._images[i].url;
if(j){window.URL.revokeObjectURL(j);
}delete this._images[i];
}},this);
},usesImage:function(k){var j;
var l=this._sheets;
for(j=l.length;
--j>=0;
){if(l[j].usesImage(k)){return 1;
}}var m=this.undoRedoStack.stack;
for(j=m.length;
--j>=0;
){if(m[j].usesImage(k)){return 2;
}}return false;
}});
function g(o,t){function u(i,j,z){return i!==undefined?i:j!==undefined?j:z;
}var x=u(o.rowCount,t.rows,200),m=u(o.columnCount,t.columns,50),y=u(o.rowHeight,t.rowHeight,20),n=u(o.columnWidth,t.columnWidth,64),p=u(o.headerHeight,t.headerHeight,20),q=u(o.headerWidth,t.headerWidth,32);
if(o.rows!==undefined){for(var r=0;
r<o.rows.length;
++r){var w=o.rows[r];
var v=u(w.index,r);
if(v>=x){x=v+1;
}if(w.cells){for(var s=0;
s<w.cells.length;
++s){var k=w.cells[s];
var l=u(k.index,s);
if(l>=m){m=l+1;
}}}}}return{rowCount:x,columnCount:m,rowHeight:y,columnWidth:n,headerHeight:p,headerWidth:q};
}d.spreadsheet.Workbook=h;
if(d.PDFMixin){d.PDFMixin.extend(h.prototype);
h.prototype.saveAsPDF=function(j){var k=new a.Deferred();
var l=k.promise();
var i={promise:l};
if(this.trigger("pdfExport",i)){return;
}this._drawPDF(j,k).then(function(m){return j.forceProxy?d.pdf.exportPDF(m):d.pdf.exportPDFToBlob(m);
}).done(function(m){d.saveAs({dataURI:m,fileName:j.fileName,proxyURL:j.proxyURL,forceProxy:j.forceProxy,proxyTarget:j.proxyTarget});
k.resolve();
}).fail(function(m){k.reject(m);
});
return l;
};
h.prototype._drawPDF=function(j){var k=new a.Deferred();
var i=function(l){k.resolve(l);
};
switch(j.area){case"workbook":j.workbook.draw(j,i);
break;
case"sheet":j.workbook.activeSheet().draw(j,i);
break;
case"selection":j.workbook.activeSheet().selection().draw(j,i);
break;
}return k.promise();
};
}}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/formulacontext",["kendo.core"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var f=kendo.spreadsheet;
var a=f.CellRef;
var d=f.RangeRef;
var g=f.UnionRef;
var c=f.NameRef;
var e=f.Ref;
var b=kendo.Class.extend({init:function(i){this.workbook=i;
},getRefCells:function(w,s,r,q,o,G){var y,p,E,t;
if(w instanceof a){y=this.workbook.sheetByName(w.sheet);
if(!y||!w.valid()){return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];
}p=y.formula(w);
E=y.range(w.row,w.col).value();
if(G||p!=null||E!=null){return[{formula:p,value:E,row:w.row,col:w.col,sheet:w.sheet,hidden:s?y.columnWidth(w.col)===0||y.rowHeight(w.row)===0:false}];
}else{return[];
}}if(w instanceof d){t=this.workbook.sheetIndex(w.sheet);
var A=[],v=t;
if(w.endSheet){v=this.workbook.sheetIndex(w.endSheet);
if(t>v){var C=t;
t=v;
v=C;
}}if(t<0||v<0||!w.valid()){return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];
}while(t<=v){y=this.workbook.sheetByIndex(t++);
var B=y._grid.normalize(w.topLeft);
var k=y._grid.normalize(w.bottomRight);
var z=y._grid.cellRefIndex(B);
var m=y._grid.cellRefIndex(k);
var F=y._properties.iterator("value",z,m);
for(var l=B.col;
l<=k.col;
++l){for(var x=B.row;
x<=k.row;
++x){var u=y._grid.index(x,l);
p=y._properties.get("formula",u);
E=F.at(u);
if(G||p!=null||E!=null){A.push({formula:p,value:E,row:x,col:l,sheet:y.name(),hidden:s?y.columnWidth(l)===0||y.rowHeight(x)===0:false});
}}}}return A;
}if(w instanceof g){var j=[];
for(t=0;
t<w.refs.length;
++t){j=j.concat(this.getRefCells(w.refs[t],s,r,q,o));
}return j;
}if(w instanceof c){var D=this.nameValue(w,r,q,o);
if(D instanceof e){return this.getRefCells(D,s,r,q,o);
}return[{value:D==null?new kendo.spreadsheet.calc.runtime.CalcError("NAME"):D}];
}return[];
},nameValue:function(l,k,j,i){var m;
if(l.hasSheet()){m=this.workbook.nameValue(l.print());
}else{l=l.clone().setSheet(k,true);
m=this.workbook.nameValue(l.print());
if(m==null){m=this.workbook.nameValue(l.name);
}}if(m instanceof e){m=m.absolute(j,i);
}return m;
},getData:function(m,l,k,j,o){var n=m instanceof a;
if(m instanceof c){n=this.workbook.nameValue(m.name) instanceof a;
}var i=this.getRefCells(m,false,l,k,j,o).map(function(p){var q=p.value;
if(q instanceof kendo.spreadsheet.calc.runtime.Formula){q=q.value;
}return q;
});
return n?i[0]:i;
},onFormula:function(l){var o=this.workbook.sheetByName(l.sheet);
var n=l.row,j=l.col,r=l.value;
var k=o.formula({row:n,col:j});
if(k!==l){return false;
}var i=l.arrayFormulaRange;
if(i){var q,p;
var s=r.width;
var m=r.height;
o.forEach(i,function(u,t){if(q===undefined){q=u;
p=t;
}var x=u-q;
var w=t-p;
var v;
if(x<m&&w<s){v=r.get(x,w);
}else{v=new kendo.spreadsheet.calc.runtime.CalcError("N/A");
}o._value(u,t,v);
});
}else{if(r instanceof e){r=this.getData(r,l.sheet,n,j);
if(Array.isArray(r)){r=r[0];
}if(r===undefined){r=null;
}}if(r instanceof kendo.spreadsheet.calc.runtime.Matrix){r=r.get(0,0);
}o._value(n,j,r);
}clearTimeout(o._formulaContextRefresh);
o._formulaContextRefresh=setTimeout(function(){o.batch(function(){},{layout:true});
},50);
return true;
}});
var h=b.extend({onFormula:function(){return true;
}});
f.FormulaContext=b;
f.ValidationFormulaContext=h;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/controller",["kendo.core"],b);
}(function(){(function(n){if(n.support.browser.msie&&n.support.browser.version<9){return;
}var a=n.jQuery;
var d=/:alphanum$/;
var c={up:"up",down:"down",left:"left",right:"right",home:"first-col","ctrl+left":"first-col",end:"last-col","ctrl+right":"last-col","ctrl+up":"first-row","ctrl+down":"last-row","ctrl+home":"first","ctrl+end":"last",pageup:"prev-page",pagedown:"next-page"};
var k={tab:"next","shift+tab":"previous",enter:"lower","shift+enter":"upper","delete":"clearContents",backspace:"clearContents","shift+:alphanum":"edit","alt+:alphanum":"edit",":alphanum":"edit","ctrl+:alphanum":"ctrl","alt+ctrl+:alphanum":"edit",":edit":"edit"};
var g={wheel:"onWheel","*+mousedown":"onMouseDown",contextmenu:"onContextMenu","*+mousedrag":"onMouseDrag","*+mouseup":"onMouseUp","*+dblclick":"onDblClick",mousemove:"onMouseMove",touchmove:"onTouchMove",touchend:"onTouchEnd"};
var e={pageup:"onPageUp",pagedown:"onPageDown",mouseup:"onMouseUp","*+cut":"onCut","*+paste":"onPaste","*+copy":"onCopy"};
var i={esc:"onEditorEsc",enter:"onEditorBlur","alt+enter":"insertNewline","shift+enter":"onEditorBlur",tab:"onEditorBlur","shift+tab":"onEditorBlur","shift+ctrl+enter":"onEditorArrayFormula"};
var l=a.extend({focus:"onEditorBarFocus"},i);
var m=a.extend({focus:"onEditorCellFocus"},i);
var p={cell:"range",rowheader:"row",columnheader:"column",topcorner:"sheet",autofill:"autofill"};
function r(t){return t.map(function(u){return'[data-action="'+u+'"]';
}).join(",");
}var f=r(["cut","copy","paste","insert-left","insert-right","insert-above","insert-below"]);
var s=r(["unhide-row","unhide-column"]);
var b=[];
var q=[];
var j=[];
for(var o in c){b.push(o);
q.push("shift+"+o);
}for(o in k){j.push(o);
}e[b]="onAction";
e[q]="onShiftAction";
e[j]="onEntryAction";
m[b]="onEditorAction";
m[q]="onEditorShiftAction";
var h=n.Class.extend({init:function(t,u){this.view=t;
this.workbook(u);
this.container=a(t.container);
this.clipboardElement=a(t.clipboard);
this.cellContextMenu=t.cellContextMenu;
this.rowHeaderContextMenu=t.rowHeaderContextMenu;
this.colHeaderContextMenu=t.colHeaderContextMenu;
this.drawingContextMenu=t.drawingContextMenu;
this.scroller=t.scroller;
this.tabstrip=t.tabstrip;
this.sheetsbar=t.sheetsbar;
t.nameEditor.bind("enter",this.onNameEditorEnter.bind(this));
t.nameEditor.bind("cancel",this.onNameEditorCancel.bind(this));
t.nameEditor.bind("select",this.onNameEditorSelect.bind(this));
t.nameEditor.bind("delete",this.onNameEditorDelete.bind(this));
this.editor=t.editor;
this.editor.bind("change",this.onEditorChange.bind(this));
this.editor.bind("activate",this.onEditorActivate.bind(this));
this.editor.bind("deactivate",this.onEditorDeactivate.bind(this));
this.editor.bind("update",this.onEditorUpdate.bind(this));
a(t.scroller).on("scroll",this.onScroll.bind(this));
this.listener=new n.spreadsheet.EventListener(this.container,this,g);
this._enableEditorEvents();
if(this.sheetsbar){this.sheetsbar.bind("select",this.onSheetBarSelect.bind(this));
this.sheetsbar.bind("reorder",this.onSheetBarReorder.bind(this));
this.sheetsbar.bind("rename",this.onSheetBarRename.bind(this));
this.sheetsbar.bind("remove",this.onSheetBarRemove.bind(this));
}this.cellContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.rowHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.colHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.drawingContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).add(this.drawingContextMenu.element).on("contextmenu",false);
if(this.tabstrip){this.tabstrip.bind("action",this.onCommandRequest.bind(this));
this.tabstrip.bind("dialog",this.onDialogRequest.bind(this));
}},_enableEditorEvents:function(t){if(t===undefined||t){this.keyListener=new n.spreadsheet.EventListener(this.clipboardElement,this,e);
this.barKeyListener=new n.spreadsheet.EventListener(this.editor.barElement(),this,l);
this.inputKeyListener=new n.spreadsheet.EventListener(this.editor.cellElement(),this,m);
}else{this.keyListener.destroy();
this.barKeyListener.destroy();
this.inputKeyListener.destroy();
}},_execute:function(t){var u=this._workbook.execute(t);
if(t.command==="EditCommand"&&!u){this._workbook.trigger("change",{editorClose:true});
}if(u){this._preventNavigation=true;
if(u.reason==="error"){this.editor.deactivate(true);
this.view.showError(u,function(){this.activateEditor(false);
this.editor.value(this._lastEditorValue);
this.editor._value=this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());
this.editor.select();
}.bind(this));
}else{this.view.openDialog(u.reason);
}}return u;
},_activeTooltip:function(){return this._workbook.activeSheet().activeCell().simplify().toString();
},onContextMenuSelect:function(v){var t=a(v.item).data("action");
var u;
switch(t){case"cut":u={command:"ToolbarCutCommand",options:{workbook:this._workbook}};
break;
case"copy":u={command:"ToolbarCopyCommand",options:{workbook:this._workbook}};
break;
case"paste":u={command:"ToolbarPasteCommand",options:{workbook:this._workbook}};
break;
case"delete-drawing":u={command:"DeleteDrawingCommand",options:{drawing:this.navigator._sheet._activeDrawing}};
break;
case"bring-to-front":u={command:"BringToFrontCommand",options:{drawing:this.navigator._sheet._activeDrawing}};
break;
case"send-to-back":u={command:"SendToBackCommand",options:{drawing:this.navigator._sheet._activeDrawing}};
break;
case"unmerge":u={command:"MergeCellCommand",options:{value:"unmerge"}};
break;
case"merge":this.view.openDialog("merge");
break;
case"hide-row":u={command:"HideLineCommand",options:{axis:"row"}};
break;
case"hide-column":u={command:"HideLineCommand",options:{axis:"column"}};
break;
case"unhide-row":u={command:"UnHideLineCommand",options:{axis:"row"}};
break;
case"unhide-column":u={command:"UnHideLineCommand",options:{axis:"column"}};
break;
case"delete-row":u={command:"DeleteRowCommand"};
break;
case"delete-column":u={command:"DeleteColumnCommand"};
break;
}if(u){this._execute(u);
}},onSheetBarRemove:function(t){var u=this._workbook.sheetByName(t.name);
if(!u){return;
}this._workbook.removeSheet(u);
},destroy:function(){this.listener.destroy();
this._enableEditorEvents(false);
this.keyListener.destroy();
this.inputKeyListener.destroy();
},onSheetBarSelect:function(t){var u;
var v=this._workbook;
if(t.isAddButton){if(this._workbook.trigger("insertSheet")){return;
}u=v.insertSheet();
}else{u=v.sheetByName(t.name);
}if(v.activeSheet().name()!==u.name()){if(this._workbook.trigger("selectSheet",{sheet:u})){return;
}if(!this.editor.canInsertRef(false)){this.editor.deactivate();
}v.activeSheet(u);
}},onSheetBarReorder:function(t){var u=this._workbook.sheetByIndex(t.oldIndex);
this._workbook.moveSheetToIndex(u,t.newIndex);
this._workbook.activeSheet(u);
},onSheetBarRename:function(t){var u=this._workbook.sheetByIndex(t.sheetIndex);
if(this._workbook.sheetByName(t.name)){this.view.showError({reason:"error",type:"duplicateSheetName"});
return;
}this._workbook.renameSheet(u,t.name);
this.clipboardElement.focus();
},sheet:function(t){this.navigator=t.navigator();
this.axisManager=t.axisManager();
},workbook:function(t){this._workbook=t;
this.clipboard=t.clipboard();
t.bind("commandRequest",this.onCommandRequest.bind(this));
},refresh:function(){var u=this.editor;
var x=this._workbook;
var w=x.activeSheet();
this._viewPortHeight=this.view.scroller.clientHeight;
this.navigator.height(this._viewPortHeight);
if(!u.isActive()&&!this.isEditorDisabled){u.enable(w.selection().enable()!==false);
this.resetEditorValue();
}var v=w.selection()._ref.simplify();
var t=this._workbook.nameForRef(v,w.name());
this.view.nameEditor.value(t.name);
},onScroll:function(){this.view.render({scroll:true});
},onWheel:function(v){var t=v.originalEvent.deltaX;
var u=v.originalEvent.deltaY;
if(v.originalEvent.deltaMode===1){t*=10;
u*=10;
}this.scrollWith(t,u);
v.preventDefault();
},onTouchMove:function(){this.view.forceScrollerStackingOrder(2);
},onTouchEnd:function(){this.view.forceScrollerStackingOrder(1);
},onAction:function(u,t){var v=this._workbook.activeSheet();
v._activeDrawing=null;
this.navigator.moveActiveCell(c[t]);
u.preventDefault();
},onPageUp:function(){this.scrollDown(-this._viewPortHeight);
},onPageDown:function(){this.scrollDown(this._viewPortHeight);
},onEntryAction:function(w,t){var y=this._workbook.activeSheet();
if(w.mod){var z=true;
var x=String.fromCharCode(w.keyCode);
switch(x){case"A":y._activeDrawing=null;
this.navigator.selectAll();
break;
case"Y":this._workbook.undoRedoStack.redo();
break;
case"Z":this._workbook.undoRedoStack.undo();
break;
default:z=false;
break;
}if(z){w.preventDefault();
}}else{var v=y.selection().enable()===false;
var u=t!==":edit";
if(t=="delete"||t=="backspace"){if(y._activeDrawing){this._execute({command:"DeleteDrawingCommand",options:{drawing:y._activeDrawing}});
}else{if(!v){this._execute({command:"ClearContentCommand"});
}}w.preventDefault();
}else{if(d.test(t)||!u){y._activeDrawing=null;
if(v){w.preventDefault();
return;
}if(u){this.editor.value("");
}this.activateEditor(u);
}else{this.navigator.navigateInSelection(k[t]);
w.preventDefault();
}}}},onShiftAction:function(u,t){this.navigator.modifySelection(c[t.replace("shift+","")],this.appendSelection);
u.preventDefault();
},onMouseMove:function(t){var v=this._workbook.activeSheet();
if(v.resizingInProgress()||v.selectionInProgress()){return;
}var u=this.objectAt(t);
if(u.type==="columnresizehandle"||u.type==="rowresizehandle"){v.positionResizeHandle(u.ref);
}else{v.removeResizeHandle();
}v._renderComment(u.type=="cell"?u.ref:null);
},onMouseDown:function(t){var u=this.objectAt(t);
if(u.pane){this.originFrame=u.pane;
}if(this._startResizingDrawing(t,u)){t.stopPropagation();
return;
}var v=this._workbook.activeSheet();
var w=this.container.closest('[data-role="window"]');
if(w.length){w=n.widgetInstance(w);
if(w&&w.options.modal){t.stopPropagation();
}}v._activeDrawing=null;
if(u.type==="drawing"){v._activeDrawing=u.drawing;
u.copy=u.drawing.clone();
u.startBox=v.drawingBoundingBox(u.copy);
v.startDragging(u);
v.triggerChange({dragging:true});
t.preventDefault();
return;
}if(u.type==="editor"){this.onEditorEsc();
this.openCustomEditor();
t.preventDefault();
return;
}if(this.editor.canInsertRef(false)&&u.ref){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());
this.navigator.startSelection(u.ref,this._selectionMode,this.appendSelection,t.shiftKey,this.view);
t.preventDefault();
return;
}else{this._preventNavigation=false;
this.editor.deactivate();
if(this._preventNavigation){return;
}}if(u.type==="columnresizehandle"||u.type==="rowresizehandle"){v.startResizing({x:u.x,y:u.y});
t.preventDefault();
return;
}if(u.type==="filtericon"){this.openFilterMenu(t);
t.preventDefault();
return;
}this._selectionMode=p[u.type];
this.appendSelection=t.mod;
this.navigator.startSelection(u.ref,this._selectionMode,this.appendSelection,t.shiftKey,this.view);
},_startResizingDrawing:function(v){var w=a(v.target).closest(".k-spreadsheet-drawing-handle");
if(w.length){var x=this.translateCoords(v);
var t=w.data("direction");
var y=this._workbook.activeSheet();
var u=y._activeDrawing;
y.startDragging({pane:this.originFrame,drawing:u,copy:u.clone(),startBox:y.drawingBoundingBox(u),resize:t,startX:x.x,startY:x.y});
return true;
}},onContextMenu:function(t){var x=this._workbook.activeSheet();
t.preventDefault();
if(x.resizingInProgress()||x.draggingInProgress()){return;
}this.cellContextMenu.close();
this.colHeaderContextMenu.close();
this.rowHeaderContextMenu.close();
this.drawingContextMenu.close();
var v;
var w=this.objectAt(t);
if(w.type==="columnresizehandle"||w.type==="rowresizehandle"){return;
}if(w.ref){this.navigator.selectForContextMenu(w.ref,p[w.type]);
}else{if(w.type=="drawing"){this.navigator.selectDrawingForContextMenu(w.drawing);
}}var u=this.navigator._sheet.select() instanceof n.spreadsheet.UnionRef;
var y=false;
var z=false;
if(w.type=="columnheader"){v=this.colHeaderContextMenu;
y=!u&&this.axisManager.selectionIncludesHiddenColumns();
}else{if(w.type=="rowheader"){v=this.rowHeaderContextMenu;
y=!u&&this.axisManager.selectionIncludesHiddenRows();
}else{if(w.type=="drawing"){v=this.drawingContextMenu;
}else{v=this.cellContextMenu;
z=this.navigator.selectionIncludesMergedCells();
}}}v.element.find(f).toggle(!u);
v.element.find(s).toggle(y);
v.element.find("[data-action=unmerge]").toggle(z);
setTimeout(function(){v.open(t.pageX,t.pageY);
});
},prevent:function(t){t.preventDefault();
},constrainResize:function(w,t){var v=this._workbook.activeSheet();
var u=v.resizeHandlePosition();
return !u||w==="outside"||w==="topcorner"||t.col<u.col||t.row<u.row;
},_dragDrawing:function(x){var z=this._workbook.activeSheet();
var v=z.draggingInProgress();
if(!v){return false;
}var y=this.translateCoords(x);
var w=v.drawing;
var t=y.x-v.startX;
var u=y.y-v.startY;
if(v.resize=="SE"){if(v.aspect){if(Math.abs(t)>Math.abs(u)){w.width=Math.max(v.copy.width+t,20);
w.height=w.width/v.aspect;
}else{w.height=Math.max(v.copy.height+u,20);
w.width=w.height*v.aspect;
}}else{w.width=Math.max(v.copy.width+t,20);
w.height=Math.max(v.copy.height+u,20);
}}else{if(v.resize=="E"){w.width=Math.max(v.copy.width+t,20);
}else{if(v.resize=="S"){w.height=Math.max(v.copy.height+u,20);
}else{if(v.resize=="N"){if(v.copy.height-u>20){w.height=v.copy.height-u;
w.offsetY=v.copy.offsetY+u;
}}else{if(v.resize=="W"){if(v.copy.width-t>20){w.width=v.copy.width-t;
w.offsetX=v.copy.offsetX+t;
}}else{if(v.resize=="NE"){w.width=Math.max(v.copy.width+t,20);
if(v.copy.height-u>20){w.height=v.copy.height-u;
w.offsetY=v.copy.offsetY+u;
}}else{if(v.resize=="SW"){w.height=Math.max(v.copy.height+u,20);
if(v.copy.width-t>20){w.width=v.copy.width-t;
w.offsetX=v.copy.offsetX+t;
}}else{if(v.resize=="NW"){if(v.copy.height-u>20){w.height=v.copy.height-u;
w.offsetY=v.copy.offsetY+u;
}if(v.copy.width-t>20){w.width=v.copy.width-t;
w.offsetX=v.copy.offsetX+t;
}}else{w.offsetX=v.copy.offsetX+t;
w.offsetY=v.copy.offsetY+u;
}}}}}}}}z.triggerChange({dragging:true});
return true;
},onMouseDrag:function(t){if(this._selectionMode==="sheet"){return;
}var v={clientX:t.clientX,clientY:t.clientY};
var x=this._workbook.activeSheet();
if(this._dragDrawing(t)){return;
}var w=this.objectAt(v);
if(x.resizingInProgress()){if(!this.constrainResize(w.type,w.ref)){x.resizeHintPosition({x:w.x,y:w.y});
}return;
}if(w.type==="outside"){this.startAutoScroll(w);
return;
}if(this.originFrame===w.pane){this.selectToLocation(v);
}else{var u=this.originFrame._grid;
if(w.x>u.right){this.scrollLeft();
}if(w.y>u.bottom){this.scrollTop();
}if(w.y<u.top||w.x<u.left){this.startAutoScroll(w,v);
}else{this.selectToLocation(v);
}}t.preventDefault();
},onMouseUp:function(v){var x=this._workbook.activeSheet();
x.completeResizing();
x.completeDragging();
this.navigator.completeSelection();
this.stopAutoScroll();
var t=this.editor.activeEditor();
if(!t){return;
}var u=v.target;
while(u){if(u===t.element[0]){return;
}u=u.parentNode;
}var w=this.objectAt(v);
if(w&&w.ref&&t.canInsertRef(false)){t.refAtPoint(x);
x._setFormulaSelections(t.highlightedRefs());
}},onDblClick:function(u){var v=this.objectAt(u);
var t=this._workbook.activeSheet().selection().enable()===false;
if(v.type!=="cell"||t){return;
}var w=this._workbook.activeSheet().selection();
this.activateEditor(!w.value()&&!w.formula());
this.onEditorUpdate();
},onCut:function(t){if(t){var u=this.clipboardElement.find("table.kendo-clipboard-"+this.clipboard._uid).detach();
this.clipboardElement.append(u.clone(false));
setTimeout(function(){this.clipboardElement.empty().append(u);
}.bind(this));
}this._execute({command:"CutCommand",options:{workbook:this.view._workbook,event:t.originalEvent||t}});
},clipBoardValue:function(){return this.clipboardElement.html();
},_pasteImage:function(u){var w=this;
var t=u.getAsFile();
var v=new window.Image();
v.src=window.URL.createObjectURL(t);
v.onload=function(){w._execute({command:"InsertImageCommand",options:{blob:t,width:v.width,height:v.height}});
};
setTimeout(function(){window.URL.revokeObjectURL(v.src);
},10);
},onPaste:function(u){var B=this;
var x="";
var A="";
B.clipboard.menuInvoked=u===undefined;
if(u){var t=u.originalEvent.clipboardData;
if(t&&t.getData){u.preventDefault();
var v=false;
var w=false;
if(window.DOMStringList&&t.types instanceof window.DOMStringList){v=t.types.contains("text/html");
w=t.types.contains("text/plain");
}else{if(Array.isArray(t.types)){v=t.types.indexOf("text/html")>=0;
w=t.types.indexOf("text/plain")>=0;
}else{v=/text\/html/.test(t.types);
w=/text\/plain/.test(t.types);
}}if(v){x=t.getData("text/html");
}if(w){A=t.getData("text/plain").trim();
}if(!v&&!w&&t.items&&t.items.length){for(var y=0;
y<t.items.length;
++y){var z=t.items[y];
if(z.kind=="file"&&/^image\/(?:png|jpe?g|gif)$/i.test(z.type)){return B._pasteImage(z);
}}}}else{var C=B.clipboardElement.find("table.kendo-clipboard-"+B.clipboard._uid).detach();
B.clipboardElement.empty();
setTimeout(function(){var D=B.clipboardElement.html();
var E=window.clipboardData.getData("Text").trim();
if(!D&&!E){return;
}B.clipboard.external({html:D,plain:E});
B.clipboardElement.empty().append(C);
B._execute({command:"PasteCommand",options:{workbook:B.view._workbook,event:u.originalEvent||u}});
B.clipboard.menuInvoked=true;
});
return;
}}else{if(n.support.browser.msie){B.clipboardElement.focus().select();
document.execCommand("paste");
return;
}else{B.clipboard.menuInvoked=true;
}}if(!x&&!A){return;
}B.clipboard.external({html:x,plain:A});
B._execute({command:"PasteCommand",options:{workbook:B.view._workbook,event:u.originalEvent||u}});
},onCopy:function(t){this.clipboard.menuInvoked=t===undefined;
this._execute({command:"CopyCommand",options:{workbook:this.view._workbook,event:t.originalEvent||t}});
},scrollTop:function(){this.scroller.scrollTop=0;
},scrollLeft:function(){this.scroller.scrollLeft=0;
},scrollDown:function(t){this.scroller.scrollTop+=t;
},scrollRight:function(t){this.scroller.scrollLeft+=t;
},scrollWith:function(u,t){this.scroller.scrollTop+=t;
this.scroller.scrollLeft+=u;
},translateCoords:function(u){var t=this.container[0].getBoundingClientRect();
return{x:u.clientX-t.left,y:u.clientY-t.top};
},objectAt:function(t,u){if(!t){return;
}t=this.translateCoords(t);
return this.view.objectAt(t.x,t.y,u);
},selectToLocation:function(t){var u=this.objectAt(t,true);
if(u.pane&&u.ref){this.extendSelection(u);
this.lastKnownCellLocation=t;
this.originFrame=u.pane;
}this.stopAutoScroll();
},extendSelection:function(t){this.navigator.extendSelection(t.ref,this._selectionMode,this.appendSelection);
},autoScroll:function(){var A=this._autoScrollTarget.x;
var B=this._autoScrollTarget.y;
var t=this.originFrame._grid;
var u=this.view.scroller;
var w=8;
var v=u.scrollLeft;
var z=u.scrollTop;
if(A<t.left){this.scrollRight(-w);
}if(A>t.right){this.scrollRight(w);
}if(B<t.top){this.scrollDown(-w);
}if(B>t.bottom){this.scrollDown(w);
}if(z===u.scrollTop&&v===u.scrollLeft){this.selectToLocation(this.finalLocation);
}else{this.extendSelection(this.objectAt(this.lastKnownCellLocation));
}},startAutoScroll:function(u,t){if(!this._scrollInterval){this._scrollInterval=setInterval(this.autoScroll.bind(this),50);
}this.finalLocation=t||this.lastKnownCellLocation;
this._autoScrollTarget=u;
},stopAutoScroll:function(){clearInterval(this._scrollInterval);
this._scrollInterval=null;
},openCustomEditor:function(){this.view.openCustomEditor();
},openFilterMenu:function(u){var w=this.objectAt(u);
var x=this._workbook.activeSheet();
var t=x.filterColumn(w.ref);
var v=this.view.createFilterMenu(t);
v.bind("action",this.onCommandRequest.bind(this));
v.bind("action",v.close.bind(v));
v.openFor(u.target);
},_saveEditorValue:function(t){var u=this.editor._range.sheet();
var v=this.editor.value();
if(this._workbook.activeSheet()!==u){this._workbook.activeSheet()._setFormulaSelections();
this._workbook.activeSheet(u);
}u.isInEditMode(false);
this._lastEditorValue=v;
this._execute({command:"EditCommand",options:{value:v,arrayFormula:t}});
},onEditorChange:function(){this._saveEditorValue(false);
},onEditorArrayFormula:function(){this._saveEditorValue(true);
this.editor.deactivate(true);
},onEditorActivate:function(){var u=this._workbook;
var t=u.activeSheet();
t._setFormulaSelections(this.editor.highlightedRefs());
t.isInEditMode(true);
},onEditorDeactivate:function(){var t=this._workbook.activeSheet();
t.isInEditMode(false);
t._setFormulaSelections([]);
},onEditorUpdate:function(){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());
},onEditorBarFocus:function(){var t=this._workbook.activeSheet().selection().enable()===false;
if(t){return;
}this.editor.activate({range:this._workbook.activeSheet().selection(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()});
},onEditorCellFocus:function(){this.editor.scale();
},onEditorEsc:function(){this.resetEditorValue();
this.editor.deactivate();
this.clipboardElement.focus();
},insertNewline:function(t){t.preventDefault();
this.editor.insertNewline();
},onEditorBlur:function(t,u){if(this.editor.isFiltered()){return;
}this._preventNavigation=false;
this.editor.deactivate();
if(!this._preventNavigation){this.clipboardElement.focus();
this.navigator.navigateInSelection(k[u]);
}},onEditorAction:function(v,t){var u=this.editor;
var w=this._workbook.activeSheet();
if(this._casualEditing&&/^(?:up|right|down|left)$/.test(t)){this.deactivateEditor();
this.navigator.moveActiveCell(c[t]);
v.preventDefault();
}else{if(u.canInsertRef(true)){this.navigator.moveActiveCell(c[t]);
u.activeEditor().refAtPoint(w);
w._setFormulaSelections(u.highlightedRefs());
v.preventDefault();
}}},onEditorShiftAction:function(v,t){var u=this.editor;
var w=this._workbook.activeSheet();
if(u.canInsertRef(true)){this.navigator.modifySelection(c[t.replace("shift+","")],this.appendSelection);
u.activeEditor().refAtPoint(w);
w._setFormulaSelections(u.highlightedRefs());
v.preventDefault();
}},resetEditorValue:function(){var v=this._workbook.activeSheet();
var u=v.activeCell();
var t=this._workbook._inputForRef(u);
var w=v.range(u).intersectingArrayFormula();
if(w){t="="+w.formula;
}this.editor.value(t,!!w);
},activateEditor:function(t){this._casualEditing=t;
this.editor.activate({range:this._workbook.activeSheet().selection(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()}).focus();
},deactivateEditor:function(){this.view.editor.deactivate();
},onCommandRequest:function(t){if(t.command){this._execute(t);
}else{this._workbook.undoRedoStack[t.action]();
}},onDialogRequest:function(u){var t={pdfExport:this._workbook.options.pdf,excelExport:this._workbook.options.excel};
if(u.options){a.extend(true,u.options,t);
}else{u.options=t;
}this.view.openDialog(u.name,u.options);
},onNameEditorEnter:function(){var u;
var x=this._workbook;
var v=x.activeSheet();
var t=this.view.nameEditor.value();
u=n.spreadsheet.calc.parseReference(t,true)||x.nameValue(t);
if(u instanceof n.spreadsheet.Ref){if(u.sheet&&u.sheet.toLowerCase()!=v.name().toLowerCase()){var w=x.sheetByName(u.sheet);
if(w){x.activeSheet(w);
v=w;
}}v.range(u).select();
return;
}u=v.selection()._ref.clone().simplify().setSheet(v.name(),true);
this._execute({command:"DefineNameCommand",options:{name:t,value:u}});
this.clipboardElement.focus();
},onNameEditorCancel:function(){this.clipboardElement.focus();
},onNameEditorSelect:function(t){var u=t.name;
var y=this._workbook;
var w=y.activeSheet();
var v=y.nameValue(u);
if(v instanceof n.spreadsheet.Ref){if(v.sheet&&v.sheet.toLowerCase()!=w.name().toLowerCase()){var x=y.sheetByName(v.sheet);
if(x){y.activeSheet(x);
w=x;
}}w.range(v).select();
return;
}this.clipboardElement.focus();
},onNameEditorDelete:function(t){this._execute({command:"DeleteNameCommand",options:{name:t.name}});
this.clipboardElement.focus();
}});
n.spreadsheet.Controller=h;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/view",["kendo.core","kendo.menu","spreadsheet/sheetsbar","util/main"],b);
}(function(){(function(q){if(q.support.browser.msie&&q.support.browser.version<9){return;
}var a=q.jQuery;
var h=q.spreadsheet.CellRef;
var j=".";
var t=7;
var n=20;
var o="Error";
var y={view:"k-spreadsheet-view",fixedContainer:"k-spreadsheet-fixed-container",editContainer:"k-spreadsheet-edit-container",scroller:"k-spreadsheet-scroller",viewSize:"k-spreadsheet-view-size",clipboard:"k-spreadsheet-clipboard",cellEditor:"k-spreadsheet-cell-editor",barEditor:"k-spreadsheet-editor",topCorner:"k-spreadsheet-top-corner",filterHeadersWrapper:"k-filter-wrapper",filterRange:"k-filter-range",filterButton:"k-spreadsheet-filter",filterButtonActive:"k-state-active",horizontalResize:"k-horizontal-resize",verticalResize:"k-vertical-resize",icon:"k-icon",iconFilterDefault:"k-i-arrow-60-down",sheetsBar:"k-spreadsheet-sheets-bar",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",cellContextMenu:"k-spreadsheet-cell-context-menu",rowHeaderContextMenu:"k-spreadsheet-row-header-context-menu",colHeaderContextMenu:"k-spreadsheet-col-header-context-menu",drawingContextMenu:"k-spreadsheet-drawing-context-menu"};
q.spreadsheet.messages.view={nameBox:"Name Box",errors:{openUnsupported:"Unsupported format. Please select an .xlsx file.",shiftingNonblankCells:"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.",insertColumnWhenRowIsSelected:"Cannot insert column when all columns are selected.",insertRowWhenColumnIsSelected:"Cannot insert row when all rows are selected.",filterRangeContainingMerges:"Cannot create a filter within a range containing merges",sortRangeContainingMerges:"Cannot sort a range containing merges",cantSortMultipleSelection:"Cannot sort multiple selection",cantSortNullRef:"Cannot sort empty selection",cantSortMixedCells:"Cannot sort range containing cells of mixed shapes",validationError:"The value that you entered violates the validation rules set on the cell.",cannotModifyDisabled:"Cannot modify disabled cells."},tabs:{home:"Home",insert:"Insert",data:"Data"}};
q.spreadsheet.messages.menus={cut:"Cut",copy:"Copy",paste:"Paste",merge:"Merge",unmerge:"Unmerge","delete":"Delete",hide:"Hide",unhide:"Unhide",bringToFront:"Bring to front",sendToBack:"Send to back"};
function v(A){var C=window.getSelection();
C.removeAllRanges();
var B=document.createRange();
B.selectNodeContents(A);
C.addRange(B);
}function f(C,B){var A=C.trs[B].children;
return A[A.length-2];
}function e(D,C){var B=D.trs[C-1];
var A=D.trs[C].children.length-1;
if(B&&A>=0){return B.children[A];
}}function g(A){return(A.size||1)+"px solid "+(A.color||"#000");
}function c(A){if(!/:\/\//.test(A)){A="http://"+A;
}return A;
}function k(F,B,E,N){function K(S){var T=B.link;
if(!T){if(typeof B.value=="object"){T=B.value.link;
}}if(T){var U={textDecoration:"none"};
if(B.color){U.color=B.color;
}if(B.underline){U.textDecoration="underline";
}return q.dom.element("a",{href:c(T),style:U,target:"_blank"},S?[S]:[]);
}return S;
}var M=B.value!=null||B.validation!=null&&!B.validation.value||B.background||B.merged||B.comment;
if(!E&&!M){return;
}var O={};
var A=B.background;
if(A){var H=A;
if(N){H=q.parseColor(H).toHSV();
H.v*=0.9;
H=H.toCssRgba();
}H=g({color:H});
O.outline=H;
}if(A){O.backgroundColor=A;
}if(B.color){O.color=B.color;
}if(B.fontFamily){O.fontFamily=B.fontFamily;
}if(B.underline){O.textDecoration="underline";
}if(B.italic){O.fontStyle="italic";
}if(B.textAlign){O.textAlign=B.textAlign;
}if(B.bold){O.fontWeight="bold";
}if(B.fontSize){O.fontSize=B.fontSize+"px";
}if(B.wrap===true){O.whiteSpace="pre-wrap";
O.overflowWrap="break-word";
O.wordWrap="break-word";
}else{O.whiteSpace="pre";
O.overflowWrap="normal";
O.wordWrap="normal";
}O.left=B.left+1+"px";
O.top=B.top+1+"px";
O.width=B.width-1+"px";
O.height=B.height-1+"px";
var G=B.value,P=typeof G,J=B.format;
if(!J&&P=="number"&&G!=Math.floor(G)){J="0.##############";
}if(J&&G!=null){G=q.spreadsheet.formatting.format(G,J);
if(G.__dataType){P=G.__dataType;
}}else{if(G!==null&&G!==undefined){G=q.dom.text(G);
}}if(!O.textAlign){switch(P){case"number":case"date":case"percent":case"currency":O.textAlign="right";
break;
case"boolean":O.textAlign="center";
break;
}}q.spreadsheet.draw.applyIndent(B,O);
var D=[s.cell];
if(E){D.push(E);
}if(B.enable===false){D.push("k-state-disabled");
}if(B.merged){D.push("k-spreadsheet-merged-cell");
}if(B.comment){D.push("k-spreadsheet-has-comment");
}var R=B.verticalAlign||"bottom";
if(R&&G){G=q.dom.element("div",{className:"k-vertical-align-"+R},[K(G)]);
}else{G=K(G);
}var C=G?[G]:[];
var L={style:O};
var Q=B.validation;
if(Q&&!Q.value){C.push(q.dom.element("span",{className:"k-dirty"}));
D.push("k-dirty-cell");
L.title=Q.message;
}L.className=D.join(" ");
var I=q.dom.element("div",L,C);
F.push(I);
return I;
}function b(I,F,B){var H={};
if(B.background){H.backgroundColor=B.background;
}if(B.color){H.color=B.color;
}if(B.fontFamily){H.fontFamily=B.fontFamily;
}if(B.underline){H.textDecoration="underline";
}if(B.italic){H.fontStyle="italic";
}if(B.textAlign){H.textAlign=B.textAlign;
}if(B.verticalAlign){H.verticalAlign=B.verticalAlign==="center"?"middle":B.verticalAlign;
}if(B.bold){H.fontWeight="bold";
}if(B.fontSize){H.fontSize=B.fontSize+"px";
}if(B.wrap===true){H.whiteSpace="pre-wrap";
}if(B.borderRight){H.borderRight=g(B.borderRight);
}else{if(B.background){H.borderRightColor=B.background;
}}if(B.borderBottom){H.borderBottom=g(B.borderBottom);
}else{if(B.background){H.borderBottomColor=B.background;
}}var D=B.value,K=typeof D,E=B.format;
if(!E&&K=="number"&&D!=Math.floor(D)){E="0.##############";
}if(E&&D!=null){D=q.spreadsheet.formatting.format(D,E);
if(D.__dataType){K=D.__dataType;
}}if(!H.textAlign){switch(K){case"number":case"date":case"percent":case"currency":H.textAlign="right";
break;
case"boolean":H.textAlign="center";
break;
}}var C=null;
if(B.enable===false){C="k-state-disabled";
}var J=I.addCell(F,D,H,C,B.validation);
var A,G;
if(B.borderLeft){G=f(I,F);
A=g(B.borderLeft);
if(G&&A){G.attr.style.borderRight=A;
}}else{if(B.background){H.borderLeftColor=B.background;
}}if(B.borderTop){G=e(I,F);
A=g(B.borderTop);
if(G&&A){G.attr.style.borderBottom=A;
}}else{if(B.background){H.borderTopColor=B.background;
}}return J;
}var p=q.Class.extend({init:function(){this.cols=[];
this.trs=[];
this._height=0;
this._width=0;
},addColumn:function(B){this._width+=B;
var A=q.dom.element("col",{style:{width:B+"px"}});
A.visible=B>0;
this.cols.push(A);
},addRow:function(B){var A=null;
A={style:{height:B+"px"}};
this._height+=B;
var C=q.dom.element("tr",A);
C.visible=B>0;
this.trs.push(C);
},addCell:function(D,G,E,B,H){if(G===null||G===undefined){G="";
}if(!(G instanceof q.dom.Node)){G=q.dom.text(G);
}var A=[G];
var C={style:E};
if(H&&!H.value){A.push(q.dom.element("span",{className:"k-dirty"}));
B=(B||"")+(B?" ":"")+"k-dirty-cell";
C.title=H.message;
}if(B){C.className=B;
}var F=q.dom.element("td",C,A);
this.trs[D].children.push(F);
return F;
},toDomTree:function(C,D,A){this.trs=this.trs.filter(function(E){return E.visible;
});
var B=0;
this.cols=this.cols.filter(function(F,E){if(!F.visible){this.trs.forEach(function(G){G.children.splice(E-B,1);
});
B++;
}return F.visible;
},this);
return q.dom.element("table",{style:{left:C+"px",top:D+"px",height:this._height+"px",width:this._width+"px"},className:A},[q.dom.element("colgroup",null,this.cols),q.dom.element("tbody",null,this.trs)]);
}});
var d='<ul class="#=classNames.cellContextMenu#"><li data-action=cut>#: messages.cut #</li><li data-action=copy>#: messages.copy #</li><li data-action=paste>#: messages.paste #</li><li class="k-separator"></li><li data-action=merge>#: messages.merge #</li><li data-action=unmerge>#: messages.unmerge #</li></ul>';
var u='<ul class="#=classNames.rowHeaderContextMenu#"><li data-action=cut>#: messages.cut #</li><li data-action=copy>#: messages.copy #</li><li data-action=paste>#: messages.paste #</li><li class="k-separator"></li><li data-action="delete-row">#: messages.delete #</li><li data-action="hide-row">#: messages.hide #</li><li data-action="unhide-row">#: messages.unhide #</li></ul>';
var i='<ul class="#=classNames.colHeaderContextMenu#"><li data-action=cut>#: messages.cut #</li><li data-action=copy>#: messages.copy #</li><li data-action=paste>#: messages.paste #</li><li class="k-separator"></li><li data-action="delete-column">#: messages.delete #</li><li data-action="hide-column">#: messages.hide #</li><li data-action="unhide-column">#: messages.unhide #</li></ul>';
var l='<ul class="#=classNames.drawingContextMenu#"><li data-action="bring-to-front">#: messages.bringToFront #</li><li data-action="send-to-back">#: messages.sendToBack #</li><li class="k-separator"></li><li data-action="delete-drawing">#: messages.delete #</li></ul>';
q.spreadsheet.ContextMenu=q.ui.ContextMenu;
var x=q.template('<div class="#=classNames.view#"><div class="#=classNames.fixedContainer#"></div><div class="#=classNames.scroller#"><div class="#=classNames.viewSize#"></div></div><div tabindex="0" class="#=classNames.clipboard#" contenteditable=true></div><div class="#=classNames.cellEditor#"></div></div><div class="#=classNames.sheetsBar#"></div>'+d+u+i+l);
function z(C,B,A){return C>=B&&C<=A;
}var w=q.Class.extend({init:function(C,D){var A=w.classNames;
this.element=C;
this.options=a.extend(true,{messages:q.spreadsheet.messages.view},this.options,D);
this._chrome();
this._dialogs=[];
C.append(x({classNames:A,messages:q.spreadsheet.messages.menus}));
this._formulaInput();
this.wrapper=C.find(j+A.view);
this.container=C.find(j+A.fixedContainer)[0];
this.scroller=C.find(j+A.scroller)[0];
this.clipboard=C.find(j+A.clipboard);
this.viewSize=a(this.scroller.firstChild);
this.tree=new q.dom.Tree(this.container);
this.clipboardContents=new q.dom.Tree(this.clipboard[0]);
this.editor=new q.spreadsheet.SheetEditor(this);
this._sheetsbar();
var B={target:C,animation:false,showOn:"never"};
this.cellContextMenu=new q.spreadsheet.ContextMenu(C.find(j+A.cellContextMenu),B);
this.colHeaderContextMenu=new q.spreadsheet.ContextMenu(C.find(j+A.colHeaderContextMenu),B);
this.rowHeaderContextMenu=new q.spreadsheet.ContextMenu(C.find(j+A.rowHeaderContextMenu),B);
this.drawingContextMenu=new q.spreadsheet.ContextMenu(C.find(j+A.drawingContextMenu),B);
},enableClipboard:function(A){this.isClipboardDeactivated=!A;
if(A){this.clipboard.attr("contenteditable",A);
}else{this.clipboard.removeAttr("contenteditable");
}},_resize:function(){var A=a(this.formulaBar.element).parents(".k-spreadsheet-action-bar");
var C=q._outerHeight;
var E=this.tabstrip?C(this.tabstrip.element):0;
var B=A?C(A):0;
var D=this.sheetsbar?C(this.sheetsbar.element):0;
this.wrapper.height(this.element.height()-(E+B+D));
if(this.tabstrip){this.tabstrip.quickAccessAdjust();
}},_chrome:function(){var C=a("<div class='k-spreadsheet-action-bar' />").prependTo(this.element);
var B=a("<div class='k-spreadsheet-name-editor' />").appendTo(C);
this.nameEditor=new q.spreadsheet.NameEditor(B,this.options);
var A=a("<div />").appendTo(C);
this.formulaBar=new q.spreadsheet.FormulaBar(A);
if(this.options.toolbar){this._tabstrip();
}},_formulaInput:function(){var A=this.element.find(j+w.classNames.cellEditor);
this.formulaInput=new q.spreadsheet.FormulaInput(A,{autoScale:true});
},_sheetsbar:function(){if(this.options.sheetsbar){var A=a.extend(true,{openDialog:this.openDialog.bind(this)},this.options.sheetsbar);
this.sheetsbar=new q.spreadsheet.SheetsBar(this.element.find(j+w.classNames.sheetsBar),A);
}},_tabstrip:function(){var A=this.options.messages.tabs;
var C=a.extend(true,{home:true,insert:true,data:true},this.options.toolbar);
var D=[];
if(this.tabstrip){this.tabstrip.destroy();
this.element.children(".k-tabstrip").remove();
}for(var B in C){if(C[B]===true||C[B] instanceof Array){D.push({id:B,text:A[B],content:""});
}}this.tabstrip=new q.spreadsheet.TabStrip(a("<div />").prependTo(this.element),{animation:false,dataTextField:"text",dataContentField:"content",dataSource:D,toolbarOptions:C,view:this});
this.tabstrip.select(0);
},_executeCommand:function(A){this._sheet.trigger("commandRequest",A);
},workbook:function(A){this._workbook=A;
A._view=this;
this.nameEditor._workbook=A;
},sheet:function(A){this._sheet=A;
},activeCellRectangle:function(){return this.cellRectangle(this._sheet._viewActiveCell());
},_rectangle:function(A,B){return A._grid.boundingRectangle(B.toRangeRef());
},isColumnResizer:function(C,B,A){C-=this._sheet._grid._headerWidth;
if(!B._grid.columns.frozen){C+=this.scroller.scrollLeft;
}A=this._sheet._grid._columns.locate(0,A,function(D){return Math.abs(C-D)<=t/2;
});
return A!==null&&!this._sheet.isHiddenColumn(A)?A:null;
},isRowResizer:function(C,A,B){C-=this._sheet._grid._headerHeight;
if(!A._grid.rows.frozen){C+=this.scroller.scrollTop;
}B=this._sheet._grid._rows.locate(0,B,function(D){return Math.abs(C-D)<=t/2;
});
return B!==null&&!this._sheet.isHiddenRow(B)?B:null;
},isFilterIcon:function(G,H,A,B){var E=this;
var F=A._grid;
var D=F.rows.frozen?0:E.scroller.scrollTop;
var C=F.columns.frozen?0:E.scroller.scrollLeft;
G-=E._sheet._grid._headerWidth-C;
H-=E._sheet._grid._headerHeight-D;
return q.util.withExit(function(I){E._sheet.forEachFilterHeader(B,function(K){var J=E._rectangle(A,K);
if(A.filterIconRect(J).intersects(G,H)){I(true);
}});
});
},isAutoFill:function(D,E,A){var C=this._sheet.select();
if(C.size>1){return false;
}D-=this._sheet._grid._headerWidth;
E-=this._sheet._grid._headerHeight;
if(!A._grid.columns.frozen){D+=this.scroller.scrollLeft;
}if(!A._grid.rows.frozen){E+=this.scroller.scrollTop;
}var B=this._rectangle(A,C);
return Math.abs(B.right-D)<8&&Math.abs(B.bottom-E)<8;
},isEditButton:function(D,E,B){var A=this._sheet.activeCellCustomEditor();
if(A){var C=this.activeCellRectangle();
if(E>=C.top&&E<=C.bottom){return B._editorInLastColumn?D<C.left&&D>=C.left-n:D>C.right&&D<=C.right+n;
}}},drawingAt:function(G,H,E){G-=this._sheet._grid._headerWidth;
H-=this._sheet._grid._headerHeight;
if(!E._grid.columns.frozen){G+=this.scroller.scrollLeft;
}if(!E._grid.rows.frozen){H+=this.scroller.scrollTop;
}var F=this._sheet;
var C=this._sheet._drawings;
for(var D=C.length;
--D>=0;
){var B=C[D];
var A=F.drawingBoundingBox(B);
if(A.intersects(G,H)){return{drawing:B,drx:A.left-G,dry:A.top-H};
}}},objectAt:function(K,L,D){var C=this._sheet._grid;
var E,F;
if(K<0||L<0||K>this.scroller.clientWidth||L>this.scroller.clientHeight){E={type:"outside"};
}else{if(K<C._headerWidth&&L<C._headerHeight){E={type:"topcorner"};
}else{F=this.paneAt(K,L);
if(!F){E={type:"outside"};
}else{if(!D){var B=this.drawingAt(K,L,F);
if(B){return{type:"drawing",drawing:B.drawing,drx:B.drx,dry:B.dry,pane:F,startX:K,startY:L};
}}var H=F._grid.rows.indexVisible(L,this.scroller.scrollTop);
var A=F._grid.columns.indexVisible(K,this.scroller.scrollLeft);
var J="cell";
var G=new h(H,A);
var I=this._sheet.selectionInProgress();
if(this.isAutoFill(K,L,F)){J="autofill";
}else{if(this.isFilterIcon(K,L,F,G)){J="filtericon";
}else{if(!I&&K<C._headerWidth){J="rowheader";
if((H=this.isRowResizer(L,F,H))!==null){G=new h(H,-Infinity);
J="rowresizehandle";
}}else{if(!I&&L<C._headerHeight){J="columnheader";
if((A=this.isColumnResizer(K,F,A))!==null){G=new h(-Infinity,A);
J="columnresizehandle";
}}else{if(this.isEditButton(K,L,F)){J="editor";
}}}}}if(J=="cell"){this._sheet.forEachMergedCell(G,function(M){G=M.topLeft;
});
}E={type:J,ref:G};
}}}E.pane=F;
E.x=K;
E.y=L;
return E;
},paneAt:function(B,C){return this.panes.filter(function A(E){var D=E._grid;
return z(C,D.top,D.bottom)&&z(B,D.left,D.right);
})[0];
},containingPane:function(A){return this.panes.filter(function(B){if(B._grid.contains(A)){return true;
}return false;
})[0];
},cellRectangle:function(A){var C=this.containingPane(A)._grid;
var B=this._sheet._grid.rectangle(A);
return B.offset(C.headerWidth-(C.columns.frozen?0:this.scroller.scrollLeft),C.headerHeight-(C.rows.frozen?0:this.scroller.scrollTop));
},refresh:function(C){var D=this._sheet;
if(this.tabstrip){this.tabstrip.refreshTools(D.range(D.activeCell()));
}if(C.sheetSelection&&this.sheetsbar){this.sheetsbar.renderSheets(this._workbook.sheets(),this._workbook.sheetIndex(this._sheet));
}this._resize();
this.viewSize[0].style.height=D._grid.totalHeight()+"px";
this.viewSize[0].style.width=D._grid.totalWidth()+"px";
if(C.layout){var A=D.frozenColumns();
var B=D.frozenRows();
this.panes=[this._pane(B,A)];
if(A>0){this.panes.push(this._pane(B,0,null,A));
}if(B>0){this.panes.push(this._pane(0,A,B,null));
}if(B>0&&A>0){this.panes.push(this._pane(0,0,B,A));
}}if(C.filter){this._destroyFilterMenu();
}if(C.activeCell){this._focus=D.activeCell().toRangeRef();
}},createFilterMenu:function(A){if(this._filterMenu&&this._filterMenu.options.column==A){return this._filterMenu;
}this._destroyFilterMenu();
var G=this._sheet;
var F=G.filter().ref;
var E=new q.spreadsheet.Range(F,G);
var B=a("<div />").appendTo(this.element);
var D={column:A,range:E};
var C=new q.spreadsheet.FilterMenu(B,D);
this._filterMenu=C;
return C;
},selectClipboardContents:function(){if(!this.isClipboardDeactivated){this.clipboard.focus();
v(this.clipboard[0]);
}},scrollIntoView:function(B){var G=false;
var F=this.containingPane(B)._grid;
var A=F.scrollBoundaries(B);
var C=this.scroller;
var E=F.rows.frozen?0:C.scrollTop;
var D=F.columns.frozen?0:C.scrollLeft;
if(A.top<E){G=true;
C.scrollTop=A.scrollTop;
}if(A.bottom>E){G=true;
C.scrollTop=A.scrollBottom;
}if(A.left<D){G=true;
C.scrollLeft=A.scrollLeft;
}if(A.right>D){G=true;
C.scrollLeft=A.scrollRight;
}return G;
},_destroyDialog:function(){this._dialogs.pop();
},openCustomEditor:function(){var D=this;
var A=D._sheet.activeCell().first();
var B=D._sheet.activeCellCustomEditor();
var C=D._sheet.range(A);
B.edit({range:C,rect:D.activeCellRectangle(),view:this,validation:this._sheet.validation(A),callback:function(F,E){D._executeCommand({command:"EditCommand",options:{operatingRange:C,property:E?"input":"value",value:F}});
}});
},openDialog:function(A,B){var C=this._sheet;
return C.withCultureDecimals(function(){var D=q.spreadsheet.dialogs.create(A,B);
if(D){D.bind("action",this._executeCommand.bind(this));
D.bind("deactivate",this._destroyDialog.bind(this));
this._dialogs.push(D);
var F=C.activeCell();
var E=new q.spreadsheet.Range(F,C);
D.open(E);
return D;
}}.bind(this));
},showError:function(G,H){var A=this._dialogs;
var C=this.options.messages.errors;
var E=false;
if(A.length>0){A.forEach(function(I){if(I.options&&I.options.title===o){E=true;
}});
}if(E){return;
}var D=function(J){var I=J.sender.dialog().element;
I.find(".k-button:first").focus();
I.find(".k-button, input").on("keydown",function(K){if(K.keyCode==q.keys.ESC){J.sender.close();
}});
};
var F=function(J){var I=J.sender;
this.selectClipboardContents();
if(I._retry&&H){H();
}}.bind(this);
if(q.spreadsheet.dialogs.registered(G.type)){var B={close:F};
if(G.type==="validationError"){B=a.extend(B,{title:G.title||"Error",text:G.body?G.body:C[G.type],activate:D});
}this.openDialog(G.type,B);
}else{this.openDialog("message",{title:G.title||"Error",text:G.body?G.body:C[G.type],activate:D,close:F});
}},destroy:function(){this._dialogs.forEach(function(A){A.destroy();
});
this.cellContextMenu.destroy();
this.rowHeaderContextMenu.destroy();
this.colHeaderContextMenu.destroy();
this.drawingContextMenu.destroy();
this.cellContextMenu=this.rowHeaderContextMenu=this.colHeaderContextMenu=this.drawingContextMenu=null;
if(this.tabstrip){this.tabstrip.destroy();
this.tabstrip=null;
}this._destroyFilterMenu();
},_destroyFilterMenu:function(){if(this._filterMenu){this._filterMenu.destroy();
this._filterMenu=undefined;
this._filterMenuColumn=undefined;
}},render:function(C){if(!this.element.is(":visible")){return;
}var H=this._sheet;
var A=H.focus();
if(A&&this.scrollIntoView(A)){return;
}var D=!H.resizingInProgress()?"none":H.resizeHandlePosition().col===-Infinity?"column":"row";
this.wrapper.toggleClass(y.editContainer,this.editor.isActive()).toggleClass(y.horizontalResize,D=="row").toggleClass(y.verticalResize,D=="column");
var B=H._grid;
var G=this.scroller;
var E=this.panes.map(function(J){return J.render(G);
});
var I=q.dom.element("div",{style:{width:B._headerWidth+"px",height:B._headerHeight+"px"},className:w.classNames.topCorner});
E.push(I);
if(H.resizeHandlePosition()&&H.resizeHintPosition()){E.push(this.renderResizeHint());
}this.tree.render(E);
var F=q.support.scrollbar();
a(this.container).css({width:this.wrapper[0].clientWidth-F,height:this.wrapper[0].clientHeight-F});
if(this.editor.isActive()){this.editor.toggleTooltip(this.activeCellRectangle());
}else{if(!(C.resize||C.scroll||C.comment||H.selectionInProgress()||H.resizingInProgress()||H.draggingInProgress()||H.isInEditMode())){this.renderClipboardContents();
}}},renderResizeHint:function(){var D=this._sheet;
var C=D.resizeHandlePosition();
var B=C.col!==-Infinity;
var E;
if(B){E={height:this.scroller.clientHeight+"px",width:t+"px",left:D.resizeHintPosition().x+"px",top:"0px"};
}else{E={height:t+"px",width:this.scroller.clientWidth+"px",top:D.resizeHintPosition().y+"px",left:"0px"};
}var A=r.classNames;
return q.dom.element("div",{className:A.resizeHint+(!B?" "+A.resizeHintVertical:""),style:E},[q.dom.element("div",{className:A.resizeHintHandle}),q.dom.element("div",{className:A.resizeHintMarker})]);
},renderClipboardContents:function(){var F=this._sheet;
var A=F._grid;
var D=A.normalize(F.select().toRangeRef());
var G=this._workbook.clipboard().canCopy();
if(G.canCopy===false&&G.multiSelection){this.clipboardContents.render([]);
this.selectClipboardContents();
return;
}D=F.trim(D);
var H=new p();
var E=A.rangeDimensions(D);
E.rows.forEach(function(J){H.addRow(J);
});
E.columns.forEach(function(J){H.addColumn(J);
});
var I=F._getMergedCells(D);
var B=I.primary;
var C=I.secondary;
F.forEach(D,function(N,K,J){var L=new h(N,K).print();
if(!C[L]){var O=b(H,N-D.topLeft.row,J);
var M=B[L];
if(M){O.attr.colspan=M.width();
O.attr.rowspan=M.height();
}}});
this.clipboardContents.render([H.toDomTree(0,0,"kendo-clipboard-"+this._workbook.clipboard()._uid)]);
this.selectClipboardContents();
},_pane:function(D,A,E,B){var C=new r(this._sheet,this._sheet._grid.pane({row:D,column:A,rowCount:E,columnCount:B}));
C.refresh(this.scroller.clientWidth,this.scroller.clientHeight);
return C;
},forceScrollerStackingOrder:function(A){a(this.scroller).css("z-index",A);
}});
var s={cell:"k-spreadsheet-cell",vaxis:"k-spreadsheet-vaxis",haxis:"k-spreadsheet-haxis",vborder:"k-spreadsheet-vborder",hborder:"k-spreadsheet-hborder",rowHeader:"k-spreadsheet-row-header",columnHeader:"k-spreadsheet-column-header",pane:"k-spreadsheet-pane",data:"k-spreadsheet-data",mergedCell:"k-spreadsheet-merged-cell",mergedCellsWrapper:"k-merged-cells-wrapper",activeCell:"k-spreadsheet-active-cell",selection:"k-spreadsheet-selection",selectionWrapper:"k-selection-wrapper",autoFillWrapper:"k-auto-fill-wrapper",single:"k-single",top:"k-top",right:"k-right",bottom:"k-bottom",left:"k-left",resizeHandle:"k-resize-handle",columnResizeHandle:"k-column-resize-handle",rowResizeHandle:"k-row-resize-handle",resizeHint:"k-resize-hint",resizeHintHandle:"k-resize-hint-handle",resizeHintMarker:"k-resize-hint-marker",resizeHintVertical:"k-resize-hint-vertical",selectionHighlight:"k-spreadsheet-selection-highlight",series:["k-series-a","k-series-b","k-series-c","k-series-d","k-series-e","k-series-f"]};
var r=q.Class.extend({init:function(B,A){this._sheet=B;
this._grid=A;
},refresh:function(B,A){this._grid.refresh(B,A);
},isVisible:function(B,C,A){return this._grid.view(B,C).ref.intersects(A);
},render:function(H){var I=H.scrollLeft;
var J=H.scrollTop;
if(J<0){J=0;
}if(I<0){I=0;
}var B=r.classNames;
var K=this._sheet;
var D=this._grid;
var L=D.view(I,J);
this._currentView=L;
this._currentRect=this._rectangle(L.ref);
this._selectedHeaders=K.selectedHeaders();
var A=[];
A.push(this.renderData());
if(!K._activeDrawing){A.push(this.renderSelection(H));
}A.push(this.renderAutoFill());
A.push(this.renderEditorSelection());
A.push(this.renderFilterHeaders());
if(D.hasRowHeader){var G=q.dom.element("div",{className:B.rowHeader,style:{width:D.headerWidth+"px",top:L.rowOffset+"px"}});
A.push(G);
K.forEach(L.ref.leftColumn(),function(N){if(!K.isHiddenRow(N)){var O=N+1,M=K.rowHeight(N);
G.children.push(q.dom.element("div",{className:this.headerClassName(N,"row"),style:{width:D.headerWidth+"px",height:M+"px"}},[q.dom.element("div",{className:"k-vertical-align-center"},[q.dom.text(O+"")])]));
}}.bind(this));
}if(D.hasColumnHeader){var C=q.dom.element("div",{className:B.columnHeader,style:{top:"0px",left:L.columnOffset+"px",width:this._currentRect.width+"px",height:D.headerHeight+"px"}});
A.push(C);
var E=0;
K.forEach(L.ref.topRow(),function(N,M){if(!K.isHiddenColumn(M)){var O=q.spreadsheet.Ref.display(null,Infinity,M),P=K.columnWidth(M);
C.children.push(q.dom.element("div",{className:this.headerClassName(M,"col"),style:{position:"absolute",left:E+"px",width:P+"px",height:D.headerHeight+"px"}},[q.dom.element("div",{className:"k-vertical-align-center"},[q.dom.text(O+"")])]));
E+=P;
}}.bind(this));
}if(K.resizeHandlePosition()&&(D.hasColumnHeader||D.hasRowHeader)){if(!K.resizeHintPosition()){this.renderResizeHandle(A);
}}var F=[B.pane];
if(D.hasColumnHeader){F.push(B.top);
}if(D.hasRowHeader){F.push(B.left);
}return q.dom.element("div",{style:D.style,className:F.join(" ")},A);
},headerClassName:function(C,F){var E=this._selectedHeaders;
var D;
var A;
if(F==="row"){D=E.rows[C];
A=E.allRows;
}else{D=E.cols[C];
A=E.allCols;
}var B=D||(E.all?"full":A?"partial":"none");
if(B){B="k-selection-"+B;
}return B;
},renderData:function(){var H=this._sheet;
var J=this._currentView;
var D=q.dom.element("div",{className:r.classNames.data,style:{position:"relative",left:J.columnOffset+"px",top:J.rowOffset+"px"}});
var G=this._currentRect;
var E=q.spreadsheet.draw.doLayout(H,J.ref,{forScreen:true}),F;
var I=H._showGridLines;
if(I){F=null;
E.xCoords.forEach(function(K){if(K!==F){F=K;
D.children.push(q.dom.element("div",{className:s.vaxis,style:{left:K+"px",height:G.height+"px",borderColor:H.gridLinesColor()}}));
}});
F=null;
E.yCoords.forEach(function(K){if(K!==F){F=K;
D.children.push(q.dom.element("div",{className:s.haxis,style:{top:K+"px",width:G.width+"px",borderColor:H.gridLinesColor()}}));
}});
}var C=q.spreadsheet.draw.Borders();
var B=H.activeCell().toRangeRef();
var A=B.topLeft;
E.cells.forEach(function(M){var N=null;
var L=M.row+J.ref.topLeft.row;
var K=M.col+J.ref.topLeft.col;
if(H._activeDrawing){var P=H._activeDrawing.topLeftCell;
if(P&&P.row==L&&P.col==K){N="k-spreadsheet-drawing-anchor-cell";
}}else{if(L==A.row&&K==A.col){N=[r.classNames.activeCell].concat(this._activeFormulaColor(),this._directionClasses(B));
if(H.singleCellSelection()){N.push(r.classNames.single);
}N=N.join(" ");
}}C.add(M);
k(D.children,M,N,I);
if(M.comment&&H._commentRef&&L==H._commentRef.row&&K==H._commentRef.col){var Q=4;
var O=q.dom.element("div",{className:"k-tooltip k-spreadsheet-cell-comment",style:{left:M.right+Q+"px",top:M.top+"px"}},[q.dom.text(M.comment)]);
D.children.push(O);
}},this);
C.vert.forEach(function(K){K.forEach(function(L){if(!L.rendered){L.rendered=true;
var M={left:L.x+"px",top:L.top+"px",height:L.bottom-L.top+1+"px",borderWidth:L.size+"px",borderColor:L.color};
if(L.size!=1){M.transform="translateX(-"+(L.size-1)/2+"px)";
}D.children.push(q.dom.element("div",{className:s.vborder,style:M}));
}});
});
C.horiz.forEach(function(K){K.forEach(function(L){if(!L.rendered){L.rendered=true;
var M={top:L.y+"px",left:L.left+"px",width:L.right-L.left+"px",borderWidth:L.size+"px",borderColor:L.color};
if(L.size!=1){M.transform="translateY(-"+(L.size-1)/2+"px)";
}D.children.push(q.dom.element("div",{className:s.hborder,style:M}));
}});
});
this.renderDrawings(E,D.children);
return D;
},renderDrawings:function(B,A){var C=this._sheet;
var D=C._workbook;
B.drawings.forEach(function(F){var H=F.drawing;
var E=F.box;
var G=E.toDiv("k-spreadsheet-drawing");
if(H.image){G.children.push(q.dom.element("div",{className:"k-spreadsheet-drawing-image",style:{backgroundImage:"url('"+D.imageUrl(H.image)+"')",opacity:H.opacity}}));
}if(H===C._activeDrawing){G.attr.className+=" k-spreadsheet-active-drawing";
m(G.children);
}A.push(G);
});
},renderResizeHandle:function(B){var E=this._sheet;
var D=E.resizeHandlePosition();
var C=this._rectangle(D);
var A=[r.classNames.resizeHandle];
var F;
if(D.col!==-Infinity){if(this._grid.rows._start>0){return;
}F={height:this._grid.headerHeight+"px",width:t+"px",left:C.right-t/2+"px",top:"0px"};
A.push(y.horizontalResize);
}else{if(this._grid.columns._start>0){return;
}F={height:t+"px",width:this._grid.headerWidth+"px",top:C.bottom-t/2+"px",left:"0px"};
A.push(y.verticalResize);
}B.push(q.dom.element("div",{className:A.join(" "),style:F}));
},filterIconRect:function(C){var B=16;
var A=3;
return new q.spreadsheet.Rectangle(C.right-B-A,C.top+A,B,B);
},renderFilterHeaders:function(){var F=this._sheet;
var A=[];
var B=w.classNames;
var C=F.filter();
function E(G){return q.dom.element("span",{className:B.icon+" "+G});
}function D(I,L,K){var M={left:L.left+"px",top:L.top+"px"};
var J=C&&C.columns.some(function(N){return N.index===K;
});
var H=I.filterButton;
if(J){H+=" "+I.filterButtonActive;
}var G=q.dom.element("span",{className:H,style:M},[E(I.iconFilterDefault)]);
return G;
}if(C){this._addDiv(A,C.ref,B.filterRange);
}F.forEachFilterHeader(this._currentView.ref,function(K){var J=this._rectangle(K);
var I=this.filterIconRect(J);
var H=this._sheet.filterColumn(K);
var G=D(B,I,H);
A.push(G);
}.bind(this));
return q.dom.element("div",{className:B.filterHeadersWrapper},A);
},renderEditorSelection:function(){var A=r.classNames;
var C=this._sheet;
var B=[];
C._formulaSelections.forEach(function(D){var E=D.ref;
if(E===q.spreadsheet.NULLREF){return;
}this._addDiv(B,E,A.selectionHighlight+" "+D.colorClass);
}.bind(this));
return q.dom.element("div",{className:A.selectionWrapper},B);
},renderSelection:function(C){var B=r.classNames;
var F=[];
var E=[B.selection];
var G=this._sheet;
var A=G.activeCell().toRangeRef();
var D=G.select();
E=E.concat(this._activeFormulaColor());
if(D.size()===1){E.push("k-single-selection");
}if(this._sheet.autoFillPunch()){E.push("k-dim-auto-fill-handle");
}D.forEach(function(H){if(H!==q.spreadsheet.NULLREF){this._addDiv(F,H,E.join(" "));
}}.bind(this));
this._renderCustomEditorButton(F,A,C);
return q.dom.element("div",{className:B.selectionWrapper},F);
},renderAutoFill:function(){var A=[];
if(this._sheet.autoFillInProgress()){var B=this._sheet.autoFillRef();
var F=this._sheet.autoFillPunch();
var D=this._sheet._autoFillDirection;
this._addDiv(A,B,"k-auto-fill");
if(F){this._addDiv(A,F,"k-auto-fill-punch");
}else{if(D!==undefined){var H,C;
switch(D){case 0:H=B.bottomRight;
C="k-auto-fill-br-hint";
break;
case 1:H=B.bottomRight;
C="k-auto-fill-br-hint";
break;
case 2:H=new h(B.topLeft.row,B.bottomRight.col);
C="k-auto-fill-tr-hint";
break;
case 3:H=new h(B.bottomRight.row,B.topLeft.col);
C="k-auto-fill-bl-hint";
break;
}var G=this._addDiv(A,H,C);
if(G){var E=q.dom.element("span",{className:"k-tooltip"},[q.dom.text(this._sheet._autoFillHint)]);
G.children.push(E);
}}}}return q.dom.element("div",{className:r.classNames.autoFillWrapper},A);
},_addDiv:function(B,D,A){var E=this._currentView,C;
if(E.ref.intersects(D)){C=this._rectangle(D).resize(1,1).toDiv(A);
B.push(C);
}return C;
},_renderCustomEditorButton:function(A,E,F){var G=this;
var H=G._sheet;
var I=G._currentView;
var B=G._grid.columns._axis._count;
var C=H.activeCellCustomEditor();
if(C&&I.ref.intersects(E)){var D=G._rectangle(E);
H.forEach(E.collapse(),function(O,M,L){L.left=D.left;
L.top=D.top;
L.width=D.width;
L.height=D.height;
var K="k-button k-spreadsheet-editor-button";
var N=M==B-1||G._buttonOutOfVisiblePane(O,M,F);
if(N){K+=" k-spreadsheet-last-column";
}G._editorInLastColumn=N;
var J=q.dom.element("div",{className:K,style:{left:L.left+(N?0:L.width)+"px",top:L.top+"px",height:L.height+"px"}});
if(C.icon){J.children.push(q.dom.element("span",{className:"k-icon "+C.icon}));
}A.push(J);
});
}},_activeFormulaColor:function(){var A;
var B=[];
if(this._sheet.isInEditMode()){A=this._sheet._formulaSelections.filter(function(C){return C.active&&C.type=="ref";
})[0];
if(A){B.push(A.colorClass);
}}return B;
},_directionClasses:function(A){var B=[];
var C=r.classNames;
var D=this._currentView.ref;
if(!A.move(0,-1).intersects(D)){B.push(C.left);
}if(!A.move(-1,0).intersects(D)){B.push(C.top);
}if(!A.move(0,1).intersects(D)){B.push(C.right);
}if(!A.move(1,0).intersects(D)){B.push(C.bottom);
}return B;
},_rectangle:function(A){return this._grid.boundingRectangle(A.toRangeRef()).offset(-this._currentView.mergedCellLeft,-this._currentView.mergedCellTop);
},_buttonOutOfVisiblePane:function(D,B,E){var G=this;
var I=G._grid;
var H=G._sheet;
var C=H.range(D,B)._ref;
var A=I.scrollBoundaries(C);
var F=I.columns.frozen?0:E.scrollLeft;
if(A.right+n>F||B+1===H.frozenColumns()){return true;
}}});
function m(A){["N","NE","E","SE","S","SW","W","NW"].forEach(function(B){A.push(q.dom.element("div",{className:"k-spreadsheet-drawing-handle "+B,"data-direction":B}));
});
}q.spreadsheet.View=w;
q.spreadsheet.Pane=r;
q.spreadsheet.drawCell=k;
a.extend(true,w,{classNames:y});
a.extend(true,r,{classNames:s});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/customeditors",["kendo.core","kendo.popup","kendo.calendar","kendo.listview","spreadsheet/sheet"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var a=c.jQuery;
var b={};
var d=c.spreadsheet.registerEditor=function(f,e){b[f]=e;
};
c.spreadsheet.Sheet.prototype.activeCellCustomEditor=function(){var e=this.activeCell().first();
if(this.range(e).enable()){var h=this.validation(e);
var g=this._properties.get("editor",this._grid.cellRefIndex(e));
var f;
if(g!=null){f=b[g];
}else{if(h&&h.showButton){g="_validation_"+h.dataType;
f=b[g];
}}if(typeof f=="function"){f=b[g]=f();
}return f;
}};
d("_validation_date",function(){var f,e,i;
function g(){if(!e){e=a("<div>").kendoCalendar();
i=a("<div>").kendoPopup();
e.appendTo(i);
e=e.getKendoCalendar();
i=i.getKendoPopup();
e.bind("change",function(){i.close();
var j=e.value();
if(!f.range.format()){f.range.format("yyyy-mm-dd");
}f.callback(c.spreadsheet.dateToNumber(j));
});
}i.setOptions({anchor:f.view.element.find(".k-spreadsheet-editor-button")});
}function h(){g();
var j=f.range.value();
if(j!=null){e.value(c.spreadsheet.numberToDate(j));
}else{e.value(null);
}var m=f.validation;
if(m){var l=c.ui.Calendar.fn.options.min;
var k=c.ui.Calendar.fn.options.max;
if(/^(?:greaterThan|between)/.test(m.comparerType)){l=c.spreadsheet.numberToDate(m.from.value);
}if(m.comparerType=="between"){k=c.spreadsheet.numberToDate(m.to.value);
}if(m.comparerType=="lessThan"){k=c.spreadsheet.numberToDate(m.from.value);
}e.setOptions({disableDates:function(n){var o=m.from?m.from.value|0:0;
var p=m.to?m.to.value|0:0;
n=c.spreadsheet.dateToNumber(n)|0;
return !c.spreadsheet.validation.validationComparers[m.comparerType](n,o,p);
},min:l,max:k});
}else{e.setOptions({disableDates:null,min:null,max:null});
}i.open();
}return{edit:function(j){f=j;
h();
},icon:"k-i-calendar"};
});
d("_validation_list",function(){var e,g,i;
function f(){if(!g){g=a("<ul class='k-list k-reset'/>").kendoStaticList({template:"#:value#",selectable:true,autoBind:false});
i=a("<div>").kendoPopup();
g.appendTo(i);
i=i.getKendoPopup();
g=g.getKendoStaticList();
g.bind("change",function(){i.close();
var j=g.value()[0];
if(j){e.callback(j.value);
}});
}i.setOptions({anchor:e.view.element.find(".k-spreadsheet-editor-button")});
}function h(){f();
var m=e.validation.from.value;
var k=[],j=function(n){k.push({value:n});
};
if(m instanceof c.spreadsheet.calc.runtime.Matrix){m.each(j);
}else{(m+"").split(/\s*,\s*/).forEach(j);
}var l=new c.data.DataSource({data:k});
g.setDataSource(l);
l.read();
i.open();
}return{edit:function(j){e=j;
h();
},icon:"k-i-arrow-60-down"};
});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/grid",["kendo.core","spreadsheet/references"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var a=c.spreadsheet.CellRef;
var e=c.spreadsheet.RangeRef;
var g=c.spreadsheet.UnionRef;
var f=c.Class.extend({init:function f(i,j,k,h){this.left=i;
this.top=j;
this.width=k;
this.height=h;
this.right=this.left+this.width;
this.bottom=this.top+this.height;
},offset:function(h,i){return new f(this.left+h,this.top+i,this.width,this.height);
},resize:function(i,h){return new f(this.left,this.top,this.width+i,this.height+h);
},intersects:function(h,i){if(h instanceof f){return this.intersectsRect(h);
}return this.left<h&&h<this.left+this.width&&this.top<i&&i<this.top+this.height;
},intersectsRect:function(i){var h=this;
return h.left<=i.right&&i.left<=h.right&&h.top<=i.bottom&&i.top<=h.bottom;
},toDiv:function(h){return c.dom.element("div",{className:h,style:{width:this.width+"px",height:this.height+"px",top:this.top+"px",left:this.left+"px"}});
}});
var b=c.Class.extend({init:function(m,i,l,h,j,k){this.rowCount=l;
this.columnCount=h;
this._columns=i;
this._rows=m;
this._headerHeight=j;
this._headerWidth=k;
},isAxis:function(i){i=i.toRangeRef();
var j=i.topLeft;
var h=i.bottomRight;
return j.row===0&&h.row===this.rowCount-1||j.col===0&&h.col===this.columnCount-1;
},width:function(i,h){return this._columns.sum(i,h);
},height:function(i,h){return this._rows.sum(i,h);
},totalHeight:function(){return this._rows.total+this._headerHeight;
},totalWidth:function(){return this._columns.total+this._headerWidth;
},index:function(i,h){return h*this.rowCount+i;
},cellRef:function(h){return new a(h%this.rowCount,h/this.rowCount>>0);
},rowRef:function(h){return new e(new a(h,0),new a(h,this.columnCount-1));
},colRef:function(h){return new e(new a(0,h),new a(this.rowCount-1,h));
},cellRefIndex:function(h){return this.index(h.row,h.col);
},normalize:function(h){if(h instanceof e){return new e(this.normalize(h.topLeft),this.normalize(h.bottomRight)).setSheet(h.sheet,h.hasSheet());
}if(h instanceof g){return h.map(function(i){return this.normalize(i);
},this);
}if(h instanceof a){h=h.clone();
h.col=Math.max(0,Math.min(this.columnCount-1,h.col));
h.row=Math.max(0,Math.min(this.rowCount-1,h.row));
}return h;
},rectangle:function(i){var j=this.normalize(i.topLeft);
var h=this.normalize(i.bottomRight);
return new f(this.width(0,j.col-1),this.height(0,j.row-1),this.width(j.col,h.col),this.height(j.row,h.row));
},pane:function(h){return new d(new c.spreadsheet.PaneAxis(this._rows,h.row,h.rowCount,this._headerHeight),new c.spreadsheet.PaneAxis(this._columns,h.column,h.columnCount,this._headerWidth),this);
},rangeDimensions:function(h){return{rows:this._rows.values.iterator(h.topLeft.row,h.bottomRight.row),columns:this._columns.values.iterator(h.topLeft.col,h.bottomRight.col)};
},forEach:function(k,i){var m=this.normalize(k.topLeft);
var h=this.normalize(k.bottomRight);
for(var j=m.col;
j<=h.col;
j++){for(var l=m.row;
l<=h.row;
l++){i(new a(l,j));
}}},trim:function(o,n){var q=this.normalize(o.topLeft);
var h=this.normalize(o.bottomRight);
var j=q.row;
var i=q.col;
for(var l=q.col;
l<=h.col;
l++){var p=this.index(q.row,l);
var m=this.index(h.row,l);
var r=n.tree.intersecting(p,m);
if(r.length){var k=this.cellRef(r[r.length-1].end);
j=Math.max(j,k.row);
i=l;
}}return new e(o.topLeft,new a(Math.min(j,o.bottomRight.row),i));
}});
var d=c.Class.extend({init:function(j,h,i){this.rows=j;
this.columns=h;
this._grid=i;
this.headerHeight=j.headerSize;
this.headerWidth=h.headerSize;
this.hasRowHeader=h.hasHeader;
this.hasColumnHeader=j.hasHeader;
},refresh:function(i,h){this.columns.viewSize(i);
this.rows.viewSize(h);
var j=this.columns.paneSegment();
var k=this.rows.paneSegment();
this.left=j.offset;
this.top=k.offset;
this.right=j.offset+j.length;
this.bottom=k.offset+k.length;
this.style={top:k.offset+"px",left:j.offset+"px",height:k.length+"px",width:j.length+"px"};
},view:function(i,k){var j=this.rows.visible(k);
var h=this.columns.visible(i);
return{rows:j,columns:h,rowOffset:j.offset,columnOffset:h.offset,mergedCellLeft:h.start,mergedCellTop:j.start,ref:new e(new a(j.values.start,h.values.start),new a(j.values.end,h.values.end))};
},contains:function(h){return this.rows.contains(h.topLeft.row,h.bottomRight.row)&&this.columns.contains(h.topLeft.col,h.bottomRight.col);
},index:function(i,h){return this._grid.index(i,h);
},boundingRectangle:function(h){return this._grid.rectangle(h);
},cellRefIndex:function(h){return this._grid.cellRefIndex(h);
},scrollBoundaries:function(i){var k=this.boundingRectangle(i);
var h={top:Math.max(0,k.top-this.top+(this.hasColumnHeader?0:this.headerHeight)),left:Math.max(0,k.left-this.left+(this.hasRowHeader?0:this.headerWidth)),right:k.right-this.columns._viewSize+this.headerWidth,bottom:k.bottom-this.rows._viewSize+this.headerHeight};
var l=this.columns.defaultValue/2;
var j=this.rows.defaultValue/2;
h.scrollTop=h.top-j;
h.scrollBottom=h.bottom+j;
h.scrollLeft=h.left-l;
h.scrollRight=h.right+l;
return h;
}});
c.spreadsheet.Grid=b;
c.spreadsheet.PaneGrid=d;
c.spreadsheet.Rectangle=f;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/axis",["kendo.core"],b);
}(function(){(function(b){if(b.support.browser.msie&&b.support.browser.version<9){return;
}var a=b.Class.extend({init:function(d,e){this._value=e;
this._count=d;
this.values=new b.spreadsheet.RangeList(0,d-1,e);
this._hidden=new b.spreadsheet.RangeList(0,d-1,0);
this.scrollBarSize=b.support.scrollbar();
this._refresh();
},adjust:function(e,d){if(d<0){this.values.copy(e-d,this._count-1,e);
this._hidden.copy(e-d,this._count-1,e);
}else{this.values.copy(e,this._count,e+d);
this._hidden.copy(e,this._count,e+d);
this.values.value(e,e+d-1,this._value);
this._hidden.value(e,e+d-1,0);
}this._refresh();
},toJSON:function(d,j){var l=[];
var h=this.values.iterator(0,this._count-1);
for(var f=0;
f<this._count;
f++){var k=h.at(f);
var e=this._hidden.value(f,f);
if(k===this._value&&!e){continue;
}var i=j[f];
if(i===undefined){i=l.length;
var g={index:f};
g[d]=k;
if(e){g.hidden=e;
}l.push(g);
j[f]=i;
}}return l;
},fromJSON:function(e,i){for(var f=0;
f<i.length;
f++){var d=i[f];
var g=d.index;
if(g===undefined){g=f;
}var h=d[e];
if(h===0){this._hidden.value(g,g,d.hidden||this._value);
this.value(g,g,0);
}else{this.value(g,g,h);
}}},hide:function(d){if(!this.hidden(d)){var e=this.value(d,d);
this._hidden.value(d,d,e);
this.value(d,d,0);
}},hidden:function(d){return this._hidden.value(d,d)!==0;
},includesHidden:function(e,d){return this._hidden.intersecting(e,d).length>1;
},nextVisible:function(f){var d=this._count-1,e=f;
while(++e<=d){if(!this.hidden(e)){return e;
}}return f;
},nextPage:function(d,e){return this.index(this.sum(0,d-1)+e);
},prevPage:function(d,e){return this.index(this.sum(0,d)-e);
},firstVisible:function(){var d=this._hidden.first();
if(d.value===0){return 0;
}else{return d.end+1;
}},lastVisible:function(){var d=this._hidden.last();
if(d.value===0){return this._count-1;
}else{return d.start-1;
}},prevVisible:function(e){var d=e;
while(--d>=0){if(!this.hidden(d)){return d;
}}return e;
},unhide:function(d){if(this.hidden(d)){var e=this._hidden.value(d,d);
this._hidden.value(d,d,0);
this.value(d,d,e);
}},value:function(e,d,f){if(f!==undefined){this.values.value(e,d,f);
this._refresh();
}else{return this.values.iterator(e,d).at(0);
}},sum:function(f,d){var h=this.values.iterator(f,d);
var g=0;
for(var e=f;
e<=d;
e++){g+=h.at(e);
}return g;
},locate:function(g,d,f){var j=this.values.iterator(g,d);
var h=0;
for(var e=g;
e<=d;
e++){h+=j.at(e);
var i=f(h);
if(i){return e;
}}return null;
},visible:function(k,d){var n=null;
var g=null;
var h=false;
if(d>=this.total+this.scrollBarSize){h=true;
}var j=this._pixelValues.intersecting(k,d);
n=j[0];
g=j[j.length-1];
if(!n){return{values:this.values.iterator(0,0),offset:0};
}var m=k-n.start;
var l=(m/n.value.value>>0)+n.value.start;
var i=m-(l-n.value.start)*n.value.value;
var f=d-g.start;
var e=(f/g.value.value>>0)+g.value.start;
if(e>g.value.end){e=g.value.end;
}if(h){i+=g.value.value-(f-(e-g.value.start)*g.value.value);
}i=Math.min(-i,0);
return{values:this.values.iterator(l,e),offset:i};
},index:function(g){var e=0;
var f=this.values.iterator(0,this._count-1);
var d=f.at(0);
while(d<g&&e<this._count-1){d+=f.at(++e);
}return e;
},indexVisible:function(e){var d=this.index(e);
if(this.hidden(d)){d=this.prevVisible(d);
}return d;
},_refresh:function(){var d=0;
this._pixelValues=this.values.map(function(f){var g=d;
d+=(f.end-f.start+1)*f.value;
var e=d-1;
return new b.spreadsheet.ValueRange(g,e,f);
});
this.total=d;
},getState:function(){return{values:this.values.getState(),hidden:this._hidden.getState()};
},setState:function(d){this.values.setState(d.values);
this._hidden.setState(d.hidden);
this._refresh();
}});
var c=b.Class.extend({init:function(d,g,e,f){this._axis=d;
this._start=g;
this._count=e;
this.hasHeader=g===0;
this.headerSize=f;
this.defaultValue=d._value;
this.frozen=e>0;
},viewSize:function(d){this._viewSize=d;
},sum:function(e,d){return this._axis.sum(e,d-1);
},start:function(){return this.sum(0,this._start);
},size:function(){return this.sum(this._start,this._start+this._count);
},index:function(e,d){return this._axis.index(e+(this.frozen?0:d)-this.headerSize);
},indexVisible:function(e,d){return this._axis.indexVisible(e+(this.frozen?0:d)-this.headerSize);
},paneSegment:function(){var e=this.start();
var d;
if(!this.hasHeader){e+=this.headerSize;
}if(this.frozen){d=this.size();
if(this.hasHeader){d+=this.headerSize;
}else{d-=this.headerSize;
}}else{d=this._viewSize-e;
}return{offset:e,length:d};
},visible:function(d){var g=this.start();
var f;
if(this.frozen){f=this.size();
if(!this.hasHeader){f-=this.headerSize;
}}else{f=this._viewSize-g-this.headerSize;
g+=d;
}var e=this._axis.visible(g,g+f-1);
if(this.frozen){e.offset=0;
}e.start=g;
if(this.hasHeader){e.offset+=this.headerSize;
e.start-=this.headerSize;
}return e;
},contains:function(e,d){if(this.frozen){if(e>this._start+this._count){return false;
}if(d<this._start){return false;
}return true;
}else{return d>=this._start;
}}});
b.spreadsheet.Axis=a;
b.spreadsheet.PaneAxis=c;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/filter",["kendo.core","kendo.data"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var c=d.spreadsheet.Filter=d.Class.extend({prepare:function(){},value:function(k){return k.value;
},matches:function(){throw new Error("The 'matches' method is not implemented.");
},toJSON:function(){throw new Error("The 'toJSON' method is not implemented.");
}});
c.create=function(m){var l=m.filter;
if(!l){throw new Error("Filter type not specified.");
}var k=d.spreadsheet[l.charAt(0).toUpperCase()+l.substring(1)+"Filter"];
if(!k){throw new Error("Filter type not recognized.");
}return new k(m);
};
d.spreadsheet.ValueFilter=c.extend({_values:[],_dates:[],_blanks:false,init:function j(k){if(k.values!==undefined){this._values=k.values;
}if(k.blanks!==undefined){this._blanks=k.blanks;
}if(k.dates!==undefined){this._dates=k.dates;
}},value:function(k){var m=k.value;
if(this._dates.length>0&&k.format&&typeof m==="number"){var l=d.spreadsheet.formatting.type(m,k.format);
if(l==="date"){m=d.spreadsheet.numberToDate(m);
}}return m;
},matches:function(k){if(k===null||k===undefined){return this._blanks;
}if(k instanceof Date){return this._dates.some(function(l){return l.year===k.getFullYear()&&(l.month===undefined||l.month===k.getMonth())&&(l.day===undefined||l.day===k.getDate())&&(l.hours===undefined||l.hours===k.getHours())&&(l.minutes===undefined||l.minutes===k.getMinutes())&&(l.seconds===undefined||l.seconds===k.getSeconds());
});
}return this._values.indexOf(k)>=0;
},toJSON:function(){return{filter:"value",blanks:this._blanks,values:this._values.slice(0)};
}});
d.spreadsheet.CustomFilter=c.extend({_logic:"and",init:function a(l){if(l.logic!==undefined){this._logic=l.logic;
}if(l.criteria===undefined){throw new Error("Must specify criteria.");
}this._criteria=l.criteria;
var k=d.data.Query.filterExpr({logic:this._logic,filters:this._criteria}).expression;
this._matches=new Function("d","return "+k);
},matches:function(k){if(k===null){return false;
}return this._matches(k);
},value:function(k){var n=k.value;
var m=this._criteria[0].value;
var l=m instanceof Date?"date":typeof m;
var o=typeof n;
if(k.format){o=d.spreadsheet.formatting.type(n,k.format);
}if(o!=l){if(l=="string"){if(k.format){n=d.spreadsheet.formatting.text(n,k.format);
}n=n+"";
}}else{if(o=="date"){n=d.spreadsheet.numberToDate(n);
}}return n;
},toJSON:function(){return{filter:"custom",logic:this._logic,criteria:this._criteria};
}});
d.spreadsheet.TopFilter=c.extend({init:function i(k){this._type=k.type;
this._value=k.value;
this._values=[];
},prepare:function(k){var m=k.map(this.value).sort().filter(function(p,o,n){return o===0||p!==n[o-1];
});
if(this._type==="topNumber"||this._type=="topPercent"){m.sort(function(n,o){return o-n;
});
}else{m.sort(function(n,o){return n-o;
});
}var l=this._value;
if(this._type==="topPercent"||this._type==="bottomPercent"){l=m.length*l/100>>0;
}this._values=m.slice(0,l);
},matches:function(k){return this._values.indexOf(k)>=0;
},toJSON:function(){return{filter:"top",type:this._type,value:this._value};
}});
d.spreadsheet.DynamicFilter=c.extend({init:function b(k){this._type=k.type;
this._predicate=this[k.type];
if(typeof this._predicate!=="function"){throw new Error("DynamicFilter type '"+k.type+"' not recognized.");
}},value:function(k){var m=k.value;
if(k.format){var l=d.spreadsheet.formatting.type(m,k.format);
if(l==="date"){m=d.spreadsheet.numberToDate(m);
}}return m;
},prepare:function(k){var n=0;
var m=0;
for(var l=0;
l<k.length;
l++){var o=this.value(k[l]);
if(typeof o==="number"){n+=o;
m++;
}}if(m>0){this._average=n/m;
}else{this._average=0;
}},matches:function(k){return this._predicate(k);
},aboveAverage:function(k){if(k instanceof Date){k=d.spreadsheet.dateToNumber(k);
}if(typeof k!=="number"){return false;
}return k>this._average;
},belowAverage:function(k){if(k instanceof Date){k=d.spreadsheet.dateToNumber(k);
}if(typeof k!=="number"){return false;
}return k<this._average;
},tomorrow:function(l){if(l instanceof Date){var k=d.date.addDays(d.date.today(),1);
return d.date.getDate(l).getTime()===k.getTime();
}return false;
},today:function(k){if(k instanceof Date){return d.date.isToday(k);
}return false;
},yesterday:function(k){if(k instanceof Date){var l=d.date.addDays(d.date.today(),-1);
return d.date.getDate(k).getTime()===l.getTime();
}return false;
},nextWeek:function(k){return g(d.date.addDays(d.date.today(),7),k);
},thisWeek:function(k){return g(d.date.today(),k);
},lastWeek:function(k){return g(d.date.addDays(d.date.today(),-7),k);
},nextMonth:function(k){return f(k,1);
},thisMonth:function(k){return f(k,0);
},lastMonth:function(k){return f(k,-1);
},nextQuarter:function(m){if(m instanceof Date){var l=d.date.today();
var k=e(m)-e(l);
return k===1&&l.getFullYear()===m.getFullYear()||k==-3&&l.getFullYear()+1===m.getFullYear();
}return false;
},thisQuarter:function(m){if(m instanceof Date){var l=d.date.today();
var k=e(m)-e(l);
return k===0&&l.getFullYear()===m.getFullYear();
}return false;
},lastQuarter:function(m){if(m instanceof Date){var l=d.date.today();
var k=e(l)-e(m);
return k===1&&l.getFullYear()===m.getFullYear()||k==-3&&l.getFullYear()-1===m.getFullYear();
}return false;
},nextYear:function(k){return h(k,1);
},thisYear:function(k){return h(k,0);
},lastYear:function(k){return h(k,-1);
},yearToDate:function(l){if(l instanceof Date){var k=d.date.today();
return l.getFullYear()===k.getFullYear()&&l<=k;
}return false;
},toJSON:function(){return{filter:"dynamic",type:this._type};
}});
[1,2,3,4].forEach(function(k){d.spreadsheet.DynamicFilter.prototype["quarter"+k]=function(l){if(l instanceof Date){return e(l)===k;
}return false;
};
});
d.cultures["en-US"].calendar.months.names.forEach(function(l,k){d.spreadsheet.DynamicFilter.prototype[l.toLowerCase()]=function(m){if(m instanceof Date){return m.getMonth()===k;
}return false;
};
});
function e(l){var k=l.getMonth()+1;
if(k>=1&&k<=3){return 1;
}else{if(k>=4&&k<=6){return 2;
}else{if(k>=7&&k<=9){return 3;
}else{return 4;
}}}}function h(m,k){if(m instanceof Date){var l=d.date.today();
l.setFullYear(l.getFullYear()+k);
return l.getFullYear()===m.getFullYear();
}return false;
}function f(m,k){if(m instanceof Date){var l=d.date.firstDayOfMonth(d.date.today());
l.setMonth(l.getMonth()+k,1);
return l.getTime()===d.date.firstDayOfMonth(m).getTime();
}return false;
}function g(k,l){if(l instanceof Date){var m=d.date.dayOfWeek(d.date.getDate(k),1);
var n=d.date.dayOfWeek(d.date.getDate(l),1);
return m.getTime()===n.getTime();
}return false;
}}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/sorter",["kendo.core"],b);
}(function(){(function(a){if(a.support.browser.msie&&a.support.browser.version<9){return;
}var b=a.Class.extend({init:function(c,d){this._grid=c;
this._lists=d;
},indices:function(g,f,c,e){var d=b.ascendingComparer;
if(c===false){d=b.descendingComparer;
}return f.sortedIndices(this._grid.cellRefIndex(g.topLeft),this._grid.cellRefIndex(g.bottomRight),d,e);
},sortBy:function(j,e,i,c,g){var k=this.indices(j.toColumn(e),i,c,g);
for(var d=j.topLeft.col;
d<=j.bottomRight.col;
d++){var l=this._grid.index(j.topLeft.row,d);
var f=this._grid.index(j.bottomRight.row,d);
for(var h=0;
h<this._lists.length;
h++){if(l<this._lists[h].lastRangeStart()){this._lists[h].sort(l,f,k);
}}}return k;
}});
b.ascendingComparer=function(c,d){if(c===null&&d===null){return 0;
}if(c===null){return 1;
}if(d===null){return -1;
}var e=typeof c;
var f=typeof d;
if(e==="number"){if(f==="number"){return c-d;
}else{return -1;
}}if(e==="string"){switch(f){case"number":return 1;
case"string":return c.localeCompare(d);
default:return -1;
}}if(e==="boolean"){switch(f){case"number":return 1;
case"string":return 1;
case"boolean":return c-d;
default:return -1;
}}if(c instanceof a.spreadsheet.calc.runtime.CalcError){if(d instanceof a.spreadsheet.calc.runtime.CalcError){return 0;
}else{return 1;
}}throw new Error("Cannot compare "+c+" and "+d);
};
b.descendingComparer=function(c,d){if(c===null&&d===null){return 0;
}if(c===null){return 1;
}if(d===null){return -1;
}return b.ascendingComparer(d,c);
};
a.spreadsheet.Sorter=b;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/numformat",["spreadsheet/calc","kendo.dom","util/main"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var r=kendo.util;
var b=kendo.spreadsheet.calc;
var f=kendo.dom;
var m=/^\[(black|green|white|blue|magenta|yellow|cyan|red)\]/i;
var n=/^\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\]/;
function j(u){u=b.InputStream(u);
var C=[],t=false,s;
while(!u.eof()){var B=A();
C.push(B);
if(B.cond){t=true;
}}if(!t){if(C.length==1){C[0].cond="num";
}else{if(C.length==2){C[0].cond={op:">=",value:0};
C[1].cond={op:"<",value:0};
}else{if(C.length>=3){C[0].cond={op:">",value:0};
C[1].cond={op:"<",value:0};
C[2].cond={op:"=",value:0};
if(C.length>3){C[3].cond="text";
C=C.slice(0,4);
}}}}}return C;
function v(){var D=u.skip(m);
if(D){return D[1].toLowerCase();
}}function w(){var D=u.skip(n);
if(D){var E=parseFloat(D[2]);
if(!isNaN(E)){return{op:D[1],value:E,custom:true};
}}}function y(){var D=[],F,E=null;
while(!u.eof()&&(F=z())){if(F.type=="date"){if(E&&/^(el)?time$/.test(E.type)&&E.part=="h"&&F.part=="m"&&F.format<3){F.type="time";
}}else{if(/^(el)?time$/.test(F.type)&&F.part=="s"){if(E&&E.type=="date"&&E.part=="m"&&E.format<3){E.type="time";
}}}if(!/^(?:str|space|fill)$/.test(F.type)){E=F;
}D.push(F);
}return D;
}function x(E){if(E.type!="date"||E.part=="m"&&E.format<3){var D=u.skip(/^\.(0+)/);
if(D){E.fraction=D[1].length;
if(E.type=="date"){E.type="time";
}}}return E;
}function z(){var D,E;
if(E=u.skip(/^([#0?]+)(?:,([#0?]+))+/)){return{type:"digit",sep:true,format:E[1]+E[2],decimal:s};
}if(E=u.skip(/^[#0?]+/)){return{type:"digit",sep:false,format:E[0],decimal:s};
}if(E=u.skip(/^(e)([+-])/i)){return{type:"exp",ch:E[1],sign:E[2]};
}if(E=u.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)){E=E[1].toLowerCase();
return x({type:"date",part:E.charAt(0),format:E.length});
}if(E=u.skip(/^(hh?|ss?)/i)){E=E[1].toLowerCase();
return x({type:"time",part:E.charAt(0),format:E.length});
}if(E=u.skip(/^\[(hh?|mm?|ss?)\]/i)){E=E[1].toLowerCase();
return x({type:"eltime",part:E.charAt(0),format:E.length});
}if(E=u.skip(/^(a[.]?m[.]?\/p[.]?m[.]?|a\/p)/i)){E=E[1].split("/");
return{type:"ampm",am:E[0],pm:E[1]};
}switch(D=u.next()){case";":return null;
case"\\":return{type:"str",value:u.next()};
case'"':return{type:"str",value:u.readEscaped(D)};
case"@":return{type:"text"};
case"_":return{type:"space",value:u.next()};
case"*":return{type:"fill",value:u.next()};
case".":if(u.lookingAt(/^\s*[#0?]/)){s=true;
return{type:"dec"};
}return{type:"str",value:"."};
case"%":return{type:"percent"};
case",":return{type:"comma"};
}return{type:"str",value:D};
}function A(){s=false;
var D=v(),E=w();
if(!D&&E){D=v();
}return{color:D,cond:E,body:y()};
}}function k(v){return v.map(t).join(";");
function t(x){var w="";
if(x.color){w+="["+x.color+"]";
}if(x.cond){if(!(x.cond=="text"||x.cond=="num")){w+="["+x.cond.op+x.cond.value+"]";
}}w+=x.body.map(u).join("");
return w;
}function s(w,x){if(x.fraction){w+="."+h("",x.fraction,"0");
}return w;
}function u(w){if(w.type=="digit"){if(w.sep){return w.format.charAt(0)+","+w.format.substr(1);
}else{return w.format;
}}else{if(w.type=="exp"){return w.ch+w.sign;
}else{if(w.type=="date"||w.type=="time"){return s(h("",w.format,w.part),w);
}else{if(w.type=="eltime"){return s("["+h("",w.format,w.part)+"]",w);
}else{if(w.type=="ampm"){return w.am+"/"+w.pm;
}else{if(w.type=="str"){return JSON.stringify(w.value);
}else{if(w.type=="text"){return"@";
}else{if(w.type=="space"){return"_"+w.value;
}else{if(w.type=="fill"){return"*"+w.value;
}else{if(w.type=="dec"){return".";
}else{if(w.type=="percent"){return"%";
}else{if(w.type=="comma"){return",";
}}}}}}}}}}}}}}function a(s,t){s.forEach(function(y){var w=t;
if(y.cond=="text"){return;
}var v=y.body,u=false,x=v.length;
while(w!==0&&--x>=0){var A=v[x];
if(A.type=="digit"){if(A.decimal){u=true;
if(w>0){A.format+=h("",w,"0");
}else{if(w<0){var z=A.format.length;
A.format=A.format.substr(0,z+w);
w+=z-A.format.length;
}}if(A.format.length===0){v.splice(x,1);
while(--x>=0){A=v[x];
if(A.type=="digit"&&A.decimal){++x;
break;
}if(A.type=="dec"){v.splice(x,1);
break;
}}}}if(w>0){break;
}}}if(!u&&w>0){v.splice(x+1,0,{type:"dec"},{type:"digit",sep:false,decimal:true,format:h("",w,"0")});
}});
}function q(t){var s=0;
return{next:function(){return t[s++];
},eof:function(){return s>=t.length;
},ahead:function(v,u){if(s+v<=t.length){var w=u.apply(null,t.slice(s,s+v));
if(w){s+=v;
}return w;
}},restart:function(){s=0;
}};
}function d(y){var C=q(y.body);
var A=false;
var B=false;
var z=false;
var F=0;
var v=/[\$\xA2-\xA5\u058F\u060B\u09F2\u09F3\u09FB\u0AF1\u0BF9\u0E3F\u17DB\u20A0-\u20BD\uA838\uFDFC\uFE69\uFF04\uFFE0\uFFE1\uFFE5\uFFE6]/;
var H=0;
var t="var intPart, decPart, isNegative, date, time; ";
var I=false;
var x=0;
var D=[],w=[];
var u=y.cond;
var G="";
if(u=="text"){G="if (typeof value == 'string' || value instanceof kendo.spreadsheet.CalcError) { ";
}else{if(u=="num"){G="if (typeof value == 'number') { ";
}else{if(u){var E=u.op=="="?"==":u.op;
G="if (typeof value == 'number' && value "+E+" "+u.value+") { ";
if(!u.custom){t+="value = Math.abs(value); ";
}}}}if(y.color){t+="result.color = "+JSON.stringify(y.color)+"; ";
}function s(K,L){if(K.type=="digit"&&L.type=="comma"||K.type=="comma"&&K.hidden&&L.type=="comma"){L.hidden=true;
H++;
}}while(!C.eof()){C.ahead(2,s);
var J=C.next();
if(J.type=="percent"){F++;
}else{if(J.type=="digit"){if(J.decimal){x+=J.format.length;
w.push(J.format);
}else{D.push(J.format);
if(J.sep){I=true;
}}}else{if(J.type=="time"){B=true;
}else{if(J.type=="date"){A=true;
}else{if(J.type=="ampm"){z=B=true;
}}}}}}if(F>0){t+="value *= "+Math.pow(100,F)+"; ";
}if(H>0){t+="value /= "+Math.pow(1000,H)+"; ";
}if(D.length){t+="intPart = runtime.formatInt(culture, value, "+JSON.stringify(D)+", "+x+", "+I+"); ";
t+="isNegative = parseInt(intPart[0]) < 0;";
}if(w.length){t+="decPart = runtime.formatDec(value, "+JSON.stringify(w)+", "+x+"); ";
}if(D.length||w.length){t+="type = 'number'; ";
}if(A){t+="date = runtime.unpackDate(value); ";
}if(B){t+="time = runtime.unpackTime(value); ";
}if(A||B){t+="type = 'date'; ";
}if(F>0||H>0||D.length||w.length||A||B){if(!G){G="if (typeof value == 'number') { ";
}}C.restart();
t+="var matchedCurrency = false;";
while(!C.eof()){var J=C.next();
if(J.type=="dec"){t+="output += culture.numberFormat['.']; ";
}else{if(J.type=="comma"&&!J.hidden){t+="output += ','; ";
}else{if(J.type=="percent"){t+="type = 'percent'; ";
t+="output += culture.numberFormat.percent.symbol; ";
}else{if(J.type=="str"){if(v.test(J.value)){t+="type = 'currency'; ";
t+="if (isNegative) { output += '-'; matchedCurrency = true; }";
}t+="output += "+JSON.stringify(J.value)+"; ";
}else{if(J.type=="text"){t+="type = 'text'; ";
t+="output += value; ";
}else{if(J.type=="space"){t+="if (output) result.body.push(output); ";
t+="output = ''; ";
t+="result.body.push({ type: 'space', value: "+JSON.stringify(J.value)+" }); ";
}else{if(J.type=="fill"){t+="output += runtime.fill("+JSON.stringify(J.value)+"); ";
}else{if(J.type=="digit"){t+="if (isNegative && intPart[0] && matchedCurrency) {intPart[0] = intPart[0].replace('-', '');}";
t+="output += "+(J.decimal?"decPart":"intPart")+".shift(); ";
}else{if(J.type=="date"){t+="output += runtime.date(culture, date, "+JSON.stringify(J.part)+", "+J.format+"); ";
}else{if(J.type=="time"){t+="output += runtime.time(time, "+JSON.stringify(J.part)+", "+J.format+", "+z+", "+J.fraction+"); ";
}else{if(J.type=="eltime"){t+="output += runtime.eltime(value, "+JSON.stringify(J.part)+", "+J.format+", "+J.fraction+"); ";
}else{if(J.type=="ampm"){t+="output += time.hours < 12 ? "+JSON.stringify(J.am)+" : "+JSON.stringify(J.pm)+"; ";
}}}}}}}}}}}}}t+="if (output) result.body.push(output); ";
t+="result.type = type; ";
t+="return result; ";
if(G){t=G+t+"}";
}return t;
}var p=d({cond:"text",body:[{type:"text"}]});
var c=r.memoize(function(t){var u=j(t);
var s=u.map(d);
s.push(p);
s=s.join("\n");
s="'use strict'; return function(value, culture){ if (!culture) culture = kendo.culture(); var output = '', type = null, result = { body: [] }; "+s+"; return result; };";
return new Function("runtime",s)(l);
});
var g=r.memoize(function(s){var A=j(s);
var z,t=false,u=false;
for(var v=0;
v<A.length;
++v){z=A[v];
for(var w=0;
w<z.body.length;
++w){if(/^(?:date|time|ampm)$/.test(z.body[w].type)){t=true;
if(z.body[w].type=="ampm"){u=true;
}}}if(t){break;
}}if(!t){return null;
}return z.body.map(y).join("");
function x(B,C){if(C.fraction){B+=h("",Math.max(C.fraction,3),"f");
}return B;
}function y(C){if(C.type=="digit"){if(C.sep){return C.format.charAt(0)+","+C.format.substr(1);
}else{return C.format;
}}else{if(C.type=="exp"){return C.ch+C.sign;
}else{if(C.type=="date"||C.type=="time"){var B=C.part;
if(C.type=="date"&&/^m/.test(B)){B="M";
}else{if(C.type=="time"&&/^h/.test(B)){if(!u){B=B.toUpperCase();
}}}return x(h("",C.format,B),C);
}else{if(C.type=="ampm"){return"tt";
}else{if(C.type=="str"){return C.value;
}else{if(C.type=="space"){return" ";
}else{if(C.type=="dec"){return".";
}else{if(C.type=="percent"){return"%";
}else{if(C.type=="comma"){return",";
}else{return"";
}}}}}}}}}}});
var l={unpackDate:b.runtime.unpackDate,unpackTime:b.runtime.unpackTime,date:function(s,t,v,u){switch(v){case"d":switch(u){case 1:return t.date;
case 2:return h(t.date,2,"0");
case 3:return s.calendars.standard.days.namesAbbr[t.day];
case 4:return s.calendars.standard.days.names[t.day];
}break;
case"m":switch(u){case 1:return t.month+1;
case 2:return h(t.month+1,2,"0");
case 3:return s.calendars.standard.months.namesAbbr[t.month];
case 4:return s.calendars.standard.months.names[t.month];
case 5:return s.calendars.standard.months.names[t.month].charAt(0);
}break;
case"y":switch(u){case 2:return t.year%100;
case 4:return t.year;
}break;
}return"##";
},time:function(z,x,w,s,u){var y,v;
switch(x){case"h":y=h(s?z.hours%12||12:z.hours,w,"0");
if(u){v=(z.minutes+(z.seconds+z.milliseconds/1000)/60)/60;
}break;
case"m":y=h(z.minutes,w,"0");
if(u){v=(z.seconds+z.milliseconds/1000)/60;
}break;
case"s":y=h(z.seconds,w,"0");
if(u){v=z.milliseconds/1000;
}break;
}if(v){y+=l.toFixed(v,u).replace(/^0+/,"");
}return y;
},eltime:function(x,v,u,s){var w,t;
switch(v){case"h":w=x*24;
break;
case"m":w=x*24*60;
break;
case"s":w=x*24*60*60;
break;
}if(s){t=w-(w|0);
}w=h(w|0,u,"0");
if(t){w+=l.toFixed(t,s).replace(/^0+/,"");
}return w;
},fill:function(s){return s;
},formatInt:function(u,H,C,v,E){H=l.toFixed(H,v).replace(/\..*$/,"");
var A=C[C.length-1];
if(v>0&&A[C.length-1]!="0"){if(H==="0"){H="";
}else{if(H==="-0"){H="-";
}}}var F=false;
var x=H.length-1;
var D=[];
var B=0,G;
function s(I,J){if(E&&B&&B%3===0&&/^[0-9]$/.test(I)){G=u.numberFormat[","]+G;
}if(J&&I==="-"){F=true;
I="0";
}G=I+G;
B++;
}for(var y=C.length;
--y>=0;
){var w=C[y];
G="";
for(var z=w.length;
--z>=0;
){var t=w.charAt(z);
if(x<0){if(t=="0"){s("0");
}else{if(t=="?"){s(" ");
}}}else{if(H=="0"&&t=="?"){s(" ");
}else{if(t=="0"){s(H.charAt(x),true);
}else{s(H.charAt(x));
}}x--;
}}if(y===0){while(x>=0){s(H.charAt(x--));
}}D.unshift(G);
}if(F){D[0]="-"+D[0];
}return D;
},formatDec:function(C,y,t){C=l.toFixed(C,t);
var z=C.indexOf(".");
if(z>=0){C=C.substr(z+1).replace(/0+$/,"");
}else{C="";
}var v=0;
var A=[];
for(var w=0;
w<y.length;
++w){var u=y[w];
var B="";
for(var x=0;
x<u.length;
++x){var s=u.charAt(x);
if(v<C.length){B+=C.charAt(v++);
}else{if(s=="0"){B+="0";
}else{if(s=="?"){B+=" ";
}}}}A.push(B);
}return A;
},toFixed:function(u,s){return function t(A,y){if(!isFinite(A)){return"#NUM!";
}if(A<0){return"-"+t(-A);
}if(s===0){return String(Math.round(A));
}if(A===Math.round(A)&&!/e/i.test(String(A))){return A.toFixed(s);
}var z=e(A);
var x=z.intpart;
var v=z.decpart;
if(v.length<=s){while(v.length<s){v+="0";
}return x+"."+v;
}if(y){return x+"."+v.substr(0,s);
}var w=Math.pow(10,s);
return t(Math.round(A*w)/w,true);
}(Number(u.toFixed(14)));
}};
function h(t,u,s){t+="";
while(t.length<u){t=s+t;
}return t;
}function i(t,u,s){t+="";
while(t.length<u){t+=s;
}return t;
}function e(w){var y=String(w).toLowerCase();
var u,s,v;
var x=y.indexOf(".");
if(x<0){x=y.indexOf("e");
if(x<0){u=y;
s="";
}else{u=y.substr(0,x);
s=y.substr(x);
}}else{u=y.substr(0,x);
s=y.substr(x+1);
}if(v=/(\d*)e([-+]?\d+)/.exec(s)){var t=parseInt(v[2],10);
if(t>=0){s=i(v[1],t,"0");
u+=s.substr(0,t);
s=s.substr(t);
}else{u=h(u,-t,"0");
s=u.substr(t)+v[1];
u=u.substr(0,u.length+t);
}}return{intpart:u||"0",decpart:s};
}function o(u){var s=u.body;
var w="";
for(var v=0;
v<s.length;
++v){var t=s[v];
if(typeof t=="string"){w+=t;
}else{if(t.type=="space"){w+=" ";
}}}return w;
}kendo.spreadsheet.formatting={compile:c,parse:j,format:function(z,w,t){var v=c(w)(z,t);
var y=f.element("span");
y.__dataType=v.type;
var s=v.body;
if(v.color){y.attr.style={color:v.color};
}for(var x=0;
x<s.length;
++x){var u=s[x];
if(typeof u=="string"){y.children.push(f.text(u));
}else{if(u.type=="space"){y.children.push(f.element("span",{style:{visibility:"hidden"}},[f.text(u.value)]));
}}}return y;
},text:function(v,u,s){var t=c(u)(v,s);
return o(t);
},textAndColor:function(v,u,s){var t=c(u)(v,s);
return{text:o(t),color:t.color,type:t.type};
},type:function(t,s){return c(s)(t).type;
},adjustDecimals:function(u,t){var s=j(u);
a(s,t);
return k(s);
},makeDateFormat:g};
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/runtime.functions",["spreadsheet/runtime","util/main"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var U=kendo.util;
var R=kendo.spreadsheet;
var x=R.calc;
var P=x.runtime;
var D=P.defineFunction;
var C=P.defineAlias;
var y=P.CalcError;
var N=R.RangeRef;
var z=R.CellRef;
var S=R.UnionRef;
var J=P.Matrix;
var O=R.Ref;
var A=P.daysInMonth;
var L=P.packDate;
var T=P.unpackDate;
var B=P.daysInYear;
["abs","cos","sin","acos","asin","tan","atan","exp","sqrt"].forEach(function(W){D(W,Math[W]).args([["*n","number"]]);
});
D("ln",Math.log).args([["*n","number"]]);
D("log",function(X,W){return Math.log(X)/Math.log(W);
}).args([["*num","number++"],["*base",["or","number++",["null",10]]],["?",["assert","$base != 1","DIV/0"]]]);
D("log10",function(W){return Math.log(W)/Math.log(10);
}).args([["*num","number++"]]);
D("pi",function(){return Math.PI;
}).args([]);
D("sqrtpi",function(W){return Math.sqrt(W*Math.PI);
}).args([["*num","number+"]]);
D("degrees",function(W){return 180*W/Math.PI%360;
}).args([["*radians","number"]]);
D("radians",function(W){return Math.PI*W/180;
}).args([["*degrees","number"]]);
function d(W){return(Math.exp(W)+Math.exp(-W))/2;
}D("cosh",d).args([["*num","number"]]);
D("acosh",function(W){return Math.log(W+Math.sqrt(W-1)*Math.sqrt(W+1));
}).args([["*num","number"],["?",["assert","$num >= 1"]]]);
function n(W){return(Math.exp(W)-Math.exp(-W))/2;
}D("sinh",n).args([["*num","number"]]);
D("asinh",function(W){return Math.log(W+Math.sqrt(W*W+1));
}).args([["*num","number"]]);
D("sec",function(W){return 1/Math.cos(W);
}).args([["*num","number"]]);
D("sech",function(W){return 1/d(W);
}).args([["*num","number"]]);
D("csc",function(W){return 1/Math.sin(W);
}).args([["*num","number"]]);
D("csch",function(W){return 1/n(W);
}).args([["*num","number"]]);
D("atan2",function(W,X){return Math.atan(X/W);
}).args([["*x","divisor"],["*y","number"]]);
function p(W){return n(W)/d(W);
}D("tanh",p).args([["*num","number"]]);
D("atanh",function(W){return Math.log(Math.sqrt(1-W*W)/(1-W));
}).args([["*num",["and","number",["(between)",-1,1]]]]);
D("cot",function(W){return 1/Math.tan(W);
}).args([["*num","divisor"]]);
D("coth",function(W){return 1/p(W);
}).args([["*num","divisor"]]);
D("acot",function(W){return Math.PI/2-Math.atan(W);
}).args([["*num","number"]]);
D("acoth",function(W){return Math.log((W+1)/(W-1))/2;
}).args([["*num","number"],["?",["or",["assert","$num < -1"],["assert","$num > 1"]]]]);
D("power",function(W,X){return Math.pow(W,X);
}).args([["*a","number"],["*b","number"]]);
D("mod",function(W,X){return W%X;
}).args([["*a","number"],["*b","divisor"]]);
D("quotient",function(W,X){return Math.floor(W/X);
}).args([["*a","number"],["*b","divisor"]]);
D("ceiling",function(W,X){return X?X*Math.ceil(W/X):0;
}).args([["*number","number"],["*significance","number"],["?",["assert","$significance >= 0 || $number < 0"]]]);
D("ceiling.precise",function(W,X){X=Math.abs(X);
return X?X*Math.ceil(W/X):0;
}).args([["*number","number"],["*significance",["or","number",["null",1]]]]);
C("iso.ceiling","ceiling.precise");
D("ceiling.math",function(X,Y,W){if(!Y||!X){return 0;
}if(X<0&&(!W&&Y<0||W&&Y>0)){Y=-Y;
}return Y?Y*Math.ceil(X/Y):0;
}).args([["*number","number"],["*significance",["or","number",["null","$number < 0 ? -1 : 1"]]],["*mode",["or","logical",["null",0]]]]);
D("floor",function(W,X){return X?X*Math.floor(W/X):0;
}).args([["*number","number"],["*significance","number"],["?",["assert","$significance >= 0 || $number < 0"]]]);
D("floor.precise",function(W,X){X=Math.abs(X);
return X?X*Math.floor(W/X):0;
}).args([["*number","number"],["*significance",["or","number",["null",1]]]]);
D("floor.math",function(X,Y,W){if(!Y||!X){return 0;
}if(X<0&&(!W&&Y<0||W&&Y>0)){Y=-Y;
}return Y?Y*Math.floor(X/Y):0;
}).args([["*number","number"],["*significance",["or","number",["null","$number < 0 ? -1 : 1"]]],["*mode",["or","logical",["null",0]]]]);
D("int",Math.floor).args([["*number","number"]]);
D("mround",function(X,W){return W?W*Math.round(X/W):0;
}).args([["*number","number"],["*multiple","number"]]);
D("round",function(X,W){var Y=X<0?-1:1;
if(Y<0){X=-X;
}W=Math.pow(10,W);
X*=W;
X=Math.round(X);
return Y*X/W;
}).args([["*number","number"],["*digits","number"]]);
D("roundup",function(X,W){W=Math.pow(10,W);
X*=W;
X=X<0?Math.floor(X):Math.ceil(X);
return X/W;
}).args([["*number","number"],["*digits","number"]]);
D("rounddown",function(X,W){W=Math.pow(10,W);
X*=W;
X=X<0?Math.ceil(X):Math.floor(X);
return X/W;
}).args([["*number","number"],["*digits","number"]]);
D("even",function(X){var W=X<0?Math.floor(X):Math.ceil(X);
return W%2?W+(W<0?-1:1):W;
}).args([["*number","number"]]);
D("odd",function(X){var W=X<0?Math.floor(X):Math.ceil(X);
return W%2?W:W+(W<0?-1:1);
}).args([["*number","number"]]);
D("sign",function(W){return W<0?-1:W>0?1:0;
}).args([["*number","number"]]);
function h(W,X){while(X){var Y=W%X;
W=X;
X=Y;
}return W;
}function i(W,X){return Math.abs(W*X)/h(W,X);
}D("gcd",function(X){var W=X[0];
for(var Y=1;
Y<X.length;
++Y){W=h(W,X[Y]);
}return W;
}).args([["numbers",["collect","number"]]]);
D("lcm",function(X){var W=X[0];
for(var Y=1;
Y<X.length;
++Y){W=i(W,X[Y]);
}return W;
}).args([["numbers",["collect","number"]]]);
D("sum",function(W){return W.reduce(function(Y,X){return Y+X;
},0);
}).args([["numbers",["collect","number"]]]);
D("product",function(W){return W.reduce(function(Y,X){return Y*X;
},1);
}).args([["numbers",["collect","number"]]]);
D("sumproduct",function(W,X){var Y=0;
W.each(function(ab,ac,Z){if(typeof ab=="number"){for(var aa=0;
aa<X.length;
++aa){var ad=X[aa].get(ac,Z);
if(typeof ad!="number"){return;
}ab*=ad;
}Y+=ab;
}});
return Y;
}).args([["a1","matrix"],["+",["a2",["and","matrix",["assert","$a2.width == $a1.width"],["assert","$a2.height == $a1.height"]]]]]);
D("sumsq",function(W){return W.reduce(function(Y,X){return Y+X*X;
},0);
}).args([["numbers",["collect","number"]]]);
D("sumx2my2",function(W,X){var Y=0;
W.each(function(ab,aa,Z){var ac=X.get(aa,Z);
if(typeof ab=="number"&&typeof ac=="number"){Y+=ab*ab-ac*ac;
}});
return Y;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
D("sumx2py2",function(W,X){var Y=0;
W.each(function(ab,aa,Z){var ac=X.get(aa,Z);
if(typeof ab=="number"&&typeof ac=="number"){Y+=ab*ab+ac*ac;
}});
return Y;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
D("sumxmy2",function(W,X){var Y=0;
W.each(function(ab,aa,Z){var ac=X.get(aa,Z);
if(typeof ab=="number"&&typeof ac=="number"){Y+=(ab-ac)*(ab-ac);
}});
return Y;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
D("seriessum",function(aa,Y,X,W){var Z=0;
W.each(function(ab){if(typeof ab!="number"){throw new y("VALUE");
}Z+=ab*Math.pow(aa,Y);
Y+=X;
});
return Z;
}).args([["x","number"],["y","number"],["m","number"],["a","matrix"]]);
D("min",function(W){return W.length?Math.min.apply(Math,W):0;
}).args([["numbers",["collect","number"]]]);
D("max",function(W){return W.length?Math.max.apply(Math,W):0;
}).args([["numbers",["collect","number"]]]);
D("counta",function(W){return W.length;
}).args([["values",["#collect","anyvalue"]]]);
D("count",function(W){return W.length;
}).args([["numbers",["#collect","number"]]]);
D("countunique",function(Y){var W=0,X=[];
Y.forEach(function(Z){if(X.indexOf(Z)<0){W++;
X.push(Z);
}});
return W;
}).args([["values",["#collect","anyvalue"]]]);
D("countblank",function(W){var Y=0;
function X(aa){if(aa==null||aa===""){Y++;
}}function Z(aa){for(var ab=0;
ab<aa.length;
++ab){var ac=aa[ab];
if(ac instanceof J){ac.each(X,true);
}else{X(ac);
}}}Z(W);
return Y;
}).args([["+",["args",["or","matrix","anyvalue"]]]]);
D("iseven",function(W){return W%2===0;
}).args([["*number","number"]]);
D("isodd",function(W){return W%2!==0;
}).args([["*number","number"]]);
D("n",function(W){if(typeof W=="boolean"){return W?1:0;
}if(typeof W=="number"){return W;
}return 0;
}).args([["*value","anyvalue"]]);
D("na",function(){return new y("N/A");
}).args([]);
function G(W,Z){var X=[],aa=0,ab=W[0];
while(aa<W.length){X.push({matrix:W[aa++],pred:M(W[aa++])});
}ROW:for(var ac=0;
ac<ab.height;
++ac){COL:for(var Y=0;
Y<ab.width;
++Y){for(aa=0;
aa<X.length;
++aa){var ad=X[aa].matrix.get(ac,Y);
if(!X[aa].pred(ad==null||ad===""?0:ad)){continue COL;
}}Z(ac,Y);
}}}var s=[["m1","matrix"],["c1","anyvalue"],[["m2","matrix"],["c2","anyvalue"]]];
D("countifs",function(Y,W,Z){var X=0;
Z.unshift(Y,W);
G(Z,function(){X++;
});
return X;
}).args(s);
var v=[["range","matrix"]].concat(s);
D("sumifs",function(Z,Y,X,W){W.unshift(Z,K,Y,X);
var aa=0;
G(W,function(ac,ab){var ad=Z.get(ac,ab);
if(ad){aa+=ad;
}});
return aa;
}).args(v);
D("averageifs",function(aa,Z,X,W){W.unshift(aa,K,Z,X);
var ab=0,Y=0;
G(W,function(ad,ac){var ae=aa.get(ad,ac);
if(ae==null||ae===""){ae=0;
}ab+=ae;
Y++;
});
return Y?ab/Y:new y("DIV/0");
}).args(v);
D("countif",function(Y,X){X=M(X);
var W=0;
Y.each(function(Z){if(X(Z)){W++;
}});
return W;
}).args([["range","matrix"],["*criteria","anyvalue"]]);
var u=[["range","matrix"],["*criteria","anyvalue"],["sumRange",["or",["and","matrix",["assert","$sumRange.width == $range.width"],["assert","$sumRange.height == $range.height"]],["null","$range"]]]];
D("sumif",function(X,W,Z){var Y=0;
W=M(W);
X.each(function(ad,ab,aa){if(W(ad)){var ac=Z.get(ab,aa);
if(K(ac)){Y+=ac||0;
}}});
return Y;
}).args(u);
D("averageif",function(Y,X,aa){var Z=0,W=0;
X=M(X);
Y.each(function(ae,ac,ab){if(X(ae)){var ad=aa.get(ac,ab);
if(K(ad)){Z+=ad||0;
W++;
}}});
return W?Z/W:new y("DIV/0");
}).args(u);
(function(W){W("large",function(Y,X){return Y.sort(E)[X];
});
W("small",function(Y,X){return Y.sort(w)[X];
});
}(function(X,W){D(X,function(Z,aa){var ab=[];
var Y=Z.each(function(ac){if(ac instanceof y){return ac;
}if(typeof ac=="number"){ab.push(ac);
}});
if(Y){return Y;
}if(aa>ab.length){return new y("NUM");
}return W(ab,aa-1);
}).args([["array","matrix"],["*nth","number++"]]);
}));
function a(W){return W.reduce(function(Y,X){return Y+X;
},0)/W.length;
}function q(Y,X,W){if(W==null){W=a(Y);
}return Y.reduce(function(aa,Z){return aa+Math.pow(Z-W,2);
},0)/X;
}function o(X,W){return Math.sqrt(q(X,W));
}D("stdev.s",function(W){return o(W,W.length-1);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
D("stdev.p",function(W){return o(W,W.length);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
D("var.s",function(W){return q(W,W.length-1);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
D("var.p",function(W){return q(W,W.length);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
D("median",function(X){var W=X.length;
X.sort(w);
if(W%2){return X[W>>1];
}return(X[W>>=1]+X[W-1])/2;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]);
D("mode.sngl",function(ab){ab.sort(w);
var ac=null,W=0,Y=1,Z=null;
for(var X=0;
X<ab.length;
++X){var aa=ab[X];
if(aa!=ac){W=1;
ac=aa;
}else{W++;
}if(W>Y){Y=W;
Z=aa;
}}return Z==null?new y("N/A"):Z;
}).args([["numbers",["collect","number"]]]);
D("mode.mult",function(Y){var aa=Object.create(null),X=2,Z=[];
Y.forEach(function(ab){var ac=aa[ab]||0;
aa[ab]=++ac;
if(ac==X){Z.push(ab);
}else{if(ac>X){X=ac;
Z=[ab];
}}});
var W=new J(this);
Z.forEach(function(ac,ab){W.set(ab,0,ac);
});
return W;
}).args([["numbers",["collect","number"]]]);
D("geomean",function(X){var W=X.length;
var Y=X.reduce(function(aa,Z){if(Z<0){throw new y("NUM");
}return aa*Z;
},1);
return Math.pow(Y,1/W);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","NUM"]]]);
D("harmean",function(X){var W=X.length;
var Y=X.reduce(function(aa,Z){if(!Z){throw new y("DIV/0");
}return aa+1/Z;
},0);
return W/Y;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","NUM"]]]);
D("trimmean",function(Z,aa){var Y=Z.length;
Z.sort(w);
var W=Math.floor(Y*aa);
if(W%2){--W;
}W/=2;
var ab=0;
for(var X=W;
X<Y-W;
++X){ab+=Z[X];
}return ab/(Y-W*2);
}).args([["numbers",["collect","number",1]],["percent",["and","number",["[between)",0,1]]],["?",["assert","$numbers.length > 0","NUM"]]]);
D("frequency",function(Y,W){Y.sort(w);
W.sort(w);
var ab=-Infinity;
var Z=0;
function X(ac){var ad=0;
while(Z<Y.length&&Y[Z]>ab&&Y[Z]<=ac){++ad;
++Z;
}return ad;
}var aa=new J(this);
W.forEach(function(ae,ac){var ad=X(ae);
ab=ae;
aa.set(ac,0,ad);
});
aa.set(aa.height,0,Y.length-Z);
return aa;
}).args([["data",["collect","number",1]],["bins",["collect","number",1]]]);
D("rank.eq",function(Z,X,W){X.sort(W?w:E);
var Y=X.indexOf(Z);
return Y<0?new y("N/A"):Y+1;
}).args([["value","number"],["numbers",["collect","number"]],["order",["or","logical",["null",false]]]]);
C("rank","rank.eq");
D("rank.avg",function(aa,Y,W){Y.sort(W?w:E);
var Z=Y.indexOf(aa);
if(Z<0){return new y("N/A");
}for(var X=Z;
Y[X]==aa;
++X){}return(Z+X+1)/2;
}).args([["value","number"],["numbers",["collect","number"]],["order",["or","logical",["null",false]]]]);
D("kurt",function(Y){var X=Y.length;
var W=a(Y);
var ab=q(Y,X-1,W);
var Z=Math.sqrt(ab);
var aa=Y.reduce(function(ad,ac){return ad+Math.pow((ac-W)/Z,4);
},0);
return X*(X+1)/((X-1)*(X-2)*(X-3))*aa-3*Math.pow(X-1,2)/((X-2)*(X-3));
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 4","NUM"]]]);
function m(ab,ad,W){var aa=0,Z=0,Y=null,ac=null,X=false;
ab.forEach(function(ae){if(ae<ad){aa++;
Y=Y==null?ae:Math.max(Y,ae);
}else{if(ae>ad){Z++;
ac=ac==null?ae:Math.min(ac,ae);
}else{X=true;
}}});
if(!aa&&!Z){return new y("N/A");
}if(X){if(W){return(aa+1)/(ab.length+1);
}return aa/(aa+Z);
}return((ac-ad)*m(ab,Y,W)+(ad-Y)*m(ab,ac,W))/(ac-Y);
}var t=[["array",["collect","number",1]],["x","number"],["significance",["or",["null",3],"integer++"]],["?",["assert","$array.length > 0","NUM"]]];
D("percentrank.inc",function(W,Z,Y){var X=m(W,Z,0);
X=X.toFixed(Y+1);
return parseFloat(X.substr(0,X.length-1));
}).args(t);
D("percentrank.exc",function(W,Z,Y){var X=m(W,Z,1);
X=X.toFixed(Y+1);
return parseFloat(X.substr(0,X.length-1));
}).args(t);
C("percentrank","percentrank.inc");
function e(ac,ad,Y){var ab=0;
var W=a(ac);
var X=a(ad);
var aa=ac.length;
for(var Z=0;
Z<aa;
++Z){ab+=(ac[Z]-W)*(ad[Z]-X);
}return ab/Y;
}D("covariance.p",function(W,X){return e(W,X,W.length);
}).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length == $array2.length","N/A"]],["?",["assert","$array1.length > 0","DIV/0"]]]);
D("covariance.s",function(W,X){return e(W,X,W.length-1);
}).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length == $array2.length","N/A"]],["?",["assert","$array1.length > 1","DIV/0"]]]);
C("covar","covariance.p");
var g=U.memoize(function(Y){for(var X=2,W=1;
X<=Y;
++X){W*=X;
}return W;
});
D("fact",g).args([["*n","integer+"]]);
D("factdouble",function(Y){for(var X=2+(Y&1),W=1;
X<=Y;
X+=2){W*=X;
}return W;
}).args([["*n","integer+"]]);
D("multinomial",function(X){var W=1,Y=0;
X.forEach(function(Z){if(Z<0){throw new y("NUM");
}Y+=Z;
W*=g(Z);
});
return g(Y)/W;
}).args([["numbers",["collect","number"]]]);
var c=U.memoize(function(Z,Y){for(var W=Y+1,X=1,aa=1,ab=1;
X<=Z-Y;
++W,++X){aa*=W;
ab*=X;
}return aa/ab;
});
D("combin",c).args([["*n","integer++"],["*k",["and","integer",["[between]",0,"$n"]]]]);
D("combina",function(X,W){return c(X+W-1,X-1);
}).args([["*n","integer++"],["*k",["and","integer",["[between]",1,"$n"]]]]);
D("average",function(W){var X=W.reduce(function(Z,Y){return Z+Y;
},0);
return X/W.length;
}).args([["numbers",["collect","number!"]],["?",["assert","$numbers.length > 0","DIV/0"]]]);
D("averagea",function(Y){var X=0,W=0;
Y.forEach(function(Z){if(typeof Z!="string"){X+=Z;
}++W;
});
return W?X/W:new y("DIV/0");
}).args([["values",["collect","anyvalue"]]]);
function j(Z,aa){Z.sort(w);
var Y=Z.length;
var X=aa|0,W=aa-X;
if(X===0){return Z[0];
}if(X>=Y){return Z[Y-1];
}--X;
return Z[X]+W*(Z[X+1]-Z[X]);
}function l(W,X){var Y=X*(W.length-1)+1;
return j(W,Y);
}function k(W,X){var Y=X*(W.length+1);
return j(W,Y);
}D("percentile.inc",l).args([["numbers",["collect","number",1]],["p",["and","number",["[between]",0,1]]]]);
D("percentile.exc",k).args([["numbers",["collect","number",1]],["p",["and","number",["(between)",0,1]]]]);
D("quartile.inc",function(W,X){return l(W,X/4);
}).args([["numbers",["collect","number",1]],["quarter",["values",0,1,2,3,4]]]);
D("quartile.exc",function(W,X){return k(W,X/4);
}).args([["numbers",["collect","number",1]],["quarter",["values",0,1,2,3,4]]]);
C("quartile","quartile.inc");
C("percentile","percentile.inc");
var r=["AVERAGE","COUNT","COUNTA","MAX","MIN","PRODUCT","STDEV.S","STDEV.P","SUM","VAR.S","VAR.P","MEDIAN","MODE.SNGL","LARGE","SMALL","PERCENTILE.INC","QUARTILE.INC","PERCENTILE.EXC","QUARTILE.EXC"];
function F(ac,W,ab){var ad=[];
var Z=1;
var Y=2;
var aa=4;
(function X(ae){if(ae instanceof O){ac.getRefCells(ae,true).forEach(function(ag){var ai=ag.value;
if(ab&Z&&ag.hidden){return;
}if(ag.formula){var ah=ag.formula.print(ag.row,ag.col);
if(/^\s*(?:aggregate|subtotal)\s*\(/i.test(ah)){if(!(ab&aa)){return;
}}}if(ab&Y&&ai instanceof y){return;
}if(typeof ai=="number"||ai instanceof y){ad.push(ai);
}});
}else{if(Array.isArray(ae)){for(var af=0;
af<ae.length;
++af){X(ae[af]);
}}else{if(ae instanceof J){ae.each(X);
}else{if(typeof ae=="number"){ad.push(ae);
}else{if(ae instanceof y&&!(ab&Y)){ad.push(ae);
}}}}}}(W));
return ad;
}D("aggregate",function(X,Y,Z,W){var aa=this;
aa.resolveCells(W,function(){var ac;
if(Y>12){ac=F(aa,W[0],Z);
var ab=W[1];
if(ab instanceof z){ab=aa.getRefData(ab);
}if(typeof ab!="number"){return X(new y("VALUE"));
}}else{ac=F(aa,W,Z);
}aa.func(r[Y-1],X,ac);
});
}).argsAsync([["funcId",["values",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],["options",["or",["null",0],["values",0,1,2,3,4,5,6,7]]],["args","rest"]]);
D("subtotal",function(X,Y){var ab=this;
var aa=Y>100;
if(aa){Y-=100;
}var W=[];
for(var Z=2;
Z<arguments.length;
++Z){W.push(arguments[Z]);
}ab.resolveCells(W,function(){var ac=F(ab,W,aa?1:0);
ab.func(r[Y-1],X,ac);
});
}).argsAsync([["funcId",["values",1,2,3,4,5,6,7,8,9,10,11,101,102,103,104,105,106,107,108,109,110,111]],["+",["ref",["or","ref","#matrix"]]]]);
D("avedev",function(X){var W=X.reduce(function(Z,Y){return Z+Y;
},0)/X.length;
return X.reduce(function(Z,Y){return Z+Math.abs(Y-W);
},0)/X.length;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
function b(ab,Y,Z,W){if(!W){return c(Y,ab)*Math.pow(Z,ab)*Math.pow(1-Z,Y-ab);
}else{var aa=0;
for(var X=0;
X<=ab;
++X){aa+=c(Y,X)*Math.pow(Z,X)*Math.pow(1-Z,Y-X);
}return aa;
}}D("binom.dist",b).args([["successes","integer+"],["trials",["and","integer",["assert","$trials >= $successes"]]],["probability",["and","number",["[between]",0,1]]],["cumulative","logical"]]);
C("binomdist","binom.dist");
D("binom.inv",function(X,Y,W){for(var Z=0;
Z<=X;
++Z){if(b(Z,X,Y,true)>=W){return Z;
}}return new y("N/A");
}).args([["trials","integer+"],["probability",["and","number",["[between]",0,1]]],["alpha",["and","number",["[between]",0,1]]]]);
C("critbinom","binom.inv");
D("binom.dist.range",function(X,Y,Z,aa){var ab=0;
for(var W=Z;
W<=aa;
++W){ab+=c(X,W)*Math.pow(Y,W)*Math.pow(1-Y,X-W);
}return ab;
}).args([["trials","integer+"],["probability",["and","number",["[between]",0,1]]],["successes_min",["and","integer",["[between]",0,"$trials"]]],["successes_max",["or",["and","integer",["[between]","$successes_min","$trials"]],["null","$successes_min"]]]]);
D("negbinom.dist",function(aa,X,Y,W){if(W){var Z=0;
while(aa>=0){Z+=c(aa+X-1,aa)*Math.pow(Y,X)*Math.pow(1-Y,aa);
aa--;
}return Z;
}return c(aa+X-1,aa)*Math.pow(Y,X)*Math.pow(1-Y,aa);
}).args([["number_f","integer+"],["number_s","integer+"],["probability_s",["and","number",["[between]",0,1]]],["cumulative","logical"]]);
C("negbinomdist","negbinom.dist");
D("address",function(aa,Z,X,W,ab){var Y=new z(aa-1,Z-1,X-1);
if(ab){Y.setSheet(ab,true);
}return W?Y.print(0,0):Y.print();
}).args([["row","integer++"],["col","integer++"],["abs",["or",["null",1],["values",1,2,3,4]]],["a1",["or",["null",true],"logical"]],["sheet",["or","null","string"]]]);
D("areas",function(Y){var W=0;
(function X(Z){if(Z instanceof z||Z instanceof N){W++;
}else{if(Z instanceof S){Z.refs.forEach(X);
}}}(Y));
return W;
}).args([["ref","ref"]]);
D("choose",function(X,W){if(X>W.length){return new y("N/A");
}else{return W[X-1];
}}).args([["*index","integer"],["+",["value","anything"]]]);
D("column",function(W){if(!W){return this.formula.col+1;
}if(W instanceof z){return W.col+1;
}return this.asMatrix(W).mapCol(function(X){return X+W.topLeft.col+1;
});
}).args([["ref",["or","area","null"]]]);
D("columns",function(W){return W instanceof O?W.width():W.width;
}).args([["ref",["or","area","#matrix"]]]);
D("formulatext",function(X){var W=this.getRefCells(X)[0];
if(!W.formula){return new y("N/A");
}return W.formula.print(W.row,W.col);
}).args([["ref","ref"]]);
D("hlookup",function(aa,X,Z,W){var Y=null;
X.eachCol(function(ab){var ac=X.get(0,ab);
if(W){if(ac>aa){return true;
}Y=ab;
}else{if(ac===aa){Y=ab;
return true;
}}});
if(Y==null){return new y("N/A");
}return X.get(Z-1,Y);
}).args([["value","anyvalue"],["range","matrix"],["row","integer++"],["approx",["or","logical",["null",true]]]]);
D("index",function(X,ab,ac,Z,W){var ae=this;
if(ab instanceof S){ab=ab.refs[W-1];
}if(!ac&&!Z||!ab){return X(new y("N/A"));
}if(ab instanceof z){ab=ab.toRangeRef();
}if(ab instanceof N){if(ac&&Z){if(Z>ab.width()||ac>ab.height()){return X(new y("REF"));
}var Y=ab.toCell(ac-1,Z-1);
ae.resolveCells([Y],function(){X(ae.getRefData(Y));
});
return;
}if(!ac){var aa=ab.toColumn(Z-1);
ae.resolveCells([aa],function(){X(ae.asMatrix(aa));
});
return;
}if(!Z){var ad=ab.toRow(ac-1);
ae.resolveCells([ad],function(){X(ae.asMatrix(ad));
});
return;
}}else{if(ab instanceof J){if(ab.width>1&&ab.height>1){if(ac&&Z){return X(ab.get(ac-1,Z-1));
}if(!ac){return X(ab.mapRow(function(af){return ab.get(af,Z-1);
}));
}if(!Z){return X(ab.mapCol(function(af){return ab.get(ac-1,af);
}));
}}if(ab.width==1){return X(ab.get(ac-1,0));
}if(ab.height==1){return X(ab.get(0,Z-1));
}}else{X(new y("REF"));
}}}).argsAsync([["range",["or","ref","matrix"]],["row",["or","integer+","null"]],["col",["or","integer+","null"]],["areanum",["or","integer++",["null",1]]]]);
D("indirect",function(Z){try{var Y=this.formula;
var X=x.parseFormula(Y.sheet,Y.row,Y.col,Z);
if(!(X.ast instanceof O)){throw 1;
}return X.ast.absolute(Y.row,Y.col);
}catch(W){return new y("REF");
}}).args([["thing","string"]]);
D("match",function(aa,Y,Z){var X=1,W;
if(Z===0){W=M(aa);
}else{if(Z===-1){W=M("<="+aa);
}else{if(Z===1){W=M(">="+aa);
}}}if(Y.each(function(ab){if(ab!=null&&W(ab)){if(Z!==0&&aa!=ab){--X;
}return true;
}X++;
},true)&&X>0){return X;
}else{return new y("N/A");
}}).args([["value","anyvalue"],["range","matrix"],["type",["or",["values",-1,0,1],["null",1]]]]);
D("offset",function(Y,Z,W,X,ab){var aa=(Y instanceof z?Y:Y.topLeft).clone();
aa.row+=Z;
aa.col+=W;
if(aa.row<0||aa.col<0){return new y("VALUE");
}if(X>1||ab>1){return new N(aa,new z(aa.row+X-1,aa.col+ab-1)).setSheet(Y.sheet,Y.hasSheet());
}return aa;
}).args([["ref","area"],["*rows","integer"],["*cols","integer"],["*height",["or","integer++",["null","$ref.height()"]]],["*width",["or","integer++",["null","$ref.width()"]]]]);
D("row",function(W){if(!W){return this.formula.row+1;
}if(W instanceof z){return W.row+1;
}return this.asMatrix(W).mapRow(function(X){return X+W.topLeft.row+1;
});
}).args([["ref",["or","area","null"]]]);
D("rows",function(W){return W instanceof O?W.height():W.height;
}).args([["ref",["or","area","#matrix"]]]);
D("vlookup",function(aa,Y,X,W){var Z=null;
if(typeof aa!="number"){W=false;
}if(typeof aa=="string"){aa=aa.toLowerCase();
}Y.eachRow(function(ac){var ab=Y.get(ac,0);
if(W){if(ab>aa){return true;
}Z=ac;
}else{if(typeof ab=="string"){ab=ab.toLowerCase();
}if(ab===aa){Z=ac;
return true;
}}});
if(Z==null){return new y("N/A");
}return Y.get(Z,X-1);
}).args([["value","anyvalue"],["range","matrix"],["col","integer++"],["approx",["or","logical",["null",true]]]]);
D("date",function(Y,X,W){return L(Y,X-1,W);
}).args([["*year","integer"],["*month","integer"],["*date","integer"]]);
D("day",function(W){return T(W).date;
}).args([["*date","date"]]);
D("month",function(W){return T(W).month+1;
}).args([["*date","date"]]);
D("year",function(W){return T(W).year;
}).args([["*date","date"]]);
D("weekday",function(W){return T(W).day+1;
}).args([["*date","date"]]);
D("weeknum",function(W,aa){var Y=L(T(W).year,0,1);
var Z=T(Y);
var X;
if(aa==21){X=3-(Z.day+6)%7;
if(X<0){X+=7;
}Y+=X;
Z.date+=X;
Z.day=4;
aa=1;
}else{if(aa==1){aa=0;
}else{if(aa==2){aa=1;
}else{aa=(aa-10)%7;
}}}X=Z.day-aa;
if(X<0){X+=7;
}Y-=X;
return Math.ceil((W+1-Y)/7);
}).args([["*date","date"],["*type",["or",["null",1],["values",1,2,11,12,13,14,15,16,17,21]]]]);
function V(X){var W=T(L(X,0,1));
if(W.day==4||W.day==3&&P.isLeapYear(X)){return 53;
}return 52;
}D("isoweeknum",function I(X){var W=T(X);
var Y=W.day||7;
var Z=Math.floor((W.ord-Y+10)/7);
if(Z<1){return V(W.year-1);
}else{if(Z==53&&Z>V(W.year)){return 1;
}}return Z;
}).args([["*date","date"]]);
D("now",function(){return P.dateToSerial(new Date());
}).args([]);
D("today",function(){return P.dateToSerial(new Date())|0;
}).args([]);
D("time",function(W,X,Y){return P.packTime(W,X,Y,0);
}).args([["*hours","integer"],["*minutes","integer"],["*seconds","integer"]]);
D("hour",function(W){return P.unpackTime(W).hours;
}).args([["*time","datetime"]]);
D("minute",function(W){return P.unpackTime(W).minutes;
}).args([["*time","datetime"]]);
D("second",function(W){return P.unpackTime(W).seconds;
}).args([["*time","datetime"]]);
D("edate",function(W,Z){var X=T(W);
var Y=X.month+Z;
var aa=X.year+Math.floor(Y/12);
Y%=12;
if(Y<0){Y+=12;
}X=Math.min(X.date,A(aa,Y));
return L(aa,Y,X);
}).args([["*start_date","date"],["*months","integer"]]);
D("eomonth",function(W,Z){var X=T(W);
var Y=X.month+Z;
var aa=X.year+Math.floor(Y/12);
Y%=12;
if(Y<0){Y+=12;
}X=A(aa,Y);
return L(aa,Y,X);
}).args([["*start_date","date"],["*months","integer"]]);
D("workday",function(W,aa,Y){var Z=aa>0?1:-1;
aa=Math.abs(aa);
var X=T(W).day;
while(aa>0){W+=Z;
X=(X+Z)%7;
if(X>0&&X<6&&Y.indexOf(W)<0){--aa;
}}return W;
}).args([["start_date","date"],["days","integer"],["holidays",["collect","date"]]]);
D("networkdays",function(X,Z,aa){if(X>Z){var ab=X;
X=Z;
Z=ab;
}var W=0;
var Y=T(X).day;
while(X<=Z){if(Y>0&&Y<6&&aa.indexOf(X)<0){W++;
}X++;
Y=(Y+1)%7;
}return W;
}).args([["start_date","date"],["end_date","date"],["holidays",["collect","date"]]]);
D("days",function(X,W){return W-X;
}).args([["*start_date","date"],["*end_date","date"]]);
function f(aa,Y,Z){var W=T(aa);
var X=T(Y);
if(Z){if(W.date==31){W.date=30;
}if(X.date==31){X.date=30;
}}else{if(W.month==1&&X.month==1&&W.date==A(W.year,1)&&X.date==A(X.year,1)){X.date=30;
}if(W.date==A(W.year,W.month)){W.date=30;
if(X.date==31){X.date=30;
}}else{if(W.date==30&&X.date==31){X.date=30;
}}}return 360*(X.year-W.year)+30*(X.month-W.month)+(X.date-W.date);
}P._days_360=f;
D("days360",f).args([["*start_date","date"],["*end_date","date"],["*method",["or","logical",["null",false]]]]);
D("yearfrac",function(Y,W,X){switch(X){case 0:return f(Y,W,false)/360;
case 1:return(W-Y)/B(T(Y).year);
case 2:return(W-Y)/360;
case 3:return(W-Y)/365;
case 4:return f(Y,W,true)/360;
}}).args([["*start_date","date"],["*end_date","date"],["*method",["or",["null",0],["values",0,1,2,3,4]]]]);
D("datevalue",function(X){var W=P.parseDate(X);
if(W){return P.dateToSerial(W);
}return new y("VALUE");
}).args([["*text","string"]]);
D("timevalue",function(ab){var Y=ab.toLowerCase().match(/(\d+):(\d+)(:(\d+)(\.(\d+))?)?\s*(am?|pm?)?/);
if(Y){var X=parseFloat(Y[1]);
var Z=parseFloat(Y[2]);
var aa=Y[3]?parseFloat(Y[4]):0;
var W=Y[7];
if(W&&(X>12||X<1)){return new y("VALUE");
}if(/^p/.test(W)){X+=12;
}return P.packTime(X,Z,aa,0);
}return new y("VALUE");
}).args([["*text","string"]]);
D("mdeterm",function(X){var W=X.each(function(Y){if(typeof Y!="number"){return new y("VALUE");
}},true);
return W||X.determinant();
}).args([["m",["and","matrix",["assert","$m.width == $m.height"]]]]);
D("transpose",function(W){return W.transpose();
}).args([["range","matrix"]]);
D("mmult",function(W,X){return W.multiply(X);
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.height == $a.width"]]]]);
D("munit",function(W){return new J(this).unit(W);
}).args([["n","integer+"]]);
D("minverse",function(X){var W=X.each(function(Y){if(typeof Y!="number"){return new y("VALUE");
}},true);
return W||X.inverse()||new y("VALUE");
}).args([["m",["and","matrix",["assert","$m.width == $m.height"]]]]);
D("rand",function(){return Math.random();
}).args([]);
D("randbetween",function(X,W){return X+Math.floor((W-X+1)*Math.random());
}).args([["min","integer"],["max",["and","integer",["assert","$max >= $min"]]]]);
D("true",function(){return true;
}).args([]);
D("false",function(){return true;
}).args([]);
D("roman",function(W){return U.arabicToRoman(W).toUpperCase();
}).args([["*number","integer"]]);
D("arabic",function(X){var W=U.romanToArabic(X);
return W==null?new y("VALUE"):W;
}).args([["*roman","string"]]);
D("base",function(X,Y,W){var Z=X.toString(Y).toUpperCase();
while(Z.length<W){Z="0"+Z;
}return Z;
}).args([["*number","integer"],["*radix",["and","integer",["[between]",2,36]]],["*minLen",["or","integer+",["null",0]]]]);
D("decimal",function(Z,Y){Z=Z.toUpperCase();
var aa=0;
for(var X=0;
X<Z.length;
++X){var W=Z.charCodeAt(X);
if(W>=48&&W<=57){W-=48;
}else{if(W>=65&&W<55+Y){W-=55;
}else{return new y("VALUE");
}}aa=aa*Y+W;
}return aa;
}).args([["*text","string"],["*radix",["and","integer",["[between]",2,36]]]]);
D("char",function(W){return String.fromCharCode(W);
}).args([["*code","integer+"]]);
var Q=/[\0-\x1F\x7F-\x9F\xAD\u0378\u0379\u037F-\u0383\u038B\u038D\u03A2\u0528-\u0530\u0557\u0558\u0560\u0588\u058B-\u058E\u0590\u05C8-\u05CF\u05EB-\u05EF\u05F5-\u0605\u061C\u061D\u06DD\u070E\u070F\u074B\u074C\u07B2-\u07BF\u07FB-\u07FF\u082E\u082F\u083F\u085C\u085D\u085F-\u089F\u08A1\u08AD-\u08E3\u08FF\u0978\u0980\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09FC-\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF2-\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B78-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BFB-\u0C00\u0C04\u0C0D\u0C11\u0C29\u0C34\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5A-\u0C5F\u0C64\u0C65\u0C70-\u0C77\u0C80\u0C81\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0D01\u0D04\u0D0D\u0D11\u0D3B\u0D3C\u0D45\u0D49\u0D4F-\u0D56\u0D58-\u0D5F\u0D64\u0D65\u0D76-\u0D78\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DF1\u0DF5-\u0E00\u0E3B-\u0E3E\u0E5C-\u0E80\u0E83\u0E85\u0E86\u0E89\u0E8B\u0E8C\u0E8E-\u0E93\u0E98\u0EA0\u0EA4\u0EA6\u0EA8\u0EA9\u0EAC\u0EBA\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F48\u0F6D-\u0F70\u0F98\u0FBD\u0FCD\u0FDB-\u0FFF\u10C6\u10C8-\u10CC\u10CE\u10CF\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u137D-\u137F\u139A-\u139F\u13F5-\u13FF\u169D-\u169F\u16F1-\u16FF\u170D\u1715-\u171F\u1737-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17DE\u17DF\u17EA-\u17EF\u17FA-\u17FF\u180F\u181A-\u181F\u1878-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191D-\u191F\u192C-\u192F\u193C-\u193F\u1941-\u1943\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19DD\u1A1C\u1A1D\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1A9F\u1AAE-\u1AFF\u1B4C-\u1B4F\u1B7D-\u1B7F\u1BF4-\u1BFB\u1C38-\u1C3A\u1C4A-\u1C4C\u1C80-\u1CBF\u1CC8-\u1CCF\u1CF7-\u1CFF\u1DE7-\u1DFB\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FC5\u1FD4\u1FD5\u1FDC\u1FF0\u1FF1\u1FF5\u1FFF\u200B-\u200F\u202A-\u202E\u2060-\u206F\u2072\u2073\u208F\u209D-\u209F\u20BB-\u20CF\u20F1-\u20FF\u218A-\u218F\u23F4-\u23FF\u2427-\u243F\u244B-\u245F\u2700\u2B4D-\u2B4F\u2B5A-\u2BFF\u2C2F\u2C5F\u2CF4-\u2CF8\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D71-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E3C-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u2FFC-\u2FFF\u3040\u3097\u3098\u3100-\u3104\u312E-\u3130\u318F\u31BB-\u31BF\u31E4-\u31EF\u321F\u32FF\u4DB6-\u4DBF\u9FCD-\u9FFF\uA48D-\uA48F\uA4C7-\uA4CF\uA62C-\uA63F\uA698-\uA69E\uA6F8-\uA6FF\uA78F\uA794-\uA79F\uA7AB-\uA7F7\uA82C-\uA82F\uA83A-\uA83F\uA878-\uA87F\uA8C5-\uA8CD\uA8DA-\uA8DF\uA8FC-\uA8FF\uA954-\uA95E\uA97D-\uA97F\uA9CE\uA9DA-\uA9DD\uA9E0-\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A\uAA5B\uAA7C-\uAA7F\uAAC3-\uAADA\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F-\uABBF\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBC2-\uFBD2\uFD40-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFE\uFDFF\uFE1A-\uFE1F\uFE27-\uFE2F\uFE53\uFE67\uFE6C-\uFE6F\uFE75\uFEFD-\uFF00\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]/g;
D("clean",function(W){return W.replace(Q,"");
}).args([["*text","string"]]);
D("code",function(W){return W.charAt(0);
}).args([["*text","string"]]);
C("unichar","char");
C("unicode","code");
D("concatenate",function(W){var Y="";
for(var X=0;
X<W.length;
++X){Y+=W[X];
}return Y;
}).args([["+",["*text","string"]]]);
D("dollar",function(aa,X){var Z="$#,##0DECIMALS;($#,##0DECIMALS)";
var W="";
var Y=1;
while(X-->0){W+="0";
}while(++X<0){Y*=10;
}if(W!==""){W="."+W;
}else{if(Y!==1){aa=Math.round(aa/Y)*Y;
}}Z=Z.replace(/DECIMALS/g,W);
return R.formatting.text(aa,Z);
}).args([["*number","number"],["*decimals",["or","integer",["null",2]]]]);
D("exact",function(W,X){return W===X;
}).args([["*text1","string"],["*text2","string"]]);
D("find",function(Z,Y,X){var W=Y.indexOf(Z,X-1);
return W<0?new y("VALUE"):W+1;
}).args([["*substring","string"],["*string","string"],["*start",["or","integer++",["null",1]]]]);
D("fixed",function(Z,W,Y){var aa=Math.pow(10,W);
Z=Math.round(Z*aa)/aa;
var X=Y?"0":"#,##0";
if(W>0){X+=".";
while(W-->0){X+="0";
}}return R.formatting.text(Z,X);
}).args([["*number","number"],["*decimals",["or","integer",["null",2]]],["*noCommas",["or","boolean",["null",false]]]]);
D("left",function(X,W){return X.substr(0,W);
}).args([["*text","string"],["*length",["or","integer+",["null",1]]]]);
D("right",function(X,W){return X.substr(-W);
}).args([["*text","string"],["*length",["or","integer+",["null",1]]]]);
D("len",function(W){return W.length;
}).args([["*text","string"]]);
D("lower",function(W){return W.toLowerCase();
}).args([["*text","string"]]);
D("upper",function(W){return W.toUpperCase();
}).args([["*text","string"]]);
D("ltrim",function(W){return W.replace(/^\s+/,"");
}).args([["*text","string"]]);
D("rtrim",function(W){return W.replace(/\s+$/,"");
}).args([["*text","string"]]);
D("trim",function(W){return W.replace(/^\s+|\s+$/,"");
}).args([["*text","string"]]);
D("mid",function(Y,X,W){return Y.substr(X-1,W);
}).args([["*text","string"],["*start","integer++"],["*length","integer+"]]);
D("proper",function(W){return W.toLowerCase().replace(/\b./g,function(X){return X.toUpperCase();
});
}).args([["*text","string"]]);
D("replace",function(Z,Y,W,X){return Z.substr(0,--Y)+X+Z.substr(Y+W);
}).args([["*text","string"],["*start","integer++"],["*length","integer+"],["*newText","string"]]);
D("rept",function(Y,W){var X="";
while(W-->0){X+=Y;
}return X;
}).args([["*text","string"],["*number","integer+"]]);
D("search",function(Z,Y,X){var W=Y.toLowerCase().indexOf(Z.toLowerCase(),X-1);
return W<0?new y("VALUE"):W+1;
}).args([["*substring","string"],["*string","string"],["*start",["or","integer++",["null",1]]]]);
D("substitute",function(ab,Y,W,X){if(Y===W){return ab;
}var Z=-1;
function aa(){ab=ab.substring(0,Z)+W+ab.substring(Z+Y.length);
}while((Z=ab.indexOf(Y,Z+1))>=0){if(X==null){aa();
}else{if(--X===0){aa();
break;
}}}return ab;
}).args([["*text","string"],["*oldText","string"],["*newText","string"],["*nth",["or","integer++","null"]]]);
D("t",function(W){return typeof W=="string"?W:"";
}).args([["*value","anyvalue"]]);
D("text",function(X,W){return R.formatting.text(X,W);
}).args([["*value","anyvalue"],["*format","string"]]);
D("value",function(W){if(typeof W=="number"){return W;
}if(typeof W=="boolean"){return +W;
}W=(W+"").replace(/[$,]/g,"");
W=parseFloat(W);
return isNaN(W)?new y("VALUE"):W;
}).args([["*value","anyvalue"]]);
function H(W,X){this.link=W;
this.text=X;
}H.prototype.toString=function(){return this.text;
};
D("hyperlink",function(W,X){return new H(W,X);
}).args([["*link","string"],["*text",["or","string",["null","$link"]]]]);
D("iferror",function(W,X){return W instanceof y?X:W;
}).args([["*value","forced!"],["*value_if_error","anyvalue!"]]);
var M=function(){var ae=Object.create(null);
function ad(af,ah){if(typeof ah=="string"){var ag=parseFloat(ah);
if(!isNaN(ag)&&ag==ah){ah=ag;
}}return function(ai){var aj=ah;
if(typeof ai=="string"&&typeof aj=="string"){ai=ai.toLowerCase();
aj=aj.toLowerCase();
}return af(ai,aj);
};
}function ac(af){var ag,ah;
if(typeof af=="string"){af=af.toLowerCase();
}if(/^[0-9.]+%$/.test(af)){ah=af.substr(0,af.length-1);
ag=parseFloat(ah);
if(!isNaN(ag)&&ag==ah){af=ag/100;
}}else{if(/^[0-9.]+$/.test(af)){ag=parseFloat(af);
if(!isNaN(ag)&&ag==af){af=ag;
}}}return af;
}function Z(af,ag){return ac(af)<ac(ag);
}function aa(af,ag){return ac(af)<=ac(ag);
}function X(af,ag){return ac(af)>ac(ag);
}function Y(af,ag){return ac(af)>=ac(ag);
}function ab(af,ag){return !W(af,ag);
}function W(af,ag){if(ag instanceof RegExp){return ag.test(af);
}if(typeof af=="string"||typeof ag=="string"){af=String(af);
ag=String(ag);
}return ac(af)==ac(ag);
}return function(af){if(typeof af=="function"){return af;
}var ag;
if(ag=/^=(.*)$/.exec(af)){return ad(W,ag[1]);
}if(ag=/^<>(.*)$/.exec(af)){return ad(ab,ag[1]);
}if(ag=/^<=(.*)$/.exec(af)){return ad(aa,ag[1]);
}if(ag=/^<(.*)$/.exec(af)){return ad(Z,ag[1]);
}if(ag=/^>=(.*)$/.exec(af)){return ad(Y,ag[1]);
}if(ag=/^>(.*)$/.exec(af)){return ad(X,ag[1]);
}if(/[?*]/.exec(af)){var ah=ae[af];
if(!ah){ah=af.replace(/(~\?|~\*|[\]({\+\.\|\^\$\\})\[]|[?*])/g,function(ai){switch(ai){case"~?":return"\\?";
case"~*":return"\\*";
case"?":return".";
case"*":return".*";
default:return"\\"+ai;
}});
ah=ae[af]=new RegExp("^"+ah+"$","i");
}return ad(W,ah);
}return ad(W,af);
};
}();
function K(W){return typeof W=="number"||typeof W=="boolean"||W==null||W==="";
}function w(W,X){return W===X?0:W<X?-1:1;
}function E(W,X){return W===X?0:W<X?1:-1;
}},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/runtime.functions.2",["spreadsheet/runtime"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var a1=kendo.spreadsheet;
var u=a1.calc;
var aY=u.runtime;
var Q=aY.defineFunction;
var v=aY.CalcError;
var aK=aY.packDate;
var bb=aY.unpackDate;
var aw=aY.isLeapYear;
var M=aY.daysInMonth;
var c=aY._days_360;
Q("ERF",function(bg,bh){if(bh==null){return U(bg);
}return U(bh)-U(bg);
}).args([["lower_limit","number"],["upper_limit",["or","number","null"]]]);
Q("ERFC",V).args([["x","number"]]);
Q("GAMMALN",ao).args([["x","number++"]]);
Q("GAMMA",ak).args([["x","number"]]);
Q("GAMMA.DIST",al).args([["x","number+"],["alpha","number++"],["beta","number++"],["cumulative","logical"]]);
Q("GAMMA.INV",an).args([["p",["and","number",["[between]",0,1]]],["alpha","number++"],["beta","number++"]]);
Q("NORM.S.DIST",aG).args([["z","number"],["cumulative","logical"]]);
Q("NORM.S.INV",aH).args([["p",["and","number",["[between]",0,1]]]]);
Q("NORM.DIST",aE).args([["x","number"],["mean","number"],["stddev","number++"],["cumulative","logical"]]);
Q("NORM.INV",aF).args([["p",["and","number",["[between]",0,1]]],["mean","number"],["stddev","number++"]]);
Q("BETADIST",p).args([["x","number"],["alpha","number++"],["beta","number++"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]],["?",["assert","$x >= $A","NUM"]],["?",["assert","$x <= $B","NUM"]],["?",["assert","$A < $B","NUM"]]]);
Q("BETA.DIST",m).args([["x","number"],["alpha","number++"],["beta","number++"],["cumulative","logical"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]],["?",["assert","$x >= $A","NUM"]],["?",["assert","$x <= $B","NUM"]],["?",["assert","$A < $B","NUM"]]]);
Q("BETA.INV",n).args([["p",["and","number",["[between]",0,1]]],["alpha","number++"],["beta","number++"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]]]);
Q("CHISQ.DIST",w).args([["x","number+"],["deg_freedom","integer++"],["cumulative","logical"]]);
Q("CHISQ.DIST.RT",y).args([["x","number+"],["deg_freedom","integer++"]]);
Q("CHISQ.INV",x).args([["p",["and","number",["[between]",0,1]]],["deg_freedom","integer++"]]);
Q("CHISQ.INV.RT",z).args([["p",["and","number",["[between]",0,1]]],["deg_freedom","integer++"]]);
Q("CHISQ.TEST",function(bg,bh){return A(bg.data,bh.data);
}).args([["actual_range","matrix"],["expected_range","matrix"],["?",["assert","$actual_range.width == $expected_range.width"]],["?",["assert","$actual_range.height == $expected_range.height"]]]);
Q("EXPON.DIST",W).args([["x","number+"],["lambda","number++"],["cumulative","logical"]]);
Q("POISSON.DIST",aO).args([["x","integer+"],["mean","number+"],["cumulative","logical"]]);
Q("F.DIST",Y).args([["x","number+"],["deg_freedom1","integer++"],["deg_freedom2","integer++"],["cumulative","logical"]]);
Q("F.DIST.RT",Z).args([["x","number+"],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
Q("F.INV",aa).args([["p",["and","number",["[between]",0,1]]],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
Q("F.INV.RT",ab).args([["p",["and","number",["[between]",0,1]]],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
Q("F.TEST",ag).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length >= 2","DIV/0"]],["?",["assert","$array2.length >= 2","DIV/0"]]]);
Q("FISHER",ac).args([["x",["and","number",["(between)",-1,1]]]]);
Q("FISHERINV",ad).args([["y","number"]]);
Q("T.DIST",a4).args([["x","number"],["deg_freedom","integer++"],["cumulative","logical"]]);
Q("T.DIST.RT",a8).args([["x","number"],["deg_freedom","integer++"]]);
Q("T.DIST.2T",a5).args([["x","number+"],["deg_freedom","integer++"]]);
Q("T.INV",a7).args([["p",["and","number",["(between]",0,1]]],["deg_freedom","integer++"]]);
Q("T.INV.2T",a6).args([["p",["and","number",["(between]",0,1]]],["deg_freedom","integer++"]]);
Q("T.TEST",a9).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["tails",["and","integer",["values",1,2]]],["type",["and","integer",["values",1,2,3]]],["?",["assert","$type != 1 || $array1.length == $array2.length","N/A"]],["?",["assert","$array1.length >= 2","DIV/0"]],["?",["assert","$array2.length >= 2","DIV/0"]]]);
Q("CONFIDENCE.T",C).args([["alpha",["and","number",["(between)",0,1]]],["standard_dev","number++"],["size",["and","integer++",["assert","$size != 1","DIV/0"]]]]);
Q("CONFIDENCE.NORM",B).args([["alpha",["and","number",["(between)",0,1]]],["standard_dev","number++"],["size",["and","integer++"]]]);
Q("GAUSS",ap).args([["z","number"]]);
Q("PHI",aM).args([["x","number"]]);
Q("LOGNORM.DIST",aA).args([["x","number++"],["mean","number"],["standard_dev","number++"],["cumulative","logical"]]);
Q("LOGNORM.INV",aB).args([["probability",["and","number",["(between)",0,1]]],["mean","number"],["standard_dev","number++"]]);
Q("PROB",aS).args([["x_range",["collect","number",1]],["prob_range",["collect","number",1]],["lower_limit","number"],["upper_limit",["or","number",["null","$lower_limit"]]],["?",["assert","$prob_range.length == $x_range.length","N/A"]]]);
Q("SLOPE",a0).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]);
Q("INTERCEPT",ar).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]);
Q("PEARSON",aL).args([["array1",["collect!","anything",1]],["array2",["collect!","anything",1]],["?",["assert","$array2.length == $array1.length","N/A"]],["?",["assert","$array2.length > 0 && $array1.length > 0","N/A"]]]);
Q("RSQ",aX).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]],["?",["assert","$known_x.length != 1 && $known_y.length != 1","N/A"]]]);
Q("STEYX",a2).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length >= 3 && $known_y.length >= 3","DIV/0"]]]);
Q("FORECAST",ae).args([["x","number"],["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]);
Q("LINEST",ay).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["const",["or","logical",["null",true]]],["stats",["or","logical",["null",false]]]]);
Q("LOGEST",az).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["const",["or","logical",["null",true]]],["stats",["or","logical",["null",false]]]]);
Q("TREND",ba).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["new_x",["or","matrix","null"]],["const",["or","logical",["null",true]]]]);
Q("GROWTH",aq).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["new_x",["or","matrix","null"]],["const",["or","logical",["null",true]]]]);
Q("FV",ah).args([["rate","number"],["nper","number"],["pmt",["or","number",["null",0]]],["pv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$pmt || $pv"]]]);
Q("PV",aT).args([["rate","number"],["nper","number"],["pmt",["or","number",["null",0]]],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]]]);
Q("PMT",aN).args([["rate","number"],["nper","number"],["pmt","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]]]);
Q("NPER",aI).args([["rate","number"],["pmt","number"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]]]);
Q("RATE",aU).args([["nper","number"],["pmt",["or","number",["null",0]]],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["guess",["or","number++",["null",0.01]]],["?",["assert","$pmt || $fv"]]]);
Q("IPMT",au).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$per >= 1 && $per <= $nper"]]]);
Q("PPMT",aP).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$per >= 1 && $per <= $nper"]]]);
Q("CUMPRINC",L).args([["rate","number++"],["nper","number++"],["pv","number++"],["start_period","number++"],["end_period","number++"],["type",["or",["values",0,1],["null",0]]],["?",["assert","$end_period >= $start_period","NUM"]]]);
Q("CUMIPMT",K).args([["rate","number++"],["nper","number++"],["pv","number++"],["start_period","number++"],["end_period","number++"],["type",["or",["values",0,1],["null",0]]],["?",["assert","$end_period >= $start_period","NUM"]]]);
Q("NPV",aJ).args([["rate","number"],["values",["collect","number"]],["?",["assert","$values.length > 0","N/A"]]]);
Q("IRR",av).args([["values",["collect","number",1]],["guess",["or","number",["null",0.1]]]]);
Q("EFFECT",S).args([["nominal_rate","number++"],["npery","integer++"]]);
Q("NOMINAL",aD).args([["effect_rate","number++"],["npery","integer++"]]);
Q("XNPV",bf).args([["rate","number"],["values",["collect","number",1]],["dates",["collect","date",1]],["?",["assert","$values.length == $dates.length","NUM"]]]);
Q("XIRR",be).args([["values",["collect","number",1]],["dates",["collect","date",1]],["guess",["or","number",["null",0.1]]],["?",["assert","$values.length == $dates.length","NUM"]]]);
Q("ISPMT",ax).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["?",["assert","$per >= 1 && $per <= $nper"]]]);
Q("DB",O).args([["cost","number"],["salvage","number"],["life","number++"],["period","number++"],["month",["or","number",["null",12]]]]);
Q("DDB",P).args([["cost","number"],["salvage","number"],["life","number++"],["period","number++"],["factor",["or","number",["null",2]]]]);
Q("SLN",aZ).args([["cost","number"],["salvage","number"],["life","number++"]]);
Q("SYD",a3).args([["cost","number"],["salvage","number"],["life","number++"],["per","number++"]]);
Q("VDB",bc).args([["cost","number+"],["salvage","number+"],["life","number++"],["start_period","number+"],["end_period","number+"],["factor",["or","number+",["null",2]]],["no_switch",["or","logical",["null",false]]],["?",["assert","$end_period >= $start_period","NUM"]]]);
var J=[["settlement","date"],["maturity","date"],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]];
Q("COUPDAYBS",D).args(J);
Q("COUPDAYS",E).args(J);
Q("COUPDAYSNC",F).args(J);
Q("COUPPCD",I).args(J);
Q("COUPNCD",G).args(J);
Q("COUPNUM",H).args(J);
Q("ACCRINTM",k).args([["issue","date"],["settlement","date"],["rate","number++"],["par",["or",["null",1000],"number++"]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$issue < $settlement","NUM"]]]);
Q("ACCRINT",j).args([["issue","date"],["first_interest","date"],["settlement","date"],["rate","number++"],["par",["or",["null",1000],"number++"]],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["calc_method",["or","logical",["null",true]]],["?",["assert","$issue < $settlement","NUM"]]]);
Q("DISC",R).args([["settlement","date"],["maturity","date"],["pr","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
Q("INTRATE",at).args([["settlement","date"],["maturity","date"],["investment","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
Q("RECEIVED",aV).args([["settlement","date"],["maturity","date"],["investment","number++"],["discount","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
Q("PRICE",aQ).args([["settlement","date"],["maturity","date"],["rate","number++"],["yld","number++"],["redemption","number++"],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
Q("PRICEDISC",aR).args([["settlement","date"],["maturity","date"],["discount","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
var aC=300,T=2.2204e-16,af=1e-30,X=Math.abs;
function U(bk){if(X(bk)>=3.3){return 1-V(bk);
}var bj=bk>0?1:-1;
if(bj==-1){bk=-bk;
}var bh=0,bg=1;
for(var bi=1;
bi<100;
bi++){bh+=bg;
bg*=2*bk*bk/(2*bi+1);
}return bj*2/Math.sqrt(Math.PI)*bk*Math.exp(-bk*bk)*bh;
}function V(bj){if(X(bj)<3.3){return 1-U(bj);
}var bi=1;
if(bj<0){bi=-1;
bj=-bj;
}var bg=bj;
for(var bh=8;
bh>=1;
bh-=0.5){bg=bj+bh/bg;
}bg=1/(bj+bg);
return bi==1?Math.exp(-bj*bj)/Math.sqrt(Math.PI)*bg:2-Math.exp(-bj*bj)/Math.sqrt(Math.PI)*bg;
}function ao(bk){var bg=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,0.001208650973866179,-5.395239384953e-06];
var bl=bk,bj=bk+5.5,bi=bg[0];
bj-=(bk+0.5)*Math.log(bj);
for(var bh=1;
bh<=6;
bh++){bl+=1;
bi+=bg[bh]/bl;
}return -bj+Math.log(Math.sqrt(2*Math.PI)*bi/bk);
}function ak(bh){if(bh>0){return Math.exp(ao(bh));
}var bg=Math.PI,bi=-bh;
return -bg/(bi*ak(bi)*Math.sin(bg*bi));
}function q(bg,bh){return ao(bg)+ao(bh)-ao(bg+bh);
}function l(bg,bh){return Math.exp(q(bg,bh));
}function am(bg,bh){return bh<bg+1?aj(bg,bh):1-ai(bg,bh);
}function aj(bg,bm){var bl=1/bg,bi=bl,bh=bg;
var bj=ao(bg),bk;
for(bk=1;
bk<=aC;
bk++){bh++;
bi*=bm/bh;
bl+=bi;
if(X(bi)<X(bl)*T){break;
}}return bl*Math.exp(-bm+bg*Math.log(bm)-bj);
}function ai(bg,bq){var bn=af,bk=bn,bl=0,bh=1,bi=bq+1-bg;
var bo=ao(bg);
for(var bp=1;
bp<=aC;
bp++){bl=bi+bh*bl;
if(X(bl)<af){bl=af;
}bk=bi+bh/bk;
if(X(bk)<af){bk=af;
}bl=1/bl;
var bm=bk*bl;
bn*=bm;
if(X(bm-1)<T){break;
}bi+=2;
bh=-bp*(bp-bg);
}return bn*Math.exp(-bq-bo+bg*Math.log(bq));
}function al(bj,bg,bh,bi){if(!bi){return Math.pow(bj/bh,bg-1)*Math.exp(-bj/bh)/(bh*ak(bg));
}return am(bg,bj/bh);
}function an(bm,bg,bi){if(bm===0){return 0;
}if(bm==1){return Infinity;
}var bk=0,bl=10,bo=0,bh=bg*bi;
if(bh>1){bl*=bh;
}for(var bj=0;
bj<aC;
bj++){bo=0.5*(bk+bl);
var bn=al(bo,bg,bi,true);
if(X(bm-bn)<1e-16){break;
}if(bn>bm){bl=bo;
}else{bk=bo;
}}return bo;
}function aG(bh,bg){if(!bg){return Math.exp(-bh*bh/2)/Math.sqrt(2*Math.PI);
}return 0.5+0.5*U(bh/Math.sqrt(2));
}function aH(bk){var bg=[-39.69683028665376,220.9460984245205,-275.9285104469687,138.357751867269,-30.66479806614716,2.506628277459239],bh=[-54.47609879822406,161.5858368580409,-155.6989798598866,66.80131188771972,-13.28068155288572],bi=[-0.007784894002430293,-0.3223964580411365,-2.400758277161838,-2.549732539343734,4.374664141464968,2.938163982698783],bj=[0.007784695709041462,0.3224671290700398,2.445134137142996,3.754408661907416];
var bm=0.02425,bl=1-bm;
var bn,bo;
if(bk<bm){bn=Math.sqrt(-2*Math.log(bk));
return(((((bi[0]*bn+bi[1])*bn+bi[2])*bn+bi[3])*bn+bi[4])*bn+bi[5])/((((bj[0]*bn+bj[1])*bn+bj[2])*bn+bj[3])*bn+1);
}if(bl<bk){bn=Math.sqrt(-2*Math.log(1-bk));
return -(((((bi[0]*bn+bi[1])*bn+bi[2])*bn+bi[3])*bn+bi[4])*bn+bi[5])/((((bj[0]*bn+bj[1])*bn+bj[2])*bn+bj[3])*bn+1);
}bn=bk-0.5;
bo=bn*bn;
return(((((bg[0]*bo+bg[1])*bo+bg[2])*bo+bg[3])*bo+bg[4])*bo+bg[5])*bn/(((((bh[0]*bo+bh[1])*bo+bh[2])*bo+bh[3])*bo+bh[4])*bo+1);
}function aE(bj,bh,bi,bg){if(!bg){return Math.exp(-(bj-bh)*(bj-bh)/(2*bi*bi))/(bi*Math.sqrt(2*Math.PI));
}return aG((bj-bh)/bi,true);
}function aF(bh,bg,bi){return bg+bi*aH(bh);
}function t(bi,bg,bh){return Math.exp((bg-1)*Math.log(bi)+(bh-1)*Math.log(1-bi)-q(bg,bh));
}function r(bj,bg,bh){var bi=Math.exp(bg*Math.log(bj)+bh*Math.log(1-bj)-q(bg,bh));
return bj<(bg+1)/(bg+bh+2)?bi*o(bg,bh,bj)/bg:1-bi*o(bh,bg,1-bj)/bh;
}function o(bg,bi,bs){var bn,bo;
var bh,bj,bk,bl,bm,bp,bq,br;
bp=bg+bi;
br=bg+1;
bq=bg-1;
bj=1;
bk=1-bp*bs/br;
if(X(bk)<af){bk=af;
}bk=1/bk;
bm=bk;
for(bn=1;
bn<=aC;
bn++){bo=2*bn;
bh=bn*(bi-bn)*bs/((bq+bo)*(bg+bo));
bk=1+bh*bk;
if(X(bk)<af){bk=af;
}bj=1+bh/bj;
if(X(bj)<af){bj=af;
}bk=1/bk;
bm*=bk*bj;
bh=-(bg+bn)*(bp+bn)*bs/((bg+bo)*(br+bo));
bk=1+bh*bk;
if(X(bk)<af){bk=af;
}bj=1+bh/bj;
if(X(bj)<af){bj=af;
}bk=1/bk;
bl=bk*bj;
bm*=bl;
if(X(bl-1)<T){break;
}}return bm;
}function s(bl,bg,bh){var bj=0,bk=1,bn=0;
for(var bi=0;
bi<aC;
bi++){bn=0.5*(bj+bk);
var bm=r(bn,bg,bh);
if(X(bl-bm)<T){break;
}if(bm>bl){bk=bn;
}else{bj=bn;
}}return bn;
}function p(bk,bg,bh,bi,bj){return r((bk-bi)/(bj-bi),bg,bh);
}function m(bl,bg,bh,bi,bj,bk){if(bi){return r((bl-bj)/(bk-bj),bg,bh);
}return t((bl-bj)/(bk-bj),bg,bh)/(bk-bj);
}function n(bk,bg,bh,bi,bj){return bi+(bj-bi)*s(bk,bg,bh);
}function w(bi,bh,bg){return al(bi,bh/2,2,bg);
}function y(bh,bg){return 1-w(bh,bg,true);
}function x(bh,bg){return an(bh,bg/2,2);
}function z(bh,bg){return x(1-bh,bg);
}function A(bn,bj){var bo=bn.length,bg=bn[0].length;
var bp=0,bk,bl;
for(bk=0;
bk<bo;
bk++){for(bl=0;
bl<bg;
bl++){var bi=bj[bk][bl];
var bh=bn[bk][bl]-bi;
bh*=bh;
bp+=bh/bi;
}}var bm=(bo-1)*(bg-1);
return y(bp,bm);
}function W(bi,bh,bg){if(bg){return 1-Math.exp(-bh*bi);
}return bh*Math.exp(-bh*bi);
}function aO(bi,bk,bg){if(bg){return 1-w(2*bk,2*(bi+1),true);
}var bj=0;
for(var bh=2;
bh<=bi;
bh++){bj+=Math.log(bh);
}return Math.exp(bi*Math.log(bk)-bk-bj);
}function Y(bk,bi,bh,bg){if(bg){return r(bi*bk/(bh+bi*bk),bi/2,bh/2);
}var bj=bi/bh;
bi/=2;
bh/=2;
return bj/l(bi,bh)*Math.pow(bj*bk,bi-1)/Math.pow(1+bj*bk,bi+bh);
}function Z(bi,bh,bg){return 1-Y(bi,bh,bg,true);
}function ab(bi,bh,bg){return bg/bh*(1/n(bi,bg/2,bh/2,0,1)-1);
}function aa(bi,bh,bg){return bg/bh*(1/n(1-bi,bg/2,bh/2,0,1)-1);
}function h(bg){var bi=0,bj=bg.length;
for(var bh=0;
bh<bj;
bh++){bi+=bg[bh];
}return bi/bj;
}function i(bg,bj){var bl=0,bk=bg.length;
for(var bi=0;
bi<bk;
bi++){var bh=bg[bi]-bj;
bl+=bh*bh;
}return bl/(bk-1);
}function ag(bg,bh){var bi=bg.length-1,bj=bh.length-1;
var bk=i(bg,h(bg)),bl=i(bh,h(bh));
if(!bk||!bl){throw new v("DIV/0");
}return 2*Y(bk/bl,bi,bj,true);
}function ac(bg){return 0.5*Math.log((1+bg)/(1-bg));
}function ad(bh){var bg=Math.exp(2*bh);
return(bg-1)/(bg+1);
}function a4(bi,bh,bg){if(bg){return 1-0.5*r(bh/(bi*bi+bh),bh/2,0.5);
}return 1/(Math.sqrt(bh)*l(0.5,bh/2))*Math.pow(1+bi*bi/bh,-(bh+1)/2);
}function a8(bh,bg){return 1-a4(bh,bg,true);
}function a5(bh,bg){if(bh<0){bh=-bh;
}return 2*a8(bh,bg);
}function a7(bh,bg){var bi=s(2*Math.min(bh,1-bh),bg/2,0.5);
bi=Math.sqrt(bg*(1-bi)/bi);
return bh>0.5?bi:-bi;
}function a6(bh,bg){return a7(1-bh/2,bg);
}function a9(bk,bl,bv,bw){var bq=bk.length,br=bl.length;
var bu,bj;
if(bw==1){var bg=0,bh=0;
for(var bm=0;
bm<bq;
bm++){var bi=bk[bm]-bl[bm];
bg+=bi;
bh+=bi*bi;
}var bp=bg/bq;
bu=bp/Math.sqrt((bh-bg*bp)/(bq*(bq-1)));
return bv==1?a8(bu,bq-1):a5(bu,bq-1);
}var bn=h(bk),bo=h(bl),bA=i(bk,bn),bB=i(bl,bo);
if(bw==3){var by=bA/bq,bz=bB/br,bx=by+bz;
var bs=by/bx,bt=bz/bx;
bj=1/(bs*bs/(bq-1)+bt*bt/(br-1));
bu=X(bn-bo)/Math.sqrt(bx);
return bv==1?a8(bu,bj):a5(bu,bj);
}else{bj=bq+br-2;
bu=X(bn-bo)*Math.sqrt(bj*bq*br/((bq+br)*((bq-1)*bA+(br-1)*bB)));
return bv==1?a8(bu,bj):a5(bu,bj);
}}function C(bg,bi,bh){return -a7(bg/2,bh-1)*bi/Math.sqrt(bh);
}function B(bg,bi,bh){return -aH(bg/2)*bi/Math.sqrt(bh);
}function ap(bg){return aG(bg,true)-0.5;
}function aM(bg){return aG(bg);
}function aA(bk,bh,bi,bg){if(bg){return 0.5+0.5*U((Math.log(bk)-bh)/(bi*Math.sqrt(2)));
}var bj=Math.log(bk)-bh;
return Math.exp(-bj*bj/(2*bi*bi))/(bk*bi*Math.sqrt(2*Math.PI));
}function aB(bh,bg,bi){return Math.exp(aF(bh,bg,bi));
}function aS(bo,bj,bh,bm){var bi=bo.length;
var bl=0,bg;
for(bg=0;
bg<bi;
bg++){if(bj[bg]<=0||bj[bg]>1){throw new v("NUM");
}bl+=bj[bg];
}if(bl!=1){throw new v("NUM");
}var bk=0;
for(bg=0;
bg<bi;
bg++){var bn=bo[bg];
if(bn>=bh&&bn<=bm){bk+=bj[bg];
}}return bk;
}function a0(bo,bn){var bj=h(bn),bk=h(bo),bg=0,bh=0;
for(var bi=0,bl=bo.length;
bi<bl;
bi++){var bm=bn[bi]-bj;
bg+=bm*(bo[bi]-bk);
bh+=bm*bm;
}return bg/bh;
}function ar(bo,bn){var bj=h(bn),bk=h(bo);
var bg=0,bh=0;
for(var bi=0,bl=bo.length;
bi<bl;
bi++){var bm=bn[bi]-bj;
bg+=bm*(bo[bi]-bk);
bh+=bm*bm;
}return bk-bg*bj/bh;
}function aL(bp,bq){bd(bp,bq);
var bh=h(bp),bi=h(bq);
var bk=0,bl=0,bm=0;
for(var bg=0,bj=bp.length;
bg<bj;
bg++){var bn=bp[bg]-bh,bo=bq[bg]-bi;
bk+=bn*bo;
bl+=bn*bn;
bm+=bo*bo;
}return bk/Math.sqrt(bl*bm);
}function aX(bh,bi){var bg=aL(bh,bi);
return bg*bg;
}function a2(bq,bp){var bj=bp.length;
var bh=h(bp),bi=h(bq);
var bk=0,bl=0,bm=0;
for(var bg=0;
bg<bj;
bg++){var bn=bp[bg]-bh,bo=bq[bg]-bi;
bk+=bo*bo;
bl+=bn*bo;
bm+=bn*bn;
}return Math.sqrt((bk-bl*bl/bm)/(bj-2));
}function ae(bq,bs,br){var bj=h(br),bk=h(bs);
var bm=0,bn=0;
for(var bi=0,bl=br.length;
bi<bl;
bi++){var bo=br[bi]-bj,bp=bs[bi]-bk;
bm+=bo*bp;
bn+=bo*bo;
}if(bn===0){throw new v("N/A");
}var bh=bm/bn,bg=bk-bh*bj;
return bg+bh*bq;
}function g(bh){var bi=bh.height,bj=0;
for(var bg=0;
bg<bi;
bg++){bj+=bh.data[bg][0];
}return bj/bi;
}function f(bh,bi){var bj=bh.height,bk=0;
for(var bg=0;
bg<bj;
bg++){var bl=bh.data[bg][0]-bi;
bk+=bl*bl;
}return bk;
}function ay(bA,by,bl,bx){var bk=0;
if(!by){by=bA.map(function(){return ++bk;
});
}if(bl){by=by.clone();
by.eachRow(function(bD){by.data[bD].unshift(1);
});
++by.width;
}var bz=by.transpose();
var bg=bz.multiply(by).inverse().multiply(bz).multiply(bA);
var bm=[];
for(bk=bg.height-1;
bk>=0;
bk--){bm.push(bg.data[bk][0]);
}if(!bl){bm.push(0);
}if(!bx){return this.asMatrix([bm]);
}var bC=by.multiply(bg);
var bB=bA.adds(bC,true);
var bs=!bl?0:g(bC);
var bv=f(bC,bs);
var br=!bl?0:g(bB);
var bw=f(bB,br);
var bq=[];
bq.push(bv,bw);
var bt=bv/(bv+bw);
var bh=bA.height-by.width;
var bi=Math.sqrt(bw/bh);
var bo=[];
bo.push(bt,bi);
var bj=!bl?bt/by.width/((1-bt)/bh):bv/(by.width-1)/(bw/bh);
var bp=[];
bp.push(bj,bh);
var bu=bz.multiply(by).inverse();
var bn=[];
for(bk=bu.height-1;
bk>=0;
bk--){bn.push(Math.sqrt(bu.data[bk][bk]*bw/bh));
}return this.asMatrix([bm,bn,bo,bp,bq]);
}function az(bj,bi,bg,bh){return ay.call(this,bj.map(Math.log),bi,bg,bh).map(Math.exp);
}function ba(bm,bk,bj,bi){var bh=0;
if(!bk){bk=bm.map(function(){return ++bh;
});
}if(bi){bk=bk.clone();
bk.eachRow(function(bn){bk.data[bn].unshift(1);
});
++bk.width;
}var bl=bk.transpose();
var bg=bl.multiply(bk).inverse().multiply(bl).multiply(bm);
if(!bj){bj=bk;
}else{if(bi){bj=bj.clone();
bj.eachRow(function(bn){bj.data[bn].unshift(1);
});
++bj.width;
}}return bj.multiply(bg);
}function aq(bj,bi,bh,bg){return ba.call(this,bj.map(Math.log),bi,bh,bg).map(Math.exp);
}function aW(bm,bn,bp,bi){var bq=bp||20,bj=bi||1e-07;
var br=bn;
for(var bo=1;
bo<=bq;
bo++){var bl=bm(br),bk=bl[0],bg=bl[1];
var bh=bk/bg;
br-=bh;
if(Math.abs(bh)<bj){return br;
}}return new v("NUM");
}function ah(bl,bi,bj,bk,bm){var bg=Math.pow(1+bl,bi);
var bh=bl?(bg-1)/bl:bi;
return -(bk*bg+bj*bh*(1+bl*bm));
}function aT(bk,bi,bj,bg,bl){if(!bk){return -bg-bj*bi;
}var bh=Math.pow(1+bk,bi);
return -(bg+bj*(bh-1)/bk*(1+bk*bl))/bh;
}function aN(bk,bi,bj,bg,bl){if(!bk){return -(bg+bj)/bi;
}var bh=Math.pow(1+bk,bi);
return -bk*(bg+bj*bh)/((1+bk*bl)*(bh-1));
}function aI(bk,bi,bj,bg,bl){if(!bk){return -(bg+bj)/bi;
}var bh=bi*(1+bk*bl);
return Math.log((bh-bg*bk)/(bh+bj*bk))/Math.log(1+bk);
}function aU(bi,bj,bk,bg,bl,bh){function bm(bp){var bo=Math.pow(1+bp,bi-1),bn=bo*(1+bp);
return[bk*bn+bj*(1/bp+bl)*(bn-1)+bg,bi*bk*bo+bj*(-(bn-1)/(bp*bp)+(1/bp+bl)*bi*bo)];
}return aW(bm,bh);
}function au(bm,bj,bi,bl,bg,bn){if(bn==1&&bj==1){return 0;
}var bk=aN(bm,bi,bl,bg,bn);
var bh=ah(bm,bj-1,bk,bl,bn)*bm;
return bn?bh/(1+bm):bh;
}function aP(bl,bi,bh,bk,bg,bm){var bj=aN(bl,bh,bk,bg,bm);
return bj-au(bl,bi,bh,bk,bg,bm);
}function L(bk,bi,bj,bn,bg,br){if(br==1){bn--;
bg--;
}var bp=Math.pow(1+bk,bi),bq=Math.pow(1+bk,bn-1),bo=Math.pow(1+bk,bg);
var bh=bk*bj*bp/(bp-1);
var bm=bq*bj-(bq-1)/bk*bh;
var bl=bo*bj-(bo-1)/bk*bh;
return bl-bm;
}function K(bl,bj,bk,bm,bh,bn){var bg=0;
for(var bi=bm;
bi<=bh;
bi++){bg+=au(bl,bi,bj,bk,0,bn);
}return bg;
}function aJ(bk,bg){var bj=0;
for(var bh=0,bi=bg.length;
bh<bi;
bh++){bj+=bg[bh]*Math.pow(1+bk,-bh-1);
}return bj;
}function av(bg,bh){function bi(bn){var bl=0,bm=0;
for(var bj=0,bk=bg.length;
bj<bk;
bj++){bl+=bg[bj]*Math.pow(1+bn,-bj-1);
bm+=-bj*bg[bj]*Math.pow(1+bn,-bj-2);
}return[bl,bm];
}return aW(bi,bh);
}function S(bg,bh){return Math.pow(1+bg/bh,bh)-1;
}function aD(bg,bh){return bh*(Math.pow(bg+1,1/bh)-1);
}function bf(bk,bl,bg){var bj=0;
for(var bh=0,bi=bl.length;
bh<bi;
bh++){bj+=bl[bh]*Math.pow(1+bk,(bg[0]-bg[bh])/365);
}return bj;
}function be(bi,bg,bh){function bj(bp){var bn=bi[0],bo=0;
for(var bl=1,bm=bi.length;
bl<bm;
bl++){var bk=(bg[0]-bg[bl])/365;
bn+=bi[bl]*Math.pow(1+bp,bk);
bo+=bk*bi[bl]*Math.pow(1+bp,bk-1);
}return[bn,bo];
}return aW(bj,bh);
}function ax(bj,bh,bg,bi){var bk=-bi*bj;
return bk*(1-bh/bg);
}function O(bg,bn,bj,bl,bk){var bm=1-Math.pow(bn/bg,1/bj);
bm=Math.floor(bm*1000+0.5)/1000;
var bh=bg*bm*bk/12;
if(bl==1){return bh;
}for(var bi=1;
bi<bj;
bi++){if(bi==bl-1){return(bg-bh)*bm;
}bh+=(bg-bh)*bm;
}return(bg-bh)*bm*(12-bk)/12;
}function P(bg,bn,bk,bl,bj){var bi=bj/bk;
var bm=-bg*(Math.pow(1-bi,bl-1)-1);
var bh=(bg-bm)*bi;
bh=Math.min(bh,Math.max(0,bg-bm-bn));
return bh;
}function aZ(bg,bi,bh){return(bg-bi)/bh;
}function a3(bg,bj,bh,bi){return(bg-bj)*(bh-bi+1)*2/(bh*(bh+1));
}function bc(bi,bt,bp,bu,bj,bk,br){var bn=bk>=bp?1:bk/bp;
function bg(bB,bA){var bx,bz,by;
if(bn==1){bz=bA==1?bB:0;
}else{bz=bB*Math.pow(1-bn,bA-1);
}by=bB*Math.pow(1-bn,bA);
bx=by<bt?bz-bt:bz-by;
return bx<0?0:bx;
}function bh(bx,bC,bE){var bF=bx-bt;
var bA=Math.ceil(bE);
var bG,bB=0,bH=0,bD=false;
for(var bz=1;
bz<=bA;
bz++){if(!bD){var by=bg(bx,bz);
bB=bF/(bC-bz+1);
if(bB>by){bG=bB;
bD=true;
}else{bG=by;
bF-=by;
}}else{bG=bB;
}if(bz==bA){bG*=bE+1-bA;
}bH+=bG;
}return bH;
}var bo=Math.floor(bu),bm=Math.ceil(bj);
var bw=0;
if(br){for(var bl=bo+1;
bl<=bm;
bl++){var bv=bg(bi,bl);
if(bl==bo+1){bv*=Math.min(bj,bo+1)-bu;
}else{if(bl==bm){bv*=bj+1-bm;
}}bw+=bv;
}}else{var bq=bp;
if(bu!=Math.floor(bu)){if(bk>1){if(bu>=bp/2){var bs=bu-bp/2;
bu=bp/2;
bj-=bs;
bq+=1;
}}}bi-=bh(bi,bq,bu);
bw=bh(bi,bp-bu,bj-bu);
}return bw;
}function e(bg,bj){var bh=bb(bg);
var bi=bh.month+bj;
var bk=bh.year+Math.floor(bi/12);
bi%=12;
if(bi<0){bi+=12;
}bh=Math.min(bh.date,M(bk,bi));
return aK(bk,bi,bh);
}function d(bh,bi,bg){if(bg==1||bg==2||bg==3){return bi-bh;
}return c(bh,bi,bg);
}function a(bo,bi,bh){var bn=bb(bo),bg=bb(bi);
var bl=bg.year-bn.year;
if(bl>0){bl=(bl-1)*bh;
}var bm,bk,bj=12/bh;
do{bl++;
bm=e(bi,-bl*bj);
}while(bo<bm);
bl--;
bk=e(bi,-bl*bj);
return[bm,bk];
}function b(bh,bo,bi){var bn=bb(bo),bg=bb(bh);
var bl=bn.year-bg.year;
if(bl>0){bl=(bl-1)*bi;
}var bm=bh,bk,bj=12/bi;
while(bo>bm){bk=bm;
bl++;
bm=e(bh,bl*bj);
}return[bk,bm];
}function D(bk,bi,bh,bg){var bj=a(bk,bi,bh)[0];
return d(bj,bk,bg);
}function E(bk,bj,bi,bg){if(bg==1){var bh=a(bk,bj,bi);
return d(bh[0],bh[1],1);
}if(bg==3){return 365/bi;
}return 360/bi;
}function F(bk,bi,bh,bg){var bj=a(bk,bi,bh)[1];
return d(bk,bj,bg);
}function I(bi,bh,bg){return a(bi,bh,bg)[0];
}function G(bi,bh,bg){return a(bi,bh,bg)[1];
}function H(bl,bi,bg){var bk=bb(bl),bh=bb(bi);
var bj=12*(bh.year-bk.year)+bh.month-bk.month;
return 1+(bj*bg/12|0);
}function N(bh,bg){if(bg==3){return 365;
}if(bg==1){return aw(bh)?366:365;
}return 360;
}function k(bh,bi,bk,bj,bg){var bl=N(bb(bi).year,bg);
return bk*bj*d(bh,bi,bg)/bl;
}function j(bp,bn,bx,bw,bt,bo,bj,bl){var bh=0,bm=bt*bw/bo;
var bk,bu,bq,bv,br,bs;
var bi=bj%2===0?360:365;
function bg(by,bz){return(bz-by)*bo/bi|0;
}if(bx<=bn){bk=a(bx,bn,bo);
bu=bk[0];
bq=bk[1];
if(bu<=bp){return bm*d(bp,bx,bj)/d(bu,bq,bj);
}bk=a(bp,bu,bo);
bv=bk[0];
br=bk[1];
bs=bg(br,bx);
return bm*(bs+d(bp,br,bj)/d(bv,br,bj)+(bx<bq?d(bu,bx,bj)/d(bu,bq,bj):0));
}else{bk=b(bn,bx,bo);
bu=bk[0];
bq=bk[1];
bs=bg(bn,bx);
if(bq==bx){bh=bm*bs;
}else{bh=bm*(bs+d(bu,bx,bj)/d(bu,bq,bj));
}if(!bl){return bh;
}bk=a(bp,bn,bo);
bu=bk[0];
bq=bk[1];
bs=bg(bp,bn);
bh+=bm*(bs+d(bp,bq,bj)/d(bu,bq,bj));
return bh;
}}function R(bl,bi,bj,bk,bh){var bg=bh%2===0?360:aw(bb(bl).year)?366:365;
return(bk-bj)/bk*bg/d(bl,bi,bh);
}function at(bl,bj,bi,bk,bh){var bg=bh%2===0?360:aw(bb(bl).year)?366:365;
return(bk-bi)/bi*bg/d(bl,bj,bh);
}function aV(bl,bk,bj,bi,bh){var bg=bh%2===0?360:aw(bb(bl).year)?366:365;
return bj/(1-bi*d(bl,bk,bh)/bg);
}function aQ(bt,bn,br,bw,bs,bm,bg){var bo=1+((bn-bt)*bm/(bg%2===0?360:365)|0);
var bj=a(bt,bn,bm),bq=bj[0],bp=bj[1];
var bi=d(bq,bt,bg),bu=d(bt,bp,bg),bh=d(bq,bp,bg);
var bk=100*br/bm,bv=bw/bm,bl=bu/bh;
if(bo==1){return(bs+bk)/(1+bl*bv)-bi/bh*bk;
}return bs/Math.pow(1+bv,bo-1+bl)+bk*Math.pow(1+bv,1-bo-bl)*(Math.pow(1+bv,bo)-1)/bv-bi/bh*bk;
}function aR(bm,bk,bh,bl,bg){var bi=d(bm,bk,bg),bj=N(bb(bk).year,bg);
return bl-bh*bl*bi/bj;
}function bd(bg,bh){for(var bi=bg.length;
--bi>=0;
){if(typeof bg[bi]!="number"||typeof bh[bi]!="number"){bg.splice(bi,1);
bh.splice(bi,1);
}}}},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/borderpalette",["kendo.core","kendo.colorpicker","kendo.popup"],b);
}(function(){(function(g){if(g.support.browser.msie&&g.support.browser.version<9){return;
}var a=g.jQuery;
var c=["allBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","outsideBorders","leftBorder","topBorder","rightBorder","bottomBorder","noBorders"];
var b=g.spreadsheet.messages.borderPalette={allBorders:"All borders",insideBorders:"Inside borders",insideHorizontalBorders:"Inside horizontal borders",insideVerticalBorders:"Inside vertical borders",outsideBorders:"Outside borders",leftBorder:"Left border",topBorder:"Top border",rightBorder:"Right border",bottomBorder:"Bottom border",noBorders:"No border"};
var e=g.spreadsheet.messages.colorPicker={reset:"Reset color",customColor:"Custom color...",apply:"Apply",cancel:"Cancel"};
function h(i){return function(j){j.preventDefault();
return i.apply(this,arguments);
};
}var f=g.ui.Widget.extend({init:function(i,j){g.ui.Widget.call(this,i,j);
this.element=i;
this.color=j.color;
this._resetButton();
this._colorPalette();
this._customColorPalette();
this._customColorButton();
this.resetButton.on("click",h(this.resetColor.bind(this)));
this.customColorButton.on("click",h(this.customColor.bind(this)));
},options:{name:"ColorChooser"},events:["change"],destroy:function(){g.unbind(this.dialog.element.find(".k-action-buttons"));
this.dialog.destroy();
this.colorPalette.destroy();
this.resetButton.off("click");
this.customColorButton.off("click");
},value:function(i){if(i!==undefined){this.color=i;
this.customColorButton.find(".k-icon").css("background-color",this.color);
this.colorPalette.value(null);
this.flatColorPicker.value(this.color);
}else{return this.color;
}},_change:function(i){this.color=i;
this.trigger("change",{value:i});
},_colorPalette:function(){var j=a("<div />",{"class":"k-spreadsheet-color-palette"});
var i=this.colorPalette=a("<div />").kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],value:this.color,change:function(k){this.customColorButton.find(".k-icon").css("background-color","transparent");
this.flatColorPicker.value(null);
this._change(k.value);
}.bind(this)}).data("kendoColorPalette");
j.append(i.wrapper).appendTo(this.element);
},_customColorPalette:function(){var j=a("<div />",{"class":"k-spreadsheet-window",html:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>"+e.apply+"</button><button class='k-button' data-bind='click: close'>"+e.cancel+"</button></div>"});
var i=this.dialog=j.appendTo(document.body).kendoWindow({animation:false,scrollable:false,resizable:false,maximizable:false,modal:true,visible:false,width:"auto",open:function(){this.center();
}}).data("kendoWindow");
i.one("activate",function(){this.element.find("[data-role=flatcolorpicker]").data("kendoFlatColorPicker")._hueSlider.resize();
});
var k=this.flatColorPicker=i.element.children().first().kendoFlatColorPicker().data("kendoFlatColorPicker");
var l=g.observable({apply:function(){this.customColorButton.find(".k-icon").css("background-color",k.value());
this.colorPalette.value(null);
this._change(k.value());
i.close();
}.bind(this),close:function(){k.value(null);
i.close();
}});
g.bind(i.element.find(".k-action-buttons"),l);
},_resetButton:function(){this.resetButton=a("<a class='k-button k-reset-color' href='#'><span class='k-icon k-i-reset-color'></span>"+e.reset+"</a>").appendTo(this.element);
},_customColorButton:function(){this.customColorButton=a("<a class='k-button k-custom-color' href='#'><span class='k-icon'></span>"+e.customColor+"</a>").appendTo(this.element);
},resetColor:function(){this.colorPalette.value(null);
this.flatColorPicker.value(null);
this._change(null);
},customColor:function(){this.dialog.open();
}});
var d=g.ui.Widget.extend({init:function(i,j){g.ui.Widget.call(this,i,j);
this.element=i;
this.color="#000";
this.element.addClass("k-spreadsheet-border-palette");
this._borderTypePalette();
this._borderColorPalette();
this.element.on("click",".k-spreadsheet-border-type-palette .k-button",h(this._click.bind(this)));
},options:{name:"BorderPalette"},events:["change"],destroy:function(){this.colorChooser.destroy();
this.element.off("click");
},_borderTypePalette:function(){var k=b;
var i=c.map(function(l){return'<a title="'+k[l]+'" aria-label="'+k[l]+'" href="#" data-border-type="'+l+'" class="k-button k-button-icon"><span class="k-icon k-i-'+g.toHyphens(l)+'"></span></a>';
}).join("");
var j=a("<div />",{"class":"k-spreadsheet-border-type-palette",html:i});
j.appendTo(this.element);
},_borderColorPalette:function(){var i=a("<div />",{"class":"k-spreadsheet-border-color-palette"});
i.appendTo(this.element);
this.colorChooser=new f(i,{color:this.color,change:this._colorChange.bind(this)});
},_click:function(i){this.type=a(i.currentTarget).data("borderType");
this.trigger("change",{type:this.type,color:this.color});
},_colorChange:function(i){this.color=i.value;
if(this.type){this.trigger("change",{type:this.type,color:this.color});
}}});
g.spreadsheet.ColorChooser=f;
g.spreadsheet.BorderPalette=d;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/toolbar",["kendo.toolbar","kendo.colorpicker","kendo.combobox","kendo.dropdownlist","kendo.popup","spreadsheet/borderpalette"],b);
}(function(){(function(y){if(y.support.browser.msie&&y.support.browser.version<9){return;
}var a=y.jQuery;
var I=y.ui.ToolBar;
var B=y.spreadsheet.messages.toolbar={addColumnLeft:"Add column left",addColumnRight:"Add column right",addRowAbove:"Add row above",addRowBelow:"Add row below",alignment:"Alignment",alignmentButtons:{justtifyLeft:"Align left",justifyCenter:"Center",justifyRight:"Align right",justifyFull:"Justify",alignTop:"Align top",alignMiddle:"Align middle",alignBottom:"Align bottom"},backgroundColor:"Background",bold:"Bold",borders:"Borders",copy:"Copy",cut:"Cut",deleteColumn:"Delete column",deleteRow:"Delete row",filter:"Filter",fontFamily:"Font",fontSize:"Font size",format:"Custom format...",formatTypes:{automatic:"Automatic",text:"Text",number:"Number",percent:"Percent",financial:"Financial",currency:"Currency",date:"Date",time:"Time",dateTime:"Date time",duration:"Duration",moreFormats:"More formats..."},formatDecreaseDecimal:"Decrease decimal",formatIncreaseDecimal:"Increase decimal",freeze:"Freeze panes",freezeButtons:{freezePanes:"Freeze panes",freezeRows:"Freeze rows",freezeColumns:"Freeze columns",unfreeze:"Unfreeze panes"},insertComment:"Insert comment",insertImage:"Insert image",italic:"Italic",merge:"Merge cells",mergeButtons:{mergeCells:"Merge all",mergeHorizontally:"Merge horizontally",mergeVertically:"Merge vertically",unmerge:"Unmerge"},open:"Open...",paste:"Paste",quickAccess:{redo:"Redo",undo:"Undo"},exportAs:"Export...",toggleGridlines:"Toggle gridlines",sort:"Sort",sortButtons:{sortRangeAsc:"Sort range A to Z",sortRangeDesc:"Sort range Z to A"},textColor:"Text Color",textWrap:"Wrap text",underline:"Underline",validation:"Data validation...",hyperlink:"Link"};
var k={home:["open","exportAs",["cut","copy","paste"],["bold","italic","underline"],"hyperlink","insertComment","insertImage","backgroundColor","textColor","borders","fontSize","fontFamily","alignment","textWrap",["formatDecreaseDecimal","formatIncreaseDecimal"],"format","merge","freeze","filter","toggleGridlines"],insert:[["addColumnLeft","addColumnRight","addRowBelow","addRowAbove"],["deleteColumn","deleteRow"]],data:["sort","filter","validation"]};
var J={open:{type:"open",overflow:"never",iconClass:"file-excel"},exportAs:{type:"exportAsDialog",dialogName:"exportAs",overflow:"never",text:"",iconClass:"file-excel"},bold:{type:"button",command:"PropertyChangeCommand",property:"bold",value:true,iconClass:"bold",togglable:true},italic:{type:"button",command:"PropertyChangeCommand",property:"italic",value:true,iconClass:"italic",togglable:true},underline:{type:"button",command:"PropertyChangeCommand",property:"underline",value:true,iconClass:"underline",togglable:true},formatDecreaseDecimal:{type:"button",command:"AdjustDecimalsCommand",value:-1,iconClass:"decimal-decrease"},formatIncreaseDecimal:{type:"button",command:"AdjustDecimalsCommand",value:+1,iconClass:"decimal-increase"},textWrap:{type:"button",command:"TextWrapCommand",property:"wrap",value:true,iconClass:"text-wrap",togglable:true},cut:{type:"button",command:"ToolbarCutCommand",iconClass:"cut"},copy:{type:"button",command:"ToolbarCopyCommand",iconClass:"copy"},paste:{type:"button",command:"ToolbarPasteCommand",iconClass:"paste"},separator:{type:"separator"},alignment:{type:"alignment",iconClass:"align-left"},backgroundColor:{type:"colorPicker",property:"background",iconClass:"paint"},textColor:{type:"colorPicker",property:"color",iconClass:"foreground-color"},fontFamily:{type:"fontFamily",property:"fontFamily",iconClass:"font-family"},fontSize:{type:"fontSize",property:"fontSize",iconClass:"font-size"},format:{type:"format",property:"format",iconClass:"custom-format"},filter:{type:"filter",property:"hasFilter",iconClass:"filter"},merge:{type:"merge",iconClass:"cells-merge"},freeze:{type:"freeze",iconClass:"pane-freeze"},borders:{type:"borders",iconClass:"borders-all"},formatCells:{type:"dialog",dialogName:"formatCells",overflow:"never"},hyperlink:{type:"dialog",dialogName:"hyperlink",iconClass:"link-horizontal",overflow:"never",text:""},toggleGridlines:{type:"button",command:"GridLinesChangeCommand",property:"gridLines",value:true,iconClass:"border-no",togglable:true},insertComment:{type:"dialog",dialogName:"insertComment",property:"comment",togglable:true,overflow:"never",iconClass:"comment",text:""},insertImage:{type:"dialog",dialogName:"insertImage",overflow:"never",iconClass:"image",text:""},addColumnLeft:{type:"button",command:"AddColumnCommand",value:"left",iconClass:"table-column-insert-left"},addColumnRight:{type:"button",command:"AddColumnCommand",value:"right",iconClass:"table-column-insert-right"},addRowBelow:{type:"button",command:"AddRowCommand",value:"below",iconClass:"table-row-insert-below"},addRowAbove:{type:"button",command:"AddRowCommand",value:"above",iconClass:"table-row-insert-above"},deleteColumn:{type:"button",command:"DeleteColumnCommand",iconClass:"table-column-delete"},deleteRow:{type:"button",command:"DeleteRowCommand",iconClass:"table-row-delete"},sort:{type:"sort",iconClass:"sort-desc"},validation:{type:"dialog",dialogName:"validation",iconClass:"exception",overflow:"never"}};
var H=I.extend({init:function(K,M){M.items=this._expandTools(M.tools||H.prototype.options.tools[M.toolbarName]);
I.fn.init.call(this,K,M);
var L=this._click.bind(this);
this.element.addClass("k-spreadsheet-toolbar");
this._addSeparators(this.element);
var N=this;
this.element.on("keydown",function(O){var P;
if(O.keyCode===9){P=N._nextTool(O.shiftKey?-1:1);
if(P){document.activeElement.blur();
if(a(P).is(".k-upload-button")){a(P).addClass("k-state-focused");
}if(a(P).find("input").length){a(P).find("input").focus();
}else{P.focus();
}O.preventDefault();
}}});
this.element.on("focusout",function(){a(this).find(".k-toolbar-first-visible").removeClass("k-state-focused");
});
this.bind({click:L,toggle:L});
},_nextTool:function(L){var M=this;
var N=M.element.find(".k-widget, .k-button, .k-button-group > a");
var K=N.index(a(document.activeElement).closest(".k-widget, .k-button, .k-button-group > a"));
if(K>0){return N[K+L];
}},_addSeparators:function(K){var L=K.children(".k-widget, a.k-button, .k-button-group");
L.before("<span class='k-separator' />");
},_expandTools:function(L){function K(P){var M=a.isPlainObject(P)?P:J[P]||{};
var N="k-icon k-i-"+M.iconClass;
var Q=M.type;
var R={button:{showText:"overflow"},colorPicker:{toolIcon:N,spriteCssClass:N},borders:{spriteCssClass:N},alignment:{spriteCssClass:N},merge:{spriteCssClass:N},freeze:{spriteCssClass:N}};
var O=a.extend({name:M.name||P,text:B[M.name||P],icon:M.iconClass,attributes:{title:B[M.name||P],"aria-label":B[M.name||P]}},R[Q],M);
if(Q=="splitButton"){O.menuButtons=O.menuButtons.map(K);
}O.attributes["data-tool"]=P;
if(M.property){O.attributes["data-property"]=M.property;
}return O;
}return L.reduce(function(N,M){if(a.isArray(M)){N.push({type:"buttonGroup",buttons:M.map(K)});
}else{N.push(K.call(this,M));
}return N;
},[]);
},_click:function(M){var O=M.target.attr("data-tool");
var N=J[O]||{};
var L=N.command;
if(!L){return;
}var K={command:L,options:{property:N.property||null,value:N.value||null}};
if(typeof K.options.value==="boolean"){K.options.value=M.checked?true:null;
}this.action(K);
},events:["click","toggle","open","close","overflowOpen","overflowClose","action","dialog"],options:{name:"SpreadsheetToolBar",resizable:true,tools:k},action:function(K){this.trigger("action",K);
},dialog:function(K){this.trigger("dialog",K);
},refresh:function(K){var N=K;
var Q=this._tools();
function O(W,Y){var X=W.toolbar;
var T=W.overflow;
var U=X&&X.options.togglable||T&&T.options.togglable;
if(!U){return;
}var V=false;
if(typeof Y==="boolean"){V=Y;
}else{if(typeof Y==="string"){if(X.options.hasOwnProperty("value")){V=X.options.value===Y;
}else{V=Y!=null;
}}}X.toggle(V);
if(T){T.toggle(V);
}}function R(U,W){var V=U.toolbar;
var T=U.overflow;
if(V&&V.update){V.update(W);
}if(T&&T.update){T.update(W);
}}for(var L=0;
L<Q.length;
L++){var M=Q[L].property;
var P=Q[L].tool;
var S=y.isFunction(N[M])?N[M]():N;
if(M=="gridLines"){S=N.sheet().showGridLines();
}if(P.type==="button"){O(P,S);
}else{R(P,S);
}}this.resize();
},_tools:function(){return this.element.find("[data-property]").toArray().map(function(K){K=a(K);
return{property:K.attr("data-property"),tool:this._getItem(K)};
}.bind(this));
},destroy:function(){this.element.find("[data-command],.k-button").each(function(){var K=a(this);
var L=K.data("instance");
if(L&&L.destroy){L.destroy();
}});
I.fn.destroy.call(this);
}});
y.spreadsheet.ToolBar=H;
var l=y.toolbar.Item.extend({init:function(L,M){var K=a("<select />").attr("title",L.attributes.title).attr("aria-label",L.attributes.title).kendoDropDownList({height:"auto"}).data("kendoDropDownList");
this.dropDownList=K;
this.element=K.wrapper;
this.options=L;
this.toolbar=M;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
K.bind("open",this._open.bind(this));
K.bind("change",this._change.bind(this));
this.element.width(L.width).attr({"data-command":"PropertyChangeCommand","data-property":L.property});
},_open:function(){var K=this.dropDownList;
var L=K.list;
var M;
L.css({whiteSpace:"nowrap",width:"auto"});
M=L.width();
if(M>0){M+=20;
}else{M=K._listWidth;
}L.css("width",M+y.support.scrollbar());
K._listWidth=M;
},_change:function(L){var O=this;
var M=L.sender;
var P=M.value();
var K=M.dataItem();
var N=K?K.popup:undefined;
if(N){setTimeout(function(){O.toolbar.dialog({name:N});
});
}else{O.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:P=="null"?null:P}});
}},value:function(K){if(K!==undefined){this.dropDownList.value(K);
}else{return this.dropDownList.value();
}}});
var E=y.toolbar.Item.extend({init:function(K,L){this.element=a("<a href='#' class='k-button k-button-icon'><span class='"+K.spriteCssClass+"'></span><span class='k-icon k-i-arrow-60-down'></span></a>");
this.element.on("click touchend",this.open.bind(this)).attr("data-command",K.command);
this.options=K;
this.toolbar=L;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
this._popup();
},destroy:function(){this.popup.destroy();
},open:function(K){K.preventDefault();
this.popup.toggle();
},_popup:function(){var K=this.element;
this.popup=a("<div class='k-spreadsheet-popup' />").appendTo(K).kendoPopup({anchor:K}).data("kendoPopup");
}});
y.toolbar.registerComponent("dialog",y.toolbar.ToolBarButton.extend({init:function(K,L){y.toolbar.ToolBarButton.fn.init.call(this,K,L);
this._dialogName=K.dialogName;
this.element.bind("click touchend",this.open.bind(this)).data("instance",this);
},open:function(){this.toolbar.dialog({name:this._dialogName});
}}));
y.toolbar.registerComponent("exportAsDialog",y.toolbar.Item.extend({init:function(K,L){this._dialogName=K.dialogName;
this.toolbar=L;
this._title=K.attributes.title;
this.element=a("<button type='button' class='k-button k-button-icon'><span class='k-icon k-i-download' /></button>").attr("title",this._title).attr("aria-label",this._title).data("instance",this);
this.element.bind("click",this.open.bind(this)).data("instance",this);
},open:function(){this.toolbar.dialog({name:this._dialogName});
}}));
var D=y.toolbar.OverflowButton.extend({init:function(L,M){y.toolbar.OverflowButton.fn.init.call(this,L,M);
this.element.on("click touchend",this._click.bind(this));
this.message=this.options.text;
var K=this.element.data("button");
this.element.data(this.options.type,K);
},_click:a.noop});
var f=E.extend({init:function(K,L){E.fn.init.call(this,K,L);
this.popup.element.addClass("k-spreadsheet-colorpicker");
this.colorChooser=new y.spreadsheet.ColorChooser(this.popup.element,{change:this._colorChange.bind(this)});
this.element.attr({"data-property":K.property});
this.element.data({type:"colorPicker",colorPicker:this,instance:this});
},destroy:function(){this.colorChooser.destroy();
E.fn.destroy.call(this);
},update:function(K){this.value(K);
},value:function(K){this.colorChooser.value(K);
},_colorChange:function(K){this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:K.sender.value()}});
this.popup.close();
}});
var g=D.extend({init:function(K,L){K.iconName="text";
D.fn.init.call(this,K,L);
},_click:function(){this.toolbar.dialog({name:"colorPicker",options:{title:this.options.property,property:this.options.property}});
}});
y.toolbar.registerComponent("colorPicker",f,g);
var p=[8,9,10,11,12,13,14,16,18,20,22,24,26,28,36,48,72];
var i=12;
var s=y.toolbar.Item.extend({init:function(L,M){var K=a("<input />").attr("aria-label",L.attributes.title).kendoComboBox({change:this._valueChange.bind(this),clearButton:false,dataSource:L.fontSizes||p,value:i}).data("kendoComboBox");
this.comboBox=K;
this.element=K.wrapper;
this.options=L;
this.toolbar=M;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
this.element.width(L.width).attr({"data-command":"PropertyChangeCommand","data-property":L.property});
this.element.data({type:"fontSize",fontSize:this});
},_valueChange:function(K){this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:y.parseInt(K.sender.value())}});
},update:function(K){this.value(y.parseInt(K)||i);
},value:function(K){if(K!==undefined){this.comboBox.value(K);
}else{return this.comboBox.value();
}}});
var t=D.extend({_click:function(){this.toolbar.dialog({name:"fontSize",options:{sizes:p,defaultSize:i}});
},update:function(K){this._value=K||i;
this.element.find(".k-text").text(this.message+" ("+this._value+") ...");
}});
y.toolbar.registerComponent("fontSize",s,t);
var o=["Arial","Courier New","Georgia","Times New Roman","Trebuchet MS","Verdana"];
var h="Arial";
var q=l.extend({init:function(L,M){l.fn.init.call(this,L,M);
var K=this.dropDownList;
K.setDataSource(L.fontFamilies||o);
K.value(h);
this.element.data({type:"fontFamily",fontFamily:this});
},update:function(K){this.value(K||h);
}});
var r=D.extend({_click:function(){this.toolbar.dialog({name:"fontFamily",options:{fonts:o,defaultFont:h}});
},update:function(K){this._value=K||h;
this.element.find(".k-text").text(this.message+" ("+this._value+") ...");
}});
y.toolbar.registerComponent("fontFamily",q,r);
var j=y.spreadsheet.formats={automatic:null,text:"@",number:"#,0.00",percent:"0.00%",financial:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',currency:"$#,##0.00;[Red]$#,##0.00",date:"m/d/yyyy",time:"h:mm:ss AM/PM",dateTime:"m/d/yyyy h:mm",duration:"[h]:mm:ss"};
var u=l.extend({_revertTitle:function(K){K.sender.value("");
K.sender.wrapper.width("auto");
},init:function(M,N){l.fn.init.call(this,M,N);
var K=this.dropDownList;
var L="<span class='k-icon k-i-"+M.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>";
K.bind("change",this._revertTitle.bind(this));
K.bind("dataBound",this._revertTitle.bind(this));
K.setOptions({dataValueField:"format",dataTextField:"name",dataValuePrimitive:true,valueTemplate:L,template:"# if (data.sample) { #<span class='k-spreadsheet-sample'>#: data.sample #</span># } ##: data.name #"});
K.text(L);
K.setDataSource([{format:j.automatic,name:B.formatTypes.automatic},{format:j.text,name:B.formatTypes.text},{format:j.number,name:B.formatTypes.number,sample:"1,499.99"},{format:j.percent,name:B.formatTypes.percent,sample:"14.50%"},{format:j.financial,name:B.formatTypes.financial,sample:"(1,000.12)"},{format:j.currency,name:B.formatTypes.currency,sample:"$1,499.99"},{format:j.date,name:B.formatTypes.date,sample:"4/21/2012"},{format:j.time,name:B.formatTypes.time,sample:"5:49:00 PM"},{format:j.dateTime,name:B.formatTypes.dateTime,sample:"4/21/2012 5:49:00"},{format:j.duration,name:B.formatTypes.duration,sample:"168:05:00"},{popup:"formatCells",name:B.formatTypes.moreFormats}]);
this.element.data({type:"format",format:this});
}});
var v=D.extend({_click:function(){this.toolbar.dialog({name:"formatCells"});
}});
y.toolbar.registerComponent("format",u,v);
var e=E.extend({init:function(K,L){E.fn.init.call(this,K,L);
this._borderPalette();
this.element.data({type:"borders",instance:this});
},destroy:function(){this.borderPalette.destroy();
E.fn.destroy.call(this);
},_borderPalette:function(){var K=a("<div />").appendTo(this.popup.element);
this.borderPalette=new y.spreadsheet.BorderPalette(K,{change:this._action.bind(this)});
},_action:function(K){this.toolbar.action({command:"BorderChangeCommand",options:{border:K.type,style:{size:1,color:K.color}}});
}});
var d=D.extend({_click:function(){this.toolbar.dialog({name:"borders"});
}});
y.toolbar.registerComponent("borders",e,d);
var c=E.extend({init:function(K,L){E.fn.init.call(this,K,L);
this.element.attr({"data-property":"alignment"});
this._defineButtons();
this._commandPalette();
this.popup.element.on("click",".k-button",function(M){this._action(a(M.currentTarget));
}.bind(this));
this.element.data({type:"alignment",alignment:this,instance:this});
},_defineButtons:function(){this.buttons=[{property:"textAlign",value:"left",iconClass:"align-left",text:B.alignmentButtons.justtifyLeft},{property:"textAlign",value:"center",iconClass:"align-center",text:B.alignmentButtons.justifyCenter},{property:"textAlign",value:"right",iconClass:"align-right",text:B.alignmentButtons.justifyRight},{property:"textAlign",value:"justify",iconClass:"align-justify",text:B.alignmentButtons.justifyFull},{property:"verticalAlign",value:"top",iconClass:"align-top",text:B.alignmentButtons.alignTop},{property:"verticalAlign",value:"center",iconClass:"align-middle",text:B.alignmentButtons.alignMiddle},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom",text:B.alignmentButtons.alignBottom}];
},destroy:function(){this.popup.element.off();
E.fn.destroy.call(this);
},update:function(L){var M=L.textAlign();
var N=L.verticalAlign();
var K=this.popup.element;
K.find(".k-button").removeClass("k-state-active");
if(M){K.find("[data-property=textAlign][data-value="+M+"]").addClass("k-state-active");
}if(N){K.find("[data-property=verticalAlign][data-value="+N+"]").addClass("k-state-active");
}},_commandPalette:function(){var K=this.buttons;
var L=a("<div />").appendTo(this.popup.element);
K.forEach(function(O,N){var M="<a title='"+O.text+"' data-property='"+O.property+"' data-value='"+O.value+"' class='k-button k-button-icon'><span class='k-icon k-i-"+O.iconClass+"'></span></a>";
if(N!==0&&K[N-1].property!==O.property){L.append(a("<span class='k-separator' />"));
}L.append(M);
});
},_action:function(K){var L=K.attr("data-property");
var M=K.attr("data-value");
this.toolbar.action({command:"PropertyChangeCommand",options:{property:L,value:M}});
}});
var b=D.extend({_click:function(){this.toolbar.dialog({name:"alignment"});
}});
y.toolbar.registerComponent("alignment",c,b);
var A=E.extend({init:function(K,L){E.fn.init.call(this,K,L);
this._defineButtons();
this._commandPalette();
this.popup.element.on("click",".k-button",function(M){this._action(a(M.currentTarget));
}.bind(this));
this.element.data({type:"merge",merge:this,instance:this});
},_defineButtons:function(){this.buttons=[{value:"cells",iconClass:"cells-merge",text:B.mergeButtons.mergeCells},{value:"horizontally",iconClass:"cells-merge-horizontally",text:B.mergeButtons.mergeHorizontally},{value:"vertically",iconClass:"cells-merge-vertically",text:B.mergeButtons.mergeVertically},{value:"unmerge",iconClass:"table-unmerge",text:B.mergeButtons.unmerge}];
},destroy:function(){this.popup.element.off();
E.fn.destroy.call(this);
},_commandPalette:function(){var K=a("<div />").appendTo(this.popup.element);
this.buttons.forEach(function(M){var L="<a title='"+M.text+"' data-value='"+M.value+"' class='k-button k-button-icontext'><span class='k-icon k-i-"+M.iconClass+"'></span>"+M.text+"</a>";
K.append(L);
});
},_action:function(K){var L=K.attr("data-value");
this.toolbar.action({command:"MergeCellCommand",options:{value:L}});
}});
var z=D.extend({_click:function(){this.toolbar.dialog({name:"merge"});
}});
y.toolbar.registerComponent("merge",A,z);
var x=E.extend({init:function(K,L){E.fn.init.call(this,K,L);
this._defineButtons();
this._commandPalette();
this.popup.element.on("click",".k-button",function(M){this._action(a(M.currentTarget));
}.bind(this));
this.element.data({type:"freeze",freeze:this,instance:this});
},_defineButtons:function(){this.buttons=[{value:"panes",iconClass:"pane-freeze",text:B.freezeButtons.freezePanes},{value:"rows",iconClass:"row-freeze",text:B.freezeButtons.freezeRows},{value:"columns",iconClass:"column-freeze",text:B.freezeButtons.freezeColumns},{value:"unfreeze",iconClass:"table-unmerge",text:B.freezeButtons.unfreeze}];
},destroy:function(){this.popup.element.off();
E.fn.destroy.call(this);
},_commandPalette:function(){var K=a("<div />").appendTo(this.popup.element);
this.buttons.forEach(function(M){var L="<a title='"+M.text+"' data-value='"+M.value+"' class='k-button k-button-icontext'><span class='k-icon k-i-"+M.iconClass+"'></span>"+M.text+"</a>";
K.append(L);
});
},_action:function(K){var L=K.attr("data-value");
this.toolbar.action({command:"FreezePanesCommand",options:{value:L}});
}});
var w=D.extend({_click:function(){this.toolbar.dialog({name:"freeze"});
}});
y.toolbar.registerComponent("freeze",x,w);
var F=l.extend({_revertTitle:function(K){K.sender.value("");
K.sender.wrapper.width("auto");
},init:function(L,M){l.fn.init.call(this,L,M);
var K=this.dropDownList;
K.bind("change",this._revertTitle.bind(this));
K.bind("dataBound",this._revertTitle.bind(this));
K.setOptions({valueTemplate:"<span class='k-icon k-i-"+L.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>",template:"<span class='k-icon k-i-#= iconClass #' style='line-height: 1em; width: 1.35em;'></span>#=text#",dataTextField:"text",dataValueField:"value"});
K.setDataSource([{value:"asc",sheet:false,text:B.sortButtons.sortRangeAsc,iconClass:"sort-asc"},{value:"desc",sheet:false,text:B.sortButtons.sortRangeDesc,iconClass:"sort-desc"}]);
K.select(0);
this.element.data({type:"sort",sort:this});
},_change:function(L){var M=L.sender;
var K=M.dataItem();
if(K){this.toolbar.action({command:"SortCommand",options:{value:K.value,sheet:K.sheet}});
}},value:a.noop});
var G=D.extend({_click:function(){this.toolbar.dialog({name:"sort"});
}});
y.toolbar.registerComponent("sort",F,G);
var m=y.toolbar.ToolBarButton.extend({init:function(K,L){K.showText="overflow";
y.toolbar.ToolBarButton.fn.init.call(this,K,L);
this.element.on("click",this._click.bind(this));
this.element.data({type:"filter",filter:this});
},_click:function(){this.toolbar.action({command:"FilterCommand"});
},update:function(K){this.toggle(K);
}});
var n=D.extend({init:function(K,L){D.fn.init.call(this,K,L);
this.element.data({type:"filter",filter:this});
},_click:function(){this.toolbar.action({command:"FilterCommand"});
},update:function(K){this.toggle(K);
}});
y.toolbar.registerComponent("filter",m,n);
var C=y.toolbar.Item.extend({init:function(K,L){this.toolbar=L;
this.element=a("<div class='k-button k-upload-button k-button-icon'><span class='k-icon k-i-folder-open' /></div>").data("instance",this);
this._title=K.attributes.title;
this._reset();
},_reset:function(){this.element.find("input").remove();
a("<input type='file' autocomplete='off' accept='.xlsx'/>").attr("title",this._title).attr("aria-label",this._title).one("change",this._change.bind(this)).appendTo(this.element);
},_change:function(K){this.toolbar.action({command:"OpenCommand",options:{file:K.target.files[0]}});
this._reset();
}});
y.toolbar.registerComponent("open",C);
y.spreadsheet.TabStrip=y.ui.TabStrip.extend({init:function(K,L){y.ui.TabStrip.fn.init.call(this,K,L);
K.addClass("k-spreadsheet-tabstrip");
this._quickAccessButtons();
this.toolbars={};
var M=L.dataSource;
this.contentElements.each(function(O,N){this._toolbar(a(N),M[O].id,L.toolbarOptions[M[O].id]);
}.bind(this));
this.one("activate",function(){this.toolbars[this.options.dataSource[0].id].resize();
});
},events:y.ui.TabStrip.fn.events.concat(["action","dialog"]),destroy:function(){this.quickAccessToolBar.off("click");
y.ui.TabStrip.fn.destroy.call(this);
for(var K in this.toolbars){this.toolbars[K].destroy();
}},action:function(K){this.trigger("action",K);
},dialog:function(K){this.trigger("dialog",K);
},refreshTools:function(L){var M=this.toolbars;
for(var K in M){if(M.hasOwnProperty(K)){M[K].refresh(L);
}}},_quickAccessButtons:function(){var K=[{title:B.quickAccess.undo,iconClass:"undo",action:"undo"},{title:B.quickAccess.redo,iconClass:"redo",action:"redo"}];
var L=y.template("<a href='\\#' title='#= title #' data-action='#= action #' class='k-button k-button-icon' aria-label='#= title #'><span class='k-icon k-i-#=iconClass#'></span></a>");
this.quickAccessToolBar=a("<div />",{"class":"k-spreadsheet-quick-access-toolbar",html:y.render(L,K)}).insertBefore(this.wrapper);
this.quickAccessToolBar.on("click",".k-button",function(N){N.preventDefault();
var M=a(N.currentTarget).attr("data-action");
this.action({action:M});
}.bind(this));
this.quickAccessAdjust();
},quickAccessAdjust:function(){this.tabGroup.css("padding-left",y._outerWidth(this.quickAccessToolBar));
},_toolbar:function(K,M,O){var L;
var N;
if(this.toolbars[M]){this.toolbars[M].destroy();
K.children(".k-toolbar").remove();
}if(O){L=K.html("<div />").children("div");
N={tools:typeof O==="boolean"?undefined:O,toolbarName:M,action:this.action.bind(this),dialog:this.dialog.bind(this)};
this.toolbars[M]=new y.spreadsheet.ToolBar(L,N);
}}});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/dialogs",["kendo.core","kendo.binder","kendo.validator"],b);
}(function(){(function(t){if(t.support.browser.msie&&t.support.browser.version<9){return;
}var a=t.jQuery;
var y=t.data.ObservableObject;
var x=t.spreadsheet.messages.dialogs={apply:"Apply",save:"Save",cancel:"Cancel",remove:"Remove",retry:"Retry",revert:"Revert",okText:"OK",formatCellsDialog:{title:"Format",categories:{number:"Number",currency:"Currency",date:"Date"}},fontFamilyDialog:{title:"Font"},fontSizeDialog:{title:"Font size"},bordersDialog:{title:"Borders"},alignmentDialog:{title:"Alignment",buttons:{justtifyLeft:"Align left",justifyCenter:"Center",justifyRight:"Align right",justifyFull:"Justify",alignTop:"Align top",alignMiddle:"Align middle",alignBottom:"Align bottom"}},mergeDialog:{title:"Merge cells",buttons:{mergeCells:"Merge all",mergeHorizontally:"Merge horizontally",mergeVertically:"Merge vertically",unmerge:"Unmerge"}},freezeDialog:{title:"Freeze panes",buttons:{freezePanes:"Freeze panes",freezeRows:"Freeze rows",freezeColumns:"Freeze columns",unfreeze:"Unfreeze panes"}},confirmationDialog:{text:"Are you sure you want to remove this sheet?",title:"Sheet remove"},validationDialog:{title:"Data Validation",hintMessage:"Please enter a valid {0} value {1}.",hintTitle:"Validation {0}",criteria:{any:"Any value",number:"Number",text:"Text",date:"Date",custom:"Custom Formula",list:"List"},comparers:{greaterThan:"greater than",lessThan:"less than",between:"between",notBetween:"not between",equalTo:"equal to",notEqualTo:"not equal to",greaterThanOrEqualTo:"greater than or equal to",lessThanOrEqualTo:"less than or equal to"},comparerMessages:{greaterThan:"greater than {0}",lessThan:"less than {0}",between:"between {0} and {1}",notBetween:"not between {0} and {1}",equalTo:"equal to {0}",notEqualTo:"not equal to {0}",greaterThanOrEqualTo:"greater than or equal to {0}",lessThanOrEqualTo:"less than or equal to {0}",custom:"that satisfies the formula: {0}"},labels:{criteria:"Criteria",comparer:"Comparer",min:"Min",max:"Max",value:"Value",start:"Start",end:"End",onInvalidData:"On invalid data",rejectInput:"Reject input",showWarning:"Show warning",showHint:"Show hint",hintTitle:"Hint title",hintMessage:"Hint message",ignoreBlank:"Ignore blank",showListButton:"Display button to show list",showCalendarButton:"Display button to show calendar"},placeholders:{typeTitle:"Type title",typeMessage:"Type message"}},exportAsDialog:{title:"Export...",defaultFileName:"Workbook",xlsx:{description:"Excel Workbook (.xlsx)"},pdf:{description:"Portable Document Format (.pdf)",area:{workbook:"Entire Workbook",sheet:"Active Sheet",selection:"Selection"},paper:{a2:"A2 (420 mm \xD7 594 mm)",a3:"A3 (297 mm x 420 mm)",a4:"A4 (210 mm x 297 mm)",a5:"A5 (148 mm x 210 mm)",b3:"B3 (353 mm \xD7 500 mm)",b4:"B4 (250 mm x 353 mm)",b5:"B5 (176 mm x 250 mm)",folio:'Folio (8.5" x 13")',legal:'Legal (8.5" x 14")',letter:'Letter (8.5" x 11")',tabloid:'Tabloid (11" x 17")',executive:'Executive (7.25" x 10.5")'},margin:{normal:"Normal",narrow:"Narrow",wide:"Wide"}},labels:{scale:"Scale",fit:"Fit to page",fileName:"File name",saveAsType:"Save as type",exportArea:"Export",paperSize:"Paper size",margins:"Margins",orientation:"Orientation",print:"Print",guidelines:"Guidelines",center:"Center",horizontally:"Horizontally",vertically:"Vertically"}},modifyMergedDialog:{errorMessage:"Cannot change part of a merged cell."},rangeDisabledDialog:{errorMessage:"Destination range contains disabled cells."},intersectsArrayDialog:{errorMessage:"You cannot alter part of an array"},incompatibleRangesDialog:{errorMessage:"Incompatible ranges"},noFillDirectionDialog:{errorMessage:"Cannot determine fill direction"},duplicateSheetNameDialog:{errorMessage:"Duplicate sheet name"},overflowDialog:{errorMessage:"Cannot paste, because the copy area and the paste area are not the same size and shape."},useKeyboardDialog:{title:"Copying and pasting",errorMessage:"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:",labels:{forCopy:"for copy",forCut:"for cut",forPaste:"for paste"}},unsupportedSelectionDialog:{errorMessage:"That action cannot be performed on multiple selection."},linkDialog:{title:"Hyperlink",labels:{text:"Text",url:"Address",removeLink:"Remove link"}},insertCommentDialog:{title:"Insert comment",labels:{comment:"Comment",removeComment:"Remove comment"}},insertImageDialog:{title:"Insert image",info:"Drag an image here, or click to select",typeError:"Please select a JPEG, PNG or GIF image"}};
var A={};
t.spreadsheet.dialogs={register:function(K,J){A[K]=J;
},registered:function(J){return !!A[J];
},create:function(K,L){var J=A[K];
if(J){return new J(L);
}}};
var B=t.spreadsheet.SpreadsheetDialog=t.Observable.extend({init:function(J){t.Observable.fn.init.call(this,J);
this.options=D(a.extend(true,{},this.options,J));
this.bind(this.events,J);
},events:["close","activate"],options:{autoFocus:true},dialog:function(){if(!this._dialog){var J={autoFocus:false,scrollable:false,resizable:false,modal:true,visible:false,width:this.options.width||320,title:this.options.title,open:function(){this.center();
},close:this._onDialogClose.bind(this),activate:this._onDialogActivate.bind(this),deactivate:this._onDialogDeactivate.bind(this)};
this._dialog=a("<div class='k-spreadsheet-window k-action-window k-popup-edit-form' />").addClass(this.options.className||"").append(t.template(this.options.template)({messages:t.spreadsheet.messages.dialogs||x,errors:this.options.errors})).kendoWindow(J).data("kendoWindow");
}return this._dialog;
},_onDialogClose:function(){this.trigger("close",{action:this._action});
},_onDialogActivate:function(){this.trigger("activate");
},_onDialogDeactivate:function(){this.trigger("deactivate");
this.destroy();
},destroy:function(){if(this._dialog){this._dialog.destroy();
this._dialog=null;
}},open:function(){this.dialog().open();
this.dialog().element.find(".k-primary").focus();
},apply:function(){this.close();
},close:function(){this._action="close";
this.dialog().close();
}});
function n(K,J){return t.spreadsheet.formatting.text(K,J);
}var m=t.spreadsheet.FormatCellsViewModel=y.extend({init:function(J){y.fn.init.call(this,J);
this.useCategory(this.category);
},useCategory:function(J){var L=J&&J.type||"number";
var K=L=="currency";
this.category=J;
this.set("showCurrencyFilter",K&&this.currencies.length>1);
if(!K){this.set("formats",this.allFormats[L+"Formats"]);
}else{this.currency(this.currencies[0]);
}this.useFirstFormat();
},useFirstFormat:function(){if(this.formats.length){this.set("format",this.formats[0].value);
}},currency:function(J){if(J!==undefined){this._currency=J;
var L=J.value;
var K=[{currency:L,decimals:true},{currency:L,decimals:true,iso:true},{currency:L,decimals:false}];
K=K.map(function(M){M=m.convert.currency(M);
return{value:M,name:n(1000,M)};
});
this.set("formats",K);
this.useFirstFormat();
}return this._currency||this.currencies[0];
},categoryFilter:function(J){if(J!==undefined){this.useCategory(J);
}return this.category;
},preview:function(){var J=this.get("format");
var K=this.value||0;
if(J&&J.length){return n(K,J);
}else{return K;
}}});
m.convert={currency:function(L){function M(O,N){return new Array(N+1).join(O);
}var K=L.currency;
var J=K.pattern[1];
if(L.decimals){J=J.replace(/n/g,"n"+K["."]+M("0",K.decimals));
}if(L.iso){J='"'+K.abbr+'" '+J.replace(/\s*\$\s*/g,"");
}else{J=J.replace(/\$/g,JSON.stringify(K.symbol));
}J=J.replace(/n/g,"?");
return J;
},date:function(J){if(/T|Z/.test(J)){return"";
}return J.toLowerCase().replace(/tt/g,"AM/PM").replace(/'/g,'"');
}};
function E(K,J){var M=[];
var N=[];
for(var L=0;
L<J.length;
L++){if(a.inArray(J[L][K],N)==-1){M.push(J[L]);
N.push(J[L][K]);
}}return M;
}var l=B.extend({init:function(L){var K=t.spreadsheet.messages.dialogs.formatCellsDialog||x;
var J={title:K.title,categories:[{type:"number",name:K.categories.number},{type:"currency",name:K.categories.currency},{type:"date",name:K.categories.date}]};
B.fn.init.call(this,a.extend(J,L));
this._generateFormats();
},options:{className:"k-spreadsheet-format-cells",template:"<div class='k-edit-form-container'><div class='k-root-tabs' data-role='tabstrip' data-text-field='name' data-bind='source: categories, value: categoryFilter' data-animation='false' /><div class='k-spreadsheet-preview' data-bind='text: preview' /><script type='text/x-kendo-template' id='format-item-template'>\\#: data.name \\#</script><select data-role='dropdownlist' class='k-format-filter' data-text-field='description' data-value-field='value.name' data-bind='visible: showCurrencyFilter, value: currency, source: currencies' /><ul data-role='staticlist' tabindex='0' class='k-list k-reset' data-template='format-item-template' data-value-primitive='true' data-value-field='value' data-bind='source: formats, value: format' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>#: messages.apply #</button><button class='k-button' data-bind='click: close'>#: messages.cancel #</button></div></div>"},_generateFormats:function(){var K=this.options;
if(!K.currencies){K.currencies=l.currenciesFrom(t.cultures);
}if(!K.numberFormats){K.numberFormats=[{value:"#.00%",name:"100.00%"},{value:"#%",name:"100%"},{value:"#.00",name:"1024.00"},{value:"#,###.00",name:"1,024.00"}];
}if(!K.dateFormats){var J=t.cultures.current.calendars.standard.patterns;
K.dateFormats=E("value",a.map(J,function(L){L=m.convert.date(L);
if(!L){return;
}return{value:L,name:n(34567.7678,L)};
}));
}},open:function(N){var M=this.options;
var O=N.value();
var J=M.categories.slice(0);
var L;
this.viewModel=new m({currencies:M.currencies.slice(0),allFormats:{numberFormats:M.numberFormats.slice(0),dateFormats:M.dateFormats.slice(0)},categories:J,format:N.format(),category:O instanceof Date?J[2]:J[0],apply:this.apply.bind(this),close:this.close.bind(this),value:O});
B.fn.open.call(this);
L=this.dialog().element;
t.bind(L,this.viewModel);
var K=L.find("select.k-format-filter").data("kendoDropDownList");
if(M.currencies.length>10){K.setOptions({filter:"contains"});
}L.find(t.roleSelector("staticlist")).parent().addClass("k-list-wrapper");
},apply:function(){var J=this.viewModel.format;
B.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"format",value:J}});
}});
l.currenciesFrom=function(J){return E("description",a.map(J,function(K,N){if(!/-/.test(N)){return;
}var L=K.numberFormat.currency;
var M=t.format("{0} ({1}, {2})",L.name,L.abbr,L.symbol);
return{description:M,value:L};
}));
};
t.spreadsheet.dialogs.register("formatCells",l);
t.spreadsheet.dialogs.FormatCellsDialog=l;
var w=B.extend({options:{className:"k-spreadsheet-message",title:"",messageId:"",text:"",template:"<div class='k-spreadsheet-message-content' data-bind='text: text' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: close'>#= messages.okText #</button></div>"},open:function(){B.fn.open.call(this);
var J=this.options;
var K=J.text;
if(J.messageId){K=t.getter(J.messageId,true)(t.spreadsheet.messages.dialogs);
}t.bind(this.dialog().element,{text:K,close:this.close.bind(this)});
}});
t.spreadsheet.dialogs.register("message",w);
var g=B.extend({init:function(L){var K=t.spreadsheet.messages.dialogs.confirmationDialog||x;
var J={title:K.title,text:K.text};
B.fn.init.call(this,a.extend(J,L));
},options:{className:"k-spreadsheet-message",messageId:"",template:"<div class='k-spreadsheet-message-content' data-bind='text: text' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: confirm'>#= messages.okText #</button><button class='k-button' data-bind='click: cancel'>#= messages.cancel #</button></div>"},open:function(){B.fn.open.call(this);
var J=this.options;
var K=J.text;
if(J.messageId){K=t.getter(J.messageId,true)(t.spreadsheet.messages.dialogs);
}t.bind(this.dialog().element,{text:K,confirm:this.confirm.bind(this),cancel:this.close.bind(this)});
},isConfirmed:function(){return this._confirmed;
},confirm:function(){this._confirmed=true;
this.close();
}});
t.spreadsheet.dialogs.register("confirmation",g);
var H=B.extend({options:{className:"k-spreadsheet-message",title:"",messageId:"",text:"",template:"<div class='k-spreadsheet-message-content' data-bind='text: text' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: retry'>#= messages.retry #</button><button class='k-button' data-bind='click: cancel'>#= messages.cancel #</button></div>"},open:function(){B.fn.open.call(this);
var J=this.options;
var K=J.text;
if(J.messageId){K=t.getter(J.messageId,true)(t.spreadsheet.messages.dialogs);
}t.bind(this.dialog().element,{text:K,retry:this.retry.bind(this),cancel:this.close.bind(this)});
},retry:function(){this._retry=true;
this.close();
}});
t.spreadsheet.dialogs.register("validationError",H);
var j=B.extend({init:function(K){var J=t.spreadsheet.messages.dialogs.fontFamilyDialog||x;
B.fn.init.call(this,a.extend({title:J.title},K));
this._list();
},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var L=this.dialog().element.find("ul");
var K=this.options.fonts;
var J=this.options.defaultFont;
this.list=new t.ui.StaticList(L,{dataSource:new t.data.DataSource({data:K}),template:"#: data #",value:J,change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(J){B.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontFamily",value:J.sender.value()[0]}});
}});
t.spreadsheet.dialogs.register("fontFamily",j);
var k=B.extend({init:function(K){var J=t.spreadsheet.messages.dialogs.fontSizeDialog||x;
B.fn.init.call(this,a.extend({title:J.title},K));
this._list();
},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var L=this.dialog().element.find("ul");
var K=this.options.sizes;
var J=this.options.defaultSize;
this.list=new t.ui.StaticList(L,{dataSource:new t.data.DataSource({data:K}),template:"#: data #",value:J,change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(J){B.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontSize",value:t.parseInt(J.sender.value()[0])}});
}});
t.spreadsheet.dialogs.register("fontSize",k);
var d=B.extend({init:function(K){var J=t.spreadsheet.messages.dialogs.bordersDialog||x;
B.fn.init.call(this,a.extend({title:J.title},K));
this.element=this.dialog().element;
this._borderPalette();
this.viewModel=t.observable({apply:this.apply.bind(this),close:this.close.bind(this)});
t.bind(this.element.find(".k-action-buttons"),this.viewModel);
},options:{width:177,template:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>#: messages.apply #</button><button class='k-button' data-bind='click: close'>#: messages.cancel #</button></div>"},apply:function(){B.fn.apply.call(this);
var J=this.value();
this.trigger("action",{command:"BorderChangeCommand",options:{border:J.type,style:{size:1,color:J.color}}});
},_borderPalette:function(){var J=this.dialog().element.find("div:first");
this.borderPalette=new t.spreadsheet.BorderPalette(J,{change:this.value.bind(this)});
},value:function(J){if(J===undefined){return this._state;
}else{this._state=J;
}}});
t.spreadsheet.dialogs.register("borders",d);
var e=B.extend({init:function(J){B.fn.init.call(this,J);
this.element=this.dialog().element;
this.property=J.property;
this.options.title=J.title;
this.viewModel=t.observable({apply:this.apply.bind(this),close:this.close.bind(this)});
t.bind(this.element.find(".k-action-buttons"),this.viewModel);
},options:{template:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>#: messages.apply #</button><button class='k-button' data-bind='click: close'>#: messages.cancel #</button></div>"},apply:function(){B.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:this.property,value:this.value()}});
},value:function(J){if(J===undefined){return this._value;
}else{this._value=J.value;
}}});
var f=e.extend({init:function(J){J.width=177;
e.fn.init.call(this,J);
this._colorPalette();
},_colorPalette:function(){var J=this.dialog().element.find("div:first");
this.colorPalette=J.kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],change:this.value.bind(this)}).data("kendoColorPalette");
}});
t.spreadsheet.dialogs.register("colorPicker",f);
var h=e.extend({init:function(J){J.width=268;
e.fn.init.call(this,J);
this.dialog().setOptions({animation:false});
this.dialog().one("activate",this._colorPicker.bind(this));
},_colorPicker:function(){var J=this.dialog().element.find("div:first");
this.colorPicker=J.kendoFlatColorPicker({change:this.value.bind(this)}).data("kendoFlatColorPicker");
}});
t.spreadsheet.dialogs.register("customColor",h);
var b=B.extend({init:function(L){var K=t.spreadsheet.messages.dialogs.alignmentDialog||x;
var J={title:K.title,buttons:[{property:"textAlign",value:"left",iconClass:"align-left",text:K.buttons.justtifyLeft},{property:"textAlign",value:"center",iconClass:"align-center",text:K.buttons.justifyCenter},{property:"textAlign",value:"right",iconClass:"align-right",text:K.buttons.justifyRight},{property:"textAlign",value:"justify",iconClass:"align-justify",text:K.buttons.justifyFull},{property:"verticalAlign",value:"top",iconClass:"align-top",text:K.buttons.alignTop},{property:"verticalAlign",value:"center",iconClass:"align-middle",text:K.buttons.alignMiddle},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom",text:K.buttons.alignBottom}]};
B.fn.init.call(this,a.extend(J,L));
this._list();
},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var J=this.dialog().element.find("ul");
this.list=new t.ui.StaticList(J,{dataSource:new t.data.DataSource({data:this.options.buttons}),template:"<a title='#=text#' data-property='#=property#' data-value='#=value#'><span class='k-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(K){var J=K.sender.value()[0];
B.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:J.property,value:J.value}});
}});
t.spreadsheet.dialogs.register("alignment",b);
var v=B.extend({init:function(L){var K=t.spreadsheet.messages.dialogs.mergeDialog||x;
var J={title:K.title,buttons:[{value:"cells",iconClass:"cells-merge",text:K.buttons.mergeCells},{value:"horizontally",iconClass:"cells-merge-horizontally",text:K.buttons.mergeHorizontally},{value:"vertically",iconClass:"cells-merge-vertically",text:K.buttons.mergeVertically},{value:"unmerge",iconClass:"table-unmerge",text:K.buttons.unmerge}]};
B.fn.init.call(this,a.extend(J,L));
this._list();
},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var J=this.dialog().element.find("ul");
this.list=new t.ui.StaticList(J,{dataSource:new t.data.DataSource({data:this.options.buttons}),template:"<a title='#=text#' data-value='#=value#'><span class='k-icon k-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(K){var J=K.sender.value()[0];
B.fn.apply.call(this);
this.trigger("action",{command:"MergeCellCommand",options:{value:J.value}});
}});
t.spreadsheet.dialogs.register("merge",v);
var o=B.extend({init:function(L){var K=t.spreadsheet.messages.dialogs.freezeDialog||x;
var J={title:K.title,buttons:[{value:"panes",iconClass:"pane-freeze",text:K.buttons.freezePanes},{value:"rows",iconClass:"row-freeze",text:K.buttons.freezeRows},{value:"columns",iconClass:"column-freeze",text:K.buttons.freezeColumns},{value:"unfreeze",iconClass:"table-unmerge",text:K.buttons.unfreeze}]};
B.fn.init.call(this,a.extend(J,L));
this._list();
},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var J=this.dialog().element.find("ul");
this.list=new t.ui.StaticList(J,{dataSource:new t.data.DataSource({data:this.options.buttons}),template:"<a title='#=text#' data-value='#=value#'><span class='k-icon k-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(K){var J=K.sender.value()[0];
B.fn.apply.call(this);
this.trigger("action",{command:"FreezePanesCommand",options:{value:J.value}});
}});
t.spreadsheet.dialogs.register("freeze",o);
var I=t.spreadsheet.ValidationCellsViewModel=y.extend({init:function(J){y.fn.init.call(this,J);
this.bind("change",function(K){if(K.field==="criterion"){this.reset();
if(this.criterion==="custom"||this.criterion==="list"){this.setHintMessageTemplate();
}}if(K.field==="comparer"){this.setHintMessageTemplate();
}if((K.field=="hintMessage"||K.field=="hintTitle")&&!this._mute){this.shouldBuild=false;
}if((K.field=="from"||K.field=="to"||K.field=="hintMessageTemplate"||K.field=="type")&&this.shouldBuild){this.buildMessages();
}}.bind(this));
this.reset();
},buildMessages:function(){this._mute=true;
this.set("hintTitle",this.hintTitleTemplate?t.format(this.hintTitleTemplate,this.type):"");
this.set("hintMessage",this.hintMessageTemplate?t.format(this.hintMessageTemplate,this.from,this.to):"");
this._mute=false;
},reset:function(){this.setComparers();
this.set("comparer",this.comparers[0].type);
this.set("from",null);
this.set("to",null);
this.set("useCustomMessages",false);
this.shouldBuild=true;
this.hintTitleTemplate=this.defaultHintTitle;
this.buildMessages();
},setComparers:function(){var J=this.defaultComparers;
var K=[];
if(this.criterion==="text"){var M=["equalTo","notEqualTo"];
for(var L=0;
L<J.length;
L++){if(M[0]==J[L].type){K.push(J[L]);
M.shift();
}}}else{K=J.slice();
}this.set("comparers",K);
},setHintMessageTemplate:function(){if(this.criterion!=="custom"&&this.criterion!=="list"){this.set("hintMessageTemplate",t.format(this.defaultHintMessage,this.criterion,this.comparerMessages[this.comparer]));
}else{this.set("hintMessageTemplate","");
this.set("hintMessage","");
}},isAny:function(){return this.get("criterion")==="any";
},isNumber:function(){return this.get("criterion")==="number";
},showToForNumber:function(){return this.showTo()&&this.isNumber();
},showToForDate:function(){return this.showTo()&&this.isDate();
},isText:function(){return this.get("criterion")==="text";
},isDate:function(){return this.get("criterion")==="date";
},isList:function(){return this.get("criterion")==="list";
},isCustom:function(){return this.get("criterion")==="custom";
},showRemove:function(){return this.get("hasValidation");
},showTo:function(){return this.get("comparer")=="between"||this.get("comparer")=="notBetween";
},update:function(J){this.set("hasValidation",!!J);
if(J){this.fromValidationObject(J);
}},fromValidationObject:function(J){this.set("criterion",J.dataType);
this.set("comparer",J.comparerType);
this.set("from",J.from);
this.set("to",J.to);
this.set("type",J.type);
this.set("ignoreBlank",J.allowNulls);
this.set("showButton",J.showButton);
if(J.messageTemplate||J.titleTemplate){this.hintMessageTemplate=J.messageTemplate;
this.hintMessage=J.messageTemplate;
this.hintTitleTemplate=J.titleTemplate;
this.hintTitle=J.titleTemplate;
this.useCustomMessages=true;
this.buildMessages();
}else{this.useCustomMessages=false;
}},toValidationObject:function(){if(this.criterion==="any"){return null;
}var J={type:this.type,dataType:this.criterion,comparerType:this.comparer,from:this.from,to:this.to,allowNulls:this.ignoreBlank,showButton:this.showButton};
if(this.useCustomMessages){J.messageTemplate=this.shouldBuild?this.hintMessageTemplate:this.hintMessage;
J.titleTemplate=this.hintTitle;
}return J;
}});
var G=B.extend({init:function(L){var K=t.spreadsheet.messages.dialogs.validationDialog||x;
var J={title:K.title,hintMessage:K.hintMessage,hintTitle:K.hintTitle,criteria:[{type:"any",name:K.criteria.any},{type:"number",name:K.criteria.number},{type:"text",name:K.criteria.text},{type:"date",name:K.criteria.date},{type:"custom",name:K.criteria.custom},{type:"list",name:K.criteria.list}],comparers:[{type:"greaterThan",name:K.comparers.greaterThan},{type:"lessThan",name:K.comparers.lessThan},{type:"between",name:K.comparers.between},{type:"notBetween",name:K.comparers.notBetween},{type:"equalTo",name:K.comparers.equalTo},{type:"notEqualTo",name:K.comparers.notEqualTo},{type:"greaterThanOrEqualTo",name:K.comparers.greaterThanOrEqualTo},{type:"lessThanOrEqualTo",name:K.comparers.lessThanOrEqualTo}],comparerMessages:K.comparerMessages};
B.fn.init.call(this,a.extend(J,L));
},options:{width:450,criterion:"any",type:"reject",ignoreBlank:true,showButton:true,useCustomMessages:false,errorTemplate:'<div class="k-widget k-tooltip k-tooltip-validation" style="margin:0.5em"><span class="k-icon k-i-warning"> </span>#= message #<div class="k-callout k-callout-n"></div></div>',template:'<div class="k-edit-form-container"><div class="k-edit-label"><label>#: messages.validationDialog.labels.criteria #:</label></div><div class="k-edit-field"><select data-role="dropdownlist" title="#: messages.validationDialog.labels.criteria #"data-text-field="name" data-value-field="type" data-bind="value: criterion, source: criteria" /></div><div data-bind="visible: isNumber"><div class="k-edit-label"><label>#: messages.validationDialog.labels.comparer #:</label></div><div class="k-edit-field"><select data-role="dropdownlist" title="#: messages.validationDialog.labels.comparer #"data-text-field="name" data-value-field="type" data-bind="value: comparer, source: comparers" /></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.min #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.min #" title="#: messages.validationDialog.labels.min #" placeholder="e.g. 10" class="k-textbox" data-bind="value: from, enabled: isNumber" required="required" /></div><div data-bind="visible: showTo"><div class="k-edit-label"><label>#: messages.validationDialog.labels.max #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.max #" title="#: messages.validationDialog.labels.max #" placeholder="e.g. 100" class="k-textbox" data-bind="value: to, enabled: showToForNumber" required="required" /></div></div></div><div data-bind="visible: isText"><div class="k-edit-label"><label>#: messages.validationDialog.labels.comparer #:</label></div><div class="k-edit-field"><select data-role="dropdownlist" title="#: messages.validationDialog.labels.comparer #"data-text-field="name" data-value-field="type" data-bind="value: comparer, source: comparers" /></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.value #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.value #" title="#: messages.validationDialog.labels.value #" class="k-textbox" data-bind="value: from, enabled: isText" required="required" /></div></div><div data-bind="visible: isDate"><div class="k-edit-label"><label>#: messages.validationDialog.labels.comparer #:</label></div><div class="k-edit-field"><select data-role="dropdownlist" title="#: messages.validationDialog.labels.comparer #"data-text-field="name" data-value-field="type" data-bind="value: comparer, source: comparers" /></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.start #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.start #" title="#: messages.validationDialog.labels.start #" class="k-textbox" data-bind="value: from, enabled: isDate" required="required" /></div><div data-bind="visible: showTo"><div class="k-edit-label"><label>#: messages.validationDialog.labels.end #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.end #" title="#: messages.validationDialog.labels.end #" class="k-textbox" data-bind="value: to, enabled: showToForDate" required="required" /></div></div></div><div data-bind="visible: isCustom"><div class="k-edit-label"><label>#: messages.validationDialog.labels.value #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.value #" title="#: messages.validationDialog.labels.value #" class="k-textbox" data-bind="value: from, enabled: isCustom" required="required" /></div></div><div data-bind="visible: isList"><div class="k-edit-label"><label>#: messages.validationDialog.labels.value #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.value #" title="#: messages.validationDialog.labels.value #" class="k-textbox" data-bind="value: from, enabled: isList" required="required" /></div></div><div data-bind="visible: isList"><div class="k-edit-field"><input type="checkbox" name="showButton" id="listShowButton" class="k-checkbox" data-bind="checked: showButton"/><label for="listShowButton" class="k-checkbox-label"> #: messages.validationDialog.labels.showListButton #</label></div></div><div data-bind="visible: isDate"><div class="k-edit-field"><input type="checkbox" name="showButton" id="dateShowButton" class="k-checkbox" data-bind="checked: showButton"/><label for="dateShowButton" class="k-checkbox-label"> #: messages.validationDialog.labels.showCalendarButton #</label></div></div><div data-bind="invisible: isAny"><div class="k-edit-field"><input type="checkbox" title="#: messages.validationDialog.labels.ignoreBlank #" name="ignoreBlank" id="ignoreBlank" class="k-checkbox" data-bind="checked: ignoreBlank"/><label for="ignoreBlank" class="k-checkbox-label"> #: messages.validationDialog.labels.ignoreBlank #</label></div></div><div data-bind="invisible: isAny"><div class="k-hr"></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div><div class="k-edit-field"><input type="radio" title="#: messages.validationDialog.labels.rejectInput #" id="validationTypeReject" name="validationType" value="reject" data-bind="checked: type" class="k-radio" /><label for="validationTypeReject" class="k-radio-label">#: messages.validationDialog.labels.rejectInput #</label> <input type="radio" title="#: messages.validationDialog.labels.showWarning #" id="validationTypeWarning"  name="validationType" value="warning" data-bind="checked: type" class="k-radio" /><label for="validationTypeWarning" class="k-radio-label">#: messages.validationDialog.labels.showWarning #</label></div></div><div data-bind="invisible: isAny" class="hint-wrapper"><div class="k-edit-field"><input type="checkbox" title="#: messages.validationDialog.labels.showHint #" name="useCustomMessages" id="useCustomMessages" class="k-checkbox" data-bind="checked: useCustomMessages" /><label class="k-checkbox-label" for="useCustomMessages"> #: messages.validationDialog.labels.showHint #</label></div><div data-bind="visible: useCustomMessages"><div class="k-edit-label"><label>#: messages.validationDialog.labels.hintTitle #:</label></div><div class="k-edit-field"><input class="k-textbox" title="#: messages.validationDialog.labels.hintTitle #" placeholder="#: messages.validationDialog.placeholders.typeTitle #" data-bind="value: hintTitle" /></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.hintMessage #:</label></div><div class="k-edit-field"><input class="k-textbox" title="#: messages.validationDialog.labels.hintMessage #" placeholder="#: messages.validationDialog.placeholders.typeMessage #" data-bind="value: hintMessage" /></div></div></div><div class="k-action-buttons"><button class="k-button" data-bind="visible: showRemove, click: remove">#: messages.remove #</button><button class="k-button k-primary" data-bind="click: apply">#: messages.apply #</button><button class="k-button" data-bind="click: close">#: messages.cancel #</button></div></div>'},open:function(L){var K=this.options;
var J;
this.viewModel=new I({type:K.type,defaultHintMessage:K.hintMessage,defaultHintTitle:K.hintTitle,defaultComparers:K.comparers.slice(0),comparerMessages:K.comparerMessages,criteria:K.criteria.slice(0),criterion:K.criterion,ignoreBlank:K.ignoreBlank,showButton:K.showButton,apply:this.apply.bind(this),close:this.close.bind(this),remove:this.remove.bind(this)});
this.viewModel.update(L.validation());
B.fn.open.call(this);
J=this.dialog().element;
if(this.validatable){this.validatable.destroy();
}t.bind(J,this.viewModel);
this.validatable=new t.ui.Validator(J.find(".k-edit-form-container"),{validateOnBlur:false,errorTemplate:this.options.errorTemplate||undefined});
},apply:function(){if(this.validatable.validate()){B.fn.apply.call(this);
this.trigger("action",{command:"EditValidationCommand",options:{value:this.viewModel.toValidationObject()}});
}},remove:function(){this.viewModel.set("criterion","any");
this.apply();
}});
t.spreadsheet.dialogs.register("validation",G);
t.spreadsheet.dialogs.ValidationDialog=G;
function z(J){return{value:J,text:C("exportAsDialog.pdf.paper."+J)};
}var i=B.extend({init:function(K){B.fn.init.call(this,K);
K=this.options;
this.viewModel=t.observable({title:K.title,name:K.name,extension:K.extension,fileFormats:K.fileFormats,excel:K.excelExport,pdf:{proxyURL:K.pdfExport.proxyURL,forceProxy:K.pdfExport.forceProxy,title:K.pdfExport.title,author:K.pdfExport.author,subject:K.pdfExport.subject,keywords:K.pdfExport.keywords,creator:K.pdfExport.creator,date:K.pdfExport.date,fitWidth:K.pdf.fitWidth,area:K.pdf.area,areas:K.pdf.areas,paperSize:K.pdf.paperSize,paperSizes:K.pdf.paperSizes,margin:K.pdf.margin,margins:K.pdf.margins,landscape:K.pdf.landscape,guidelines:K.pdf.guidelines,hCenter:K.pdf.hCenter,vCenter:K.pdf.vCenter},apply:this.apply.bind(this),close:this.close.bind(this)});
var J=this.dialog();
this.viewModel.bind("change",function(L){if(L.field==="extension"){this.set("showPdfOptions",this.extension===".pdf"?true:false);
J.center();
}});
t.bind(J.element,this.viewModel);
},options:{title:C("exportAsDialog.title","Export..."),name:C("exportAsDialog.defaultFileName","Workbook"),extension:".xlsx",fileFormats:[{description:C("exportAsDialog.xlsx.description","Excel Workbook (.xlsx)"),extension:".xlsx"},{description:C("exportAsDialog.pdf.description","Portable Document Format (.pdf)"),extension:".pdf"}],pdf:{fitWidth:true,area:"workbook",areas:[{area:"workbook",text:C("exportAsDialog.pdf.area.workbook","Entire Workbook")},{area:"sheet",text:C("exportAsDialog.pdf.area.sheet","Active Sheet")},{area:"selection",text:C("exportAsDialog.pdf.area.selection","Selection")}],paperSize:"a4",paperSizes:["a2","a3","a4","a5","b3","b4","b5","folio","legal","letter","tabloid","executive"].map(z),margin:{bottom:"0.75in",left:"0.7in",right:"0.7in",top:"0.75in"},margins:[{value:{bottom:"0.75in",left:"0.7in",right:"0.7in",top:"0.75in"},text:C("exportAsDialog.pdf.margin.normal","Normal")},{value:{bottom:"0.75in",left:"0.25in",right:"0.25in",top:"0.75in"},text:C("exportAsDialog.pdf.margin.narrow","Narrow")},{value:{bottom:"1in",left:"1in",right:"1in",top:"1in"},text:C("exportAsDialog.pdf.margin.wide","Wide")}],landscape:true,guidelines:true,hCenter:true,vCenter:true},width:520,template:"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.fileName #:</label></div><div class='k-edit-field'><input class='k-textbox' data-bind='value: name' /></div><div ><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-text-field='description' data-value-field='extension' data-bind='value: extension, source: fileFormats' /></div></div><div class='k-export-config' data-bind='visible: showPdfOptions'><hr class='k-hr' /><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-text-field='text' data-value-field='area' data-bind='value: pdf.area, source: pdf.areas' /></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-text-field='text' data-value-field='value' data-bind='value: pdf.paperSize, source: pdf.paperSizes' /></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.margins #:</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-value-primitive='true'data-text-field='text' data-value-field='value' data-bind='value: pdf.margin, source: pdf.margins' /></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.orientation #:</label></div><div class='k-edit-field'><div class='k-button-group'><input type='radio' id='k-orientation-portrait' name='orientation' data-type='boolean' data-bind='checked: pdf.landscape' value='false' /><label class='k-button k-button-icon k-group-start k-orientation-button' for='k-orientation-portrait'><span class='k-icon k-i-page-portrait'></span></label><input type='radio' id='k-orientation-landscape' name='orientation' data-type='boolean' data-bind='checked: pdf.landscape' value='true' /><label class='k-button k-button-icon k-group-end k-orientation-button' for='k-orientation-landscape'><span class='k-icon k-i-page-landscape'></span></label></div></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.print #:</label></div><div class='k-edit-field'><input class='k-checkbox' id='guidelines' type='checkbox' data-bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>#: messages.exportAsDialog.labels.guidelines#</label></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.scale #:</label></div><div class='k-edit-field'><input class='k-checkbox' id='fitWidth' type='checkbox' data-bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>#: messages.exportAsDialog.labels.fit #</label></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.center #:</label></div><div class='k-edit-field'><input class='k-checkbox' id='hCenter' type='checkbox' data-bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>#: messages.exportAsDialog.labels.horizontally #</label><input class='k-checkbox' id='vCenter' type='checkbox' data-bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>#: messages.exportAsDialog.labels.vertically #</label></div><div class='k-page-orientation'><span class='k-icon k-i-page-portrait' data-bind='invisible: pdf.landscape'></span><span class='k-icon k-i-page-landscape' data-bind='visible: pdf.landscape'></span></div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>#: messages.save #</button><button class='k-button' data-bind='click: close'>#: messages.cancel #</button></div>"},apply:function(){B.fn.apply.call(this);
this.trigger("action",{command:"SaveAsCommand",options:this.viewModel});
}});
t.spreadsheet.dialogs.register("exportAs",i);
function c(J,K){t.spreadsheet.dialogs.register(J,w.extend({options:{messageId:K}}));
}c("modifyMerged","modifyMergedDialog.errorMessage");
c("rangeDisabled","rangeDisabledDialog.errorMessage");
c("intersectsArray","intersectsArrayDialog.errorMessage");
c("overflow","overflowDialog.errorMessage");
c("unsupportedSelection","unsupportedSelectionDialog.errorMessage");
c("incompatibleRanges","incompatibleRangesDialog.errorMessage");
c("noFillDirection","noFillDirectionDialog.errorMessage");
c("duplicateSheetName","duplicateSheetNameDialog.errorMessage");
var q=w.extend({options:{width:640,title:"Errors in import",template:"<div class='k-spreadsheet-message-content k-spreadsheet-import-errors'><div class='k--header-message'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div><div class='k--errors'><table><thead><tr><th>Context</th><th>Error message</th></tr></thead># for (var i = 0; i < errors.length; ++i) { ## var err = errors[i]; #<tr><td>#: err.context #</td><td>#: err.error #</td></tr># } #</table></div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: close'>#: messages.okText #</button></div>"}});
t.spreadsheet.dialogs.register("importError",q);
var F=w.extend({options:{title:C("useKeyboardDialog.title","Copying and pasting"),template:"#: messages.useKeyboardDialog.errorMessage #<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div><div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div><div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div><div class=\"k-action-buttons\"><button class='k-button k-primary' data-bind='click: close'>#= messages.okText #</button></div>"}});
t.spreadsheet.dialogs.register("useKeyboard",F);
var p=B.extend({options:{title:C("linkDialog.title","Hyperlink"),template:"<div class='k-edit-label'><label>#: messages.linkDialog.labels.url #:</label></div><div class='k-edit-field'><input class='k-textbox' data-bind='value: url' title='#: messages.linkDialog.labels.url #' /></div><div class='k-action-buttons'>"+("<button class='k-button k-left' data-bind='click: remove'>#= messages.linkDialog.labels.removeLink #</button><button class='k-button k-primary' data-bind='click: apply'>#= messages.okText #</button><button class='k-button' data-bind='click: cancel'>#= messages.cancel #</button>")+"</div>",autoFocus:false},open:function(L){var M=this;
B.fn.open.apply(M,arguments);
var J=M.dialog().element;
var K=t.observable({url:L.link(),apply:function(){if(!/\S/.test(K.url)){K.url=null;
}M.trigger("action",{command:"HyperlinkCommand",options:{link:K.url}});
M.close();
},remove:function(){K.url=null;
K.apply();
},cancel:M.close.bind(M)});
t.bind(J,K);
J.find("input").focus().on("keydown",function(N){if(N.keyCode==13){K.url=a(this).val();
N.stopPropagation();
N.preventDefault();
K.apply();
}else{if(N.keyCode==27){N.stopPropagation();
N.preventDefault();
K.cancel();
}}});
}});
t.spreadsheet.dialogs.register("hyperlink",p);
var r=B.extend({options:{className:"k-spreadsheet-insert-comment",template:"<div class='k-edit-label'><label>#: messages.insertCommentDialog.labels.comment #:</label></div><div class='k-edit-field'><textarea rows='5' class='k-textbox' data-bind='value: comment'></textarea></div><div class='k-action-buttons'>  <button class='k-button k-left' data-bind='click: remove'>#: messages.insertCommentDialog.labels.removeComment #</button>  <button class='k-button k-primary' data-bind='click: apply'>#: messages.okText #</button>  <button class='k-button' data-bind='click: cancel'>#= messages.cancel #</button></div>",title:C("insertCommentDialog.title","Insert comment"),autoFocus:false,width:450},open:function(L){var M=this;
B.fn.open.apply(M,arguments);
var J=M.dialog().element;
var K=t.observable({comment:L.comment(),apply:function(){if(!/\S/.test(K.comment)){K.comment=null;
}M.trigger("action",{command:"InsertCommentCommand",options:{value:K.comment}});
M.close();
},remove:function(){K.comment=null;
K.apply();
},cancel:M.close.bind(M)});
t.bind(J,K);
J.find("textarea").focus();
}});
t.spreadsheet.dialogs.register("insertComment",r);
var s=B.extend({options:{template:"<div class='k-spreadsheet-insert-image-dialog'>  <label data-bind='style: { background-image: imageUrl },                    css: { k-spreadsheet-has-image: hasImage, k-state-hovered: isHovered },                    events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }'>    <div data-bind='text: info'></div>    <input type='file' data-bind='events: { change: change }'           accept='image/png, image/jpeg, image/gif' />  </label></div><div class='k-action-buttons'>  <button class='k-button k-primary' data-bind='enabled: okEnabled, click: apply'>#: messages.okText #</button>  <button class='k-button' data-bind='click: cancel'>#= messages.cancel #</button></div>",title:C("insertImageDialog.title","Insert image"),width:"auto"},open:function(){var L=this;
B.fn.open.apply(L,arguments);
var J=L.dialog().element;
var K=t.observable({okEnabled:false,info:t.spreadsheet.messages.dialogs.insertImageDialog.info,imageUrl:"",hasImage:false,isHovered:false,_url:null,_image:null,apply:function(){window.URL.revokeObjectURL(K._url);
L.trigger("action",{command:"InsertImageCommand",options:{blob:K._image,width:K._width,height:K._height}});
L.close();
},cancel:L.close.bind(L),stopEvent:function(M){M.stopPropagation();
M.preventDefault();
},drop:function(M){K.stopEvent(M);
K.selectFile(M.originalEvent.dataTransfer.files);
K.set("isHovered",false);
},dragEnter:function(M){K.stopEvent(M);
K.set("isHovered",true);
},dragLeave:function(M){K.stopEvent(M);
K.set("isHovered",false);
},change:function(M){K.selectFile(M.target.files);
},selectFile:function(M){var O;
for(var N=0;
N<M.length;
++N){if(/^image\//i.test(M[N].type)){O=M[N];
break;
}}if(K._url){window.URL.revokeObjectURL(K._url);
}if(O){K._image=O;
K._url=window.URL.createObjectURL(O);
var P=new Image();
P.src=K._url;
P.onload=function(){K._width=P.width;
K._height=P.height;
K.set("info",t.spreadsheet.messages.dialogs.insertImageDialog.info);
K.set("okEnabled",true);
K.set("imageUrl","url('"+K._url+"')");
K.set("hasImage",true);
};
}else{K._image=null;
K.set("info",t.spreadsheet.messages.dialogs.insertImageDialog.typeError);
K.set("okEnabled",false);
K.set("imageUrl","");
K.set("hasImage",false);
}}});
t.bind(J,K);
}});
t.spreadsheet.dialogs.register("insertImage",s);
function u(K,J){this.path=K.split(".");
this.def=J;
}u.prototype.trans=function(){var K=t.spreadsheet.messages.dialogs;
for(var J=0;
J<this.path.length;
++J){K=K[this.path[J]];
if(!K){return this.def;
}}return K;
};
function C(K,J){return new u(K,J);
}function D(J){if(J instanceof u){return J.trans();
}else{if(Array.isArray(J)){return J.map(D);
}else{if(J!=null&&typeof J=="object"){return Object.keys(J).reduce(function(L,K){L[K]=D(J[K]);
return L;
},{});
}}}return J;
}}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/sheetbinder",["kendo.core","kendo.data","spreadsheet/sheet"],b);
}(function(){(function(b){if(b.support.browser.msie&&b.support.browser.version<9){return;
}var a=function(d){return d;
};
var c=b.Class.extend({init:function(d){this.options=b.jQuery.extend({},this.options,d);
this.columns=this._normalizeColumns(this.options.columns);
this._sheet();
this._dataSource();
this._header();
this._boundRowsCount=0;
this.dataSource.fetch();
},_sheet:function(){this.sheet=this.options.sheet;
this._sheetChangeHandler=this._sheetChange.bind(this);
this._sheetDeleteRowHandler=this._sheetDeleteRow.bind(this);
this._sheetInsertRowHandler=this._sheetInsertRow.bind(this);
this.sheet.bind("change",this._sheetChangeHandler).bind("afterDeleteRow",this._sheetDeleteRowHandler).bind("afterInsertRow",this._sheetInsertRowHandler);
},_sheetInsertRow:function(d){if(d.index!==undefined){this.dataSource.insert(Math.max(d.index-1,0),{});
}},_sheetDeleteRow:function(f){if(f.index!==undefined){var d=this.dataSource;
var g=d.view()[f.index-1];
if(g){d.remove(g);
}}},_header:function(){this.sheet.batch(function(){this.columns.forEach(function(d,e){this.sheet.range(0,e).value(d.title);
}.bind(this));
}.bind(this));
},_sheetChange:function(h){if(h.insertRow||h.deleteRow){return;
}if(h.recalc&&h.ref){var g=this.dataSource;
var f=g.view();
var d=this.columns;
var i;
if(g.reader.model){i=g.reader.model.fields;
}if(!d.length&&f.length){d=Object.keys(f[0].toJSON());
}var j=d.map(function(e){var m=e.field;
if(m&&i&&i[m]&&i[m].type=="date"){return b.spreadsheet.numberToDate;
}return a;
});
this._skipRebind=true;
var k=this.sheet._grid.normalize(h.ref);
var l=this.sheet.range(k).values();
k.forEach(function(o){o=o.toRangeRef();
var n;
var q=0;
for(var p=o.topLeft.row;
p<=o.bottomRight.row;
p++){n=f[p-1];
if(!n){n=g.insert(p-1,{});
f=g.view();
}var m=0;
for(var e=o.topLeft.col;
e<=o.bottomRight.col&&e<d.length;
e++){n.set(d[e].field,j[e](l[q][m++]));
}q++;
}});
this._boundRowsCount=g.view().length;
this._skipRebind=false;
}},_normalizeColumns:function(d){return d.map(function(e){var f=e.field||e;
return{field:f,title:e.title||f};
});
},_dataSource:function(){var e=this.options;
var d=e.dataSource;
d=Array.isArray(d)?{data:d}:d;
if(this.dataSource&&this._changeHandler){this.dataSource.unbind("change",this._changeHandler);
}else{this._changeHandler=this._change.bind(this);
}this.dataSource=b.data.DataSource.create(d).bind("change",this._changeHandler);
},_change:function(){if(this._skipRebind){return;
}if(this.sheet.trigger("dataBinding")){return;
}var e=this.dataSource.view();
var d=this.columns;
if(!d.length&&e.length){this.columns=d=this._normalizeColumns(Object.keys(e[0].toJSON()));
this._header();
}var f=d.map(function(g){return b.getter(g.field);
});
this.sheet.batch(function(){var i=Math.max(e.length,this._boundRowsCount);
for(var h=0;
h<i;
h++){for(var g=0;
g<f.length;
g++){var j=e[h]?f[g](e[h]):null;
this.sheet.range(h+1,g).value(j);
}}}.bind(this));
this._boundRowsCount=e.length;
this.sheet.trigger("dataBound");
},destroy:function(){this.dataSource.unbind("change",this._changeHandler);
this.sheet.unbind("change",this._sheetChangeHandler).unbind("deleteRow",this._sheetDeleteRowHandler).unbind("insertRow",this._sheetInsertRowHandler);
},options:{columns:[]}});
b.spreadsheet.SheetDataSourceBinder=c;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/filtermenu",["kendo.core","kendo.popup","kendo.treeview","kendo.numerictextbox","kendo.datepicker","kendo.datetimepicker"],b);
}(function(){(function(j){if(j.support.browser.msie&&j.support.browser.version<9){return;
}var a=j.jQuery;
var m=j.ui.Widget;
var b={details:"k-details",button:"k-button",detailsSummary:"k-details-summary",detailsContent:"k-details-content",icon:"k-icon",iconCollapse:"k-i-arrow-45-down-right",iconExpand:"k-i-arrow-60-right",iconSearch:"k-i-zoom",textbox:"k-textbox",wrapper:"k-spreadsheet-filter-menu",filterByCondition:"k-spreadsheet-condition-filter",filterByValue:"k-spreadsheet-value-filter",valuesTreeViewWrapper:"k-spreadsheet-value-treeview-wrapper",actionButtons:"k-action-buttons"};
j.spreadsheet.messages.filterMenu={all:"All",sortAscending:"Sort range A to Z",sortDescending:"Sort range Z to A",filterByValue:"Filter by value",filterByCondition:"Filter by condition",apply:"Apply",search:"Search",addToCurrent:"Add to current selection",clear:"Clear",blanks:"(Blanks)",operatorNone:"None",and:"AND",or:"OR",operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with",matches:"Text matches",doesnotmatch:"Text does not match"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}};
var c=m.extend({init:function(n,p){m.fn.init.call(this,n,p);
this.element.addClass(f.classNames.details);
this._summary=this.element.find("."+f.classNames.detailsSummary).on("click",this._toggle.bind(this));
var o=p.expanded?f.classNames.iconCollapse:f.classNames.iconExpand;
this._icon=a("<span />",{"class":f.classNames.icon+" "+o}).prependTo(this._summary);
this._container=j.wrap(this._summary.next(),true);
if(!p.expanded){this._container.hide();
}},options:{name:"Details"},events:["toggle"],visible:function(){return this.options.expanded;
},toggle:function(o){var n=j.fx(this._container).expand("vertical");
n.stop()[o?"reverse":"play"]();
this._icon.toggleClass(f.classNames.iconExpand,o).toggleClass(f.classNames.iconCollapse,!o);
this.options.expanded=!o;
},_toggle:function(){var n=this.visible();
this.toggle(n);
this.trigger("toggle",{show:n});
}});
j.data.binders.spreadsheetFilterValue=j.data.Binder.extend({init:function(o,n,p){j.data.Binder.fn.init.call(this,o,n,p);
this._change=a.proxy(this.change,this);
a(this.element).on("change",this._change);
},refresh:function(){var n=this,o=n.bindings.spreadsheetFilterValue.get();
a(n.element).val(o instanceof Date?"":o);
},change:function(){var n=this.element.value;
this.bindings.spreadsheetFilterValue.set(n);
}});
j.data.binders.widget.spreadsheetFilterValue=j.data.Binder.extend({init:function(p,n,o){j.data.Binder.fn.init.call(this,p.element[0],n,o);
this.widget=p;
this._change=a.proxy(this.change,this);
this.widget.first("change",this._change);
},refresh:function(){var n=this.bindings.spreadsheetFilterValue,p=n.get(),o=a(this.widget.element).data("filterType");
if(o==="date"&&p instanceof Date||o==="number"&&!isNaN(p)){this.widget.value(p);
}else{this.widget.value(null);
}},change:function(){var o=this.widget.value(),n=this.bindings.spreadsheetFilterValue;
n.set(o);
}});
var k={filterByValue:"<div class='"+b.detailsSummary+"'>#= messages.filterByValue #</div><div class='"+b.detailsContent+"'><div class='k-textbox k-space-right'><input placeholder='#= messages.search #' data-#=ns#bind='events: { input: filterValues }' /><span class='k-icon k-i-zoom' /></div><div data-#=ns#bind='visible: hasActiveSearch'><input class='k-checkbox' type='checkbox' data-#=ns#bind='checked: appendToSearch' id='_#=guid#' /><label class='k-checkbox-label' for='_#=guid#'>#= messages.addToCurrent #</label></div><div class='"+b.valuesTreeViewWrapper+"'><div data-#=ns#role='treeview' data-#=ns#checkboxes='{ checkChildren: true }' data-#=ns#bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' /></div></div>",filterByCondition:"<div class='"+b.detailsSummary+"'>#= messages.filterByCondition #</div><div class='"+b.detailsContent+'\'><div><select data-#=ns#role="dropdownlist"data-#=ns#bind="value: operator, source: operators, events: { change: operatorChange } "data-value-primitive="false"data-option-label="#=messages.operatorNone#"data-height="auto"data-text-field="text"data-value-field="unique"></select></div><div data-#=ns#bind="visible: isString"><input data-filter-type="string" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" class="k-textbox" /></div><div data-#=ns#bind="visible: isNumber"><input data-filter-type="number" data-#=ns#role="numerictextbox" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" /></div><div data-#=ns#bind="visible: isDate"><input data-filter-type="date" data-#=ns#role="datepicker" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" /></div></div>',menuItem:"<li data-command='#=command#' data-dir='#=dir#'><span class='k-icon k-i-#=iconClass#'></span>#=text#</li>",actionButtons:"<button data-#=ns#bind='click: apply' class='k-button k-primary'>#=messages.apply#</button><button data-#=ns#bind='click: clear' class='k-button'>#=messages.clear#</button>"};
function d(q){var n={};
var p=[];
for(var o=0;
o<q.length;
o++){if(!n[q[o].value]){n[q[o].value]=q[o];
p.push(q[o]);
}else{if(!n[q[o].value].checked&&q[o].checked){n[q[o].value].checked=true;
}}}return p;
}function e(p,v){var r=false;
var o=p instanceof j.data.HierarchicalDataSource&&p.data();
var y=this;
var x=this.values;
for(var s=0;
s<o.length;
s++){var t=o[s];
var w=t.text.toString().toLowerCase();
var u=v===true||v===""||w.indexOf(v)>=0;
var q=e.bind(y);
var n=q(t.children,v);
r=r||n||u;
t.hidden=!u&&!n;
if(v.length||x&&!x.length){t.checked=!t.hidden;
}else{if(x&&x.indexOf(t.text)!=-1){t.checked=true;
}}}if(o){p.filter({field:"hidden",operator:"neq",value:true});
}return r;
}function l(o){var n=o instanceof j.data.HierarchicalDataSource&&o.data();
for(var p=0;
p<n.length;
p++){var q=n[p];
q.checked=false;
if(q.hasChildren){l(q.children);
}}}var h=j.spreadsheet.FilterMenuViewModel=j.data.ObservableObject.extend({valuesChange:function(r){var q=r?r.sender.dataSource:this.valuesDataSource;
var o=function(v){return v.checked;
};
var t=function(v){return v.dataType==="date"?j.spreadsheet.dateToNumber(v.value):v.value;
};
var s=function(x,w,v){return v.lastIndexOf(x)===w;
};
var p=q.data();
var u=p[0].children.data().toJSON();
var n=u.filter(function(v){return v.dataType==="blank";
});
n=n.length?n[0].checked:false;
u=u.filter(o).map(t);
if(this.appendToSearch&&this.valueFilter&&this.valueFilter.values.length){u=u.concat(this.valueFilter.values.toJSON()).sort().filter(s);
}this.set("valueFilter",{values:u,blanks:n});
},valueSelect:function(n){n.preventDefault();
var o=n.sender.dataItem(n.node);
o.set("checked",!o.checked);
},hasActiveSearch:false,appendToSearch:false,filterValues:function(o){var q=typeof o=="string"?o:a(o.target).val().toLowerCase();
var n=this.valuesDataSource;
this.set("hasActiveSearch",!!q);
var p=e.bind(this.valueFilter);
l(n);
p(n,q);
},reset:function(){this.set("customFilter",{logic:"and",criteria:[{operator:null,value:null}]});
this.set("valueFilter",{values:[]});
},operatorChange:function(o){var n=o.sender.dataItem();
this.set("operatorType",n.type);
if(!this.get("customFilter")){this.reset();
}this.set("customFilter.criteria[0].operator",n.value);
},isNone:function(){return this.get("operatorType")===undefined;
},isString:function(){return this.get("operatorType")==="string";
},isNumber:function(){return this.get("operatorType")==="number";
},isDate:function(){return this.get("operatorType")==="date";
}});
function i(p){var n=j.spreadsheet.messages.filterMenu.operators;
var q=[];
for(var r in p){if(!p.hasOwnProperty(r)){continue;
}for(var o in p[r]){if(!p[r].hasOwnProperty(o)){continue;
}q.push({text:n[r][o],value:o,unique:r+"_"+o,type:r});
}}return q;
}var g=j.spreadsheet.FilterMenuController={valuesTree:function(o,n){return[{text:j.spreadsheet.messages.filterMenu.all,expanded:true,checked:false,items:this.values(o.resize({top:1}),n)}];
},values:function(q,n){var s=[];
var p=j.spreadsheet.messages.filterMenu;
var o=q.column(n);
var r=q.sheet();
o.forEachCell(function(x,v,t){var u=true;
if(r.isHiddenRow(x)){u=false;
}var z=t.value;
var w=t.dataType;
var y=t.text;
if(z===undefined){w="blank";
}else{if(t.format){w=j.spreadsheet.formatting.type(z,t.format);
}else{w=typeof z;
}}if(z!==null&&t.format){y=j.spreadsheet.formatting.text(z,t.format);
}else{y=w=="blank"?p.blanks:z;
}if(w==="percent"||w==="currency"){w="number";
}if(w==="date"){z=j.spreadsheet.numberToDate(z);
}s.push({dataType:w,value:z,text:y,checked:u});
});
s=d(s);
s.sort(function(t,u){if(t.dataType===u.dataType){return 0;
}if(t.dataType==="blank"||u.dataType==="blank"){return t.dataType==="blank"?-1:1;
}if(t.dataType==="number"||u.dataType==="number"){return t.dataType==="number"?-1:1;
}if(t.dataType==="date"||u.dataType==="date"){return t.dataType==="date"?-1:1;
}return 0;
});
return s;
},filterType:function(p,n){var q=p.sheet();
var o=this.filterForColumn(n,q);
var s;
o=o&&o.filter.toJSON();
if(o&&o.filter=="custom"){var t=o.criteria[0].value;
if(t instanceof Date){s="date";
}else{if(typeof t=="string"){s="string";
}else{if(typeof t=="number"){s="number";
}}}}if(!s){var r=this.values(p.row(1),n)[0];
s=r&&r.dataType;
if(s=="blank"){s=null;
}}return s;
},filterForColumn:function(o,q){var n=q.filter();
var p;
if(n){p=n.columns.filter(function(r){return r.index===o;
})[0];
}return p;
},filter:function(n,s){var o=this.filterForColumn(n,s);
if(!o){return;
}var q=o.filter.toJSON();
var t=q.filter;
delete q.filter;
var r={type:t,options:q};
var p=q.criteria;
if(p&&p.length){r.operator=p[0].operator;
}return r;
}};
var f=m.extend({init:function(n,o){m.call(this,n,o);
this.element.addClass(f.classNames.wrapper);
this.viewModel=new h({active:"value",operator:null,operators:i(this.options.operators),clear:this.clear.bind(this),apply:this.apply.bind(this)});
this._filterInit();
this._popup();
this._sort();
this._filterByCondition();
this._filterByValue();
this._actionButtons();
},options:{name:"FilterMenu",column:0,range:null,operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with",matches:"Text matches",doesnotmatch:"Text does not match"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}},events:["action"],destroy:function(){m.fn.destroy.call(this);
this.menu.destroy();
this.valuesTreeView.destroy();
this.popup.destroy();
},openFor:function(n){this.popup.setOptions({anchor:n});
this.popup.open();
},close:function(){this.popup.close();
},clear:function(){this.action({command:"ClearFilterCommand",options:{column:this.options.column}});
this.viewModel.reset();
this.close();
},apply:function(){this._active();
var o={operatingRange:this.options.range,column:this.options.column};
var p;
var n;
if(this.viewModel.active==="value"){this.viewModel.valuesChange({sender:this.valuesTreeView});
p=this.viewModel.valueFilter.toJSON();
if(p.blanks||p.values&&p.values.length){o.valueFilter=p;
}}else{if(this.viewModel.active==="custom"){n=this.viewModel.customFilter.toJSON();
if(n.criteria.length&&n.criteria[0].value!==null){o.customFilter=n;
}}}if(o.valueFilter||o.customFilter){this.action({command:"ApplyFilterCommand",options:o});
}},action:function(n){this.trigger("action",a.extend({},n));
},_filterInit:function(){var o=this.options.column;
var q=this.options.range;
var r=q.sheet();
var n=g.filter(o,r);
if(n){var p=g.filterType(q,o);
this.viewModel.set("active",n.type);
this.viewModel.set(n.type+"Filter",n.options);
if(n.type=="custom"){this.viewModel.set("operator",p+"_"+n.operator);
this.viewModel.set("operatorType",p);
}}else{this.viewModel.reset();
}},_popup:function(){this.popup=this.element.kendoPopup({copyAnchorStyles:false}).data("kendoPopup");
},_sort:function(){var p=j.template(f.templates.menuItem);
var o=j.spreadsheet.messages.filterMenu;
var n=[{command:"sort",dir:"asc",text:o.sortAscending,iconClass:"sort-asc"},{command:"sort",dir:"desc",text:o.sortDescending,iconClass:"sort-desc"}];
var q=a("<ul />",{html:j.render(p,n)}).appendTo(this.element);
this.menu=q.kendoMenu({orientation:"vertical",select:function(s){var r=a(s.item).data("dir");
var u=this.options.range.resize({top:1});
var t={value:r,sheet:false,operatingRange:u,column:this.options.column};
this.action({command:"SortCommand",options:t});
}.bind(this)}).data("kendoMenu");
},_appendTemplate:function(r,n,p,q){var o=j.template(r);
var s=a("<div class='"+n+"'/>").html(o({messages:j.spreadsheet.messages.filterMenu,guid:j.guid(),ns:j.ns}));
this.element.append(s);
if(p){p=new c(s,{expanded:q,toggle:this._detailToggle.bind(this)});
}j.bind(s,this.viewModel);
return s;
},_detailToggle:function(n){this.element.find("[data-role=details]").not(n.sender.element).data("kendoDetails").toggle(!n.show);
},_filterByCondition:function(){var n=this.viewModel.active==="custom";
this._appendTemplate(f.templates.filterByCondition,f.classNames.filterByCondition,true,n);
},_filterByValue:function(){var n=this.viewModel.active==="value";
var p=this._appendTemplate(f.templates.filterByValue,f.classNames.filterByValue,true,n);
this.valuesTreeView=p.find("[data-role=treeview]").data("kendoTreeView");
var o=g.valuesTree(this.options.range,this.options.column);
this.viewModel.set("valuesDataSource",new j.data.HierarchicalDataSource({data:o}));
},_actionButtons:function(){this._appendTemplate(f.templates.actionButtons,f.classNames.actionButtons,false);
},_active:function(){var n=this.element.find("[data-role=details]").filter(function(p,o){return a(o).data("kendoDetails").visible();
});
if(n.hasClass(f.classNames.filterByValue)){this.viewModel.set("active","value");
}else{if(n.hasClass(f.classNames.filterByCondition)){this.viewModel.set("active","custom");
}}}});
j.spreadsheet.FilterMenu=f;
a.extend(true,f,{classNames:b,templates:k});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/editor",["kendo.core"],b);
}(function(){(function(a){if(a.support.browser.msie&&a.support.browser.version<9){return;
}var c=a.Observable.extend({init:function(d){a.Observable.fn.init.call(this);
this.view=d;
this.formulaBar=d.formulaBar;
this._active=false;
this.barInput=d.formulaBar.formulaInput;
this.cellInput=d.formulaInput;
this.barInput.syncWith(this.cellInput);
this.cellInput.syncWith(this.barInput);
this.barInput.bind("keyup",this._triggerUpdate.bind(this));
this.cellInput.bind("keyup",this._triggerUpdate.bind(this));
this.barInput.bind("blur",this._blur.bind(this));
this.cellInput.bind("blur",this._blur.bind(this));
},events:["activate","deactivate","change","update"],_blur:function(){this.deactivate();
},_triggerUpdate:function(){this.trigger("update",{value:this.value()});
},activeEditor:function(){var e=null;
var d=a._activeElement();
if(this.barElement()[0]===d){e=this.barInput;
}else{if(this.cellElement()[0]===d){e=this.cellInput;
}}return e;
},activate:function(d){this._active=true;
this._rect=d.rect;
this._range=d.range;
this.cellInput.position(d.rect);
this.cellInput.resize(d.rect);
this.cellInput.tooltip(d.tooltip);
this.cellInput.activeCell=this.barInput.activeCell=this._range.topLeft();
this.cellInput.activeSheet=this.barInput.activeSheet=this._range._sheet;
this.trigger("activate");
return this;
},deactivate:function(e){var d=this.cellInput;
if(!this._active){return;
}this._active=false;
if(!e&&d.value()!=this._value){this.trigger("change",{value:d.value(),range:this._range});
}this._rect=null;
d.hide();
this.trigger("deactivate");
},enable:function(d){this.barInput.enable(d);
this.cellInput.enable(d);
},barElement:function(){return this.barInput.element;
},cellElement:function(){return this.cellInput.element;
},focus:function(d){d=d||"cell";
if(d==="cell"){this.cellInput.element.focus();
this.cellInput.end();
}else{this.barInput.element.focus();
}},isActive:function(){return this._active;
},isFiltered:function(){return this.barInput.popup.visible()||this.cellInput.popup.visible();
},canInsertRef:function(e){var d=this.activeEditor();
return d&&d.canInsertRef(e);
},highlightedRefs:function(){var d=this.activeEditor();
var e=[];
if(d){e=d.highlightedRefs();
}return e;
},scale:function(){this.cellInput.scale();
},toggleTooltip:function(d){this.cellInput.toggleTooltip(b(this._rect,d));
},value:function(e,d){if(e===undefined){return this.barInput.value();
}if(e===null){e="";
}this._value=e;
this.barInput.value(e);
this.cellInput.value(e);
this.barInput.element.toggleClass("k-spreadsheet-array-formula",!!d);
},insertNewline:function(){this.activeEditor().insertNewline();
this.scale();
},select:function(){this.activeEditor().select();
}});
function b(e,d){return e&&(e.top!==d.top||e.left!==d.left);
}a.spreadsheet.SheetEditor=c;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/autofill",["spreadsheet/runtime","spreadsheet/range"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var m=kendo.spreadsheet;
var k=m.Range;
var l=m.calc.runtime;
var h=l.Formula;
var b="incompatibleRanges";
var c="noFillDirection";
var d=k.FillError=function(p){this.code=p;
};
k.prototype._previewFillFrom=function(J,w){var v=this,G=v._sheet;
if(typeof J=="string"){J=G.range(J);
}var H=J._ref.toRangeRef().clone().setSheet(G.name());
var u=v._ref.toRangeRef().clone().setSheet(G.name());
if(H.intersects(u)){if(H.eq(u)){return null;
}u=u.clone();
if(H.topLeft.eq(u.topLeft)){if(H.width()==u.width()){u.topLeft.row+=H.height();
w=0;
}else{if(H.height()==u.height()){u.topLeft.col+=H.width();
w=1;
}else{throw new d(b);
}}}else{if(H.bottomRight.eq(u.bottomRight)){if(H.width()==u.width()){u.bottomRight.row-=H.height();
w=2;
}else{if(H.height()==u.height()){u.bottomRight.col-=H.width();
w=3;
}else{throw new d(b);
}}}else{throw new d(b);
}}return G.range(u)._previewFillFrom(J,w);
}if(w==null){if(H.topLeft.col==u.topLeft.col){w=H.topLeft.row<u.topLeft.row?0:2;
}else{if(H.topLeft.row==u.topLeft.row){w=H.topLeft.col<u.topLeft.col?1:3;
}else{throw new d(c);
}}}var A=w&1;
var t=w&2;
if(A&&H.height()!=u.height()||!A&&H.width()!=u.width()){throw new d(b);
}var r=J._properties(),E;
if(!A){r=o(r);
E=u.height();
}else{E=u.width();
}var y=new Array(r.length);
var z=null;
for(var B=0;
B<r.length;
++B){var F=r[B];
var x=e(F);
var p=y[B]=new Array(E);
for(var D=0;
D<E;
++D){var C=t?-D-1:F.length+D;
var I=t?F.length-D%F.length-1:D%F.length;
var q=p[t?E-D-1:D]=x(C,I);
if(q.value!=null){z=q.value;
}}}if(!A){y=o(y);
}return{props:y,direction:w,dest:v,hint:z};
};
k.prototype.fillFrom=function(q,p){var r=this._previewFillFrom(q,p);
r.dest._properties(r.props,true);
return r.dest;
};
function j(r){var v=r.length;
var t=(v+1)/2,u=r.reduce(function(A,B){return A+B;
},0)/v;
var w=0,x=0;
for(var s=0;
s<v;
s++){var y=s+1-t,z=r[s]-u;
w+=y*z;
x+=y*y;
}if(!x){return function(A){return r[A%r.length];
};
}var q=w/x,p=u-q*t;
return function(A){return p+q*(A+1);
};
}function e(s){function q(u){var v=u[1]-u[0];
for(var w=2;
w<u.length;
++w){if(u[w]-u[w-1]!=v){return null;
}}return v;
}function r(u){return u.map(function(w){return w.number;
});
}var t=[];
var p=s.map(function(u){return u.formula||u.value;
});
g(p,function(v,x,B,u){var y,C;
if(B=="number"){C=r(u);
y=j(C);
}else{if(B=="string"||B=="formula"||B=="boolean"){y=function(E,D){return p[D];
};
}else{if(Array.isArray(B)){if(u.length==1){y=function(D){return B[(u[0].number+D)%B.length];
};
}else{var w=q(r(u));
if(w==null){y=function(D){return u[D%u.length].value;
};
}else{y=function(E){var D=u[0].number+w*E;
return B[D%B.length];
};
}}}else{if(B!="null"){C=r(u);
if(C.length==1){C.push(C[0]+1);
}C=j(C);
y=function(E,D){return p[D].replace(/^(.*\D)\d+/,"$1"+C(E,D));
};
}else{y=function(){return null;
};
}}}}var A={f:y,begin:v,end:x,len:x-v};
for(var z=v;
z<x;
++z){t[z]=A;
}});
return function(w,u){var A=t[u];
var y=w/p.length|0;
var z=w%p.length;
var v=y*A.len+z-A.begin;
var B=A.f(v,u);
var x=a(s[u]);
delete x.enable;
if(B instanceof h){x.formula=B;
}else{x.value=B;
}return x;
};
}function a(q){var p={};
Object.keys(q||{}).forEach(function(r){p[r]=q[r];
});
return p;
}function g(q,r){var t=null,u=0,p=[],v;
for(var s=0;
s<q.length;
++s){v=i(q[s]);
p.push(v);
if(t!=null&&v.type!==t.type){r(u,s,t.type,p.slice(u,s));
u=s;
}t=v;
}r(u,s,t.type,p.slice(u,s));
}function i(p){if(typeof p=="number"){return{type:"number",number:p};
}if(typeof p=="string"){var q=f(p);
if(q){return q;
}var r=/^(.*\D)(\d+)/.exec(p);
if(r){p=p.replace(/^(.*\D)\d+/,"$1-######");
return{type:p,match:r,number:parseFloat(r[2])};
}return{type:"string"};
}if(typeof p=="boolean"){return{type:"boolean"};
}if(p==null){return{type:"null"};
}if(p instanceof h){return{type:"formula"};
}window.console.error(p);
throw new Error("Cannot fill data");
}function n(){var p=kendo.culture();
return[p.calendars.standard.days.namesAbbr,p.calendars.standard.days.names,p.calendars.standard.months.namesAbbr,p.calendars.standard.months.names];
}function f(u){var v=u.toLowerCase();
var t=n();
for(var r=0;
r<t.length;
++r){var p=t[r];
for(var s=p.length;
--s>=0;
){var q=p[s].toLowerCase();
if(q==v){return{type:p,number:s,value:u};
}}}}function o(p){var q=p.length,v=p[0].length;
var u=[];
for(var r=0;
r<v;
++r){u[r]=[];
for(var s=0;
s<q;
++s){u[r][s]=p[s][r];
}}return u;
}},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/nameeditor",["kendo.core"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var a=c.jQuery;
var b={input:"k-spreadsheet-name-editor",list:"k-spreadsheet-name-list"};
var d=c.ui.Widget.extend({init:function(h,i){c.ui.Widget.call(this,h,i);
h.addClass(b.input);
var e=i.messages.nameBox||"Name Box";
var g=new c.data.DataSource({transport:{read:function(k){var j=[];
this._workbook.forEachName(function(l){if(!l.hidden&&l.value instanceof c.spreadsheet.Ref){j.push({name:l.name});
}});
k.success(j);
}.bind(this),cache:false}});
var f=a("<input />").attr("title",e).attr("aria-label",e);
this.combo=f.appendTo(h).kendoComboBox({clearButton:false,dataTextField:"name",dataValueField:"name",template:"#:data.name#<a class='k-button-delete' href='\\#'><span class='k-icon k-i-close'></span></a>",dataSource:g,autoBind:false,ignoreCase:true,change:this._on_listChange.bind(this),noDataTemplate:"<div></div>",open:function(){g.read();
}}).getKendoComboBox();
this.combo.input.on("keydown",this._on_keyDown.bind(this)).on("focus",this._on_focus.bind(this));
this.combo.popup.element.addClass("k-spreadsheet-names-popup").on("mousemove",function(j){j.stopPropagation();
}).on("click",".k-button-delete",function(j){j.preventDefault();
j.stopPropagation();
var k=a(j.target).closest(".k-item");
k=this.combo.dataItem(k);
this._deleteItem(k.name);
}.bind(this));
},value:function(e){if(e===undefined){return this.combo.value();
}else{this.combo.value(e);
}},_deleteItem:function(e){this.trigger("delete",{name:e});
},_on_keyDown:function(e){switch(e.keyCode){case 27:this.combo.value(this._prevValue);
this.trigger("cancel");
break;
case 13:this.trigger("enter");
break;
}},_on_focus:function(){this._prevValue=this.combo.value();
},_on_listChange:function(){var e=this.combo.value();
if(e){this.trigger("select",{name:e});
}}});
c.spreadsheet.NameEditor=d;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/print",["kendo.pdf","spreadsheet/sheet","spreadsheet/range","spreadsheet/references","spreadsheet/numformat","util/text-metrics"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var z=kendo.spreadsheet;
var d=z.CellRef;
var s=kendo.drawing;
var p=z.formatting;
var q=kendo.geometry;
var r=0.8;
function i(G,J,H,F,E){var C=0;
var I=[];
var B=J;
var D=0;
if(J&&H){H*=J;
}G.forEach(function(K,L){if(F!=null&&L<F){D+=K;
}if(J&&C+K>B){if(B-C<H){C=J*Math.ceil(C/J)+D;
if(D>0){E.push(C-D);
}}B+=J*Math.ceil(K/J);
}I.push(C);
C+=K;
});
I.push(C);
return I;
}function j(S,P,M){var G=S._grid;
P=G.normalize(P);
var T=G.rectangle(P);
var F=[];
S._drawings.forEach(function(Y){var X=S.drawingBoundingBox(Y);
if(X.intersects(T)){F.push({drawing:Y,box:X.offset(-T.left,-T.top)});
}});
var D=[];
var Q=[];
var E=[];
var L=S._getMergedCells(P);
var K=-1,J=-1;
S.forEach(P,function(ag,Y,X){var ae=ag-P.topLeft.row;
var ad=Y-P.topLeft.col;
var af=S.rowHeight(ag);
var Z=S.columnWidth(Y);
if(!M.forScreen){X.drawings=F.filter(function(ah){var ai=ah.drawing.topLeftCell;
if(ai&&ai.row==ag&&ai.col==Y){K=Math.max(K,S._rows.index(ah.box.bottom));
J=Math.max(J,S._columns.index(ah.box.right));
return true;
}});
}if(!ad){Q.push(af);
}if(!ae){E.push(Z);
}if(S.isHiddenColumn(Y)||S.isHiddenRow(ag)||!af||!Z){return;
}var ac=M.forScreen||y(X);
if(!(M.emptyCells||ac)){return;
}var aa=new d(ag,Y).print();
if(L.secondary[aa]){return;
}if(ac){K=Math.max(K,ae);
J=Math.max(J,ad);
}else{X.empty=true;
}X.row=ae;
X.col=ad;
var ab=L.primary[aa];
if(ab){delete L.primary[aa];
X.merged=true;
X.rowspan=ab.height();
X.colspan=ab.width();
if(M.forScreen){X.width=S._columns.sum(ab.topLeft.col,ab.bottomRight.col);
X.height=S._rows.sum(ab.topLeft.row,ab.bottomRight.row);
}}else{X.rowspan=1;
X.colspan=1;
}D.push(X);
});
Q=Q.slice(0,K+1);
E=E.slice(0,J+1);
var O=M.pageWidth;
var N=M.pageHeight;
var R=M.scale||1;
if(M.fitWidth){var U=E.reduce(A,0);
if(U>O){R=O/U;
}}O=Math.ceil(O/R);
N=Math.ceil(N/R);
var I=[];
var W=i(Q,N||0,M.maxEmpty,M.headerRows,I);
var V=i(E,O||0,M.maxEmpty);
var C=0;
var B=0;
var H=[];
D=D.filter(function(X){if(X.empty&&(X.row>K||X.col>J)){return false;
}if(M.headerRows&&X.row<M.headerRows){H.push(X);
}X.left=V[X.col];
X.top=W[X.row];
if(X.merged){if(!M.forScreen){X.right=w(V,X.col+X.colspan);
X.bottom=w(W,X.row+X.rowspan);
X.width=X.right-X.left;
X.height=X.bottom-X.top;
}else{X.right=X.left+X.width;
X.bottom=X.top+X.height;
}}else{X.width=E[X.col];
X.height=Q[X.row];
X.bottom=X.top+X.height;
X.right=X.left+X.width;
}if(!M.forScreen){X.drawings.forEach(function(Z){var Y=Z.box;
Y.left=X.left+Z.drawing.offsetX;
Y.top=X.top+Z.drawing.offsetY;
Y.right=Y.left+Y.width;
Y.bottom=Y.top+Y.height;
});
}C=Math.max(C,X.right);
B=Math.max(B,X.bottom);
return true;
});
Object.keys(L.primary).forEach(function(X){var Y=L.primary[X];
S.forEach(Y.topLeft.toRangeRef(),function(ad,aa,Z){var ac=ad-P.topLeft.row;
var ab=aa-P.topLeft.col;
Z.merged=true;
Z.colspan=Y.width();
Z.rowspan=Y.height();
if(ac<0){Z.top=-S._rows.sum(ad,ad-ac-1);
}else{Z.top=W[ac];
}if(ab<0){Z.left=-S._columns.sum(aa,aa-ab-1);
}else{Z.left=V[ab];
}Z.height=S._rows.sum(Y.topLeft.row,Y.bottomRight.row);
Z.width=S._columns.sum(Y.topLeft.col,Y.bottomRight.col);
if(Z.height>0&&Z.width>0){Z.right=Z.left+Z.width;
Z.bottom=Z.top+Z.height;
Z.row=ac;
Z.col=ab;
D.push(Z);
}});
});
if(M.headerRows){I.forEach(function(X){H.forEach(function(Y){Y=f(Y);
Y.top+=X;
Y.bottom=Y.top+Y.height;
D.push(Y);
});
W.push(X);
});
W.sort(v);
}return{width:C,height:B,cells:D.sort(u),scale:R,xCoords:V,yCoords:W,drawings:F};
}function f(B,C){if(!C){C={};
}if(Object.assign){return Object.assign(C,B);
}return Object.keys(B).reduce(function(D,E){D[E]=B[E];
return D;
},C);
}function x(B,C){return B.size===C.size&&B.color===C.color;
}function A(B,C){return B+C;
}function w(B,C){return C<B.length?B[C]:B[B.length-1];
}function y(B){return B.value!=null||B.merged||B.background!=null||B.borderRight!=null||B.borderBottom!=null||B.validation!=null&&!B.validation.value||B.drawings&&B.drawings.length;
}function u(B,C){if(B.top<C.top){return -1;
}else{if(B.top==C.top){if(B.left<C.left){return -1;
}else{if(B.left==C.left){return 0;
}else{return 1;
}}}else{return 1;
}}}function v(B,C){return B<C?-1:B>C?1:0;
}function m(L,F,C,I){var G=Math.ceil(F.width/I.pageWidth);
var H=Math.ceil(F.height/I.pageHeight);
var K=Math.ceil(I.pageWidth/F.scale);
var J=Math.ceil(I.pageHeight/F.scale);
for(var E=0;
E<H;
++E){for(var D=0;
D<G;
++D){B(E,D);
}}function B(ab,Q){var W=Q*K;
var aa=W+K;
var ac=ab*J;
var O=ac+J;
var T=0,U=0;
function V(ad){if(ad.right<=W||ad.left>=aa||ad.bottom<=ac||ad.top>=O){return false;
}T=Math.max(ad.bottom,T);
U=Math.max(ad.right,U);
return true;
}var P=F.cells.filter(V);
var S=F.drawings.filter(function(ad){return V(ad.box);
});
T=Math.min(T,O);
U=Math.min(U,aa);
if(P.length||S.length){var Y=new s.Group();
C.append(Y);
var R=new s.Group();
Y.append(R);
R.clip(s.Path.fromRect(new q.Rect([W-1,ac-1],[U+1,T+1])));
var X=q.Matrix.scale(F.scale,F.scale).multiplyCopy(q.Matrix.translate(-W,-ac));
if(I.hCenter||I.vCenter){X=X.multiplyCopy(q.Matrix.translate(I.hCenter?(aa-U)/2:0,I.vCenter?(O-T)/2:0));
}R.transform(X);
if(I.guidelines){var Z=null;
F.xCoords.forEach(function(ad){ad=Math.min(ad,U);
if(ad!==Z&&ad>=W&&ad<=aa){Z=ad;
R.append(new s.Path().moveTo(ad,ac).lineTo(ad,T).close().stroke(I.guideColor,r));
}});
var Z=null;
F.yCoords.forEach(function(ad){ad=Math.min(ad,T);
if(ad!==Z&&ad>=ac&&ad<=O){Z=ad;
R.append(new s.Path().moveTo(W,ad).lineTo(U,ad).close().stroke(I.guideColor,r));
}});
}var M=b();
P.forEach(function(ad){l(ad,R,I);
M.add(ad,L);
});
var N=new s.Group();
M.vert.forEach(function(ad){ad.forEach(function(ae){if(!ae.rendered){ae.rendered=true;
N.append(new s.Path().moveTo(ae.x,ae.top).lineTo(ae.x,ae.bottom).close().stroke(ae.color,ae.size));
}});
});
M.horiz.forEach(function(ad){ad.forEach(function(ae){if(!ae.rendered){ae.rendered=true;
N.append(new s.Path().moveTo(ae.left,ae.y).lineTo(ae.right,ae.y).close().stroke(ae.color,ae.size));
}});
});
R.append(N);
S.forEach(function(ae){var af=ae.drawing;
var ag=af.image;
if(ag!=null){var ad=ae.box;
var ah=L._workbook.imageUrl(ag);
R.append(new s.Image(ah,new q.Rect([ad.left,ad.top],[ad.width,ad.height])).opacity(af.opacity));
}});
}}}function l(B,D,H){var G=new s.Group();
D.append(G);
var J=new q.Rect([B.left,B.top],[B.width,B.height]);
if(B.background||B.merged){var I=J;
if(H.guidelines){I=J.clone();
I.origin.x+=r/2+0.1;
I.origin.y+=r/2+0.1;
I.size.width-=r+0.2;
I.size.height-=r+0.2;
}G.append(new s.Rect(I).fill(B.background||"#fff").stroke(null));
}var L=B.value;
if(L!=null){var K=typeof L=="number"?"number":null;
var C=new s.Group();
C.clip(s.Path.fromRect(J));
G.append(C);
var E,F=B.format;
if(!F&&K=="number"&&L!=Math.floor(L)){F="0.##############";
}if(F){E=p.textAndColor(L,F);
L=E.text;
if(E.type){K=E.type;
}}else{L+="";
}if(!B.textAlign){switch(K){case"number":case"date":case"percent":case"currency":B.textAlign="right";
break;
case"boolean":B.textAlign="center";
break;
}}o(L,E&&E.color||B.color||"#000",B,C);
}}function a(B,D){if(B.indent){var C=1.4*B.indent;
switch(D.textAlign){case null:case"left":D.paddingLeft=C+"ch";
break;
case"right":D.paddingRight=C+"ch";
break;
case"center":D.paddingLeft=C/2+"ch";
D.paddingRight=C/2+"ch";
break;
}}}var g;
function o(E,C,B,D){if(!g){g=document.createElement("div");
g.style.position="fixed";
g.style.left="0px";
g.style.top="0px";
g.style.visibility="hidden";
g.style.overflow="hidden";
g.style.boxSizing="border-box";
g.style.lineHeight="normal";
document.body.appendChild(g);
}if(g.firstChild){g.removeChild(g.firstChild);
}g.style.padding="2px 4px";
g.style.color=C;
g.style.font=t(B);
g.style.width=B.width+"px";
g.style.textAlign=B.textAlign||"left";
g.style.textDecoration=B.underline?"underline":"none";
a(B,g.style);
if(B.wrap){g.style.whiteSpace="pre-wrap";
g.style.overflowWrap=g.style.wordWrap="break-word";
}else{g.style.whiteSpace="pre";
g.style.overflowWrap=g.style.wordWrap="normal";
}g.appendChild(document.createTextNode(E));
var G=0;
switch(B.verticalAlign){case"center":G=B.height-g.offsetHeight>>1;
break;
case undefined:case null:case"bottom":G=B.height-g.offsetHeight;
break;
}if(G<0){G=0;
}var F=kendo.drawing.drawDOM.drawText(g);
F.transform(q.Matrix.translate(B.left,B.top+G));
D.append(F);
}function t(B){var C=[];
if(B.italic){C.push("italic");
}if(B.bold){C.push("bold");
}C.push((B.fontSize||12)+"px");
C.push(B.fontFamily||"Arial");
return C.join(" ");
}function k(J,I,E,B){if(E==null&&B==null){B=I;
E={};
I=z.SHEETREF;
}if(B==null){B=E;
if(I instanceof z.Range||I instanceof z.Ref||typeof I=="string"){E={};
}else{E=I;
I=z.SHEETREF;
}}E=kendo.jQuery.extend({paperSize:"A4",landscape:true,margin:"1cm",guidelines:true,guideColor:"#aaa",emptyCells:true,fitWidth:false,center:false,headerRows:null,maxEmpty:0.2,scale:1},E);
var C=new s.Group();
var H=kendo.pdf.getPaperOptions(E);
C.options.set("pdf",{author:E.author,creator:E.creator,date:E.date,keywords:E.keywords,margin:H.margin,multiPage:true,paperSize:H.paperSize,subject:E.subject,title:E.title});
var G=H.paperSize[0];
var F=H.paperSize[1];
if(H.margin){G-=H.margin.left+H.margin.right+1;
F-=H.margin.top+H.margin.bottom+1;
}E.pageWidth=G;
E.pageHeight=F;
var D=j(J,J._ref(I),E);
m(J,D,C,E);
B(C);
}z.Sheet.prototype.draw=function(D,C,B){var E=this;
if(E._workbook){E.recalc(E._workbook._context,function(){k(E,D,C,B);
});
}else{k(E,D,C,B);
}};
function h(){}h.prototype={forEach:function(B){Object.keys(this).forEach(function(C){B(this[C],C,this);
},this);
}};
function b(){var E=new h();
var F=new h();
function B(G,J){if(J){var I=J._properties;
var H=J._grid;
G.borderLeft=I.get("vBorders",H.index(G.row,G.col));
G.borderRight=I.get("vBorders",H.index(G.row,G.col+G.colspan));
G.borderTop=I.get("hBorders",H.index(G.row,G.col));
G.borderBottom=I.get("hBorders",H.index(G.row+G.rowspan,G.col));
}if(G.borderLeft){D(G.row,G.col,G.borderLeft,G.left,G.top,G.bottom);
}if(G.borderRight){D(G.row,G.col+G.colspan,G.borderRight,G.right,G.top,G.bottom);
}if(G.borderTop){C(G.row,G.col,G.borderTop,G.top,G.left,G.right);
}if(G.borderBottom){C(G.row+G.rowspan,G.col,G.borderBottom,G.bottom,G.left,G.right);
}}function D(L,J,H,N,M,I){var G=F[J]||(F[J]=new h());
var K=L>0&&G[L-1];
if(K&&x(K,H)){G[L]=K;
K.bottom=I;
}else{G[L]={size:H.size,color:H.color,x:N,top:M,bottom:I};
}}function C(M,I,H,N,J,L){var G=E[M]||(E[M]=new h());
var K=I>0&&G[I-1];
if(K&&x(K,H)){G[I]=K;
K.right=L;
}else{G[I]={size:H.size,color:H.color,y:N,left:J,right:L};
}}return{add:B,horiz:E,vert:F};
}function n(E){var F=new $.Deferred();
var G=F.promise();
E=f(E,{dataSource:null,guidelines:true,guideColor:"#000",columns:null,headerBackground:"#999",headerColor:"#000",oddBackground:null,evenBackground:null,fontFamily:"Arial",fontSize:12,paperSize:"A4",margin:"1cm",landscape:true,fitWidth:false,scale:1,rowHeight:20,maxEmpty:1,useGridFormat:true});
kendo.drawing.pdf.defineFont(kendo.drawing.drawDOM.getFontFaces(document));
var C=e(E.fontFamily,E.fontSize);
function H(J){if(J!=null){var K=12;
for(var I=J.length;
--I>=0;
){K+=C(J.charAt(I));
}return K;
}return 0;
}var B=E.guidelines?{size:1,color:E.guideColor}:null;
function D(I){if(!B){return I;
}return f(I,{borderLeft:B,borderTop:B,borderRight:B,borderBottom:B});
}E.dataSource.fetch(function(){var L=E.dataSource.data();
if(!L.length){return F.reject("Empty dataset");
}var I=E.columns.map(function(O){if(typeof O=="string"){return{title:O,field:O};
}else{return O;
}});
var J=I.map(function(O){return O.title||O.field;
});
var K=J.map(H);
var M=L.map(function(O,P){return{cells:I.map(function(Q,R){var S=O[Q.field];
if(E.useGridFormat){if(S!=null){if(Q.format){S=kendo.format(Q.format,S);
}else{S+="";
}}K[R]=Math.max(H(S),K[R]);
}return D({value:S,format:E.useGridFormat?null:Q.format,background:P%2?E.evenBackground:E.oddBackground});
})};
});
M.unshift({cells:J.map(function(O){return D({value:O,background:E.headerBackground,color:E.headerColor});
})});
var N=new kendo.spreadsheet.Sheet(M.length+1,I.length+1,E.rowHeight,50,20,20,{fontFamily:E.fontFamily,fontSize:E.fontSize,verticalAlign:"center"});
N.fromJSON({name:"Sheet1",rows:M,columns:K.map(function(P,O){return{index:O,width:P};
})});
N.draw({paperSize:E.paperSize,landscape:E.landscape,margin:E.margin,guidelines:false,scale:E.scale,fitWidth:E.fitWidth,maxEmpty:E.maxEmpty,headerRows:1},F.resolve.bind(F));
});
return G;
}var c={};
var e=function(C,D){var G=D+":"+C;
var E=c[G];
if(!E){var H,B=document.createElement("div");
B.style.position="fixed";
B.style.left="-10000px";
B.style.top="-10000px";
B.style.fontFamily=C;
B.style.fontSize=D+"px";
B.style.whiteSpace="pre";
for(var F=32;
F<128;
++F){H=document.createElement("span");
H.appendChild(document.createTextNode(String.fromCharCode(F)));
B.appendChild(H);
}document.body.appendChild(B);
var I={};
for(F=32,H=B.firstChild;
F<128&&H;
++F,H=H.nextSibling){I[F]=H.offsetWidth;
}while(H=B.firstChild){B.removeChild(H);
}E=c[G]=function(J){var K=J.charCodeAt(0);
var L=I[K];
if(L==null){H=document.createElement("span");
H.appendChild(document.createTextNode(String.fromCharCode(K)));
B.appendChild(H);
L=I[K]=H.offsetWidth;
B.removeChild(H);
}return L;
};
}return E;
};
z.draw={Borders:b,doLayout:j,applyIndent:a};
z.drawTabularData=n;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("kendo.spreadsheet",["util/undoredostack","util/text-metrics","util/parse-xml","kendo.excel","kendo.progressbar","kendo.pdf","spreadsheet/commands","spreadsheet/formulabar","spreadsheet/formulainput","spreadsheet/eventlistener","spreadsheet/rangelist","spreadsheet/propertybag","spreadsheet/references","spreadsheet/navigator","spreadsheet/axismanager","spreadsheet/clipboard","spreadsheet/range","spreadsheet/sheet","spreadsheet/sheetsbar","spreadsheet/excel-reader","spreadsheet/workbook","spreadsheet/formulacontext","spreadsheet/controller","spreadsheet/view","spreadsheet/customeditors","spreadsheet/grid","spreadsheet/axis","spreadsheet/filter","spreadsheet/sorter","spreadsheet/runtime","spreadsheet/calc","spreadsheet/numformat","spreadsheet/runtime.functions","spreadsheet/runtime.functions.2","spreadsheet/toolbar","spreadsheet/dialogs","spreadsheet/sheetbinder","spreadsheet/filtermenu","spreadsheet/editor","spreadsheet/autofill","spreadsheet/nameeditor","spreadsheet/print"],b);
}(function(){var a={id:"spreadsheet",name:"Spreadsheet",category:"web",description:"Spreadsheet component",depends:["core","binder","colorpicker","combobox","data","dom","dropdownlist","menu","ooxml","popup","sortable","tabstrip","toolbar","treeview","window","validator","excel","pdf","drawing"]};
(function(f,j){if(f.support.browser.msie&&f.support.browser.version<9){return;
}var b=f.jQuery;
var g=b.extend({F10:121,F11:122,B:66,I:73,U:85,N:78,H:72,A:65,PAGEDOWN:34,PAGEUP:33,DELETE:46,R:82},f.keys);
var l=f.ui.Widget;
var m=f.spreadsheet.Workbook;
var e=f.spreadsheet.Controller;
var k=f.spreadsheet.View;
var h=".kendoSpreadsheet";
var c={recalc:true,selection:true,activeCell:true,layout:true,sheetSelection:true,resize:true,editorChange:false,editorClose:false};
var d={wrapper:"k-widget k-spreadsheet"};
var i=f.ui.Widget.extend({init:function(n,o){l.fn.init.call(this,n,o);
this.element.addClass(i.classNames.wrapper);
this._view=new k(this.element,{messages:this.options.messages.view,toolbar:this.options.toolbar,sheetsbar:this.options.sheetsbar});
this._workbook=new m(this.options,this._view);
this._controller=new e(this._view,this._workbook);
this._autoRefresh=true;
this._bindWorkbookEvents();
this._view.workbook(this._workbook);
this._view.enableClipboard(false);
this.refresh();
this._view.enableClipboard(true);
this._resizeHandler=function(){this.resize();
}.bind(this);
b(window).on("resize"+h,this._resizeHandler);
this.element.on("keydown"+h,this._keyDown.bind(this));
},_keyDown:function(o){var p=o.keyCode;
var q=b(".k-spreadsheet-quick-access-toolbar [title=Redo]");
if(p===g.F11&&o.shiftKey){this._view.sheetsbar._onAddSelect();
o.preventDefault();
return;
}else{if(o.altKey&&p===g.PAGEDOWN){this._view.sheetsbar.trigger("select",{name:this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex+1].name(),isAddButton:false});
}else{if(o.altKey&&p===g.PAGEUP){this._view.sheetsbar.trigger("select",{name:this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex-1].name(),isAddButton:false});
}else{if(o.altKey&&p===g.DELETE){var n=function(s){var r=s.sender;
if(r.isConfirmed()){this._view.sheetsbar.trigger("remove",{name:this.activeSheet()._name(),confirmation:true});
}}.bind(this);
this._view.sheetsbar._openDialog("confirmation",{close:n});
o.preventDefault();
return;
}else{if(o.altKey&&p===g.R){this._view.sheetsbar._createEditor();
o.preventDefault();
return;
}else{if(p===g.F10&&this._view.tabstrip||p===g.TAB&&!o.shiftKey&&b(document.activeElement).is(q)){this._view.tabstrip.toolbars[this._view.tabstrip.element.find("li.k-state-active").text().toLowerCase()].element.find(":not(.k-overflow-anchor):kendoFocusable:first").focus();
this._view.tabstrip.toolbars[this._view.tabstrip.element.find("li.k-state-active").text().toLowerCase()].element.find(".k-toolbar-first-visible").addClass("k-state-focused");
o.preventDefault();
return;
}else{if(o.ctrlKey&&p===g.B){b("[data-tool=bold]")[0].click();
}else{if(o.ctrlKey&&p===g.I){b("[data-tool=italic]")[0].click();
}else{if(o.ctrlKey&&p===g.U){b("[data-tool=underline]")[0].click();
}else{if(o.altKey&&p===g.H){this._view.tabstrip.select(0);
o.preventDefault();
return;
}else{if(o.altKey&&p===g.N){this._view.tabstrip.select(1);
o.preventDefault();
return;
}else{if(o.altKey&&p===g.A){this._view.tabstrip.select(2);
o.preventDefault();
return;
}}}}}}}}}}}}},_resize:function(){this.refresh({layout:true});
},_workbookChanging:function(n){if(this.trigger("changing",n)){n.preventDefault();
}},_workbookChange:function(n){if(this._autoRefresh){this.refresh(n);
}if(n.recalc&&n.ref){var o=n.range||new f.spreadsheet.Range(n.ref,this.activeSheet());
this.trigger("change",{range:o});
}},_workbookCut:function(n){this.trigger("cut",n);
},_workbookCopy:function(n){this.trigger("copy",n);
},_workbookPaste:function(n){this.trigger("paste",n);
},activeSheet:function(n){return this._workbook.activeSheet(n);
},moveSheetToIndex:function(o,n){return this._workbook.moveSheetToIndex(o,n);
},insertSheet:function(n){return this._workbook.insertSheet(n);
},sheets:function(){return this._workbook.sheets();
},removeSheet:function(n){return this._workbook.removeSheet(n);
},sheetByName:function(n){return this._workbook.sheetByName(n);
},sheetIndex:function(n){return this._workbook.sheetIndex(n);
},sheetByIndex:function(n){return this._workbook.sheetByIndex(n);
},renameSheet:function(o,n){return this._workbook.renameSheet(o,n);
},refresh:function(n){if(!n){n=c;
}if(!n.editorClose){this._view.sheet(this._workbook.activeSheet());
this._controller.sheet(this._workbook.activeSheet());
this._workbook.refresh(n);
}if(!n.editorChange){this._view.refresh(n);
this._controller.refresh();
this._view.render(n);
this.trigger("render");
}return this;
},openDialog:function(n,o){return this._view.openDialog(n,o);
},autoRefresh:function(n){if(n!==j){this._autoRefresh=n;
if(n===true){this.refresh();
}return this;
}return this._autoRefresh;
},toJSON:function(){return this._workbook.toJSON();
},fromJSON:function(n){if(n.sheets){this._workbook.destroy();
this._workbook=new m(b.extend({},this.options,n));
this._bindWorkbookEvents();
this._view.workbook(this._workbook);
this._controller.workbook(this._workbook);
this.activeSheet(this.activeSheet());
}else{this.refresh();
}},saveJSON:function(){return this._workbook.saveJSON();
},fromFile:function(n,o){return this._workbook.fromFile(n,o);
},saveAsPDF:function(n){this._workbook.saveAsPDF(b.extend({},this.options.pdf,n,{workbook:this._workbook}));
},saveAsExcel:function(n){this._workbook.saveAsExcel(n);
},draw:function(o,n){this._workbook.draw(o,n);
},_workbookExcelExport:function(n){if(this.trigger("excelExport",n)){n.preventDefault();
}},_workbookExcelImport:function(n){if(this.trigger("excelImport",n)){n.preventDefault();
}else{this._initProgress(n.promise);
}},_initProgress:function(n){var o=b("<div class='k-loading-mask' style='width: 100%; height: 100%; top: 0;'><div class='k-loading-color'/></div>").appendTo(this.element);
var p=b("<div class='k-loading-progress'>").appendTo(o).kendoProgressBar({type:"chunk",chunkCount:10,min:0,max:1,value:0}).data("kendoProgressBar");
n.progress(function(q){p.value(q.progress);
}).always(function(){f.destroy(o);
o.remove();
});
},_workbookPdfExport:function(n){if(this.trigger("pdfExport",n)){n.preventDefault();
}},_workbookInsertSheet:function(n){if(this.trigger("insertSheet",n)){n.preventDefault();
}},_workbookRemoveSheet:function(n){if(this.trigger("removeSheet",n)){n.preventDefault();
}},_workbookSelectSheet:function(n){if(this.trigger("selectSheet",n)){n.preventDefault();
}},_workbookRenameSheet:function(n){if(this.trigger("renameSheet",n)){n.preventDefault();
}},_workbookInsertRow:function(n){if(this.trigger("insertRow",n)){n.preventDefault();
}},_workbookInsertColumn:function(n){if(this.trigger("insertColumn",n)){n.preventDefault();
}},_workbookDeleteRow:function(n){if(this.trigger("deleteRow",n)){n.preventDefault();
}},_workbookDeleteColumn:function(n){if(this.trigger("deleteColumn",n)){n.preventDefault();
}},_workbookHideRow:function(n){if(this.trigger("hideRow",n)){n.preventDefault();
}},_workbookHideColumn:function(n){if(this.trigger("hideColumn",n)){n.preventDefault();
}},_workbookUnhideRow:function(n){if(this.trigger("unhideRow",n)){n.preventDefault();
}},_workbookUnhideColumn:function(n){if(this.trigger("unhideColumn",n)){n.preventDefault();
}},_workbookSelect:function(n){this.trigger("select",n);
},_workbookChangeFormat:function(n){this.trigger("changeFormat",n);
},_workbookDataBinding:function(n){if(this.trigger("dataBinding",n)){n.preventDefault();
}},_workbookDataBound:function(n){this.trigger("dataBound",n);
},_bindWorkbookEvents:function(){this._workbook.bind("cut",this._workbookCut.bind(this));
this._workbook.bind("copy",this._workbookCopy.bind(this));
this._workbook.bind("paste",this._workbookPaste.bind(this));
this._workbook.bind("changing",this._workbookChanging.bind(this));
this._workbook.bind("change",this._workbookChange.bind(this));
this._workbook.bind("excelExport",this._workbookExcelExport.bind(this));
this._workbook.bind("excelImport",this._workbookExcelImport.bind(this));
this._workbook.bind("pdfExport",this._workbookPdfExport.bind(this));
this._workbook.bind("insertSheet",this._workbookInsertSheet.bind(this));
this._workbook.bind("removeSheet",this._workbookRemoveSheet.bind(this));
this._workbook.bind("selectSheet",this._workbookSelectSheet.bind(this));
this._workbook.bind("renameSheet",this._workbookRenameSheet.bind(this));
this._workbook.bind("insertRow",this._workbookInsertRow.bind(this));
this._workbook.bind("insertColumn",this._workbookInsertColumn.bind(this));
this._workbook.bind("deleteRow",this._workbookDeleteRow.bind(this));
this._workbook.bind("deleteColumn",this._workbookDeleteColumn.bind(this));
this._workbook.bind("hideRow",this._workbookHideRow.bind(this));
this._workbook.bind("hideColumn",this._workbookHideColumn.bind(this));
this._workbook.bind("unhideRow",this._workbookUnhideRow.bind(this));
this._workbook.bind("unhideColumn",this._workbookUnhideColumn.bind(this));
this._workbook.bind("select",this._workbookSelect.bind(this));
this._workbook.bind("changeFormat",this._workbookChangeFormat.bind(this));
this._workbook.bind("dataBinding",this._workbookDataBinding.bind(this));
this._workbook.bind("dataBound",this._workbookDataBound.bind(this));
},destroy:function(){f.ui.Widget.fn.destroy.call(this);
this._workbook.destroy();
this._controller.destroy();
this._view.destroy();
if(this._resizeHandler){b(window).off("resize"+h,this._resizeHandler);
}},options:{name:"Spreadsheet",toolbar:true,sheetsbar:true,rows:200,columns:50,rowHeight:20,columnWidth:64,headerHeight:20,headerWidth:32,excel:{proxyURL:"",fileName:"Workbook.xlsx"},messages:{},pdf:{area:"workbook",fileName:"Workbook.pdf",proxyURL:"",paperSize:"a4",landscape:true,margin:null,title:null,author:null,subject:null,keywords:null,creator:"Kendo UI PDF Generator v."+f.version,date:null},defaultCellStyle:{fontFamily:"Arial",fontSize:"12"},useCultureDecimals:false},defineName:function(o,p,n){return this._workbook.defineName(o,p,n);
},undefineName:function(n){return this._workbook.undefineName(n);
},nameValue:function(n){return this._workbook.nameValue(n);
},forEachName:function(n){return this._workbook.forEachName(n);
},cellContextMenu:function(){return this._view.cellContextMenu;
},rowHeaderContextMenu:function(){return this._view.rowHeaderContextMenu;
},colHeaderContextMenu:function(){return this._view.colHeaderContextMenu;
},addImage:function(n){return this._workbook.addImage(n);
},cleanupImages:function(){return this._workbook.cleanupImages();
},events:["cut","copy","paste","pdfExport","excelExport","excelImport","changing","change","render","removeSheet","selectSheet","renameSheet","insertRow","insertColumn","deleteRow","insertSheet","deleteColumn","hideRow","hideColumn","unhideRow","unhideColumn","select","changeFormat","dataBinding","dataBound"]});
f.spreadsheet.ALL_REASONS=c;
f.ui.plugin(i);
b.extend(true,i,{classNames:d});
}(window.kendo));
return window.kendo;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
